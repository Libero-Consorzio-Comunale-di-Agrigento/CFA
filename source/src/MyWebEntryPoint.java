// **********************************************
// Web Entry Point (session handler)
// Instant WEB Application: www.progamma.com
// Project : Cfa
// **********************************************

import com.progamma.is.*;
import com.progamma.*;
import com.progamma.doc.*;
import com.progamma.idre.CIDREObj;
import com.progamma.idre.IDREGlb;

import java.io.*;
import java.util.*;
import java.util.zip.*;
import java.math.*;
import java.sql.*;
import javax.servlet.*;
import javax.servlet.http.*;



// **********************************************
// Classe base della servlet
// **********************************************
public final class MyWebEntryPoint extends WebEntryPoint
{
  public WebEntryPoint CreateWEP() { return new MyWebEntryPoint(Parent()); }
    
  boolean PreDesktopRendered = true;   // Pre-Inizializzazione: serve per bypassare il problema dell'F5 con videata di login (vedi NPQ 955)
  public MyWebEntryPoint MainFrm=this;
  //
  // Definition of Database Objects
  public Cf4armDB Cf4armDBObject;
  //
  // Definition of External Components
  public Blobindecomp.MyWebEntryPoint BlobindecompObject = null;
  //
  // Definition of Global Variables
  public IDVariant INTERRSOGGET = new IDVariant(0,IDVariant.STRING);
  public IDVariant MESSEGINSSOG = new IDVariant(0,IDVariant.STRING);
  public IDVariant MAXIDCRONO = new IDVariant(0,IDVariant.INTEGER);
  public IDArray VALORICOMUNI = new IDArray();
  public IDVariant GESTIODELIBE = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant GESTIOECONOM = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant RETVALT99 = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant TIPOORDINATI = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant PROCEDUBUONI = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIACCCF4O = new IDVariant(0,IDVariant.STRING);
  public IDVariant ORDINAPROGET = new IDVariant(0,IDVariant.STRING);
  public IDVariant FINSUB = new IDVariant(0,IDVariant.STRING);
  public IDVariant FILTROOBIETT = new IDVariant(0,IDVariant.STRING);
  public IDVariant OBIETTOBBLIG = new IDVariant(0,IDVariant.STRING);
  public IDVariant CONTRFINIMPE = new IDVariant(0,IDVariant.STRING);
  public IDVariant MODAIMPUSPES = new IDVariant(0,IDVariant.STRING);
  public IDVariant MODAIMPUENTR = new IDVariant(0,IDVariant.STRING);
  public IDVariant RESPONSABRES = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIOIMPEGN = new IDVariant(0,IDVariant.STRING);
  public IDVariant DATAINIZSIOP = new IDVariant(0,IDVariant.DATETIME);
  public IDVariant PROCEDPERSON = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant ORDIELENDOCU = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant INTEGRAZIGC4 = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant RETTE = new IDVariant(0,IDVariant.STRING);
  public IDVariant CORRISMODIFI = new IDVariant(0,IDVariant.STRING);
  public IDVariant CONTROSERCOS = new IDVariant(0,IDVariant.STRING);
  public IDVariant SEIMPNEGLIPE = new IDVariant(0,IDVariant.STRING);
  public IDVariant RITORCCPROVV = new IDVariant(0,IDVariant.STRING);
  public IDVariant TRACCIATPERS = new IDVariant(0,IDVariant.STRING);
  public IDVariant ABILITIMPDOC = new IDVariant(0,IDVariant.STRING);
  public IDVariant BLOCCSTNTEST = new IDVariant(0,IDVariant.STRING);
  public IDVariant PROTOCAUTOMA = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIOBARCOD = new IDVariant(0,IDVariant.STRING);
  public IDVariant BLOCCTIPOVAR = new IDVariant(0,IDVariant.STRING);
  public IDVariant TIPOENTE = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIOFATTUR = new IDVariant(0,IDVariant.STRING);
  public IDVariant TIPTOTLIQMUL = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant TIPOVARNQ = new IDVariant(0,IDVariant.STRING);
  public IDVariant PROGETOBBLIG = new IDVariant(0,IDVariant.STRING);
  public IDVariant FLAGBUONI = new IDVariant(0,IDVariant.STRING);
  public IDVariant CLASSEORD = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant FLAIVANONSOG = new IDVariant(0,IDVariant.STRING);
  public IDVariant BLOCFATTDOPP = new IDVariant(0,IDVariant.STRING);
  public IDVariant CODICEPERS = new IDVariant(0,IDVariant.STRING);
  public IDVariant ESERCIZIO_INIZIO_WEB = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant CAUSALE_LIQ_AUTO = new IDVariant(0,IDVariant.STRING);
  public IDVariant FILTRO_EC = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant FLAG_EC_MO = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant G_I = new IDVariant(0,IDVariant.STRING);
  public IDVariant TIPO_EMISS_ACC_PROVV = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant CONTROLLO_PC = new IDVariant(0,IDVariant.STRING);
  public IDVariant IMPOCONTEQUI = new IDVariant(0,IDVariant.DECIMAL);
  public IDVariant LIQMO = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTOBIEATTI = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant DATARIFRITEN = new IDVariant(0,IDVariant.STRING);
  public IDVariant ORDISTAMMAND = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant TIPOSFMA = new IDVariant(0,IDVariant.STRING);
  public IDVariant CONTROIVALIQ = new IDVariant(0,IDVariant.STRING);
  public IDVariant PVBPS4 = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant NUMFINAUTO = new IDVariant(0,IDVariant.STRING);
  public IDVariant INIZGESTCRON = new IDVariant(0,IDVariant.DATETIME);
  public IDVariant CONTRCOMPFIN = new IDVariant(0,IDVariant.STRING);
  public IDVariant FINEGESTCRON = new IDVariant(0,IDVariant.DATETIME);
  public IDVariant CONTRCASSLIQ = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant CONCASLIQEMI = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant NUMOPEAUTO = new IDVariant(0,IDVariant.STRING);
  public IDVariant CONTRIMPPROV = new IDVariant(0,IDVariant.STRING);
  public IDVariant FILTRFATTPCF = new IDVariant(0,IDVariant.STRING);
  public IDVariant VOCETECNOPER = new IDVariant(0,IDVariant.STRING);
  public IDVariant PERIOVERSIVA = new IDVariant(0,IDVariant.STRING);
  public IDVariant RAGGRVERSIVA = new IDVariant(0,IDVariant.STRING);
  public IDVariant CONTRORILIVA = new IDVariant(0,IDVariant.STRING);
  public IDVariant FATTORARCONE = new IDVariant(0,IDVariant.STRING);
  public IDVariant CONREGLIQFAT = new IDVariant(0,IDVariant.STRING);
  public IDVariant ECOSTANDALON = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIOCESPIT = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant PASSAGGIOCI4 = new IDVariant(0,IDVariant.STRING);
  public IDVariant EMISPARZPROS = new IDVariant(0,IDVariant.STRING);
  public IDVariant COLLEGAMEDUP = new IDVariant(0,IDVariant.STRING);
  public IDVariant MOVLIQCISUIM = new IDVariant(0,IDVariant.STRING);
  public IDVariant DATAESIGIVA = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIONBOLLE = new IDVariant(0,IDVariant.STRING);
  public IDVariant CONTROLLO_ORDINI_RES = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant AGG_DATA_EMISS_O = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant AGG_VOCE_ECON_O = new IDVariant(0,IDVariant.STRING);
  public IDVariant AGG_CGU_O = new IDVariant(0,IDVariant.STRING);
  public IDVariant AGG_FATTORE_O = new IDVariant(0,IDVariant.STRING);
  public IDVariant AGG_PREZZO_O = new IDVariant(0,IDVariant.STRING);
  public IDVariant INTEGRAZIONE_GDM = new IDVariant(0,IDVariant.STRING);
  public IDVariant IDSUDUNISUPD = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant AGGQUIETDISP = new IDVariant(0,IDVariant.STRING);
  public IDVariant ST_COD_FORNITORE_D = new IDVariant(0,IDVariant.STRING);
  public IDVariant ST_CGU_D = new IDVariant(0,IDVariant.STRING);
  public IDVariant ST_FATTORE_D = new IDVariant(0,IDVariant.STRING);
  public IDVariant ST_CENTRO_D = new IDVariant(0,IDVariant.STRING);
  public IDVariant ST_SCADENZA_D = new IDVariant(0,IDVariant.STRING);
  public IDVariant ST_UTENTE_D = new IDVariant(0,IDVariant.STRING);
  public IDVariant SCADENZA_DISTINTA_O = new IDVariant(0,IDVariant.STRING);
  public IDVariant TOLLERANZA_CONTROLLO = new IDVariant(0,IDVariant.DECIMAL);
  public IDVariant LIQUCONTFATT = new IDVariant(0,IDVariant.STRING);
  public IDVariant PUBBAUTOART1 = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIOVARBUO = new IDVariant(0,IDVariant.STRING);
  public IDVariant CONDATBUOFAT = new IDVariant(0,IDVariant.STRING);
  public IDVariant MODALCREAXML = new IDVariant(0,IDVariant.STRING);
  public IDVariant SERVLETURL = new IDVariant(0,IDVariant.STRING);
  public IDVariant DIMMAXFILE = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant MAXDETTFILE = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant VALIDAZIFILE = new IDVariant(0,IDVariant.STRING);
  public IDVariant SIOPELINK = new IDVariant(0,IDVariant.STRING);
  public IDVariant LIIVTIDESIIV = new IDVariant(0,IDVariant.STRING);
  public IDVariant CODIDOCNOCOM = new IDVariant(0,IDVariant.STRING);
  public IDVariant DATA_INIZIO_MAND_INF = new IDVariant(0,IDVariant.DATETIME);
  public IDVariant DATA_INIZIO_ORD_INF = new IDVariant(0,IDVariant.DATETIME);
  public IDVariant TIPO_MINF = new IDVariant(0,IDVariant.STRING);
  public IDVariant CODICE_TESORERIA = new IDVariant(0,IDVariant.STRING);
  public IDVariant CODICE_ENTE = new IDVariant(0,IDVariant.STRING);
  public IDVariant CODICE_FILIALE = new IDVariant(0,IDVariant.STRING);
  public IDVariant PRIMO_PROG_TESO = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant TIPO_SUB_MAN = new IDVariant(0,IDVariant.STRING);
  public IDVariant MOD_PAGAM_DIVERSE = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIONE_ORD_ASSOCIATI = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIONE_ANNULLI = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIONE_SOSTITUZIONI = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIONE_VARIAZIONI = new IDVariant(0,IDVariant.STRING);
  public IDVariant TIPO_SUB_ORD = new IDVariant(0,IDVariant.STRING);
  public IDVariant TIPO_INC_PAG = new IDVariant(0,IDVariant.STRING);
  public IDVariant GENERA_XML = new IDVariant(0,IDVariant.STRING);
  public IDVariant SPESE_DA_SOGGETTO = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIONSPESE = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIOCOMMIS = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIOALLEGA = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTINFOTESO = new IDVariant(0,IDVariant.STRING);
  public IDVariant MANDATCOPERT = new IDVariant(0,IDVariant.STRING);
  public IDVariant SUDDIVISIONE_UNITA_SUP = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant OTTICA = new IDVariant(0,IDVariant.STRING);
  public IDVariant ATTILIQ = new IDVariant(0,IDVariant.STRING);
  public IDVariant SUDDIVUFFICI = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant SUDDUNITSUP2 = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant COMPETFINANZ = new IDVariant(0,IDVariant.STRING);
  public IDVariant INTEMPOBIGES = new IDVariant(0,IDVariant.STRING);
  public IDVariant PLUGINSFERA = new IDVariant(0,IDVariant.STRING);
  public IDVariant ANAGRACONDIV = new IDVariant(0,IDVariant.STRING);
  public IDVariant PLUGINDISTLI = new IDVariant(0,IDVariant.STRING);
  public IDVariant PLUGINDISTOR = new IDVariant(0,IDVariant.STRING);
  public IDVariant PLUGINDISTEC = new IDVariant(0,IDVariant.STRING);
  public IDVariant INTEGRGDMLIQ = new IDVariant(0,IDVariant.STRING);
  public IDVariant SCADENZADIST = new IDVariant(0,IDVariant.STRING);
  public IDVariant POLSUDUNISUP = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant SEGDATMANART = new IDVariant(0,IDVariant.STRING);
  public IDVariant DIRCENTRALE = new IDVariant(0,IDVariant.STRING);
  public IDVariant BLOCCOPROPOS = new IDVariant(0,IDVariant.STRING);
  public IDVariant PERCSTAMPERS = new IDVariant(0,IDVariant.STRING);
  public IDVariant ESEPIACONMOD = new IDVariant(0,IDVariant.STRING);
  public IDVariant DATAEMISSION = new IDVariant(0,IDVariant.STRING);
  public IDVariant CODICEUTENZA = new IDVariant(0,IDVariant.STRING);
  public IDVariant UTENDATAARRI = new IDVariant(0,IDVariant.STRING);
  public IDVariant NUMEPROTGENE = new IDVariant(0,IDVariant.STRING);
  public IDVariant DATAPROTINTE = new IDVariant(0,IDVariant.STRING);
  public IDVariant GUIDAUOGESTI = new IDVariant(0,IDVariant.STRING);
  public IDVariant GUIDAUOUTILI = new IDVariant(0,IDVariant.STRING);
  public IDVariant MODDISELILIQ = new IDVariant(0,IDVariant.STRING);
  public IDVariant PRIMOESERARM = new IDVariant(0,IDVariant.STRING);
  public IDVariant DISTINPARZIA = new IDVariant(0,IDVariant.STRING);
  public IDVariant SIBEC = new IDVariant(0,IDVariant.STRING);
  public IDVariant GENVARIMPSUB = new IDVariant(0,IDVariant.STRING);
  public IDVariant FECFAATTIVA = new IDVariant(0,IDVariant.STRING);
  public IDVariant LABECAMPLIB1 = new IDVariant(0,IDVariant.STRING);
  public IDVariant LABECAMPLIB2 = new IDVariant(0,IDVariant.STRING);
  public IDVariant VISUCHECDIST = new IDVariant(0,IDVariant.STRING);
  public IDVariant LABELACCETTA = new IDVariant(0,IDVariant.STRING);
  public IDVariant CONSENRIFIUT = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTTRATMIST = new IDVariant(0,IDVariant.STRING);
  public IDVariant INTEGRAZIPBM = new IDVariant(0,IDVariant.STRING);
  public IDVariant ATTIVASTATIS = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTCONTECON = new IDVariant(0,IDVariant.STRING);
  public IDVariant PRIESECONECO = new IDVariant(0,IDVariant.STRING);
  public IDVariant DETTIMPENETT = new IDVariant(0,IDVariant.STRING);
  public IDVariant URLCAMPIAGGI = new IDVariant(0,IDVariant.STRING);
  public IDVariant URLWSGDMSIOP = new IDVariant(0,IDVariant.STRING);
  public IDVariant INTEGRAZIPCC = new IDVariant(0,IDVariant.STRING);
  public IDVariant PCCMAXNUM = new IDVariant(0,IDVariant.STRING);
  public IDVariant DATAINIZIDOC = new IDVariant(0,IDVariant.STRING);
  public IDVariant MODDOCUMENTO = new IDVariant(0,IDVariant.STRING);
  public IDVariant ESITODOC002 = new IDVariant(0,IDVariant.STRING);
  public IDVariant BLOCCMODIFFE = new IDVariant(0,IDVariant.STRING);
  public IDVariant MODREISTNIMP = new IDVariant(0,IDVariant.STRING);
  public IDVariant NUMESEPLUFCD = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant NUMESEPLUFPV = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant SOSPFATTURE = new IDVariant(0,IDVariant.STRING);
  public IDVariant COMPFUNZSMIS = new IDVariant(0,IDVariant.STRING);
  public IDVariant PERINVCOMFAT = new IDVariant(0,IDVariant.STRING);
  public IDVariant PERINVCOFAES = new IDVariant(0,IDVariant.STRING);
  public IDVariant SALVFILESTAM = new IDVariant(0,IDVariant.STRING);
  public IDVariant IMPOUFFSZERO = new IDVariant(0,IDVariant.STRING);
  public IDVariant FCEATTCOFACO = new IDVariant(0,IDVariant.STRING);
  public IDVariant FCEURL = new IDVariant(0,IDVariant.STRING);
  public IDVariant TIPOVAROBBLI = new IDVariant(0,IDVariant.STRING);
  public IDVariant PAGOPATIPINT = new IDVariant(0,IDVariant.STRING);
  public IDVariant EFILENDPOINT = new IDVariant(0,IDVariant.STRING);
  public IDVariant EFILNAMESPAC = new IDVariant(0,IDVariant.STRING);
  public IDVariant EFILCODIENTE = new IDVariant(0,IDVariant.STRING);
  public IDVariant EFILIDAPPLIC = new IDVariant(0,IDVariant.STRING);
  public IDVariant EFILSADETTAG = new IDVariant(0,IDVariant.STRING);
  public IDVariant EFILSAIUVPER = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIONEIMP = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIONELIQ = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIONEORD = new IDVariant(0,IDVariant.STRING);
  public IDVariant GESTIODISTIN = new IDVariant(0,IDVariant.STRING);
  public IDVariant SOLOIMPESECU = new IDVariant(0,IDVariant.STRING);
  public IDVariant BLOCCOELIMIN = new IDVariant(0,IDVariant.STRING);
  public IDVariant TIPOTRASCO = new IDVariant(0,IDVariant.STRING);
  public IDVariant PROVENIENCF4 = new IDVariant(0,IDVariant.STRING);
  public IDVariant GDMCONNTYPE = new IDVariant(0,IDVariant.STRING);
  public IDVariant GDMURL = new IDVariant(0,IDVariant.STRING);
  public IDVariant GDMSSO = new IDVariant(0,IDVariant.STRING);
  public IDVariant FEACCETTADOD = new IDVariant(0,IDVariant.STRING);
  public IDVariant FORZASCADENZ = new IDVariant(0,IDVariant.STRING);
  public IDVariant ESERCIZIO = new IDVariant(0,IDVariant.STRING);
  public IDVariant PROGRESESSIO = new IDVariant(0,IDVariant.DECIMAL);
  public IDVariant FASEBILANCIO = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant FINANZIAMENT = new IDVariant(0,IDVariant.INTEGER);
  public Afc AFC = null;
  public IDVariant TEST = new IDVariant(0,IDVariant.STRING);
  public IDVariant COMPETENZA = new IDVariant(0,IDVariant.STRING);
  public IDVariant SIOPEATTIARM = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant VISRETTMASSI = new IDVariant(0,IDVariant.INTEGER);
  public IDVariant SALVATAGFILE = new IDVariant(0,IDVariant.INTEGER);
  //  
  
  
  // **********************************************
  // Setting Global panel flags
  // **********************************************
  public void InitPanelGlbFlags()
  {
    GlbPanelFlags = MyGlb.PAN_USERETURN | MyGlb.PAN_CANSORT;
    if (MyParamsObj().PanelsUseTab.equals("YES")) GlbPanelFlags = GlbPanelFlags | MyGlb.PAN_USETAB;
    if (MyParamsObj().PanelsSortAlways.equals("YES")) GlbPanelFlags = GlbPanelFlags | MyGlb.PAN_SORTALWAYS;
    if (MyParamsObj().PanelNewInsertMode.equals("YES")) GlbPanelFlags = GlbPanelFlags | MyGlb.PAN_NEWINSMODE;
    if (MyParamsObj().PanelFreezeWhenHidden.equals("YES")) GlbPanelFlags = GlbPanelFlags | Glb.PAN_FREEWHENHID;   
    //
    WelcomeURL = "qHelpCfaid.htm";
    LogoffURL = "./logout.htm";
    set_Image("");
    //
    try
    {
      iAccentColor = Integer.parseInt("0081C2", 16);
      // Inverto la parte rossa e blu
      iAccentColor = ((iAccentColor & 0xFF0000) >> 16) + (iAccentColor & 0x00FF00) + ((iAccentColor & 0x0000FF) << 16);
      //
      iSecondaryColor = Integer.parseInt("32DB64", 16);
      // Inverto la parte rossa e blu
      iSecondaryColor = ((iSecondaryColor & 0xFF0000) >> 16) + (iSecondaryColor & 0x00FF00) + ((iSecondaryColor & 0x0000FF) << 16);
      //
      iDangerColor = Integer.parseInt("F53D3D", 16);
      // Inverto la parte rossa e blu
      iDangerColor = ((iDangerColor & 0xFF0000) >> 16) + (iDangerColor & 0x00FF00) + ((iDangerColor & 0x0000FF) << 16);
      //
      iLightColor = Integer.parseInt("F4F4F4", 16);
      // Inverto la parte rossa e blu
      iLightColor = ((iLightColor & 0xFF0000) >> 16) + (iLightColor & 0x00FF00) + ((iLightColor & 0x0000FF) << 16);
      //
      iDarkColor = Integer.parseInt("222222", 16);
      // Inverto la parte rossa e blu
      iDarkColor = ((iDarkColor & 0xFF0000) >> 16) + (iDarkColor & 0x00FF00) + ((iDarkColor & 0x0000FF) << 16);
      //
      iBrightColor = Integer.parseInt("FFC125", 16);
      // Inverto la parte rossa e blu
      iBrightColor = ((iBrightColor & 0xFF0000) >> 16) + (iBrightColor & 0x00FF00) + ((iBrightColor & 0x0000FF) << 16);
      //
      iVibrantColor = Integer.parseInt("663399", 16);
      // Inverto la parte rossa e blu
      iVibrantColor = ((iVibrantColor & 0xFF0000) >> 16) + (iVibrantColor & 0x00FF00) + ((iVibrantColor & 0x0000FF) << 16);
    }
    catch (Exception e)
    {
    }
  }
  
  
  // **********************************************
  // Logging a Message
  // **********************************************
  public void log(String Message)
  {
    Parent().log(Message);
    System.err.println(Message);
  }

  
  // ************************************************
  // Determina il MimeType a partire dall'estensione
  // ************************************************
  public String GetMimeType(String ext)
  {
    String m = Parent().getMimeType("pippo."+ext);
    //
    // Se non lo trovo... provo con il minuscolo!
    if (m==null)
      m = Parent().getMimeType("pippo."+ext.toLowerCase());
    //
    // Se non l'ho trovato, uso la mia mappa
    if (m == null || m.length() == 0)
      m = GetMimeFromExtension(ext);
    //
    return m;
  }

  // **********************************************
  // La sessione sta per essere attivata dopo la deserializzazione!
  // **********************************************
  public void SetParent(ServletContext p)
  {
    set_Parent(p);
    IMDB.Reset();
  }
  

  // **********************************************
  // Una nuova sessione è iniziata!
  // **********************************************
  public MyWebEntryPoint(ServletContext p)
  {
    super();
    //
    RevNum = 47511;
    IDVer = "19.5.7600";
    AppVersion = "16.0";
    AppName = "/Cfaid/Cfaid.htm";
    iParamsObj = new MyParams();
    //
    // Se non sono un componente
    if (!Glb.ClassWithPackage(getClass()))
    {
      // Se ci sono componenti in fase di inizializzazione non posso proseguire
      if (cmpInited == 1)
      {
        // I componenti stanno per essere inizializzati, aspetto che sia tutto finito
        long dt = System.currentTimeMillis();
        while (cmpInited != 2)
        {
          try { java.lang.Thread.sleep(50); } catch (Exception e) {}
          //
          // Non aspetto all'infinito... se entro 5 secondi non finisce... forse è morto... ci provo io
          // e lascio entrare gli altri
          if (System.currentTimeMillis() - dt > 5000)
            cmpInited = 2;
        }
      }
      else if (cmpInited == 0)    // Se non sono ancora stati inizializzati i componenti, ci penso io
        cmpInited = 1;
    }
    //
    set_Parent(p);
    CmdObj = new MyCmdHandler(this);
    IndObj = new MyIndHandler(this);
    TimerObj = new MyTimerHandler(this);
    IwImdb = new MyImdbInit(this);
    RTCObj = new RTCEngine(this);
    RTCObj.AppGuid = "28CB08B1-6612-481F-984E-8CC5C1860039";
    VoiceObj = new VoiceHandler(this);
    IMDB = IwImdb.IMDB;
    //
    // Creo le ScreenZone
    if (UseZones())
    {
      ScreenZone sz = new ScreenZone(this, 0, Glb.FORMDOCK_LEFT, Glb.TABOR_LEFT);
      screenZones.add(sz);
      sz = new ScreenZone(this, 1, Glb.FORMDOCK_RIGHT, Glb.TABOR_RIGHT);
      screenZones.add(sz);
      sz = new ScreenZone(this, 2, Glb.FORMDOCK_TOP, Glb.TABOR_TOP);
      screenZones.add(sz);
      sz = new ScreenZone(this, 3, Glb.FORMDOCK_BOTTOM, Glb.TABOR_BOTTOM);
      screenZones.add(sz);
    }
    //
    // Creation of Database Objects
    Cf4armDBObject = new Cf4armDB(this);
    SyncObject.SetSyncDB(Cf4armDBObject);
    //
    GZipEnabled = 1; // unknown
    ResBuf = new StringBuffer(20 * 1024);
    RDStatus = MyGlb.RD_DISABLED;
    //
    set_Caption(new IDVariant("Cfaid"));
    InitPanelGlbFlags();
    IntSesNumber = (int)(Math.random() * 2147483647);
    UseRD = ParamsObj().UseRD;
    //
    // Initialize Visual Attributes
    //
    VisAttrObj v = null; 
    //
    DTTObj.Init (0, 0, false, false, false, this);
    //
    VisualStyleList.set_Size(MyGlb.MAX_VISATTR);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_DEFAPANESTYL, v);
    v.iGuid = "2CBA05B6-623A-11D4-BDF0-301B4CC10101";
    v.set_Alignment(1, 1);
    v.set_Alignment(2, 1);
    v.set_Alignment(3, 1);
    v.set_ControlType(1);
    v.set_ClassName("");
    v.set_Mask("");
    v.set_Cursor("");
    v.set_RowOffset(0);
    v.set_HeaderOffset(4);
    v.set_Flags(786689);
    v.set_Color(1, 3812643);
    v.set_GradCol(1, -1);
    v.set_GradDir(1, 1);
    v.set_Opacity(1, 100);
    v.set_Color(2, 3812643);
    v.set_GradCol(2, -1);
    v.set_GradDir(2, 1);
    v.set_Opacity(2, 100);
    v.set_Color(3, 3812643);
    v.set_GradCol(3, -1);
    v.set_GradDir(3, 1);
    v.set_Opacity(3, 100);
    v.set_Color(4, 16777215);
    v.set_GradCol(4, -1);
    v.set_GradDir(4, 1);
    v.set_Opacity(4, 100);
    v.set_Color(5, 16777215);
    v.set_GradCol(5, -1);
    v.set_GradDir(5, 1);
    v.set_Opacity(5, 100);
    v.set_Color(6, 15852764);
    v.set_GradCol(6, -1);
    v.set_GradDir(6, 1);
    v.set_Opacity(6, 100);
    v.set_Color(7, 16117741);
    v.set_GradCol(7, 14930895);
    v.set_GradDir(7, 3);
    v.set_Opacity(7, 100);
    v.set_Color(8, 16117741);
    v.set_GradCol(8, 14930895);
    v.set_GradDir(8, 3);
    v.set_Opacity(8, 100);
    v.set_Color(9, 16110211);
    v.set_GradCol(9, -1);
    v.set_GradDir(9, 1);
    v.set_Opacity(9, 100);
    v.set_Color(10, 16777215);
    v.set_GradCol(10, -1);
    v.set_GradDir(10, 1);
    v.set_Opacity(10, 100);
    v.set_Color(11, 12164479);
    v.set_GradCol(11, -1);
    v.set_GradDir(11, 1);
    v.set_Opacity(11, 100);
    v.set_Color(12, -1);
    v.set_GradCol(12, -1);
    v.set_GradDir(12, 1);
    v.set_Opacity(12, 100);
    v.set_Color(13, 3812643);
    v.set_GradCol(13, -1);
    v.set_GradDir(13, 1);
    v.set_Opacity(13, 100);
    v.set_Color(14, 16110211);
    v.set_GradCol(14, -1);
    v.set_GradDir(14, 1);
    v.set_Opacity(14, 100);
    v.set_Color(15, 16117741);
    v.set_GradCol(15, -1);
    v.set_GradDir(15, 1);
    v.set_Opacity(15, 100);
    v.set_Color(16, 16110211);
    v.set_GradCol(16, -1);
    v.set_GradDir(16, 1);
    v.set_Opacity(16, 100);
    v.set_Color(17, -1);
    v.set_GradCol(17, -1);
    v.set_GradDir(17, 1);
    v.set_Opacity(17, 100);
    v.set_Color(18, -1);
    v.set_GradCol(18, -1);
    v.set_GradDir(18, 1);
    v.set_Opacity(18, 100);
    v.set_Color(19, -1);
    v.set_GradCol(19, -1);
    v.set_GradDir(19, 1);
    v.set_Opacity(19, 100);
    v.set_Color(20, -1);
    v.set_GradCol(20, -1);
    v.set_GradDir(20, 1);
    v.set_Opacity(20, 100);
    v.set_Color(21, -1);
    v.set_GradCol(21, -1);
    v.set_GradDir(21, 1);
    v.set_Opacity(21, 100);
    v.set_Color(22, -1);
    v.set_GradCol(22, -1);
    v.set_GradDir(22, 1);
    v.set_Opacity(22, 100);
    v.set_Color(23, -1);
    v.set_GradCol(23, -1);
    v.set_GradDir(23, 1);
    v.set_Opacity(23, 100);
    v.set_BorderType(1, 4);
    v.set_BorderType(2, 4);
    v.set_BorderType(3, 4);
    v.set_BorderType(4, 1);
    v.set_BorderType(5, 2);
    v.set_BorderType(6, 4);
    v.set_Font(1, "Tahoma,,8");
    v.set_Font(2, "Tahoma,B,8");
    v.set_Font(3, "Tahoma,B,8");
    v.set_Font(4, "Tahoma,,8");
    v.set_Font(5, "Tahoma,,8");
    v.set_Font(6, "Tahoma,,8");
    v.set_HorizontalScale(0);
    v.set_LetterSpacing(0);
    v.set_WordSpacing(0);
    v.set_CBorColor(1, 13684944);
    v.set_CBorWidth(1, 0);
    v.set_CBorType(1, 1);
    v.set_CBorPadding(1, 0);
    v.set_CBorColor(2, 13684944);
    v.set_CBorWidth(2, 1);
    v.set_CBorType(2, 1);
    v.set_CBorPadding(2, 1);
    v.set_CBorColor(3, 13684944);
    v.set_CBorWidth(3, 1);
    v.set_CBorType(3, 1);
    v.set_CBorPadding(3, 1);
    v.set_CBorColor(4, 13684944);
    v.set_CBorWidth(4, 1);
    v.set_CBorType(4, 1);
    v.set_CBorPadding(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_PRIMAKEYFIEL, v);
    v.iGuid = "2CBA05B7-623A-11D4-BDF0-301B4CC10101";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Color(1, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_FOREIKEYFIEL, v);
    v.iGuid = "2CBA05B8-623A-11D4-BDF0-301B4CC10101";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMFIELPADR, v);
    v.iGuid = "2CBA05B9-623A-11D4-BDF0-301B4CC10101";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Alignment(3, 4);
    v.set_Color(18, 16777215);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_CURRENCY, v);
    v.iGuid = "CF724C72-5B4E-4B8F-8F19-743FED76239C";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Mask("###,###,##0.00");
    v.set_Flags(786433);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HYPERLINK1, v);
    v.iGuid = "F8F62CD0-ACFE-4E1F-983E-9FDD52D974F6";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Flags(2883585);
    v.set_Color(1, 16711680);
    v.set_Color(12, 14413275);
    v.set_Color(16, -1);
    v.set_Font(1, "Tahoma,U,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HYPELINKIMMA, v);
    v.iGuid = "A38F4112-DD5D-4080-9BCB-04043F694AF8";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_HYPERLINK1));
    v.set_Alignment(1, 3);
    v.set_Alignment(2, 3);
    v.set_Flags(2621441);
    v.set_Color(4, 16117741);
    v.set_Color(6, 14930895);
    v.set_Color(12, 15532006);
    v.set_Color(16, 16110211);
    v.set_Color(18, 16117741);
    v.set_BorderType(6, 1);
    v.set_Font(1, "Tahoma,,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HYPLINIMNOBO, v);
    v.iGuid = "A0601B2E-5DFB-4B2E-9866-49711CB560D3";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_HYPELINKIMMA));
    v.set_Flags(2621697);
    v.set_BorderType(1, 1);
    v.set_CBorColor(1, 16777215);
    v.set_CBorColor(2, 16777215);
    v.set_CBorColor(3, 16777215);
    v.set_CBorColor(4, 16777215);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HYPERLDISABI, v);
    v.iGuid = "8E03EC7C-DC99-4BE7-A867-FE68EEBAE085";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_HYPLINIMNOBO));
    v.set_Color(4, 14215660);
    v.set_Color(5, 14215660);
    v.set_Color(6, 14215660);
    v.set_Color(7, 14215660);
    v.set_Color(8, 14215660);
    v.set_Color(9, 14215660);
    v.set_Color(10, 14215660);
    v.set_Color(12, -1);
    v.set_Color(15, 14215660);
    v.set_Color(16, 14215660);
    v.set_Color(18, 14215660);
    v.set_Color(19, 14215660);
    v.set_Color(21, 14215660);
    v.set_Color(22, 14215660);
    v.set_Color(23, 14215660);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMMAGICENTRA, v);
    v.iGuid = "8EF32219-35B8-4215-A414-210B961F82FB";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_HYPELINKIMMA));
    v.set_Flags(2621697);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HYPLINIMLOU1, v);
    v.iGuid = "A39020BB-87C8-47FA-A464-209BE0302D02";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_HYPELINKIMMA));
    v.set_Color(5, 16117741);
    v.set_Color(6, 16117741);
    v.set_Color(10, 16110211);
    v.set_Color(16, 16117741);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HYLIIMNOBOVH, v);
    v.iGuid = "1121C91C-1BD1-46CB-BAB1-5601341A4B07";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_HYPELINKIMMA));
    v.set_Flags(2621697);
    v.set_BorderType(2, 2);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HYPLINSCRVER, v);
    v.iGuid = "1720A40A-1D7C-467B-BFF3-4A4F68D200C6";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_HYPELINKIMMA));
    v.set_Alignment(1, 2);
    v.set_Flags(3670273);
    v.set_Color(1, 32768);
    v.set_Color(4, 15852764);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HYPLINSCRROS, v);
    v.iGuid = "DEE38CFC-7F6A-4E1B-8940-8DE77C076A5A";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_HYPLINSCRVER));
    v.set_Color(1, 255);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HYPERLINKCF4, v);
    v.iGuid = "1A6A78FB-0530-4ADA-9A3D-4B8C04EF4AD5";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_HYPERLINK1));
    v.set_Color(6, 15660535);
    v.set_Color(9, 13690090);
    v.set_Color(15, -1116681);
    v.set_Color(16, -3087126);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HYPLINIMLOUP, v);
    v.iGuid = "68899192-CAAB-4141-9604-B3E7253DE066";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_HYPERLINK1));
    v.set_Alignment(1, 3);
    v.set_Alignment(2, 3);
    v.set_Alignment(3, 1);
    v.set_Flags(2621441);
    v.set_Color(2, 3952720);
    v.set_Color(3, 8998144);
    v.set_Color(4, 15660279);
    v.set_Color(5, 15660279);
    v.set_Color(6, 15660279);
    v.set_Color(7, 14085101);
    v.set_GradCol(7, -1);
    v.set_GradDir(7, 1);
    v.set_Color(8, 13166312);
    v.set_GradCol(8, -1);
    v.set_GradDir(8, 1);
    v.set_Color(9, 14215660);
    v.set_Color(10, -1);
    v.set_Color(13, 8998144);
    v.set_Color(14, 13695974);
    v.set_Color(15, 15660279);
    v.set_Color(18, -1);
    v.set_Font(1, "Tahoma,,8");
    v.set_Font(2, "Tahoma,,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMAGEBUTTONS, v);
    v.iGuid = "0DA61B84-90E1-4972-8845-90C783396021";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Flags(3932161);
    v.set_Color(4, 16117741);
    v.set_Color(5, 15852764);
    v.set_Color(6, 16117741);
    v.set_Color(9, 15852764);
    v.set_Color(10, 15852764);
    v.set_Color(15, 15852764);
    v.set_Color(16, 15852764);
    v.set_Color(18, 15852764);
    v.set_BorderType(1, 1);
    v.set_BorderType(6, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMALFIELDS, v);
    v.iGuid = "279BD267-AD7B-48FC-A0D2-CFE41C248C24";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Flags(1835009);
    v.set_Color(1, 3812131);
    v.set_Color(12, 16117741);
    v.set_GradCol(12, 14930895);
    v.set_GradDir(12, 3);
    v.set_Color(18, 16117741);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NOFINOBOVEHE, v);
    v.iGuid = "BEF78A26-258E-4296-AD13-29FD8AE0CB13";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALFIELDS));
    v.set_Flags(786689);
    v.set_BorderType(2, 2);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_STRINGINTERA, v);
    v.iGuid = "E480E83E-2606-4FCE-8263-2704F367E228";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALFIELDS));
    v.set_Mask("#####");
    v.set_Flags(786689);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HTMLNORMFIEL, v);
    v.iGuid = "DAD546CC-90D6-44A7-B4FE-664597E5B282";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALFIELDS));
    v.set_Mask("=");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_DATACENTRATA, v);
    v.iGuid = "BC69026E-10D4-4420-BD60-F1E5938F331E";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALFIELDS));
    v.set_Alignment(1, 3);
    v.set_Flags(786433);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VUOTOINLISTA, v);
    v.iGuid = "1B502BF2-A8DB-4899-A483-66FAF5A54F03";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALFIELDS));
    v.set_Flags(786433);
    v.set_Color(4, 15852764);
    v.set_Color(5, 15852764);
    v.set_Color(9, 15852764);
    v.set_Color(10, 15852764);
    v.set_Color(15, 15852764);
    v.set_Color(16, 15852764);
    v.set_Color(18, 15852764);
    v.set_Color(22, 15852764);
    v.set_BorderType(1, 1);
    v.set_BorderType(2, 1);
    v.set_BorderType(3, 1);
    v.set_Font(1, "Tahoma,B,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMFIELBUTT, v);
    v.iGuid = "830888BD-3F1D-4A16-85B2-164A4B914839";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALFIELDS));
    v.set_Flags(786433);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMFIELMAIU, v);
    v.iGuid = "120D91CD-C406-405F-A867-CCB0B4B89267";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALFIELDS));
    v.set_Mask(">");
    v.set_Flags(786433);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMAFIELBLU, v);
    v.iGuid = "D032D33A-036F-48F5-ACBA-88EDCAB5AACD";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALFIELDS));
    v.set_Flags(786433);
    v.set_Color(1, 16711680);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIECF4IMP, v);
    v.iGuid = "69954695-1B73-465E-831D-7DD75C68E19A";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Mask("###,###,###,##0.00");
    v.set_Color(1, 3812131);
    v.set_GradCol(8, 15852764);
    v.set_Color(18, 16117741);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIEIMPBLU, v);
    v.iGuid = "47968074-0EE2-42ED-96B0-7B3913D2B72A";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIECF4IMP));
    v.set_Color(1, 16711680);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIECFIMRO, v);
    v.iGuid = "8BBFA99A-56A0-4352-8E20-0ED34ACFA850";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIECF4IMP));
    v.set_Flags(786433);
    v.set_Color(1, 255);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NOFICFIMHELE, v);
    v.iGuid = "03A5EC4E-9FEE-40E7-9B8B-2BAA094323E7";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIECF4IMP));
    v.set_Alignment(2, 2);
    v.set_Alignment(3, 2);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMPORT3DECIM, v);
    v.iGuid = "FE3367C7-A7D8-4682-9D3B-C589C07A6C31";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIECF4IMP));
    v.set_Mask("###,###,##0.000");
    v.set_Flags(786433);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIETESVIO, v);
    v.iGuid = "B1E299B6-1CBA-47A0-9D75-E54F76F9A916";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIECF4IMP));
    v.set_Mask("");
    v.set_Flags(786433);
    v.set_Color(1, 6750336);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIETESROS, v);
    v.iGuid = "A1E2519C-EE3F-4395-A156-727785138EB7";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIECF4IMP));
    v.set_Mask("");
    v.set_Flags(786433);
    v.set_Color(1, 255);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIETESVER, v);
    v.iGuid = "0FB8C2E1-9D22-4202-82DF-AA204D4881B8";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIECF4IMP));
    v.set_Mask("");
    v.set_Color(1, 32768);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMPOINPARSTA, v);
    v.iGuid = "6433E4BC-D221-4615-8F0F-37F4442053C2";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIECF4IMP));
    v.set_Color(9, 15793151);
    v.set_Color(15, 15852764);
    v.set_Color(16, 15852764);
    v.set_Color(18, 15852764);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMINPASTNOBO, v);
    v.iGuid = "386990A3-31F5-4E5B-B595-192E96A8DD69";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_IMPOINPARSTA));
    v.set_Flags(786433);
    v.set_BorderType(1, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMAFIELCF5, v);
    v.iGuid = "0BFCFB45-B236-4816-8FA4-1560D56E8860";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Flags(786433);
    v.set_BorderType(1, 9);
    v.set_CBorColor(2, 13959039);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIECF4CA2, v);
    v.iGuid = "20ADF70C-C8E9-4C33-A8DA-CFB286F3AE33";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMAFIELCF5));
    v.set_Mask("00000");
    v.set_Flags(786689);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_ERRORMESSAGE, v);
    v.iGuid = "B3503E70-9989-46D3-85A2-CE19D85C1470";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Alignment(1, 3);
    v.set_Flags(1835265);
    v.set_Color(1, 16711680);
    v.set_BorderType(6, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_SENZABORDI, v);
    v.iGuid = "2095D24D-60E1-43F2-AFC4-FD4103223944";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Flags(1835009);
    v.set_Color(1, 11141120);
    v.set_Color(11, 16777215);
    v.set_CBorWidth(2, 0);
    v.set_CBorWidth(3, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_CAMPOTOTALE, v);
    v.iGuid = "25B1D2E6-B962-44EB-90F7-5187D13EF946";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Mask("###,###,###,##0.00");
    v.set_Flags(1310721);
    v.set_Color(1, 11141120);
    v.set_Color(15, 15660279);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIECFHELE, v);
    v.iGuid = "B2268C77-96D4-4A7C-9AED-A57C68BF33B4";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Alignment(2, 2);
    v.set_Alignment(3, 2);
    v.set_Flags(786433);
    v.set_Color(1, 0);
    v.set_Color(18, 16117741);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIECF4CA3, v);
    v.iGuid = "E1380C83-3864-4E47-91C7-070E94822A7C";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIECFHELE));
    v.set_Mask("00000");
    v.set_Flags(786689);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_CAMPTOTADISA, v);
    v.iGuid = "5D1BAAD3-8D05-45F9-A581-1B9A4F6FFE45";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Alignment(1, 4);
    v.set_Alignment(2, 4);
    v.set_Mask("###,###,###,##0.00");
    v.set_Color(1, 0);
    v.set_Color(4, 16117741);
    v.set_Color(16, 13690090);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_CAMTOTDISROS, v);
    v.iGuid = "A17614F6-EC36-4DE6-990E-3947C13C7A42";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_CAMPTOTADISA));
    v.set_Flags(1835265);
    v.set_Color(1, 255);
    v.set_Color(2, 3952720);
    v.set_Color(3, 8998144);
    v.set_Color(4, 15660279);
    v.set_Color(6, 16054778);
    v.set_Color(7, 16382457);
    v.set_GradCol(7, 15658219);
    v.set_Color(8, 16777215);
    v.set_GradCol(8, 15658219);
    v.set_Color(9, 16446446);
    v.set_Color(10, -1);
    v.set_Color(11, 13547166);
    v.set_Color(13, 8998144);
    v.set_Color(14, 14811106);
    v.set_Color(15, 15856627);
    v.set_Color(18, -1);
    v.set_Font(2, "Tahoma,,8");
    v.set_CBorWidth(2, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_CAMTOTDISRO1, v);
    v.iGuid = "CBAAE230-58AD-470B-A1F6-628368EDEBD7";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_CAMPTOTADISA));
    v.set_Flags(1835009);
    v.set_Color(1, 255);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_CAMCONSFOGRI, v);
    v.iGuid = "F1552E26-6C87-45A9-8D22-F3705DE54E1C";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Alignment(1, 3);
    v.set_Flags(1835009);
    v.set_Color(1, 0);
    v.set_Color(4, 13555414);
    v.set_BorderType(6, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIEHEALLE, v);
    v.iGuid = "7725F3E5-0DB6-4F78-A0E6-041802E73A3E";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Alignment(3, 2);
    v.set_Flags(786433);
    v.set_Color(1, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIECF4CA4, v);
    v.iGuid = "E134D5A5-2D0E-46FA-AB3E-AB18B050E27E";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIEHEALLE));
    v.set_Mask("00000");
    v.set_Flags(786689);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_CAMPODISABIL, v);
    v.iGuid = "928E079D-132D-4179-BB29-1E6BE9DCE273";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Flags(1835009);
    v.set_Color(1, 11141120);
    v.set_Color(4, 16117741);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_DISABIIMPORT, v);
    v.iGuid = "FC725E8B-2D75-4FA5-A604-7250F0A7F013";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_CAMPODISABIL));
    v.set_Mask("###,###,###,##0.00");
    v.set_Flags(786689);
    v.set_Color(1, 3812643);
    v.set_Color(6, 16117741);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMPBOLNOFICF, v);
    v.iGuid = "43EE9848-C6FB-48AF-B73C-6ED3D5231C83";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Mask("##,###,##0.00");
    v.set_Flags(1835009);
    v.set_Color(1, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_PERALINOFICF, v);
    v.iGuid = "9C4B4539-C2B9-4E26-95D6-0A63BE054E1B";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Mask("#0.000");
    v.set_Color(1, 0);
    v.set_Color(18, 16117741);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_PERINNOFICF4, v);
    v.iGuid = "67B0CBB6-2062-4F40-976A-91B4FB8CD890";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_PERALINOFICF));
    v.set_Mask("#0.00");
    v.set_Flags(786433);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_PERIMNOFICF4, v);
    v.iGuid = "65AE4890-46AD-4D4F-B557-56EA117D0B87";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Mask("##0.000");
    v.set_Flags(1835265);
    v.set_Color(1, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_PERPRNOFICF4, v);
    v.iGuid = "3F219C15-FA30-4E8A-83DF-D4592F85513D";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Mask("##0.00");
    v.set_Color(1, 0);
    v.set_Color(18, 16117741);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VUOTOSCRIBLU, v);
    v.iGuid = "95C68C27-09B1-4C24-8944-CBDF4AFC5FF4";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_PERPRNOFICF4));
    v.set_Mask("");
    v.set_Flags(786433);
    v.set_Color(1, 8931840);
    v.set_Color(4, 15852764);
    v.set_BorderType(1, 9);
    v.set_BorderType(6, 9);
    v.set_CBorWidth(2, 0);
    v.set_CBorWidth(3, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VUOSCRBLUBOR, v);
    v.iGuid = "0F29194B-CA7A-4CD3-8CDF-22C89516FA70";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_PERPRNOFICF4));
    v.set_Mask("");
    v.set_Color(1, 8931840);
    v.set_Color(4, 15852764);
    v.set_BorderType(1, 9);
    v.set_BorderType(6, 9);
    v.set_CBorColor(1, 8931840);
    v.set_CBorWidth(1, 3);
    v.set_CBorPadding(1, 10);
    v.set_CBorColor(2, 8931840);
    v.set_CBorWidth(2, 3);
    v.set_CBorPadding(2, 10);
    v.set_CBorColor(3, 8931840);
    v.set_CBorWidth(3, 3);
    v.set_CBorPadding(3, 10);
    v.set_CBorColor(4, 8931840);
    v.set_CBorWidth(4, 3);
    v.set_CBorPadding(4, 10);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIECF4PIV, v);
    v.iGuid = "A40A6784-6345-4855-9EA6-5E536D9237FF";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Mask("00000000000");
    v.set_Flags(1835265);
    v.set_Color(1, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIECF4CA5, v);
    v.iGuid = "DE0BF308-9999-42EE-A1A4-4A2A4E093A7A";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIECF4PIV));
    v.set_Mask("00000");
    v.set_Flags(786689);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIECFCACA, v);
    v.iGuid = "94A58E40-D0A0-4557-991D-C396CF709633";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Mask("00000");
    v.set_Color(1, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIECF4ANO, v);
    v.iGuid = "37125E17-0008-404E-A737-DE06B0EDED5B";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Flags(786433);
    v.set_Color(1, 255);
    v.set_Color(18, 16117741);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_ANOMINTELUNG, v);
    v.iGuid = "014F665E-3098-4BF7-9205-92CBE07B5165";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIECF4ANO));
    v.set_Mask("##########");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTEROLUNGO, v);
    v.iGuid = "6B5AB1A4-EBD9-4A90-A0F8-C23903495487";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_ANOMINTELUNG));
    v.set_Color(1, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIESI4ALT, v);
    v.iGuid = "53812E34-80DE-4C9B-9951-CF2F77593858";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Flags(786433);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMFIELADES, v);
    v.iGuid = "97C91E67-127A-4635-85EF-A82BE3DC6541";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Alignment(1, 4);
    v.set_Flags(786433);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIEINTLUN, v);
    v.iGuid = "46FE776E-9712-4031-9B0A-D5B5FE6AB8CA";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Mask("################");
    v.set_Color(18, 16117741);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTE10NORFIE, v);
    v.iGuid = "4E882790-C413-4E71-AD94-A5D076C231A4";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIEINTLUN));
    v.set_Mask("##########");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMFIEINT15, v);
    v.iGuid = "862252DC-3006-48AC-9570-AF9E910E7701";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIEINTLUN));
    v.set_Mask("###############");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_CAMPOCIG, v);
    v.iGuid = "F2EAF1F9-A1D0-48A2-940C-4BF3C326E4B8";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIEINTLUN));
    v.set_Mask("&&&&&&&&&&");
    v.set_Flags(786433);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIEINLUBL, v);
    v.iGuid = "4730BF06-81AD-4D30-81ED-AD19BDA9A340";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIEINTLUN));
    v.set_Color(1, 16711680);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NOFIINLUHELE, v);
    v.iGuid = "CE4F13FD-DB98-499D-B28E-8830002A5CBA";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Alignment(1, 4);
    v.set_Alignment(2, 2);
    v.set_Mask("################");
    v.set_Color(18, 16117741);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NOFIINLUHLNB, v);
    v.iGuid = "A24C38A0-90A5-41D5-8EA3-EF072D0D317E";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NOFIINLUHELE));
    v.set_Flags(786433);
    v.set_BorderType(2, 2);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIESFOROS, v);
    v.iGuid = "D0274B11-89A4-4BE0-857C-E3E833128F18";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMFIELPADR));
    v.set_Flags(786433);
    v.set_Color(4, 10535167);
    v.set_Color(5, 10535167);
    v.set_Color(9, 10535167);
    v.set_Color(10, 10535167);
    v.set_Color(15, 10535167);
    v.set_Color(16, 10535167);
    v.set_Color(18, 10535167);
    v.set_Color(22, 10535167);
    v.set_Color(23, 10535167);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIESFOSER, v);
    v.iGuid = "DABEB53A-2D5F-44D4-98F6-1FE1189E5B2D";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIESFOROS));
    v.set_Flags(786689);
    v.set_Color(4, 14606066);
    v.set_Color(5, 14606066);
    v.set_Color(6, 14606066);
    v.set_Color(9, 14606066);
    v.set_Color(10, 14606066);
    v.set_Color(15, 14606066);
    v.set_Color(16, 14606066);
    v.set_Color(22, 14606066);
    v.set_Color(23, 14606066);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORFIESFSEVE, v);
    v.iGuid = "EF97D664-0ADC-455F-A6A4-C2350343579D";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORFIESFOSER));
    v.set_Color(4, 14217439);
    v.set_Color(5, 14217439);
    v.set_Color(6, 14217439);
    v.set_Color(9, 14217439);
    v.set_Color(10, 14217439);
    v.set_Color(15, 14217439);
    v.set_Color(16, 14217439);
    v.set_Color(18, 14217439);
    v.set_Color(19, 3812643);
    v.set_Color(20, 3812643);
    v.set_Color(21, 3812643);
    v.set_Color(22, 14217439);
    v.set_Color(23, 14217439);
    v.set_CBorWidth(2, 0);
    v.set_CBorPadding(2, 0);
    v.set_CBorWidth(3, 0);
    v.set_CBorPadding(3, 0);
    v.set_CBorWidth(4, 0);
    v.set_CBorPadding(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BLOCKEFIELDS, v);
    v.iGuid = "2CBA05BA-623A-11D4-BDF0-301B4CC10101";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Flags(786433);
    v.set_Color(1, 8355711);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_LOOKUPFIELDS, v);
    v.iGuid = "2CBA05BB-623A-11D4-BDF0-301B4CC10101";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Color(4, 16774378);
    v.set_Color(5, 16774378);
    v.set_Color(6, 16576495);
    v.set_Color(9, 16445670);
    v.set_Color(18, 16777215);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VISULOOUPCF4, v);
    v.iGuid = "44ECED82-E927-4E28-ACD4-D11393D0886E";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LOOKUPFIELDS));
    v.set_Alignment(3, 4);
    v.set_Flags(786433);
    v.set_Color(1, 0);
    v.set_Color(4, 16117741);
    v.set_Color(5, 16248815);
    v.set_Color(6, 15660535);
    v.set_Color(9, 16110211);
    v.set_Color(10, 16117741);
    v.set_Color(12, 15532006);
    v.set_Color(14, 12451261);
    v.set_Color(18, 16117741);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VISLOOUPCFIM, v);
    v.iGuid = "E29B9D04-69C8-49E1-9395-161156788E6E";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_VISULOOUPCF4));
    v.set_Mask("###,###,###,##0.00");
    v.set_Flags(786689);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VILOUPCFHEBO, v);
    v.iGuid = "997C26D8-B804-4115-835E-CE8C21ED6BE8";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_VISULOOUPCF4));
    v.set_BorderType(2, 2);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HEADNOBORLEF, v);
    v.iGuid = "0466586E-5BB6-4C6E-80F6-CFDBA060B340";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_VISULOOUPCF4));
    v.set_Color(2, 3952720);
    v.set_Color(3, 8998144);
    v.set_Color(8, 13166312);
    v.set_Color(13, 8998144);
    v.set_Color(14, 16110211);
    v.set_BorderType(2, 2);
    v.set_Font(2, "Tahoma,,8");
    v.set_CBorWidth(1, 10);
    v.set_CBorWidth(2, 10);
    v.set_CBorWidth(3, 10);
    v.set_CBorWidth(4, 0);
    v.set_CBorPadding(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VILOUPCFNBVH, v);
    v.iGuid = "B51AB9C4-8CBC-4B88-AEC2-9CBAAFB8BFD8";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_VISULOOUPCF4));
    v.set_Color(1, 11141120);
    v.set_Color(2, 3952720);
    v.set_Color(3, 8998144);
    v.set_Color(4, 15660535);
    v.set_Color(5, 15660535);
    v.set_Color(7, 14085101);
    v.set_GradCol(7, -1);
    v.set_GradDir(7, 1);
    v.set_Color(8, 13166312);
    v.set_GradCol(8, -1);
    v.set_GradDir(8, 1);
    v.set_Color(9, 13690090);
    v.set_Color(10, -1);
    v.set_Color(13, 8998144);
    v.set_Color(15, 15660535);
    v.set_Color(16, 13690090);
    v.set_Color(18, -1);
    v.set_BorderType(2, 2);
    v.set_Font(2, "Tahoma,,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_LABELFIELD, v);
    v.iGuid = "0AA3D5EF-9931-11D4-8EBD-6C2303000000";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Flags(917761);
    v.set_Color(1, 2105376);
    v.set_Color(2, 3952720);
    v.set_Color(3, 8998144);
    v.set_Color(4, -1);
    v.set_Color(5, -1);
    v.set_Color(6, 16054778);
    v.set_Color(7, 16382457);
    v.set_GradCol(7, 15658219);
    v.set_Color(8, 16777215);
    v.set_GradCol(8, 15658219);
    v.set_Color(9, -1);
    v.set_Color(10, -1);
    v.set_Color(11, 13547166);
    v.set_Color(13, 8998144);
    v.set_Color(14, 14811106);
    v.set_Color(15, -1);
    v.set_Color(16, -1);
    v.set_BorderType(6, 1);
    v.set_Font(2, "Tahoma,,8");
    v.set_CBorWidth(2, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VUOTONORMALE, v);
    v.iGuid = "8A83AB64-123F-4C85-A01E-72425CBABAF3";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LABELFIELD));
    v.set_Alignment(1, 4);
    v.set_Alignment(2, 4);
    v.set_Alignment(3, 4);
    v.set_Flags(786433);
    v.set_Color(1, 3812131);
    v.set_Color(2, 3812643);
    v.set_Color(3, 3812643);
    v.set_Color(4, 15852764);
    v.set_Color(5, 16117741);
    v.set_Color(6, 15852764);
    v.set_Color(7, 16117741);
    v.set_GradCol(7, 14930895);
    v.set_Color(8, 14745599);
    v.set_GradCol(8, 14930895);
    v.set_Color(9, 65535);
    v.set_Color(10, 16777215);
    v.set_Color(11, 0);
    v.set_Color(12, 15532006);
    v.set_Color(13, -842150451);
    v.set_Color(14, 12451261);
    v.set_Color(15, 15852764);
    v.set_Color(16, 13690090);
    v.set_BorderType(1, 1);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Tahoma,B,8");
    v.set_Font(2, "Tahoma,B,8");
    v.set_Font(3, "Tahoma,,8");
    v.set_CBorColor(2, 0);
    v.set_CBorWidth(2, 1);
    v.set_CBorWidth(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VUONORALILEF, v);
    v.iGuid = "02A6AF3B-B206-4C40-B286-38F8A3F7A89D";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_VUOTONORMALE));
    v.set_Alignment(1, 2);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VUOTNORMCENT, v);
    v.iGuid = "A28E90E1-51C6-4320-8F4E-915E18A31B74";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_VUOTONORMALE));
    v.set_Alignment(1, 3);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VUOTOGRASSET, v);
    v.iGuid = "148370F5-7D4A-4E81-9EAE-18EDE2990C49";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LABELFIELD));
    v.set_Alignment(1, 3);
    v.set_Flags(1);
    v.set_Color(1, 3812643);
    v.set_Color(2, 3812643);
    v.set_Color(3, 3812643);
    v.set_Color(4, 15852764);
    v.set_Color(5, 15852764);
    v.set_Color(6, 15852764);
    v.set_Color(7, 16117741);
    v.set_GradCol(7, 14930895);
    v.set_Color(8, 14745599);
    v.set_GradCol(8, 14930895);
    v.set_Color(9, 65535);
    v.set_Color(10, 16777215);
    v.set_Color(11, 12164479);
    v.set_Color(12, 15532006);
    v.set_Color(13, -842150451);
    v.set_Color(14, 12451261);
    v.set_Color(15, 15852764);
    v.set_Color(16, 13690090);
    v.set_Color(17, 15852764);
    v.set_BorderType(1, 1);
    v.set_Font(1, "Tahoma,B,8");
    v.set_Font(2, "Tahoma,B,8");
    v.set_Font(3, "Tahoma,,8");
    v.set_CBorWidth(2, 1);
    v.set_CBorWidth(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_SEGNADIERROR, v);
    v.iGuid = "452C8F9E-92CE-4AD3-B3DB-C38046B2A908";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LABELFIELD));
    v.set_Alignment(1, 3);
    v.set_Alignment(2, 2);
    v.set_Alignment(3, 2);
    v.set_Flags(2097153);
    v.set_Color(1, 12632256);
    v.set_Color(2, 9143144);
    v.set_Color(3, 3812643);
    v.set_Color(4, 16777215);
    v.set_Color(5, 16117741);
    v.set_Color(6, 15852764);
    v.set_Color(7, 16117741);
    v.set_GradCol(7, 14930895);
    v.set_Color(8, 14745599);
    v.set_GradCol(8, 14930895);
    v.set_Color(9, 65535);
    v.set_Color(10, 16777215);
    v.set_Color(11, 12164479);
    v.set_Color(12, 15532006);
    v.set_Color(13, -842150451);
    v.set_Color(14, 12451261);
    v.set_Color(15, 16117741);
    v.set_Color(16, 13690090);
    v.set_BorderType(1, 1);
    v.set_BorderType(5, 4);
    v.set_BorderType(6, 4);
    v.set_Font(1, "Tahoma,B,20");
    v.set_Font(2, "Tahoma,B,20");
    v.set_Font(3, "Tahoma,,8");
    v.set_CBorWidth(2, 1);
    v.set_CBorWidth(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_SEGNDIERRINT, v);
    v.iGuid = "31058880-7A89-4C56-8778-58BE7830E444";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LABELFIELD));
    v.set_Alignment(1, 2);
    v.set_Alignment(2, 2);
    v.set_Alignment(3, 2);
    v.set_Flags(2097153);
    v.set_Color(1, 12623485);
    v.set_Color(2, 9143144);
    v.set_Color(3, 3812643);
    v.set_Color(4, 16777215);
    v.set_Color(5, 16117741);
    v.set_Color(6, 15852764);
    v.set_Color(7, 16117741);
    v.set_GradCol(7, 14930895);
    v.set_Color(8, 14745599);
    v.set_GradCol(8, 14930895);
    v.set_Color(9, 65535);
    v.set_Color(10, 16777215);
    v.set_Color(11, 12164479);
    v.set_Color(12, 15532006);
    v.set_Color(13, -842150451);
    v.set_Color(14, 12451261);
    v.set_Color(15, 16117741);
    v.set_Color(16, 13690090);
    v.set_BorderType(1, 1);
    v.set_BorderType(5, 4);
    v.set_BorderType(6, 4);
    v.set_Font(1, "Tahoma,B,14");
    v.set_Font(2, "Tahoma,B,20");
    v.set_Font(3, "Tahoma,,8");
    v.set_CBorWidth(2, 1);
    v.set_CBorWidth(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_DICITUGENERI, v);
    v.iGuid = "685F538C-6FE9-4976-B821-AA7082161E7A";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LABELFIELD));
    v.set_Alignment(1, 2);
    v.set_Alignment(2, 2);
    v.set_Alignment(3, 2);
    v.set_Flags(2097153);
    v.set_Color(1, 8545357);
    v.set_Color(2, 9143144);
    v.set_Color(3, 3812643);
    v.set_Color(4, 15852764);
    v.set_Color(5, 16117741);
    v.set_Color(6, 15852764);
    v.set_Color(7, 16117741);
    v.set_GradCol(7, 14930895);
    v.set_Color(8, 14745599);
    v.set_GradCol(8, 14930895);
    v.set_Color(9, 65535);
    v.set_Color(10, 16777215);
    v.set_Color(11, 12164479);
    v.set_Color(12, 15532006);
    v.set_Color(13, -842150451);
    v.set_Color(14, 12451261);
    v.set_Color(15, 16117741);
    v.set_Color(16, 13690090);
    v.set_BorderType(1, 1);
    v.set_BorderType(5, 4);
    v.set_Font(1, "Tahoma,B,8");
    v.set_Font(2, "Tahoma,B,20");
    v.set_Font(3, "Tahoma,,8");
    v.set_CBorWidth(2, 1);
    v.set_CBorWidth(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VUOTOGRASS12, v);
    v.iGuid = "98CCDE9D-A290-4F11-9DC3-139B761768C1";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LABELFIELD));
    v.set_Alignment(1, 3);
    v.set_Flags(1048577);
    v.set_Color(1, 8931840);
    v.set_Color(2, 3812643);
    v.set_Color(3, 3812643);
    v.set_Color(4, 16777215);
    v.set_Color(5, 16117741);
    v.set_Color(6, 15852764);
    v.set_Color(7, 16117741);
    v.set_GradCol(7, 14930895);
    v.set_Color(8, 14745599);
    v.set_GradCol(8, 14930895);
    v.set_Color(9, 65535);
    v.set_Color(10, 16777215);
    v.set_Color(11, 12164479);
    v.set_Color(13, -842150451);
    v.set_Color(14, 16110211);
    v.set_Color(15, 16117741);
    v.set_Color(16, 16110211);
    v.set_BorderType(1, 6);
    v.set_Font(1, "Tahoma,B,12");
    v.set_Font(2, "Tahoma,B,8");
    v.set_Font(3, "Tahoma,,8");
    v.set_CBorPadding(2, 0);
    v.set_CBorWidth(3, 0);
    v.set_CBorPadding(3, 0);
    v.set_CBorPadding(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VUOTGRASIMPO, v);
    v.iGuid = "575D3621-0298-4168-A80E-6B4E10A1BA1A";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LABELFIELD));
    v.set_Mask("###,###,###,##0.00");
    v.set_Flags(1048577);
    v.set_Color(1, 8931840);
    v.set_Color(2, 3812643);
    v.set_Color(3, 3812643);
    v.set_Color(4, 16777215);
    v.set_Color(5, 16117741);
    v.set_Color(6, 15852764);
    v.set_Color(7, 16117741);
    v.set_GradCol(7, 14930895);
    v.set_Color(8, 14745599);
    v.set_GradCol(8, 14930895);
    v.set_Color(9, 65535);
    v.set_Color(10, 16777215);
    v.set_Color(11, 12164479);
    v.set_Color(13, -842150451);
    v.set_Color(14, 16110211);
    v.set_Color(15, 16117741);
    v.set_Color(16, 16110211);
    v.set_BorderType(1, 1);
    v.set_Font(1, "Tahoma,B,12");
    v.set_Font(2, "Tahoma,B,8");
    v.set_Font(3, "Tahoma,,8");
    v.set_CBorPadding(2, 0);
    v.set_CBorWidth(3, 0);
    v.set_CBorPadding(3, 0);
    v.set_CBorPadding(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VUOGRAALILEF, v);
    v.iGuid = "BB57697B-9040-46AF-83FB-D64A3E58A513";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LABELFIELD));
    v.set_Alignment(1, 2);
    v.set_Flags(1);
    v.set_Color(1, 3812131);
    v.set_Color(2, 3812643);
    v.set_Color(3, 3812643);
    v.set_Color(4, 15852764);
    v.set_Color(5, 16117741);
    v.set_Color(6, 15852764);
    v.set_Color(7, 16117741);
    v.set_GradCol(7, 14930895);
    v.set_Color(8, 14745599);
    v.set_GradCol(8, 14930895);
    v.set_Color(9, 65535);
    v.set_Color(10, 16777215);
    v.set_Color(11, 12164479);
    v.set_Color(13, -842150451);
    v.set_Color(14, 16110211);
    v.set_Color(15, 15852764);
    v.set_Color(16, 16110211);
    v.set_BorderType(1, 1);
    v.set_Font(1, "Tahoma,B,8");
    v.set_Font(2, "Tahoma,B,8");
    v.set_Font(3, "Tahoma,,8");
    v.set_CBorWidth(2, 1);
    v.set_CBorWidth(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VUOGRAALLECO, v);
    v.iGuid = "9C158134-07B1-4D86-9FDE-209C27427426";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_VUOGRAALILEF));
    v.set_Flags(257);
    v.set_Color(1, 8931840);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VUOGRAALRICO, v);
    v.iGuid = "48203B66-E6A8-4C9C-9D09-F3248AD1AF23";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_VUOGRAALILEF));
    v.set_Alignment(1, 4);
    v.set_Color(1, 8931840);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VUOGRAALRIRO, v);
    v.iGuid = "345FED0E-5356-48D5-9241-91732C2E6B10";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_VUOGRAALRICO));
    v.set_Color(1, 255);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VUGRALLECODI, v);
    v.iGuid = "5AC80341-5D7A-4B36-8BE2-1FD1FC20A7FC";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_VUOGRAALILEF));
    v.set_Flags(257);
    v.set_Color(1, 8931840);
    v.set_Color(4, 16117741);
    v.set_Color(10, 65535);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VUNOALLECODI, v);
    v.iGuid = "4ACA5CDE-27F1-4487-8098-E1E95E0493D1";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_VUOGRAALILEF));
    v.set_Flags(257);
    v.set_Color(1, 8931840);
    v.set_Color(4, 16117741);
    v.set_Color(10, 65535);
    v.set_Font(1, "Tahoma,,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_VUONORTESPIC, v);
    v.iGuid = "CBF743B8-3F20-487F-AA17-33889A81CF76";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_VUNOALLECODI));
    v.set_Flags(1048577);
    v.set_Color(1, 0);
    v.set_Color(4, 16246750);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_ETICHEGRASSE, v);
    v.iGuid = "60E1AAF9-DD9E-4781-8845-4D65772D5A61";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LABELFIELD));
    v.set_Alignment(1, 3);
    v.set_Flags(1048577);
    v.set_Color(1, 8931840);
    v.set_Color(2, 3812643);
    v.set_Color(3, 3812643);
    v.set_Color(4, 15852764);
    v.set_Color(5, 16117741);
    v.set_Color(6, 15852764);
    v.set_Color(7, 16117741);
    v.set_GradCol(7, 14930895);
    v.set_Color(8, 14745599);
    v.set_GradCol(8, 14930895);
    v.set_Color(9, 65535);
    v.set_Color(10, 16777215);
    v.set_Color(11, 12164479);
    v.set_Color(13, -842150451);
    v.set_Color(14, 16110211);
    v.set_Color(15, 16117741);
    v.set_Color(16, 16110211);
    v.set_BorderType(1, 6);
    v.set_BorderType(6, 4);
    v.set_Font(1, "Tahoma,B,8");
    v.set_Font(2, "Tahoma,B,8");
    v.set_Font(3, "Tahoma,,8");
    v.set_CBorWidth(2, 1);
    v.set_CBorWidth(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_ETICGRASLEFT, v);
    v.iGuid = "2F3714EF-D309-4F67-AD61-142FBB58FA78";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_ETICHEGRASSE));
    v.set_Alignment(1, 2);
    v.set_Flags(1048833);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_ETICGRASIMPO, v);
    v.iGuid = "B8B2C96F-0F3F-4AF5-A36C-ED25D75E8541";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_ETICHEGRASSE));
    v.set_Mask("###,###,###,##0.00");
    v.set_Flags(1);
    v.set_BorderType(6, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_ETIGRAIMPROS, v);
    v.iGuid = "29D40EF0-8C35-4168-9036-ADC62C4C8D83";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_ETICGRASIMPO));
    v.set_Flags(257);
    v.set_Color(1, 255);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_ETICGRASRIGH, v);
    v.iGuid = "83F14A6C-278B-4D5B-B012-3A381AE4ED1D";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_ETICHEGRASSE));
    v.set_Alignment(1, 4);
    v.set_Flags(1);
    v.set_BorderType(6, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_ETICGRASCENT, v);
    v.iGuid = "BACF3EEB-5BFB-46B5-B47B-B2B730D79036";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_ETICHEGRASSE));
    v.set_Flags(1048833);
    v.set_Color(2, 3952720);
    v.set_Color(3, 8998144);
    v.set_Color(5, 16777215);
    v.set_Color(7, 14085101);
    v.set_GradCol(7, -1);
    v.set_GradDir(7, 1);
    v.set_GradCol(8, -1);
    v.set_GradDir(8, 1);
    v.set_Color(10, -1);
    v.set_Color(12, 15852764);
    v.set_Color(14, 13695974);
    v.set_Color(15, 15660535);
    v.set_Color(16, 14871535);
    v.set_Font(2, "Tahoma,,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_ETIGRAFONROS, v);
    v.iGuid = "FF1296CD-5467-4659-A56B-427A183DC63B";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_ETICHEGRASSE));
    v.set_Flags(1);
    v.set_Color(1, 255);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HYPERLIFIELD, v);
    v.iGuid = "D4423A16-E154-11D4-9021-88F920000000";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LABELFIELD));
    v.set_Flags(4063489);
    v.set_Color(1, 16711680);
    v.set_Font(1, "Tahoma,U,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMAGEFIELD, v);
    v.iGuid = "0C892579-65CA-494B-B7D0-B06FD2CA39FC";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LABELFIELD));
    v.set_Flags(1966337);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_CHECKSTYLE, v);
    v.iGuid = "622C602E-9B5A-11D4-8ECE-323F96000000";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Alignment(2, 4);
    v.set_Alignment(3, 4);
    v.set_ControlType(4);
    v.set_Flags(1835265);
    v.set_Color(1, 2105376);
    v.set_Color(3, 8998144);
    v.set_Color(6, 16054778);
    v.set_Color(10, -1);
    v.set_Color(11, 13547166);
    v.set_Color(13, 8998144);
    v.set_Color(22, 16777215);
    v.set_Color(23, 16777215);
    v.set_CBorWidth(2, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_CHESTYNOBOCA, v);
    v.iGuid = "725DF0C6-D92C-4668-8AF1-969E09A1670B";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_CHECKSTYLE));
    v.set_Flags(786433);
    v.set_BorderType(2, 2);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_CHESTYSFOROS, v);
    v.iGuid = "1ED430A4-4EAD-4F92-B31E-CD866C65D3B2";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_CHECKSTYLE));
    v.set_Flags(786689);
    v.set_Color(4, 10535167);
    v.set_Color(5, 10535167);
    v.set_Color(9, 10535167);
    v.set_Color(15, 10535167);
    v.set_Color(16, 10535167);
    v.set_Color(22, 10535167);
    v.set_Color(23, 10535167);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_STATICBUTTON, v);
    v.iGuid = "D47A9B39-CB14-11D5-93C0-6A9CBE000000";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Alignment(1, 3);
    v.set_Alignment(2, 3);
    v.set_Flags(3932417);
    v.set_Color(4, -1);
    v.set_Color(5, 12632256);
    v.set_Color(10, 16246750);
    v.set_BorderType(1, 9);
    v.set_BorderType(2, 9);
    v.set_BorderType(3, 9);
    v.set_BorderType(4, 9);
    v.set_BorderType(6, 9);
    v.set_Font(1, "Tahoma,B,8");
    v.set_CBorPadding(1, 30);
    v.set_CBorWidth(2, 0);
    v.set_CBorPadding(2, 0);
    v.set_CBorWidth(3, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_GROUPSTYLE, v);
    v.iGuid = "95BF1C4A-365C-4C77-A176-BD9DA36CEA99";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Flags(1966081);
    v.set_Color(9, 16707816);
    v.set_Color(12, 15852764);
    v.set_Color(14, 12451261);
    v.set_Color(16, 13690090);
    v.set_BorderType(5, 4);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_GROSTYPERLAB, v);
    v.iGuid = "0F2DDA7B-24C3-4660-9C48-10B99366D38D";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_GROUPSTYLE));
    v.set_Flags(917505);
    v.set_Color(4, -1);
    v.set_Color(6, -1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_GROSTYLINLEF, v);
    v.iGuid = "C51C5D6E-F687-40D3-ABBD-F5AA6D52A349";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_GROUPSTYLE));
    v.set_Flags(917505);
    v.set_Color(11, 12623485);
    v.set_BorderType(1, 1);
    v.set_BorderType(5, 3);
    v.set_CBorColor(1, -1);
    v.set_CBorWidth(2, 0);
    v.set_CBorPadding(2, 0);
    v.set_CBorWidth(3, 0);
    v.set_CBorPadding(3, 0);
    v.set_CBorColor(4, 2763429);
    v.set_CBorWidth(4, 2);
    v.set_CBorPadding(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_GROSTYLILEDI, v);
    v.iGuid = "373C1EDF-0246-4973-AF9B-EE7BF962CAA8";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_GROUPSTYLE));
    v.set_Flags(917761);
    v.set_Color(4, 16117741);
    v.set_BorderType(1, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_GROUSTYLLIST, v);
    v.iGuid = "52DE398A-EBFD-4B0E-8047-F3DF6E9C01B1";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_GROUPSTYLE));
    v.set_Flags(1966337);
    v.set_BorderType(2, 1);
    v.set_BorderType(5, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_GROUSTYNOBOR, v);
    v.iGuid = "72D42ABC-472A-4DBA-99FB-E1A9E038F917";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_GROUPSTYLE));
    v.set_Flags(1835009);
    v.set_Color(8, 16777215);
    v.set_Color(9, 16110211);
    v.set_Color(12, -1);
    v.set_Color(14, 16110211);
    v.set_Color(16, 16110211);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_OPTIONBUTTON, v);
    v.iGuid = "FC228E04-1136-468B-BB52-3FA80341B321";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Alignment(3, 4);
    v.set_ControlType(5);
    v.set_Color(4, 16246750);
    v.set_Color(9, 15660279);
    v.set_Color(10, 16246750);
    v.set_Color(12, 16246750);
    v.set_Color(14, 12451261);
    v.set_Color(16, 13690090);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_OPTIBUTINTSX, v);
    v.iGuid = "433BEBC7-4D50-4E61-BC4C-424A859316DE";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_OPTIONBUTTON));
    v.set_Alignment(3, 2);
    v.set_Flags(786433);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_LABEVISUSTYL, v);
    v.iGuid = "8EEF8D0F-5FC2-4AD3-A710-E81F48E11096";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Flags(786433);
    v.set_Color(4, 16117741);
    v.set_GradCol(4, 14930895);
    v.set_GradDir(4, 3);
    v.set_Color(6, -1);
    v.set_GradDir(6, 3);
    v.set_Opacity(6, 0);
    v.set_BorderType(2, 7);
    v.set_Font(1, "Tahoma,B,8");
    v.set_CBorColor(1, 15852764);
    v.set_CBorWidth(1, 7);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_LABVISSTPEGR, v);
    v.iGuid = "7C191324-8C49-4347-AA5E-537F5903E385";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LABEVISUSTYL));
    v.set_Color(1, 0);
    v.set_Color(2, 3952720);
    v.set_Color(3, 0);
    v.set_GradCol(4, 15852764);
    v.set_Color(6, 16117741);
    v.set_GradDir(6, 1);
    v.set_Color(7, 15852764);
    v.set_GradCol(7, -1);
    v.set_GradDir(7, 1);
    v.set_Color(9, 16511466);
    v.set_Color(10, -1);
    v.set_Color(12, 16777215);
    v.set_Color(13, 8998144);
    v.set_Color(14, 13695974);
    v.set_Color(16, 14871535);
    v.set_Font(2, "Tahoma,,8");
    v.set_CBorColor(1, 13684944);
    v.set_CBorWidth(1, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_LAVISTPEGRCE, v);
    v.iGuid = "3F43BD2F-19EF-4094-BB1E-CA7CCBD7374C";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LABVISSTPEGR));
    v.set_Alignment(1, 3);
    v.set_Flags(1835009);
    v.set_GradCol(4, 14930895);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_LABVISSTINGR, v);
    v.iGuid = "A3E6D1C9-5356-43EE-8124-E739243B14FA";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LABEVISUSTYL));
    v.set_Alignment(1, 3);
    v.set_Flags(786689);
    v.set_Color(1, 4018256);
    v.set_Color(2, 3952720);
    v.set_Color(3, 8998144);
    v.set_Color(4, 14085101);
    v.set_GradCol(4, -1);
    v.set_GradDir(4, 1);
    v.set_GradDir(6, 1);
    v.set_Color(7, 14085101);
    v.set_GradCol(7, -1);
    v.set_GradDir(7, 1);
    v.set_Color(8, 13166312);
    v.set_Color(9, 16511466);
    v.set_Color(10, -1);
    v.set_Color(12, 16777215);
    v.set_Color(13, 8998144);
    v.set_Color(14, 13695974);
    v.set_Color(15, 15660535);
    v.set_Color(16, 14871535);
    v.set_Font(1, "Tahoma,,8");
    v.set_Font(2, "Tahoma,,8");
    v.set_CBorColor(1, 13684944);
    v.set_CBorWidth(1, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_SFONDOGRIGIO, v);
    v.iGuid = "A98670C7-142D-4086-8079-4ECB5E4D9224";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Flags(786433);
    v.set_Color(6, -1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_OPTBUTSENBOR, v);
    v.iGuid = "C809C190-5CAF-48BF-A5FA-22A1AC2B74F8";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Alignment(3, 4);
    v.set_ControlType(5);
    v.set_RowOffset(40);
    v.set_Flags(1835265);
    v.set_Color(4, 15852764);
    v.set_Color(6, 16246750);
    v.set_Color(10, 15852764);
    v.set_Color(11, 16246750);
    v.set_Color(15, 16246750);
    v.set_BorderType(1, 1);
    v.set_BorderType(2, 1);
    v.set_BorderType(3, 1);
    v.set_BorderType(6, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_OPTBUTSEBOGR, v);
    v.iGuid = "B8EBBD7C-86F4-48F4-8E96-C311DA6936C3";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_OPTBUTSENBOR));
    v.set_Flags(786433);
    v.set_Font(1, "Tahoma,B,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_OPTBUTSEBOSX, v);
    v.iGuid = "BE631783-1000-41D0-8037-993248A4FF3E";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_OPTBUTSENBOR));
    v.set_Alignment(2, 2);
    v.set_Alignment(3, 2);
    v.set_Flags(786689);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_STATICRIQUAD, v);
    v.iGuid = "C3EB9299-A859-4335-A9EC-F2021E1F05A8";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Flags(786433);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_SFONDOMENU, v);
    v.iGuid = "ED97B4DD-0F08-4C42-93CF-8689BF1A8F41";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Flags(786433);
    v.set_Color(1, 8545357);
    v.set_Color(2, 5784373);
    v.set_Color(5, 16250871);
    v.set_Color(6, 16117741);
    v.set_Color(7, 14930895);
    v.set_GradCol(7, 16777215);
    v.set_Color(15, 15329769);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_TITOGRANMENU, v);
    v.iGuid = "E27C036C-2E59-4FDC-ABEF-3DF4AD61C4E7";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_SFONDOMENU));
    v.set_Alignment(1, 2);
    v.set_Color(1, 8085578);
    v.set_Color(4, 16117741);
    v.set_Color(5, 16117741);
    v.set_Color(15, 16117741);
    v.set_Font(1, "Tahoma,B,12");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_TITOPICCMENU, v);
    v.iGuid = "3651958D-EBE7-4557-B37E-188B1FB94474";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_SFONDOMENU));
    v.set_Alignment(1, 2);
    v.set_Color(4, 16117741);
    v.set_Color(5, 16117741);
    v.set_Color(11, 16117741);
    v.set_Color(15, 16117741);
    v.set_Font(1, "Tahoma,B,10");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_TESTINBOTMEN, v);
    v.iGuid = "340E8196-F273-478C-B4D2-DD17CB723B58";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_SFONDOMENU));
    v.set_Alignment(1, 3);
    v.set_Alignment(2, 3);
    v.set_Flags(2883585);
    v.set_Color(1, 5784373);
    v.set_Color(4, -1);
    v.set_Color(5, 12632256);
    v.set_Color(6, -1);
    v.set_Color(15, -1);
    v.set_BorderType(1, 1);
    v.set_BorderType(6, 1);
    v.set_CBorColor(1, 8545357);
    v.set_CBorColor(2, 8545357);
    v.set_CBorWidth(2, 0);
    v.set_CBorColor(3, 8545357);
    v.set_CBorWidth(3, 0);
    v.set_CBorColor(4, 8545357);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_GRUUTEINSAGG, v);
    v.iGuid = "AEC084F7-AAF0-4642-A277-07FF0B1EDD32";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Flags(1835265);
    v.set_BorderType(5, 9);
    v.set_CBorColor(1, 12164479);
    v.set_CBorColor(2, 128);
    v.set_CBorWidth(2, 0);
    v.set_CBorColor(3, 8421376);
    v.set_CBorWidth(3, 0);
    v.set_CBorColor(4, 32768);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BOTTONE, v);
    v.iGuid = "64BDB4A3-EDE3-4876-A345-A1DD9A047A37";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Alignment(1, 3);
    v.set_Flags(2883585);
    v.set_Color(1, 0);
    v.set_Color(2, 3952720);
    v.set_Color(3, 8998144);
    v.set_Color(4, -1);
    v.set_Color(5, -1);
    v.set_Color(6, 16054778);
    v.set_Color(7, 16382457);
    v.set_GradCol(7, 15658219);
    v.set_Color(8, 16777215);
    v.set_GradCol(8, 15658219);
    v.set_Color(9, 16446446);
    v.set_Color(10, -1);
    v.set_Color(11, 13547166);
    v.set_Color(13, 8998144);
    v.set_Color(14, 14811106);
    v.set_Color(15, 15856627);
    v.set_Color(16, 15658477);
    v.set_BorderType(1, 1);
    v.set_BorderType(6, 9);
    v.set_Font(1, "Tahoma,B,8");
    v.set_Font(2, "Tahoma,,8");
    v.set_CBorColor(1, 15852764);
    v.set_CBorWidth(2, 0);
    v.set_CBorColor(3, 15852764);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_SFONEBORDTRA, v);
    v.iGuid = "4292F2BB-D61B-4812-8C22-7C031FFCE35B";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Flags(1835009);
    v.set_Color(1, 2105376);
    v.set_Color(2, 3952720);
    v.set_Color(3, 8998144);
    v.set_Color(4, -1);
    v.set_Color(6, 16054778);
    v.set_Color(7, 16382457);
    v.set_GradCol(7, 15658219);
    v.set_Color(8, 16777215);
    v.set_GradCol(8, 15658219);
    v.set_Color(9, 16446446);
    v.set_Color(10, -1);
    v.set_Color(11, -1);
    v.set_Color(13, 8998144);
    v.set_Color(14, 14811106);
    v.set_Color(15, 15856627);
    v.set_Color(16, 15658477);
    v.set_BorderType(1, 1);
    v.set_BorderType(3, 1);
    v.set_BorderType(5, 1);
    v.set_BorderType(6, 1);
    v.set_Font(2, "Tahoma,,8");
    v.set_CBorWidth(2, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_SFOTRACONBOR, v);
    v.iGuid = "3AD0F3F4-885B-481A-B664-399F8C0E6B3A";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Flags(1835009);
    v.set_Color(1, 2105376);
    v.set_Color(2, 3952720);
    v.set_Color(3, 8998144);
    v.set_Color(4, -1);
    v.set_Color(6, 16054778);
    v.set_Color(7, 16382457);
    v.set_GradCol(7, 15658219);
    v.set_Color(8, 16777215);
    v.set_GradCol(8, 15658219);
    v.set_Color(9, 16446446);
    v.set_Color(10, -1);
    v.set_Color(11, -1);
    v.set_Color(13, 8998144);
    v.set_Color(14, 14811106);
    v.set_Color(15, 15856627);
    v.set_Color(16, 15658477);
    v.set_BorderType(1, 1);
    v.set_BorderType(3, 1);
    v.set_BorderType(5, 1);
    v.set_BorderType(6, 1);
    v.set_Font(2, "Tahoma,,8");
    v.set_CBorColor(1, 0);
    v.set_CBorColor(2, 0);
    v.set_CBorColor(3, 0);
    v.set_CBorColor(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_PASSWORSTYLE, v);
    v.iGuid = "D47A9B2C-CB14-11D5-93C0-6A9CBE000000";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_Flags(852225);
    v.set_Color(1, 2105376);
    v.set_Color(2, 3952720);
    v.set_Color(3, 8998144);
    v.set_Color(6, 16054778);
    v.set_Color(7, 16382457);
    v.set_GradCol(7, 15658219);
    v.set_Color(8, 16777215);
    v.set_GradCol(8, 15658219);
    v.set_Color(9, 16446446);
    v.set_Color(10, -1);
    v.set_Color(11, 13547166);
    v.set_Color(13, 8998144);
    v.set_Color(14, 14811106);
    v.set_Color(15, 15856627);
    v.set_Color(16, 15658477);
    v.set_Color(22, 16777215);
    v.set_Color(23, 16777215);
    v.set_Font(2, "Tahoma,,8");
    v.set_CBorWidth(2, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_RADIOSTYLE, v);
    v.iGuid = "DF846B65-D41A-444D-B05F-1378C91F7FC9";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_ControlType(5);
    v.set_Color(1, 2105376);
    v.set_Color(2, 3952720);
    v.set_Color(3, 8998144);
    v.set_Color(6, 16054778);
    v.set_Color(7, 16382457);
    v.set_GradCol(7, 15658219);
    v.set_Color(8, 16777215);
    v.set_GradCol(8, 15658219);
    v.set_Color(9, 16446446);
    v.set_Color(10, -1);
    v.set_Color(11, 13547166);
    v.set_Color(13, 8998144);
    v.set_Color(14, 14811106);
    v.set_Color(15, 15856627);
    v.set_Color(16, 15658477);
    v.set_Color(22, 16777215);
    v.set_Color(23, 16777215);
    v.set_Font(2, "Tahoma,,8");
    v.set_CBorWidth(2, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HTMLEDITSTYL, v);
    v.iGuid = "8A9099EE-0441-46D1-959A-474AB1390B7F";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    v.set_ControlType(7);
    v.set_Color(1, 2105376);
    v.set_Color(2, 3952720);
    v.set_Color(3, 8998144);
    v.set_Color(6, 16054778);
    v.set_Color(7, 16382457);
    v.set_GradCol(7, 15658219);
    v.set_Color(8, 16777215);
    v.set_GradCol(8, 15658219);
    v.set_Color(9, 16446446);
    v.set_Color(10, -1);
    v.set_Color(11, 13547166);
    v.set_Color(13, 8998144);
    v.set_Color(14, 14811106);
    v.set_Color(15, 15856627);
    v.set_Color(16, 15658477);
    v.set_Color(22, 16777215);
    v.set_Color(23, 16777215);
    v.set_Font(2, "Tahoma,,8");
    v.set_CBorWidth(2, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HTMEDISTNOSF, v);
    v.iGuid = "E3627EA6-CDE7-4DF6-B3FA-A232DCBBDB37";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_HTMLEDITSTYL));
    v.set_Flags(786433);
    v.set_Color(4, 15852764);
    v.set_Color(5, 15852764);
    v.set_Color(6, 15852764);
    v.set_Color(7, 15852764);
    v.set_Color(9, 15852764);
    v.set_Color(15, 15852764);
    v.set_Color(16, 15852764);
    v.set_Color(22, 15852764);
    v.set_Color(23, 15852764);
    v.set_BorderType(1, 1);
    v.set_BorderType(2, 1);
    v.set_BorderType(3, 1);
    v.set_BorderType(5, 1);
    v.set_BorderType(6, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NONNULLAFIEL, v);
    v.iGuid = "8CE4FAA4-3E26-4FCB-9CFB-7E2865C80E10";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAPANESTYL));
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_DEFAREPOSTYL, v);
    v.iGuid = "EFA25462-6C01-4AB0-A6CA-0A083C3ACE46";
    v.set_Alignment(1, 1);
    v.set_Alignment(2, 1);
    v.set_Alignment(3, 1);
    v.set_ControlType(1);
    v.set_ClassName("");
    v.set_Mask("");
    v.set_Cursor("");
    v.set_RowOffset(3);
    v.set_HeaderOffset(4);
    v.set_Flags(1);
    v.set_Color(1, 0);
    v.set_GradCol(1, -1);
    v.set_GradDir(1, 1);
    v.set_Opacity(1, 100);
    v.set_Color(2, 0);
    v.set_GradCol(2, -1);
    v.set_GradDir(2, 1);
    v.set_Opacity(2, 100);
    v.set_Color(3, 0);
    v.set_GradCol(3, -1);
    v.set_GradDir(3, 1);
    v.set_Opacity(3, 100);
    v.set_Color(4, -1);
    v.set_GradCol(4, -1);
    v.set_GradDir(4, 1);
    v.set_Opacity(4, 100);
    v.set_Color(5, -1);
    v.set_GradCol(5, -1);
    v.set_GradDir(5, 1);
    v.set_Opacity(5, 100);
    v.set_Color(6, -1);
    v.set_GradCol(6, -1);
    v.set_GradDir(6, 1);
    v.set_Opacity(6, 100);
    v.set_Color(7, -1);
    v.set_GradCol(7, -1);
    v.set_GradDir(7, 1);
    v.set_Opacity(7, 100);
    v.set_Color(8, -1);
    v.set_GradCol(8, -1);
    v.set_GradDir(8, 1);
    v.set_Opacity(8, 100);
    v.set_Color(9, -1);
    v.set_GradCol(9, -1);
    v.set_GradDir(9, 1);
    v.set_Opacity(9, 100);
    v.set_Color(10, -1);
    v.set_GradCol(10, -1);
    v.set_GradDir(10, 1);
    v.set_Opacity(10, 100);
    v.set_Color(11, 8355711);
    v.set_GradCol(11, -1);
    v.set_GradDir(11, 1);
    v.set_Opacity(11, 100);
    v.set_Color(12, 12632256);
    v.set_GradCol(12, -1);
    v.set_GradDir(12, 1);
    v.set_Opacity(12, 100);
    v.set_Color(13, 0);
    v.set_GradCol(13, -1);
    v.set_GradDir(13, 1);
    v.set_Opacity(13, 100);
    v.set_Color(14, 12648384);
    v.set_GradCol(14, -1);
    v.set_GradDir(14, 1);
    v.set_Opacity(14, 100);
    v.set_Color(15, 12632256);
    v.set_GradCol(15, -1);
    v.set_GradDir(15, 1);
    v.set_Opacity(15, 100);
    v.set_Color(16, 14737632);
    v.set_GradCol(16, -1);
    v.set_GradDir(16, 1);
    v.set_Opacity(16, 100);
    v.set_Color(17, 14745599);
    v.set_GradCol(17, -1);
    v.set_GradDir(17, 1);
    v.set_Opacity(17, 100);
    v.set_Color(18, -1);
    v.set_GradCol(18, -1);
    v.set_GradDir(18, 1);
    v.set_Opacity(18, 100);
    v.set_Color(19, -1);
    v.set_GradCol(19, -1);
    v.set_GradDir(19, 1);
    v.set_Opacity(19, 100);
    v.set_Color(20, -1);
    v.set_GradCol(20, -1);
    v.set_GradDir(20, 1);
    v.set_Opacity(20, 100);
    v.set_Color(21, -1);
    v.set_GradCol(21, -1);
    v.set_GradDir(21, 1);
    v.set_Opacity(21, 100);
    v.set_Color(22, -1);
    v.set_GradCol(22, -1);
    v.set_GradDir(22, 1);
    v.set_Opacity(22, 100);
    v.set_Color(23, -1);
    v.set_GradCol(23, -1);
    v.set_GradDir(23, 1);
    v.set_Opacity(23, 100);
    v.set_BorderType(1, 1);
    v.set_BorderType(2, 4);
    v.set_BorderType(3, 4);
    v.set_BorderType(4, 4);
    v.set_BorderType(5, 7);
    v.set_BorderType(6, 4);
    v.set_Font(1, "Arial,,8");
    v.set_Font(2, "Tahoma,,8");
    v.set_Font(3, "Tahoma,,8");
    v.set_Font(4, "Tahoma,,8");
    v.set_Font(5, "Tahoma,,8");
    v.set_Font(6, "Tahoma,,8");
    v.set_HorizontalScale(0);
    v.set_LetterSpacing(0);
    v.set_WordSpacing(0);
    v.set_CBorColor(1, 13684944);
    v.set_CBorWidth(1, 1);
    v.set_CBorType(1, 1);
    v.set_CBorPadding(1, 1);
    v.set_CBorColor(2, 13684944);
    v.set_CBorWidth(2, 1);
    v.set_CBorType(2, 1);
    v.set_CBorPadding(2, 1);
    v.set_CBorColor(3, 13684944);
    v.set_CBorWidth(3, 1);
    v.set_CBorType(3, 1);
    v.set_CBorPadding(3, 1);
    v.set_CBorColor(4, 13684944);
    v.set_CBorWidth(4, 1);
    v.set_CBorType(4, 1);
    v.set_CBorPadding(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_TITOLIINBOX, v);
    v.iGuid = "8DBB5F69-DE9E-49C9-BF9C-21936F82DF63";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Alignment(1, 3);
    v.set_Flags(1048577);
    v.set_Font(1, "Arial,B,14");
    v.set_Font(2, "Arial,,9");
    v.set_Font(3, "Arial,,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_TITOLINCORNI, v);
    v.iGuid = "78AFB53D-50CB-4678-A168-58EC62D3EB4B";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_TITOLIINBOX));
    v.set_BorderType(1, 4);
    v.set_Font(1, "Arial,B,20");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_TITOLINBOX12, v);
    v.iGuid = "9CE2DE31-6136-4FF9-8CF3-AB68F9B36336";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_TITOLIINBOX));
    v.set_Flags(1);
    v.set_Font(1, "Tahoma,B,12");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_TITOLOREPORT, v);
    v.iGuid = "43C8142E-B286-42B7-8193-E1B662006EBF";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Alignment(1, 3);
    v.set_Color(11, -1);
    v.set_BorderType(1, 4);
    v.set_Font(1, "Arial,I,14");
    v.set_Font(2, "Arial,,9");
    v.set_Font(3, "Arial,,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BOX, v);
    v.iGuid = "8A26CCE6-2DB1-4059-BC28-0BE90FB54839";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Alignment(2, 2);
    v.set_Color(6, 16777215);
    v.set_Color(11, 0);
    v.set_BorderType(1, 4);
    v.set_Font(1, "Arial,,9");
    v.set_Font(2, "Arial,,9");
    v.set_Font(3, "Arial,,9");
    v.set_CBorPadding(2, 50);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BOXDISABILIT, v);
    v.iGuid = "FD90E66E-A603-4431-B9CB-8A0E483119BE";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BOX));
    v.set_Color(4, 12632256);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BOXNORMFIEA8, v);
    v.iGuid = "0092064A-36DC-4741-AB5A-F26DF5ADE4AE";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BOX));
    v.set_Font(1, "Tahoma,,8");
    v.set_CBorPadding(2, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BOXALIGNRIGH, v);
    v.iGuid = "3990D60B-A85A-4667-AB8E-10C4ADF849C7";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BOXNORMFIEA8));
    v.set_Alignment(1, 4);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BOXALIGNCENT, v);
    v.iGuid = "A685722B-42DA-48A0-A015-4A3B1B1C5951";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BOXALIGNRIGH));
    v.set_Alignment(1, 3);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BOXALIGCENT7, v);
    v.iGuid = "40BCC14D-81E7-40A6-8CE3-6ACDA2191EBC";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BOXALIGNCENT));
    v.set_Font(1, "Tahoma,,7");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BOX7, v);
    v.iGuid = "EDDC35E9-92CE-457B-8149-978114184427";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BOX));
    v.set_Font(1, "Tahoma,,7");
    v.set_CBorPadding(2, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BOX7ITALIC, v);
    v.iGuid = "B4016C8F-3CC6-4BD3-B636-D0C86F21CD32";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BOX7));
    v.set_Flags(1048577);
    v.set_Font(1, "Tahoma,I,7");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMPORTO, v);
    v.iGuid = "6F4E03C5-A03D-4000-A6E9-FA900C221674";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Alignment(1, 4);
    v.set_Mask("###,###,###,##0.00");
    v.set_Font(2, "Arial,,9");
    v.set_Font(3, "Arial,,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMPOFONTRIDO, v);
    v.iGuid = "A8ECBFC4-7B32-413E-8D81-7AA00B10754B";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_IMPORTO));
    v.set_Font(1, "Arial,,7");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMPORA8BORDI, v);
    v.iGuid = "28D7661E-55F4-42AB-A69C-3A431E484585";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_IMPORTO));
    v.set_Color(6, 16777215);
    v.set_Color(11, 0);
    v.set_BorderType(1, 4);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMPORTOA8, v);
    v.iGuid = "31C18B99-D504-4B36-A679-93B86A257ABD";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_IMPORA8BORDI));
    v.set_BorderType(1, 1);
    v.set_Font(1, "Tahoma,,8");
    v.set_CBorWidth(1, 0);
    v.set_CBorWidth(2, 0);
    v.set_CBorWidth(3, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMPORA8GRASS, v);
    v.iGuid = "86D9AA27-8CD5-4E40-8652-66989AA15998";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_IMPORTOA8));
    v.set_Font(1, "Tahoma,B,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMPORTA8LEFT, v);
    v.iGuid = "A13DDCBC-FF08-4DA6-B78F-7CEEB9132C1E";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_IMPORTOA8));
    v.set_Alignment(1, 2);
    v.set_Flags(257);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMPORTOA7, v);
    v.iGuid = "92016A55-530F-4290-BEAF-E50A2ADAEA41";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_IMPORTOA8));
    v.set_Font(1, "Tahoma,,7");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMPORTOLEFT, v);
    v.iGuid = "64D262A6-94A8-46F9-929E-B1FB71254613";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_IMPORTO));
    v.set_Alignment(1, 2);
    v.set_Flags(1048833);
    v.set_CBorPadding(1, 4);
    v.set_CBorPadding(2, 4);
    v.set_CBorPadding(3, 4);
    v.set_CBorPadding(4, 4);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMPBORDOPINF, v);
    v.iGuid = "D93143DC-50D7-4E10-B345-C61428B15073";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_IMPORTO));
    v.set_Flags(257);
    v.set_BorderType(1, 9);
    v.set_CBorColor(1, 0);
    v.set_CBorColor(2, 0);
    v.set_CBorColor(3, 0);
    v.set_CBorWidth(3, 10);
    v.set_CBorColor(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMPCONBOSESX, v);
    v.iGuid = "CDF8348B-6347-42DF-BC70-5FBE87E2AEA2";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_IMPORTO));
    v.set_Alignment(1, 1);
    v.set_Alignment(2, 2);
    v.set_Color(6, 16777215);
    v.set_Color(11, 0);
    v.set_BorderType(1, 9);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Tahoma,,8");
    v.set_CBorColor(1, 0);
    v.set_CBorPadding(1, 4);
    v.set_CBorColor(2, 0);
    v.set_CBorPadding(2, 10);
    v.set_CBorColor(3, 0);
    v.set_CBorPadding(3, 4);
    v.set_CBorColor(4, 0);
    v.set_CBorWidth(4, 0);
    v.set_CBorPadding(4, 4);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMPORBORDSUP, v);
    v.iGuid = "7DCEBA0B-48E7-4360-96A0-ADBA6E118A4F";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_IMPORTO));
    v.set_Color(4, 16777215);
    v.set_Color(6, 16777215);
    v.set_Color(11, 0);
    v.set_Color(12, 16777215);
    v.set_BorderType(1, 9);
    v.set_BorderType(6, 9);
    v.set_Font(1, "Tahoma,,8");
    v.set_CBorColor(1, 0);
    v.set_CBorPadding(1, 4);
    v.set_CBorColor(2, 16777215);
    v.set_CBorWidth(2, 0);
    v.set_CBorPadding(2, 4);
    v.set_CBorColor(3, 16777215);
    v.set_CBorWidth(3, 0);
    v.set_CBorPadding(3, 4);
    v.set_CBorColor(4, 16777215);
    v.set_CBorWidth(4, 0);
    v.set_CBorPadding(4, 4);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMPORBOXDISA, v);
    v.iGuid = "BB633448-0F0A-41C1-9FCC-02F77A075E58";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_IMPORTO));
    v.set_Flags(257);
    v.set_Color(4, 12632256);
    v.set_Color(11, 0);
    v.set_BorderType(1, 4);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMPORTOA10, v);
    v.iGuid = "8BB21F39-A935-48E1-BCAE-A5C9E3714D46";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_IMPORTO));
    v.set_Font(1, "Arial,,10");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTSENZABORD, v);
    v.iGuid = "1A5251A9-429D-4B86-9D70-5522EAB0F451";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Alignment(2, 2);
    v.set_Color(6, 16777215);
    v.set_Color(11, 0);
    v.set_BorderType(1, 9);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Arial,B,8");
    v.set_Font(2, "Arial,,9");
    v.set_Font(3, "Arial,,9");
    v.set_CBorColor(1, 4194368);
    v.set_CBorWidth(1, 0);
    v.set_CBorWidth(2, 0);
    v.set_CBorColor(3, 4194368);
    v.set_CBorWidth(3, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTSENBORRIG, v);
    v.iGuid = "8225643B-3F8B-4413-8D66-3D83AE30B889";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTSENZABORD));
    v.set_Alignment(1, 4);
    v.set_Font(2, "Arial,B,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTSEBORFOR1, v);
    v.iGuid = "218AEE65-4E86-4A67-A811-966E4E82C3FC";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTSENBORRIG));
    v.set_Font(1, "Arial,B,7");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTSENBOGRRI, v);
    v.iGuid = "A6D0B309-9D97-406C-BE66-6E23AC944782";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTSENBORRIG));
    v.set_Color(4, 12632256);
    v.set_Font(1, "Arial,B,10");
    v.set_CBorPadding(1, 10);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTSENBORGRI, v);
    v.iGuid = "62F30E95-1DF6-4AEB-A2A1-90056A317D20";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTSENBOGRRI));
    v.set_Alignment(1, 2);
    v.set_Font(1, "Arial,B,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTSENBOFORI, v);
    v.iGuid = "C5F8F400-DDF9-42EA-8940-8BE7DF357B0B";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTSENZABORD));
    v.set_Font(1, "Arial,B,7");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_CAMSENBORCEN, v);
    v.iGuid = "862AD27A-1664-41A8-AF0E-91A62A7110AD";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTSENZABORD));
    v.set_Alignment(1, 3);
    v.set_Alignment(2, 3);
    v.set_Flags(257);
    v.set_Font(1, "Arial,,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HEADSENZBOR1, v);
    v.iGuid = "A57127D0-2868-4010-B7EF-F39EB51A7867";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTSENZABORD));
    v.set_Flags(1048833);
    v.set_Font(1, "Arial,B,10");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HEASENBOFO12, v);
    v.iGuid = "1841DB79-8C95-4D60-A342-E9BEED45220B";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_HEADSENZBOR1));
    v.set_Flags(1);
    v.set_Font(1, "Arial,B,12");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HESEBOFO10DE, v);
    v.iGuid = "31EDFB37-1EEE-47E2-A091-D236CDF4928C";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_HEASENBOFO12));
    v.set_Alignment(1, 4);
    v.set_Flags(257);
    v.set_Font(1, "Arial,,10");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HEASENBORCEN, v);
    v.iGuid = "6532E34C-3FF7-46A8-99C5-0B64023F374A";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_HEADSENZBOR1));
    v.set_Alignment(1, 3);
    v.set_Alignment(2, 3);
    v.set_Alignment(3, 3);
    v.set_Flags(257);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HEASENBORDE1, v);
    v.iGuid = "4AC832D4-2FF2-4A36-8366-A5D575C47A0E";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_HEADSENZBOR1));
    v.set_Alignment(1, 4);
    v.set_Flags(257);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTSENBORCE1, v);
    v.iGuid = "2B63AFE7-B736-45D9-A4F8-2DCB096D41A9";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTSENZABORD));
    v.set_Alignment(1, 3);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTSENBORCEN, v);
    v.iGuid = "85ACDE54-D1E1-475C-9FCB-79411140C63D";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTSENZABORD));
    v.set_Alignment(1, 3);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INCOBOCEFOBI, v);
    v.iGuid = "D2C13D4D-017E-47AC-AE2D-8F829304BBDE";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTSENBORCEN));
    v.set_Font(1, "Arial,B,10");
    v.set_CBorColor(1, 12632256);
    v.set_CBorWidth(1, 1);
    v.set_CBorColor(2, 12632256);
    v.set_CBorWidth(2, 1);
    v.set_CBorColor(3, 12632256);
    v.set_CBorWidth(3, 1);
    v.set_CBorWidth(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HEADSENZBORD, v);
    v.iGuid = "155AB1B8-E79B-47E4-882E-323EAB219CD8";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTSENZABORD));
    v.set_Flags(257);
    v.set_Font(1, "Tahoma,B,10");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HEASENBORDES, v);
    v.iGuid = "7F091331-9E14-4FF6-838C-C53B4E24CEC6";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTSENZABORD));
    v.set_Alignment(1, 4);
    v.set_Flags(257);
    v.set_Font(1, "Tahoma,B,10");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTSENZBORD7, v);
    v.iGuid = "2148BBBF-F1AC-4EF5-8DE2-044F5CADB0C5";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTSENZABORD));
    v.set_Font(1, "Tahoma,B,7");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMALGRASSE, v);
    v.iGuid = "483FCD19-E81A-45BC-9F9E-F2A3F1C3D85D";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Alignment(2, 2);
    v.set_Color(6, 16777215);
    v.set_Color(11, 0);
    v.set_BorderType(1, 9);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Arial,B,8");
    v.set_Font(2, "Arial,B,8");
    v.set_Font(3, "Arial,,9");
    v.set_CBorColor(1, 4194368);
    v.set_CBorWidth(1, 0);
    v.set_CBorWidth(2, 0);
    v.set_CBorColor(3, 4194368);
    v.set_CBorWidth(3, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORGRAFONRID, v);
    v.iGuid = "78B281C5-237F-469C-AC1E-454D4D77C17E";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALGRASSE));
    v.set_Font(1, "Arial,B,7");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORGRAFONMAG, v);
    v.iGuid = "5B1EC8C2-F710-4B81-9C6D-D682FEB81B83";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALGRASSE));
    v.set_Flags(257);
    v.set_Font(1, "Arial,B,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMGRASCENT, v);
    v.iGuid = "A59ED6C4-28F9-49D3-BFF0-FE41BF07025F";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALGRASSE));
    v.set_Alignment(1, 3);
    v.set_Font(1, "Tahoma,B,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_LINEAORIZZON, v);
    v.iGuid = "219CD5D6-F59A-4573-82B7-BAB8F91099F0";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Alignment(2, 2);
    v.set_Color(6, 16777215);
    v.set_Color(11, 0);
    v.set_BorderType(1, 9);
    v.set_Font(1, "Arial,,9");
    v.set_Font(2, "Arial,,9");
    v.set_Font(3, "Arial,,9");
    v.set_CBorColor(1, 0);
    v.set_CBorWidth(1, 0);
    v.set_CBorWidth(2, 0);
    v.set_CBorColor(3, 0);
    v.set_CBorWidth(3, 5);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_LINEAPROVA, v);
    v.iGuid = "99DAC141-FF90-422C-A6BF-F2A6044B1FD5";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LINEAORIZZON));
    v.set_Flags(1048577);
    v.set_CBorWidth(3, 1);
    v.set_CBorType(3, 3);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDOSUPERIO, v);
    v.iGuid = "F7962E7E-4475-4DB0-97E9-F11EF68B8956";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LINEAORIZZON));
    v.set_CBorWidth(1, 2);
    v.set_CBorWidth(3, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDSUPFONOK, v);
    v.iGuid = "2B557A47-B9DE-48C2-BD84-F9B7085BCC52";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDOSUPERIO));
    v.set_Flags(257);
    v.set_CBorPadding(2, 10);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDSUPEELAT, v);
    v.iGuid = "011D5ABA-600D-4E35-8199-FC11D100916B";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDOSUPERIO));
    v.set_Flags(257);
    v.set_CBorColor(2, 0);
    v.set_CBorWidth(2, 2);
    v.set_CBorPadding(2, 10);
    v.set_CBorColor(4, 0);
    v.set_CBorWidth(4, 2);
    v.set_CBorPadding(4, 5);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORSUELAFOOK, v);
    v.iGuid = "25C377F9-402D-41DF-9FCC-24C41C1F4676";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDSUPEELAT));
    v.set_Flags(1);
    v.set_Font(1, "Arial,,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BOXPERS, v);
    v.iGuid = "C6D9B517-EB65-4700-BFAA-8328CA750028";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDSUPEELAT));
    v.set_Flags(1);
    v.set_CBorPadding(1, 20);
    v.set_CBorPadding(2, 20);
    v.set_CBorWidth(3, 1);
    v.set_CBorPadding(3, 20);
    v.set_CBorPadding(4, 20);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDOSUPINF, v);
    v.iGuid = "E5A5CD4A-2DD9-42D9-8023-7F082B9AD2B9";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BOXPERS));
    v.set_CBorWidth(2, 0);
    v.set_CBorPadding(2, 8);
    v.set_CBorWidth(3, 7);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDOLEFT, v);
    v.iGuid = "CEE6BB75-F74E-4E72-AEA9-5A08C852B968";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDOSUPINF));
    v.set_CBorWidth(1, 0);
    v.set_CBorWidth(3, 0);
    v.set_CBorWidth(4, 2);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORUPDXDOWSP, v);
    v.iGuid = "0238E050-2509-4852-A197-98485C193E50";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDOSUPINF));
    v.set_CBorPadding(1, 0);
    v.set_CBorWidth(2, 2);
    v.set_CBorPadding(2, 7);
    v.set_CBorWidth(4, 2);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BSLDXINOINF1, v);
    v.iGuid = "7F7B661F-908A-4987-A54D-16E8DD10F954";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDOSUPINF));
    v.set_CBorWidth(2, 1);
    v.set_CBorWidth(3, 0);
    v.set_CBorPadding(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BSLI, v);
    v.iGuid = "BDCA6D31-DBE0-402B-B5A3-5009E7889412";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDSUPEELAT));
    v.set_Flags(1);
    v.set_CBorWidth(3, 7);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BSLDXI, v);
    v.iGuid = "1788AD9D-F81C-4855-AFDA-7BE3837E0B83";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BSLI));
    v.set_Flags(257);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BSLDXINOINF, v);
    v.iGuid = "0B3812B9-4725-4C7D-9AC8-99E904667D05";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BSLDXI));
    v.set_Flags(1);
    v.set_CBorWidth(3, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_MINIBARRA, v);
    v.iGuid = "CD737306-4289-4572-B351-779357B26530";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDOSUPERIO));
    v.set_CBorWidth(1, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDODOPPIO, v);
    v.iGuid = "995FD1F3-7314-4B56-88C5-4BBDFF75B705";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDOSUPERIO));
    v.set_Font(1, "Tahoma,,9");
    v.set_CBorWidth(1, 4);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDOINFERI1, v);
    v.iGuid = "61C7C32E-AAAD-4C5B-9E1A-806E88CCE9B0";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LINEAORIZZON));
    v.set_CBorWidth(3, 2);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDOINFERIO, v);
    v.iGuid = "FA7BBD9E-70DC-4811-BF9B-BAF88F8F5CBA";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LINEAORIZZON));
    v.set_CBorWidth(3, 2);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDINFEDOPP, v);
    v.iGuid = "8A9FBD21-C1C3-4518-B0F8-4EBB13B88720";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LINEAORIZZON));
    v.set_Font(1, "Tahoma,,9");
    v.set_CBorWidth(3, 10);
    v.set_CBorType(3, 4);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTELINEORIZ, v);
    v.iGuid = "DB4C3C19-1797-4C2D-8DBE-EDBC7379AA39";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Alignment(2, 2);
    v.set_Color(6, 16777215);
    v.set_Color(11, 0);
    v.set_BorderType(1, 9);
    v.set_Font(1, "Arial,,9");
    v.set_Font(2, "Arial,,9");
    v.set_Font(3, "Arial,,9");
    v.set_CBorColor(1, 0);
    v.set_CBorWidth(1, 2);
    v.set_CBorWidth(2, 0);
    v.set_CBorColor(3, 0);
    v.set_CBorWidth(3, 2);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_DATA, v);
    v.iGuid = "0EAB389B-0029-4B29-B33D-348369579D11";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Alignment(1, 4);
    v.set_Mask("dd/mm/yyyy");
    v.set_Font(2, "Arial,,9");
    v.set_Font(3, "Arial,,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_DATATITOLO, v);
    v.iGuid = "B6390400-DF5B-4EEE-9C93-751E0211F919";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DATA));
    v.set_Font(1, "Arial,B,14");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMALEA8, v);
    v.iGuid = "0758DCA1-4D3A-4561-85B1-8CDCB6335FD1";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Alignment(2, 2);
    v.set_Color(6, 16777215);
    v.set_Color(11, 0);
    v.set_BorderType(1, 9);
    v.set_BorderType(2, 1);
    v.set_Font(2, "Arial,B,8");
    v.set_Font(3, "Arial,,9");
    v.set_CBorColor(1, 4194368);
    v.set_CBorWidth(1, 0);
    v.set_CBorWidth(2, 0);
    v.set_CBorColor(3, 4194368);
    v.set_CBorWidth(3, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMALEA7, v);
    v.iGuid = "4BEE8634-7592-427E-99A6-F6BFB5F8E668";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA8));
    v.set_Font(1, "Arial,,7");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMAA7RIGHT, v);
    v.iGuid = "04EDE0F6-B085-4DBF-BF22-7069CE754541";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA7));
    v.set_Alignment(1, 4);
    v.set_Font(1, "Tahoma,,7");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMAA7CAPIT, v);
    v.iGuid = "7344EB99-3409-4FED-BC28-C5A3612CA35B";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA7));
    v.set_Mask("################");
    v.set_Flags(257);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMAA7ITALI, v);
    v.iGuid = "5E1B9244-9BD9-4E1C-8DBF-272873D6D17F";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA7));
    v.set_Flags(1048577);
    v.set_Font(1, "Arial,I,7");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMALEA9, v);
    v.iGuid = "8CBD9203-99DF-4D5D-928A-61931C27273A";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA8));
    v.set_Font(1, "Arial,,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMAA9RIGHT, v);
    v.iGuid = "24F881F2-29CD-4392-AE61-8CDF20C9B8E7";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA9));
    v.set_Alignment(1, 4);
    v.set_Flags(257);
    v.set_Font(1, "Tahoma,,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMALA9LEFT, v);
    v.iGuid = "1FB815B0-73B7-4F58-A495-54E4F74C8E27";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA9));
    v.set_Alignment(1, 2);
    v.set_Flags(257);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMAA9CENTR, v);
    v.iGuid = "4D7299B1-79CC-4BBC-B88F-7FE6AB80D2CF";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA9));
    v.set_Alignment(1, 3);
    v.set_Flags(257);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMA9BORGRI, v);
    v.iGuid = "375BE664-F89B-4598-B250-51F1B9886440";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA9));
    v.set_CBorColor(1, 12632256);
    v.set_CBorWidth(1, 1);
    v.set_CBorWidth(2, 1);
    v.set_CBorColor(3, 12632256);
    v.set_CBorWidth(3, 1);
    v.set_CBorWidth(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_SFONDOROSSO, v);
    v.iGuid = "ABBC26B1-AE8F-4D2C-A867-402CD7872F17";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA9));
    v.set_Color(4, 8421631);
    v.set_Color(15, 8421631);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMAA9GRASS, v);
    v.iGuid = "55B09B07-4184-4498-A170-D3F0D6085975";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA9));
    v.set_Flags(257);
    v.set_Font(1, "Tahoma,B,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMAA10GRAS, v);
    v.iGuid = "97681F15-55A9-4929-976C-33539F02412C";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA9));
    v.set_Flags(257);
    v.set_Font(1, "Arial,B,10");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMA9GRACEN, v);
    v.iGuid = "A674EBB4-94F8-470A-A75F-56F3F7CD1DB0";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA9));
    v.set_Alignment(1, 3);
    v.set_Flags(257);
    v.set_Font(1, "Tahoma,B,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMMAGINE, v);
    v.iGuid = "29AF96D2-B4B2-404F-A780-4A8D6D9251B7";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA8));
    v.set_Alignment(1, 4);
    v.set_Flags(524545);
    v.set_Color(1, 15793151);
    v.set_Font(1, "Arial,,3");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A8BORDI, v);
    v.iGuid = "71023380-3CFD-459C-AA28-6FF7CF26DF7A";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA8));
    v.set_BorderType(1, 4);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDIPAZZESC, v);
    v.iGuid = "FBC25E73-268D-4CEF-9750-829ABF3037E8";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_A8BORDI));
    v.set_Alignment(1, 5);
    v.set_Flags(1048577);
    v.set_CBorWidth(1, 1);
    v.set_CBorPadding(1, 5);
    v.set_CBorWidth(2, 1);
    v.set_CBorWidth(3, 1);
    v.set_CBorWidth(4, 1);
    v.set_CBorPadding(4, 5);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A8BORDIGRASS, v);
    v.iGuid = "7C822096-C445-4674-A700-982717D64002";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_A8BORDI));
    v.set_Font(1, "Arial,B,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A8BORDCONSP1, v);
    v.iGuid = "BC7867DC-9627-4E20-87D0-CB250D83DA7A";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_A8BORDI));
    v.set_Flags(1048577);
    v.set_BorderType(1, 9);
    v.set_CBorColor(1, 0);
    v.set_CBorWidth(1, 1);
    v.set_CBorPadding(1, 6);
    v.set_CBorColor(2, 0);
    v.set_CBorWidth(2, 1);
    v.set_CBorPadding(2, 2);
    v.set_CBorColor(3, 0);
    v.set_CBorWidth(3, 1);
    v.set_CBorColor(4, 0);
    v.set_CBorWidth(4, 1);
    v.set_CBorPadding(4, 2);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A8BORDCONSPA, v);
    v.iGuid = "179A9C76-B243-4545-A4F4-6C7D5ACE5E3A";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_A8BORDI));
    v.set_Flags(1048833);
    v.set_BorderType(1, 9);
    v.set_CBorColor(1, 0);
    v.set_CBorWidth(1, 1);
    v.set_CBorPadding(1, 6);
    v.set_CBorColor(2, 0);
    v.set_CBorWidth(2, 1);
    v.set_CBorPadding(2, 2);
    v.set_CBorColor(3, 0);
    v.set_CBorWidth(3, 1);
    v.set_CBorPadding(3, 2);
    v.set_CBorColor(4, 0);
    v.set_CBorWidth(4, 1);
    v.set_CBorPadding(4, 2);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDILATERAL, v);
    v.iGuid = "084AB67B-10DB-4BD0-80D5-5E18F3109F23";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA8));
    v.set_BorderType(1, 3);
    v.set_CBorColor(1, 0);
    v.set_CBorColor(2, 0);
    v.set_CBorWidth(2, 1);
    v.set_CBorColor(4, 0);
    v.set_CBorWidth(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDLATECUST, v);
    v.iGuid = "991DBF17-2B1F-4B75-9A69-C6551632947B";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDILATERAL));
    v.set_BorderType(1, 9);
    v.set_CBorPadding(1, 0);
    v.set_CBorWidth(2, 2);
    v.set_CBorWidth(4, 2);
    v.set_CBorPadding(4, 10);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDLATEEINF, v);
    v.iGuid = "474ECAB3-A191-40EA-8416-70A06466E752";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDLATECUST));
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORLATEINFFO, v);
    v.iGuid = "B47FE062-CD6B-4F93-AD96-3CE99C835B8B";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDLATEEINF));
    v.set_Font(1, "Arial,,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORLATCUSFON, v);
    v.iGuid = "42781D3C-71EF-4391-86B9-2815EA0A7206";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDLATECUST));
    v.set_Font(1, "Arial,,9");
    v.set_CBorPadding(2, 10);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORLATFONCEN, v);
    v.iGuid = "81D2F888-4A7A-4167-8B10-E8D57004B1BF";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORLATCUSFON));
    v.set_Alignment(1, 3);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDILATERA6, v);
    v.iGuid = "1AA59DB0-832F-4741-AF0A-504384D89CCE";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDILATERAL));
    v.set_Font(1, "Arial,,6");
    v.set_CBorPadding(1, 10);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORLATINTLUN, v);
    v.iGuid = "7D3E0B22-F29F-4ED5-B3D5-F7C58A891750";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDILATERAL));
    v.set_Mask("################");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMALA8LEF1, v);
    v.iGuid = "1C4A8427-DEF5-445E-8A26-4E0F1DEF2A24";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA8));
    v.set_Alignment(1, 2);
    v.set_Flags(257);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMAA8RIGHT, v);
    v.iGuid = "53C2C970-34BD-4F74-BF78-40786FEBF0FD";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA8));
    v.set_Alignment(1, 4);
    v.set_Flags(257);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A8BORCONSFGR, v);
    v.iGuid = "739B6D61-FCC8-43E6-904C-E85827B9B8A7";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA8));
    v.set_Color(4, 12632256);
    v.set_BorderType(1, 4);
    v.set_CBorWidth(1, 1);
    v.set_CBorColor(2, 0);
    v.set_CBorWidth(2, 1);
    v.set_CBorWidth(3, 1);
    v.set_CBorColor(4, 0);
    v.set_CBorWidth(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDLATEIMPO, v);
    v.iGuid = "1B750A0D-0C16-45A3-B8D6-20F565573B3A";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA8));
    v.set_Mask("###,###,##0.00");
    v.set_BorderType(1, 3);
    v.set_BorderType(6, 9);
    v.set_CBorColor(2, 0);
    v.set_CBorWidth(2, 1);
    v.set_CBorColor(4, 0);
    v.set_CBorWidth(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDLATEIMP6, v);
    v.iGuid = "B23AD631-1F55-4392-AAB9-A45EE319BB66";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDLATEIMPO));
    v.set_Font(1, "Arial,,6");
    v.set_CBorPadding(1, 10);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A8BORDSENZDX, v);
    v.iGuid = "461B3388-72CC-4E45-9C01-75F90F2E5101";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA8));
    v.set_Font(1, "Tahoma,,8");
    v.set_CBorColor(1, 0);
    v.set_CBorWidth(1, 1);
    v.set_CBorPadding(1, 6);
    v.set_CBorColor(3, 0);
    v.set_CBorWidth(3, 1);
    v.set_CBorPadding(3, 6);
    v.set_CBorColor(4, 0);
    v.set_CBorWidth(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A8BORDSENZSX, v);
    v.iGuid = "6F88241C-E711-4702-9346-6AAA6B797825";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA8));
    v.set_Font(1, "Tahoma,,8");
    v.set_CBorColor(1, 0);
    v.set_CBorWidth(1, 1);
    v.set_CBorPadding(1, 6);
    v.set_CBorColor(2, 0);
    v.set_CBorWidth(2, 1);
    v.set_CBorColor(3, 0);
    v.set_CBorWidth(3, 1);
    v.set_CBorPadding(3, 6);
    v.set_CBorColor(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMALA8LEFT, v);
    v.iGuid = "5A3EF4FA-FFD0-4113-9339-D40ADA58F9B0";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA8));
    v.set_Alignment(1, 2);
    v.set_Flags(257);
    v.set_Font(1, "Tahoma,,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A8LEFT, v);
    v.iGuid = "C96751EF-BD70-42B5-8124-E22F0BE75C0A";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALA8LEFT));
    v.set_Flags(1);
    v.set_Font(1, "Arial,,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A8CENTRATO1, v);
    v.iGuid = "A236519B-CC82-47B0-B076-DD9D862A987D";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_A8LEFT));
    v.set_Alignment(1, 3);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMA8INTLUN, v);
    v.iGuid = "27931789-DC27-4E4E-8038-04B183FD945C";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA8));
    v.set_Mask("################");
    v.set_Flags(257);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A8CENTRATO, v);
    v.iGuid = "4CBFBC1D-6B8A-4B1C-BF27-006FA582054F";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA8));
    v.set_Alignment(1, 3);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMALEA10, v);
    v.iGuid = "E2C5D312-B223-4E68-929D-9F12C672018E";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_NORMALEA8));
    v.set_Font(1, "Arial,,10");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_CHECKBOX, v);
    v.iGuid = "D616DC94-1A69-41D3-8183-57F8C8FF6CE6";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Alignment(2, 2);
    v.set_ControlType(4);
    v.set_Flags(7274497);
    v.set_Color(6, 16777215);
    v.set_Color(11, 0);
    v.set_BorderType(2, 1);
    v.set_Font(2, "Arial,B,8");
    v.set_Font(3, "Arial,,9");
    v.set_CBorColor(1, 4194368);
    v.set_CBorWidth(1, 0);
    v.set_CBorWidth(2, 0);
    v.set_CBorColor(3, 4194368);
    v.set_CBorWidth(3, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTCONBORDO, v);
    v.iGuid = "6F4A10D6-A8AA-44BA-BF02-1DB94F360D77";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Alignment(2, 2);
    v.set_Flags(1048577);
    v.set_Color(6, 16777215);
    v.set_Color(11, 0);
    v.set_BorderType(1, 4);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Arial,B,8");
    v.set_Font(2, "Arial,,9");
    v.set_Font(3, "Arial,,9");
    v.set_CBorColor(1, 4194368);
    v.set_CBorWidth(1, 0);
    v.set_CBorWidth(2, 0);
    v.set_CBorColor(3, 4194368);
    v.set_CBorWidth(3, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTCONBORRIG, v);
    v.iGuid = "4DF6B369-58D6-4105-A8E2-BC39BCF6BF37";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTCONBORDO));
    v.set_Alignment(1, 4);
    v.set_Flags(1);
    v.set_Font(2, "Arial,B,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTSEBORFORI, v);
    v.iGuid = "D92C71A7-210E-4C4C-A436-47BE9DB29A0D";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTCONBORRIG));
    v.set_Font(1, "Arial,B,7");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTCONBOFORI, v);
    v.iGuid = "C5CBE2E2-AE56-42D0-8CA8-CE832AAFB164";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTCONBORDO));
    v.set_Flags(1);
    v.set_Font(1, "Arial,B,7");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTCONBORCEN, v);
    v.iGuid = "9A192B88-287E-4F9C-85A1-5EA6F7BAACE4";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTCONBORDO));
    v.set_Alignment(1, 3);
    v.set_Flags(1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTCONBORCE7, v);
    v.iGuid = "78C88079-0F46-4AAE-9481-104D885C3DBE";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTCONBORCEN));
    v.set_Font(1, "Tahoma,B,7");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTCONBORCE6, v);
    v.iGuid = "AD9B8D06-5F7A-421D-A365-49EEB3EB569C";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTCONBORCE7));
    v.set_Flags(1048833);
    v.set_Font(1, "Tahoma,B,6");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INCOBOBOSUSD, v);
    v.iGuid = "136E1A7A-F6C2-4CE4-8078-48A38FB883AC";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTCONBORDO));
    v.set_Alignment(1, 3);
    v.set_BorderType(1, 9);
    v.set_CBorWidth(1, 2);
    v.set_CBorPadding(1, 5);
    v.set_CBorColor(2, 0);
    v.set_CBorWidth(2, 2);
    v.set_CBorColor(4, 0);
    v.set_CBorWidth(4, 2);
    v.set_CBorPadding(4, 5);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTCONBORSUP, v);
    v.iGuid = "B4206C63-2EFD-4BF4-B27F-31CEF6832DD5";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INCOBOBOSUSD));
    v.set_Flags(257);
    v.set_CBorWidth(2, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INCOBOSUALDX, v);
    v.iGuid = "6CD16614-1BB1-422E-952D-0FA3BA3A32DF";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTCONBORSUP));
    v.set_Alignment(1, 4);
    v.set_Flags(1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INCOBOSUALCE, v);
    v.iGuid = "6A2422D4-69AA-42D5-8D91-DB2E142F1982";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INCOBOSUALDX));
    v.set_Alignment(1, 3);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INCOBOSUEDAC, v);
    v.iGuid = "12FDAB39-65E6-44CA-948B-D063F9C04970";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INCOBOSUALCE));
    v.set_CBorWidth(2, 2);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INCOBOBSSDAD, v);
    v.iGuid = "E02744EE-A681-4AAD-BD4F-CF1D4436C697";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INCOBOBOSUSD));
    v.set_Alignment(1, 4);
    v.set_Flags(1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTCONBORGRI, v);
    v.iGuid = "C4763E9F-5AB9-47C6-8BFB-65B06FB86AB7";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTCONBORDO));
    v.set_Alignment(1, 5);
    v.set_Flags(1);
    v.set_BorderType(1, 9);
    v.set_CBorColor(1, 12632256);
    v.set_CBorWidth(1, 1);
    v.set_CBorWidth(2, 1);
    v.set_CBorColor(3, 12632256);
    v.set_CBorWidth(3, 1);
    v.set_CBorWidth(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INCOBOGRCEGR, v);
    v.iGuid = "C01BDC86-7707-4C65-AF3E-DCA2078708D8";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTCONBORGRI));
    v.set_Alignment(1, 3);
    v.set_Font(1, "Arial,B,12");
    v.set_CBorPadding(1, 35);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORDOGRIGIO, v);
    v.iGuid = "E30BB7C0-AC93-4168-9978-E8B5BE18E982";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTCONBORGRI));
    v.set_Alignment(1, 3);
    v.set_Font(1, "Arial,,8");
    v.set_CBorPadding(1, 75);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BORGRISFOAZU, v);
    v.iGuid = "2A1054C3-4625-431B-A1BA-09BB5EC49C10";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDOGRIGIO));
    v.set_Color(4, 16361472);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BARRAGRIGIA, v);
    v.iGuid = "05BD3E14-FD19-4D49-A518-FE6E81BFB885";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_BORDOGRIGIO));
    v.set_Color(4, 15066597);
    v.set_Color(6, 15066597);
    v.set_Color(15, 15066597);
    v.set_Color(16, 13750737);
    v.set_CBorWidth(1, 0);
    v.set_CBorWidth(2, 0);
    v.set_CBorWidth(3, 0);
    v.set_CBorWidth(4, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INCOBOGRSFAZ, v);
    v.iGuid = "53C2A26A-9504-4B4E-8D95-3DCC8FF40A8E";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTCONBORGRI));
    v.set_Color(4, 16764780);
    v.set_CBorPadding(4, 10);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_INTCONBOSEDX, v);
    v.iGuid = "E6203033-1042-4607-8515-B5550783C552";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_INTCONBORDO));
    v.set_Alignment(1, 4);
    v.set_Alignment(2, 1);
    v.set_Flags(1);
    v.set_BorderType(1, 9);
    v.set_BorderType(2, 4);
    v.set_Font(1, "Tahoma,B,8");
    v.set_Font(2, "Tahoma,,8");
    v.set_Font(3, "Tahoma,,8");
    v.set_CBorColor(1, 0);
    v.set_CBorWidth(1, 1);
    v.set_CBorPadding(1, 6);
    v.set_CBorColor(3, 0);
    v.set_CBorWidth(3, 1);
    v.set_CBorPadding(3, 6);
    v.set_CBorColor(4, 0);
    v.set_CBorWidth(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HYPERLINK2, v);
    v.iGuid = "E635C94A-1786-4B81-9921-683140C2AE3C";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Alignment(1, 3);
    v.set_Flags(2883585);
    v.set_Color(6, 16777215);
    v.set_Font(1, "Arial,B,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_TITOREPNOBOR, v);
    v.iGuid = "2783A49E-A417-4F62-B3C1-1A7434006980";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Font(1, "Arial,I,14");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_TITREPNOBOCE, v);
    v.iGuid = "ECE29BBC-DB86-470C-AB16-2651DF0733B1";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_TITOREPNOBOR));
    v.set_Alignment(1, 3);
    v.set_Flags(1048833);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_TITOLREPOR12, v);
    v.iGuid = "A164D197-F902-4D66-9E01-C3CAE976E2A2";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_TITREPNOBOCE));
    v.set_Flags(1);
    v.set_Font(1, "Arial,I,12");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_TITREPNONCOR, v);
    v.iGuid = "5D3A66EB-D371-48AA-9533-C23786F7029D";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_TITOREPNOBOR));
    v.set_Flags(257);
    v.set_Font(1, "Arial,B,14");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BOXCENTRATO, v);
    v.iGuid = "0683D4E2-AF5D-44A4-95B6-AF1C946EC788";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Alignment(1, 3);
    v.set_Flags(257);
    v.set_Color(11, 0);
    v.set_BorderType(1, 4);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BOXIMPORTO, v);
    v.iGuid = "C1F9CC72-0FD2-4B82-977D-7BFD985B589C";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Mask("###,###,##0.00");
    v.set_Color(11, 0);
    v.set_BorderType(1, 4);
    v.set_Font(1, "Arial,,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_STIVISTESST1, v);
    v.iGuid = "784716F9-CEE0-4690-B664-107435C762BB";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Flags(257);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_STIVISTESST2, v);
    v.iGuid = "3085ACB9-9BD2-405D-8660-A2B94F82ECAA";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Flags(257);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_STIVISTESST3, v);
    v.iGuid = "183E88BC-6213-4709-9223-11D30B8D096D";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Flags(257);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A8GRASCORSOT, v);
    v.iGuid = "9C2916B9-0DCB-4038-9DC1-E665107467B5";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Color(4, 16777215);
    v.set_Color(6, 16777215);
    v.set_Color(7, 16777215);
    v.set_Color(8, 16777215);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Tahoma,BIU,8");
    v.set_Font(2, "Arial,B,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A8GRASSCORSI, v);
    v.iGuid = "B1948B34-54AF-439B-B3CF-C05D4A1B9B74";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Flags(257);
    v.set_Color(4, 16777215);
    v.set_Color(6, 16777215);
    v.set_Color(7, 16777215);
    v.set_Color(8, 16777215);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Tahoma,BI,8");
    v.set_Font(2, "Arial,B,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A8GRASSSOTTO, v);
    v.iGuid = "354254E9-4037-470F-BC0F-4A3B6FF13670";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Flags(257);
    v.set_Color(4, 16777215);
    v.set_Color(6, 16777215);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Tahoma,BU,8");
    v.set_Font(2, "Arial,B,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A8CORSISOTTO, v);
    v.iGuid = "ADAA90DF-3EA9-4D7B-AA23-35C44565850D";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Flags(257);
    v.set_Color(6, 16777215);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Tahoma,IU,8");
    v.set_Font(2, "Arial,B,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A8CORSIVO, v);
    v.iGuid = "C335CB95-A9C0-4325-95A1-87EA6360E63A";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Flags(257);
    v.set_Color(6, 16777215);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Tahoma,I,8");
    v.set_Font(2, "Arial,B,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A8SOTTOLINEA, v);
    v.iGuid = "95479223-5CFC-4549-876B-4AC9F20C5003";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Flags(1048833);
    v.set_Color(6, 16777215);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Tahoma,U,8");
    v.set_Font(2, "Arial,B,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A9GRASSETTO, v);
    v.iGuid = "55A9905D-AF6E-410B-A349-F4AE9A56BCAE";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Flags(1048833);
    v.set_Color(6, 16777215);
    v.set_Font(1, "Tahoma,B,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A9GRASSRIGHT, v);
    v.iGuid = "74AB2052-4D5A-46D1-BA80-7C3238877A31";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_A9GRASSETTO));
    v.set_Alignment(1, 4);
    v.set_Flags(257);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A9GRASCORSOT, v);
    v.iGuid = "A0A64A22-A38D-4BDB-972E-CAADA9C3148F";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Flags(257);
    v.set_Color(6, 16777215);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Tahoma,BIU,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A9GRASSCORSI, v);
    v.iGuid = "B445860A-1A1D-49AD-9B09-3D614269ACFC";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Flags(257);
    v.set_Color(6, 16777215);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Tahoma,BI,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A9GRASSSOTTO, v);
    v.iGuid = "9E07C99F-0F4E-454C-ACBA-E7EADA1FF0AE";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Flags(257);
    v.set_Color(6, 16777215);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Tahoma,BU,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A9CORSISOTTO, v);
    v.iGuid = "077A0330-45A7-4A7A-A1FB-20DE41FDAED7";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Flags(257);
    v.set_Color(6, 16777215);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Tahoma,IU,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A9CORSIVO, v);
    v.iGuid = "A89A6C22-BABC-4744-81D2-0C7BDF352B36";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Flags(1048833);
    v.set_Color(6, 16777215);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Tahoma,I,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_A9SOTTOLINEA, v);
    v.iGuid = "35856843-070A-4B81-983F-FF15DACA3BA9";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Flags(257);
    v.set_Color(6, 16777215);
    v.set_BorderType(2, 1);
    v.set_Font(1, "Tahoma,U,9");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_COMMANBUTTON, v);
    v.iGuid = "35A1432C-83AD-4FC0-AC73-F1975EC5B17D";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Alignment(1, 3);
    v.set_ControlType(6);
    v.set_Flags(2490625);
    v.set_Font(1, "Tahoma,,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HYPERLINK, v);
    v.iGuid = "79F9869B-2BD8-4446-9CFF-498C56A82BD3";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Flags(2490625);
    v.set_Color(1, 16711680);
    v.set_Font(1, "Tahoma,U,8");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_TITOLOREPOR1, v);
    v.iGuid = "0ABC85A5-B0A9-40A0-A633-A1D2825FE39B";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAREPOSTYL));
    v.set_Font(1, "Tahoma,,12");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_DEFAMOBISTYL, v);
    v.iGuid = "43A16029-32EA-4042-B82D-E48398C51D36";
    v.set_Alignment(1, 1);
    v.set_Alignment(2, 1);
    v.set_Alignment(3, 1);
    v.set_ControlType(1);
    v.set_ClassName("");
    v.set_Mask("");
    v.set_Cursor("");
    v.set_RowOffset(0);
    v.set_HeaderOffset(0);
    v.set_Flags(786689);
    v.set_Color(1, 0);
    v.set_GradCol(1, -1);
    v.set_GradDir(1, 1);
    v.set_Opacity(1, 100);
    v.set_Color(2, 8419441);
    v.set_GradCol(2, -1);
    v.set_GradDir(2, 1);
    v.set_Opacity(2, 100);
    v.set_Color(3, 7099980);
    v.set_GradCol(3, -1);
    v.set_GradDir(3, 1);
    v.set_Opacity(3, 100);
    v.set_Color(4, 16777215);
    v.set_GradCol(4, -1);
    v.set_GradDir(4, 1);
    v.set_Opacity(4, 100);
    v.set_Color(5, 16777215);
    v.set_GradCol(5, -1);
    v.set_GradDir(5, 1);
    v.set_Opacity(5, 100);
    v.set_Color(6, -1);
    v.set_GradCol(6, -1);
    v.set_GradDir(6, 1);
    v.set_Opacity(6, 100);
    v.set_Color(7, 16382457);
    v.set_GradCol(7, 12102567);
    v.set_GradDir(7, 3);
    v.set_Opacity(7, 100);
    v.set_Color(8, 16777215);
    v.set_GradCol(8, 15658219);
    v.set_GradDir(8, 3);
    v.set_Opacity(8, 100);
    v.set_Color(9, 15790320);
    v.set_GradCol(9, -1);
    v.set_GradDir(9, 1);
    v.set_Opacity(9, 100);
    v.set_Color(10, -1);
    v.set_GradCol(10, -1);
    v.set_GradDir(10, 1);
    v.set_Opacity(10, 100);
    v.set_Color(11, 13421772);
    v.set_GradCol(11, -1);
    v.set_GradDir(11, 1);
    v.set_Opacity(11, 100);
    v.set_Color(12, 16777215);
    v.set_GradCol(12, -1);
    v.set_GradDir(12, 1);
    v.set_Opacity(12, 100);
    v.set_Color(13, 7099980);
    v.set_GradCol(13, -1);
    v.set_GradDir(13, 1);
    v.set_Opacity(13, 100);
    v.set_Color(14, 14811106);
    v.set_GradCol(14, -1);
    v.set_GradDir(14, 1);
    v.set_Opacity(14, 100);
    v.set_Color(15, 16777215);
    v.set_GradCol(15, -1);
    v.set_GradDir(15, 1);
    v.set_Opacity(15, 100);
    v.set_Color(16, 15790320);
    v.set_GradCol(16, -1);
    v.set_GradDir(16, 1);
    v.set_Opacity(16, 100);
    v.set_Color(17, -1);
    v.set_GradCol(17, -1);
    v.set_GradDir(17, 1);
    v.set_Opacity(17, 100);
    v.set_Color(18, -1);
    v.set_GradCol(18, -1);
    v.set_GradDir(18, 1);
    v.set_Opacity(18, 100);
    v.set_Color(19, -1);
    v.set_GradCol(19, -1);
    v.set_GradDir(19, 1);
    v.set_Opacity(19, 100);
    v.set_Color(20, -1);
    v.set_GradCol(20, -1);
    v.set_GradDir(20, 1);
    v.set_Opacity(20, 100);
    v.set_Color(21, -1);
    v.set_GradCol(21, -1);
    v.set_GradDir(21, 1);
    v.set_Opacity(21, 100);
    v.set_Color(22, 16777215);
    v.set_GradCol(22, -1);
    v.set_GradDir(22, 1);
    v.set_Opacity(22, 100);
    v.set_Color(23, 16777215);
    v.set_GradCol(23, -1);
    v.set_GradDir(23, 1);
    v.set_Opacity(23, 100);
    v.set_BorderType(1, 9);
    v.set_BorderType(2, 9);
    v.set_BorderType(3, 4);
    v.set_BorderType(4, 9);
    v.set_BorderType(5, 4);
    v.set_BorderType(6, 9);
    v.set_Font(1, "Arial,,13");
    v.set_Font(2, "Arial,B,13");
    v.set_Font(3, "Arial,B,13");
    v.set_Font(4, "Arial,,13");
    v.set_Font(5, "Arial,,13");
    v.set_Font(6, "Tahoma,,8");
    v.set_HorizontalScale(0);
    v.set_LetterSpacing(0);
    v.set_WordSpacing(0);
    v.set_CBorColor(1, 13684944);
    v.set_CBorWidth(1, 1);
    v.set_CBorType(1, 1);
    v.set_CBorPadding(1, 32);
    v.set_CBorColor(2, 13684944);
    v.set_CBorWidth(2, 0);
    v.set_CBorType(2, 1);
    v.set_CBorPadding(2, 40);
    v.set_CBorColor(3, 13684944);
    v.set_CBorWidth(3, 1);
    v.set_CBorType(3, 1);
    v.set_CBorPadding(3, 32);
    v.set_CBorColor(4, 13684944);
    v.set_CBorWidth(4, 0);
    v.set_CBorType(4, 1);
    v.set_CBorPadding(4, 40);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_PRIKEYFIEMOB, v);
    v.iGuid = "BAE49E85-8C0D-4222-A404-83C5DB962F89";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAMOBISTYL));
    v.set_Flags(1835265);
    v.set_Color(1, 139);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_FORKEYFIEMOB, v);
    v.iGuid = "81F8B2FB-DA5E-4C79-95D1-D741C8BFD85B";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAMOBISTYL));
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BLOCKFIELMOB, v);
    v.iGuid = "99ED52E9-6C42-4BF2-851D-7D2774698FF8";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAMOBISTYL));
    v.set_Flags(786433);
    v.set_Color(1, 8355711);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_LOOKUFIELMOB, v);
    v.iGuid = "F15E3F4D-1C3F-44B5-AB5C-6F28B23F2D90";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAMOBISTYL));
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_LABELFIELMOB, v);
    v.iGuid = "A8B47B02-5E37-4978-835F-4275B85F4327";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAMOBISTYL));
    v.set_Alignment(1, 3);
    v.set_Flags(1966337);
    v.set_Color(1, 7099980);
    v.set_Color(4, -1);
    v.set_Color(15, -1);
    v.set_Color(16, -1);
    v.set_Color(22, -1);
    v.set_Color(23, -1);
    v.set_BorderType(6, 1);
    v.set_Font(1, "Arial,,11");
    v.set_CBorPadding(2, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HYPERFIELMOB, v);
    v.iGuid = "B54E087A-BCEC-41AE-8ED5-91E87FD0990C";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LABELFIELMOB));
    v.set_Flags(4063489);
    v.set_Color(1, 16711680);
    v.set_Font(1, "Arial,U,11");
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IMAGEFIELMOB, v);
    v.iGuid = "126D21F9-8F31-438E-A18E-C39BBC3AD0DF";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_LABELFIELMOB));
    v.set_Alignment(1, 1);
    v.set_Flags(2883841);
    v.set_Color(1, 0);
    v.set_Color(4, 16777215);
    v.set_Color(15, 16777215);
    v.set_Color(16, 15790320);
    v.set_Color(22, 16777215);
    v.set_Color(23, 16777215);
    v.set_BorderType(6, 9);
    v.set_Font(1, "Arial,,13");
    v.set_CBorPadding(2, 40);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_COMMABUTTMOB, v);
    v.iGuid = "959C76FD-D3BB-467D-BFD0-54045A9EAB32";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAMOBISTYL));
    v.set_Alignment(1, 3);
    v.set_ControlType(6);
    v.set_Flags(3539201);
    v.set_Color(1, 8869177);
    v.set_Color(14, -1);
    v.set_Color(15, -1);
    v.set_Color(16, -1);
    v.set_Color(22, -1);
    v.set_Color(23, -1);
    v.set_Font(1, "Arial,B,11");
    v.set_CBorWidth(1, 0);
    v.set_CBorWidth(3, 0);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_CHECKSTYLMOB, v);
    v.iGuid = "F3702BE0-4837-49AC-98C9-B3461F813EFE";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAMOBISTYL));
    v.set_ControlType(4);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_PASSWSTYLMOB, v);
    v.iGuid = "DDFFB40A-6D1D-457F-8098-2ACBBD2A7937";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAMOBISTYL));
    v.set_Flags(852225);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_RADIOSTYLMOB, v);
    v.iGuid = "01F3CF34-A192-4B9E-AEBA-B66EA69D5319";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAMOBISTYL));
    v.set_ControlType(5);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NORMAFIELMOB, v);
    v.iGuid = "F5ED2E22-0A7B-49B1-821B-765AFEE9F2B6";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAMOBISTYL));
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_HTMEDISTYMOB, v);
    v.iGuid = "1C77869E-E35A-48C8-AAC7-DF0A1B06DB87";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAMOBISTYL));
    v.set_ControlType(7);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_NONNULFIEMOB, v);
    v.iGuid = "380CEB06-E349-42C6-93C4-8904A8CD7680";
    v.set_Derived(VisualStyleList.VisualAttribute(MyGlb.VIS_DEFAMOBISTYL));
    v.set_Flags(786433);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_WINDOWSLIKE, v);
    v.iGuid = "545BF9BC-8277-11D5-92B5-6A7392000000";
    v.set_Alignment(1, 1);
    v.set_Alignment(2, 1);
    v.set_Alignment(3, 1);
    v.set_ControlType(1);
    v.set_ClassName("");
    v.set_Mask("");
    v.set_Cursor("");
    v.set_RowOffset(0);
    v.set_HeaderOffset(4);
    v.set_Flags(786689);
    v.set_Color(1, 0);
    v.set_GradCol(1, -1);
    v.set_GradDir(1, 1);
    v.set_Opacity(1, 100);
    v.set_Color(2, 0);
    v.set_GradCol(2, -1);
    v.set_GradDir(2, 1);
    v.set_Opacity(2, 100);
    v.set_Color(3, 0);
    v.set_GradCol(3, -1);
    v.set_GradDir(3, 1);
    v.set_Opacity(3, 100);
    v.set_Color(4, 16777215);
    v.set_GradCol(4, -1);
    v.set_GradDir(4, 1);
    v.set_Opacity(4, 100);
    v.set_Color(5, 16777215);
    v.set_GradCol(5, -1);
    v.set_GradDir(5, 1);
    v.set_Opacity(5, 100);
    v.set_Color(6, 15002089);
    v.set_GradCol(6, -1);
    v.set_GradDir(6, 1);
    v.set_Opacity(6, 100);
    v.set_Color(7, 14215660);
    v.set_GradCol(7, -1);
    v.set_GradDir(7, 1);
    v.set_Opacity(7, 100);
    v.set_Color(8, 14215660);
    v.set_GradCol(8, -1);
    v.set_GradDir(8, 1);
    v.set_Opacity(8, 100);
    v.set_Color(9, 16443110);
    v.set_GradCol(9, -1);
    v.set_GradDir(9, 1);
    v.set_Opacity(9, 100);
    v.set_Color(10, 16241362);
    v.set_GradCol(10, -1);
    v.set_GradDir(10, 1);
    v.set_Opacity(10, 100);
    v.set_Color(11, 8355711);
    v.set_GradCol(11, -1);
    v.set_GradDir(11, 1);
    v.set_Opacity(11, 100);
    v.set_Color(12, 15002089);
    v.set_GradCol(12, -1);
    v.set_GradDir(12, 1);
    v.set_Opacity(12, 100);
    v.set_Color(13, 0);
    v.set_GradCol(13, -1);
    v.set_GradDir(13, 1);
    v.set_Opacity(13, 100);
    v.set_Color(14, 12451261);
    v.set_GradCol(14, -1);
    v.set_GradDir(14, 1);
    v.set_Opacity(14, 100);
    v.set_Color(15, 14606046);
    v.set_GradCol(15, -1);
    v.set_GradDir(15, 1);
    v.set_Opacity(15, 100);
    v.set_Color(16, 14737632);
    v.set_GradCol(16, -1);
    v.set_GradDir(16, 1);
    v.set_Opacity(16, 100);
    v.set_Color(17, -1);
    v.set_GradCol(17, -1);
    v.set_GradDir(17, 1);
    v.set_Opacity(17, 100);
    v.set_Color(18, -1);
    v.set_GradCol(18, -1);
    v.set_GradDir(18, 1);
    v.set_Opacity(18, 100);
    v.set_Color(19, -1);
    v.set_GradCol(19, -1);
    v.set_GradDir(19, 1);
    v.set_Opacity(19, 100);
    v.set_Color(20, -1);
    v.set_GradCol(20, -1);
    v.set_GradDir(20, 1);
    v.set_Opacity(20, 100);
    v.set_Color(21, -1);
    v.set_GradCol(21, -1);
    v.set_GradDir(21, 1);
    v.set_Opacity(21, 100);
    v.set_Color(22, -1);
    v.set_GradCol(22, -1);
    v.set_GradDir(22, 1);
    v.set_Opacity(22, 100);
    v.set_Color(23, -1);
    v.set_GradCol(23, -1);
    v.set_GradDir(23, 1);
    v.set_Opacity(23, 100);
    v.set_BorderType(1, 4);
    v.set_BorderType(2, 6);
    v.set_BorderType(3, 6);
    v.set_BorderType(4, 1);
    v.set_BorderType(5, 7);
    v.set_BorderType(6, 5);
    v.set_Font(1, "Tahoma,,8");
    v.set_Font(2, "Tahoma,B,8");
    v.set_Font(3, "Tahoma,B,8");
    v.set_Font(4, "Tahoma,,8");
    v.set_Font(5, "Tahoma,,8");
    v.set_Font(6, "Tahoma,,8");
    v.set_HorizontalScale(0);
    v.set_LetterSpacing(0);
    v.set_WordSpacing(0);
    v.set_CBorColor(1, 13684944);
    v.set_CBorWidth(1, 1);
    v.set_CBorType(1, 1);
    v.set_CBorPadding(1, 1);
    v.set_CBorColor(2, 13684944);
    v.set_CBorWidth(2, 1);
    v.set_CBorType(2, 1);
    v.set_CBorPadding(2, 1);
    v.set_CBorColor(3, 13684944);
    v.set_CBorWidth(3, 1);
    v.set_CBorType(3, 1);
    v.set_CBorPadding(3, 1);
    v.set_CBorColor(4, 13684944);
    v.set_CBorWidth(4, 1);
    v.set_CBorType(4, 1);
    v.set_CBorPadding(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IDSTYLE, v);
    v.iGuid = "545BF9CF-8277-11D5-92B5-6A7392000000";
    v.set_Alignment(1, 1);
    v.set_Alignment(2, 1);
    v.set_Alignment(3, 1);
    v.set_ControlType(1);
    v.set_ClassName("");
    v.set_Mask("");
    v.set_Cursor("");
    v.set_RowOffset(0);
    v.set_HeaderOffset(4);
    v.set_Flags(786689);
    v.set_Color(1, 0);
    v.set_GradCol(1, -1);
    v.set_GradDir(1, 1);
    v.set_Opacity(1, 100);
    v.set_Color(2, 0);
    v.set_GradCol(2, -1);
    v.set_GradDir(2, 1);
    v.set_Opacity(2, 100);
    v.set_Color(3, 0);
    v.set_GradCol(3, -1);
    v.set_GradDir(3, 1);
    v.set_Opacity(3, 100);
    v.set_Color(4, 16777215);
    v.set_GradCol(4, -1);
    v.set_GradDir(4, 1);
    v.set_Opacity(4, 100);
    v.set_Color(5, 16777215);
    v.set_GradCol(5, -1);
    v.set_GradDir(5, 1);
    v.set_Opacity(5, 100);
    v.set_Color(6, 16777215);
    v.set_GradCol(6, -1);
    v.set_GradDir(6, 1);
    v.set_Opacity(6, 100);
    v.set_Color(7, 14215660);
    v.set_GradCol(7, -1);
    v.set_GradDir(7, 1);
    v.set_Opacity(7, 100);
    v.set_Color(8, 14215660);
    v.set_GradCol(8, -1);
    v.set_GradDir(8, 1);
    v.set_Opacity(8, 100);
    v.set_Color(9, 13828095);
    v.set_GradCol(9, -1);
    v.set_GradDir(9, 1);
    v.set_Opacity(9, 100);
    v.set_Color(10, 11599871);
    v.set_GradCol(10, -1);
    v.set_GradDir(10, 1);
    v.set_Opacity(10, 100);
    v.set_Color(11, 8355711);
    v.set_GradCol(11, -1);
    v.set_GradDir(11, 1);
    v.set_Opacity(11, 100);
    v.set_Color(12, 16777215);
    v.set_GradCol(12, -1);
    v.set_GradDir(12, 1);
    v.set_Opacity(12, 100);
    v.set_Color(13, 2763429);
    v.set_GradCol(13, -1);
    v.set_GradDir(13, 1);
    v.set_Opacity(13, 100);
    v.set_Color(14, 12451261);
    v.set_GradCol(14, -1);
    v.set_GradDir(14, 1);
    v.set_Opacity(14, 100);
    v.set_Color(15, 15660535);
    v.set_GradCol(15, -1);
    v.set_GradDir(15, 1);
    v.set_Opacity(15, 100);
    v.set_Color(16, 14737632);
    v.set_GradCol(16, -1);
    v.set_GradDir(16, 1);
    v.set_Opacity(16, 100);
    v.set_Color(17, -1);
    v.set_GradCol(17, -1);
    v.set_GradDir(17, 1);
    v.set_Opacity(17, 100);
    v.set_Color(18, -1);
    v.set_GradCol(18, -1);
    v.set_GradDir(18, 1);
    v.set_Opacity(18, 100);
    v.set_Color(19, -1);
    v.set_GradCol(19, -1);
    v.set_GradDir(19, 1);
    v.set_Opacity(19, 100);
    v.set_Color(20, -1);
    v.set_GradCol(20, -1);
    v.set_GradDir(20, 1);
    v.set_Opacity(20, 100);
    v.set_Color(21, -1);
    v.set_GradCol(21, -1);
    v.set_GradDir(21, 1);
    v.set_Opacity(21, 100);
    v.set_Color(22, -1);
    v.set_GradCol(22, -1);
    v.set_GradDir(22, 1);
    v.set_Opacity(22, 100);
    v.set_Color(23, -1);
    v.set_GradCol(23, -1);
    v.set_GradDir(23, 1);
    v.set_Opacity(23, 100);
    v.set_BorderType(1, 4);
    v.set_BorderType(2, 6);
    v.set_BorderType(3, 6);
    v.set_BorderType(4, 1);
    v.set_BorderType(5, 7);
    v.set_BorderType(6, 4);
    v.set_Font(1, "Tahoma,,8");
    v.set_Font(2, "Tahoma,,8");
    v.set_Font(3, "Tahoma,B,8");
    v.set_Font(4, "Tahoma,,8");
    v.set_Font(5, "Tahoma,,8");
    v.set_Font(6, "Tahoma,,8");
    v.set_HorizontalScale(0);
    v.set_LetterSpacing(0);
    v.set_WordSpacing(0);
    v.set_CBorColor(1, 13684944);
    v.set_CBorWidth(1, 1);
    v.set_CBorType(1, 1);
    v.set_CBorPadding(1, 1);
    v.set_CBorColor(2, 13684944);
    v.set_CBorWidth(2, 1);
    v.set_CBorType(2, 1);
    v.set_CBorPadding(2, 1);
    v.set_CBorColor(3, 13684944);
    v.set_CBorWidth(3, 1);
    v.set_CBorType(3, 1);
    v.set_CBorPadding(3, 1);
    v.set_CBorColor(4, 13684944);
    v.set_CBorWidth(4, 1);
    v.set_CBorType(4, 1);
    v.set_CBorPadding(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_SIMPLICITY, v);
    v.iGuid = "08FD91B7-5C04-4582-B0D5-2EB995A3A0B0";
    v.set_Alignment(1, 1);
    v.set_Alignment(2, 1);
    v.set_Alignment(3, 1);
    v.set_ControlType(1);
    v.set_ClassName("");
    v.set_Mask("");
    v.set_Cursor("");
    v.set_RowOffset(0);
    v.set_HeaderOffset(4);
    v.set_Flags(786433);
    v.set_Color(1, 3368448);
    v.set_GradCol(1, -1);
    v.set_GradDir(1, 1);
    v.set_Opacity(1, 100);
    v.set_Color(2, 3368448);
    v.set_GradCol(2, -1);
    v.set_GradDir(2, 1);
    v.set_Opacity(2, 100);
    v.set_Color(3, 3368448);
    v.set_GradCol(3, -1);
    v.set_GradDir(3, 1);
    v.set_Opacity(3, 100);
    v.set_Color(4, 16777215);
    v.set_GradCol(4, -1);
    v.set_GradDir(4, 1);
    v.set_Opacity(4, 100);
    v.set_Color(5, 16777215);
    v.set_GradCol(5, -1);
    v.set_GradDir(5, 1);
    v.set_Opacity(5, 100);
    v.set_Color(6, 16777215);
    v.set_GradCol(6, -1);
    v.set_GradDir(6, 1);
    v.set_Opacity(6, 100);
    v.set_Color(7, 14413275);
    v.set_GradCol(7, -1);
    v.set_GradDir(7, 1);
    v.set_Opacity(7, 100);
    v.set_Color(8, 14413275);
    v.set_GradCol(8, -1);
    v.set_GradDir(8, 1);
    v.set_Opacity(8, 100);
    v.set_Color(9, 16577775);
    v.set_GradCol(9, -1);
    v.set_GradDir(9, 1);
    v.set_Opacity(9, 100);
    v.set_Color(10, 16706784);
    v.set_GradCol(10, -1);
    v.set_GradDir(10, 1);
    v.set_Opacity(10, 100);
    v.set_Color(11, 6736896);
    v.set_GradCol(11, -1);
    v.set_GradDir(11, 1);
    v.set_Opacity(11, 100);
    v.set_Color(12, -1);
    v.set_GradCol(12, -1);
    v.set_GradDir(12, 1);
    v.set_Opacity(12, 100);
    v.set_Color(13, 3368448);
    v.set_GradCol(13, -1);
    v.set_GradDir(13, 1);
    v.set_Opacity(13, 100);
    v.set_Color(14, 14220504);
    v.set_GradCol(14, -1);
    v.set_GradDir(14, 1);
    v.set_Opacity(14, 100);
    v.set_Color(15, 15660535);
    v.set_GradCol(15, -1);
    v.set_GradDir(15, 1);
    v.set_Opacity(15, 100);
    v.set_Color(16, 15265778);
    v.set_GradCol(16, -1);
    v.set_GradDir(16, 1);
    v.set_Opacity(16, 100);
    v.set_Color(17, -1);
    v.set_GradCol(17, -1);
    v.set_GradDir(17, 1);
    v.set_Opacity(17, 100);
    v.set_Color(18, -1);
    v.set_GradCol(18, -1);
    v.set_GradDir(18, 1);
    v.set_Opacity(18, 100);
    v.set_Color(19, -1);
    v.set_GradCol(19, -1);
    v.set_GradDir(19, 1);
    v.set_Opacity(19, 100);
    v.set_Color(20, -1);
    v.set_GradCol(20, -1);
    v.set_GradDir(20, 1);
    v.set_Opacity(20, 100);
    v.set_Color(21, -1);
    v.set_GradCol(21, -1);
    v.set_GradDir(21, 1);
    v.set_Opacity(21, 100);
    v.set_Color(22, -1);
    v.set_GradCol(22, -1);
    v.set_GradDir(22, 1);
    v.set_Opacity(22, 100);
    v.set_Color(23, -1);
    v.set_GradCol(23, -1);
    v.set_GradDir(23, 1);
    v.set_Opacity(23, 100);
    v.set_BorderType(1, 4);
    v.set_BorderType(2, 4);
    v.set_BorderType(3, 4);
    v.set_BorderType(4, 1);
    v.set_BorderType(5, 2);
    v.set_BorderType(6, 4);
    v.set_Font(1, "Tahoma,,8");
    v.set_Font(2, "Tahoma,,8");
    v.set_Font(3, "Tahoma,B,8");
    v.set_Font(4, "Tahoma,,8");
    v.set_Font(5, "Tahoma,,8");
    v.set_Font(6, "Tahoma,,8");
    v.set_HorizontalScale(0);
    v.set_LetterSpacing(0);
    v.set_WordSpacing(0);
    v.set_CBorColor(1, 13684944);
    v.set_CBorWidth(1, 1);
    v.set_CBorType(1, 1);
    v.set_CBorPadding(1, 1);
    v.set_CBorColor(2, 13684944);
    v.set_CBorWidth(2, 1);
    v.set_CBorType(2, 1);
    v.set_CBorPadding(2, 1);
    v.set_CBorColor(3, 13684944);
    v.set_CBorWidth(3, 1);
    v.set_CBorType(3, 1);
    v.set_CBorPadding(3, 1);
    v.set_CBorColor(4, 13684944);
    v.set_CBorWidth(4, 1);
    v.set_CBorType(4, 1);
    v.set_CBorPadding(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_CASUAL, v);
    v.iGuid = "4EF4E49D-B51C-4314-ABE0-10647F6866C4";
    v.set_Alignment(1, 1);
    v.set_Alignment(2, 1);
    v.set_Alignment(3, 1);
    v.set_ControlType(1);
    v.set_ClassName("");
    v.set_Mask("");
    v.set_Cursor("");
    v.set_RowOffset(0);
    v.set_HeaderOffset(4);
    v.set_Flags(786433);
    v.set_Color(1, 2105376);
    v.set_GradCol(1, -1);
    v.set_GradDir(1, 1);
    v.set_Opacity(1, 100);
    v.set_Color(2, 3952720);
    v.set_GradCol(2, -1);
    v.set_GradDir(2, 1);
    v.set_Opacity(2, 100);
    v.set_Color(3, 8998144);
    v.set_GradCol(3, -1);
    v.set_GradDir(3, 1);
    v.set_Opacity(3, 100);
    v.set_Color(4, 16777215);
    v.set_GradCol(4, -1);
    v.set_GradDir(4, 1);
    v.set_Opacity(4, 100);
    v.set_Color(5, 16777215);
    v.set_GradCol(5, -1);
    v.set_GradDir(5, 1);
    v.set_Opacity(5, 100);
    v.set_Color(6, 16777215);
    v.set_GradCol(6, -1);
    v.set_GradDir(6, 1);
    v.set_Opacity(6, 100);
    v.set_Color(7, 14085101);
    v.set_GradCol(7, -1);
    v.set_GradDir(7, 1);
    v.set_Opacity(7, 100);
    v.set_Color(8, 13166312);
    v.set_GradCol(8, -1);
    v.set_GradDir(8, 1);
    v.set_Opacity(8, 100);
    v.set_Color(9, 16511466);
    v.set_GradCol(9, -1);
    v.set_GradDir(9, 1);
    v.set_Opacity(9, 100);
    v.set_Color(10, -1);
    v.set_GradCol(10, -1);
    v.set_GradDir(10, 1);
    v.set_Opacity(10, 100);
    v.set_Color(11, 12164479);
    v.set_GradCol(11, -1);
    v.set_GradDir(11, 1);
    v.set_Opacity(11, 100);
    v.set_Color(12, 16777215);
    v.set_GradCol(12, -1);
    v.set_GradDir(12, 1);
    v.set_Opacity(12, 100);
    v.set_Color(13, 8998144);
    v.set_GradCol(13, -1);
    v.set_GradDir(13, 1);
    v.set_Opacity(13, 100);
    v.set_Color(14, 13695974);
    v.set_GradCol(14, -1);
    v.set_GradDir(14, 1);
    v.set_Opacity(14, 100);
    v.set_Color(15, 15660535);
    v.set_GradCol(15, -1);
    v.set_GradDir(15, 1);
    v.set_Opacity(15, 100);
    v.set_Color(16, 14871535);
    v.set_GradCol(16, -1);
    v.set_GradDir(16, 1);
    v.set_Opacity(16, 100);
    v.set_Color(17, -1);
    v.set_GradCol(17, -1);
    v.set_GradDir(17, 1);
    v.set_Opacity(17, 100);
    v.set_Color(18, -1);
    v.set_GradCol(18, -1);
    v.set_GradDir(18, 1);
    v.set_Opacity(18, 100);
    v.set_Color(19, -1);
    v.set_GradCol(19, -1);
    v.set_GradDir(19, 1);
    v.set_Opacity(19, 100);
    v.set_Color(20, -1);
    v.set_GradCol(20, -1);
    v.set_GradDir(20, 1);
    v.set_Opacity(20, 100);
    v.set_Color(21, -1);
    v.set_GradCol(21, -1);
    v.set_GradDir(21, 1);
    v.set_Opacity(21, 100);
    v.set_Color(22, -1);
    v.set_GradCol(22, -1);
    v.set_GradDir(22, 1);
    v.set_Opacity(22, 100);
    v.set_Color(23, -1);
    v.set_GradCol(23, -1);
    v.set_GradDir(23, 1);
    v.set_Opacity(23, 100);
    v.set_BorderType(1, 4);
    v.set_BorderType(2, 4);
    v.set_BorderType(3, 4);
    v.set_BorderType(4, 1);
    v.set_BorderType(5, 2);
    v.set_BorderType(6, 4);
    v.set_Font(1, "Tahoma,,8");
    v.set_Font(2, "Tahoma,,8");
    v.set_Font(3, "Tahoma,B,8");
    v.set_Font(4, "Tahoma,,8");
    v.set_Font(5, "Tahoma,,8");
    v.set_Font(6, "Tahoma,,8");
    v.set_HorizontalScale(0);
    v.set_LetterSpacing(0);
    v.set_WordSpacing(0);
    v.set_CBorColor(1, 13684944);
    v.set_CBorWidth(1, 1);
    v.set_CBorType(1, 1);
    v.set_CBorPadding(1, 1);
    v.set_CBorColor(2, 13684944);
    v.set_CBorWidth(2, 1);
    v.set_CBorType(2, 1);
    v.set_CBorPadding(2, 1);
    v.set_CBorColor(3, 13684944);
    v.set_CBorWidth(3, 1);
    v.set_CBorType(3, 1);
    v.set_CBorPadding(3, 1);
    v.set_CBorColor(4, 13684944);
    v.set_CBorWidth(4, 1);
    v.set_CBorType(4, 1);
    v.set_CBorPadding(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_SEATTLE, v);
    v.iGuid = "DD74AA17-2B85-43FE-A1DC-6A7B7BF72AEE";
    v.set_Alignment(1, 1);
    v.set_Alignment(2, 1);
    v.set_Alignment(3, 1);
    v.set_ControlType(1);
    v.set_ClassName("");
    v.set_Mask("");
    v.set_Cursor("");
    v.set_RowOffset(0);
    v.set_HeaderOffset(4);
    v.set_Flags(786689);
    v.set_Color(1, 2105376);
    v.set_GradCol(1, -1);
    v.set_GradDir(1, 1);
    v.set_Opacity(1, 100);
    v.set_Color(2, 3952720);
    v.set_GradCol(2, -1);
    v.set_GradDir(2, 1);
    v.set_Opacity(2, 100);
    v.set_Color(3, 8998144);
    v.set_GradCol(3, -1);
    v.set_GradDir(3, 1);
    v.set_Opacity(3, 100);
    v.set_Color(4, 16777215);
    v.set_GradCol(4, -1);
    v.set_GradDir(4, 1);
    v.set_Opacity(4, 100);
    v.set_Color(5, 16777215);
    v.set_GradCol(5, -1);
    v.set_GradDir(5, 1);
    v.set_Opacity(5, 100);
    v.set_Color(6, 16054778);
    v.set_GradCol(6, -1);
    v.set_GradDir(6, 1);
    v.set_Opacity(6, 100);
    v.set_Color(7, 16382457);
    v.set_GradCol(7, 15658219);
    v.set_GradDir(7, 3);
    v.set_Opacity(7, 100);
    v.set_Color(8, 16777215);
    v.set_GradCol(8, 15658219);
    v.set_GradDir(8, 3);
    v.set_Opacity(8, 100);
    v.set_Color(9, 16446446);
    v.set_GradCol(9, -1);
    v.set_GradDir(9, 1);
    v.set_Opacity(9, 100);
    v.set_Color(10, -1);
    v.set_GradCol(10, -1);
    v.set_GradDir(10, 1);
    v.set_Opacity(10, 100);
    v.set_Color(11, 13547166);
    v.set_GradCol(11, -1);
    v.set_GradDir(11, 1);
    v.set_Opacity(11, 100);
    v.set_Color(12, -1);
    v.set_GradCol(12, -1);
    v.set_GradDir(12, 1);
    v.set_Opacity(12, 100);
    v.set_Color(13, 8998144);
    v.set_GradCol(13, -1);
    v.set_GradDir(13, 1);
    v.set_Opacity(13, 100);
    v.set_Color(14, 14811106);
    v.set_GradCol(14, -1);
    v.set_GradDir(14, 1);
    v.set_Opacity(14, 100);
    v.set_Color(15, 15856627);
    v.set_GradCol(15, -1);
    v.set_GradDir(15, 1);
    v.set_Opacity(15, 100);
    v.set_Color(16, 15658477);
    v.set_GradCol(16, -1);
    v.set_GradDir(16, 1);
    v.set_Opacity(16, 100);
    v.set_Color(17, -1);
    v.set_GradCol(17, -1);
    v.set_GradDir(17, 1);
    v.set_Opacity(17, 100);
    v.set_Color(18, -1);
    v.set_GradCol(18, -1);
    v.set_GradDir(18, 1);
    v.set_Opacity(18, 100);
    v.set_Color(19, -1);
    v.set_GradCol(19, -1);
    v.set_GradDir(19, 1);
    v.set_Opacity(19, 100);
    v.set_Color(20, -1);
    v.set_GradCol(20, -1);
    v.set_GradDir(20, 1);
    v.set_Opacity(20, 100);
    v.set_Color(21, -1);
    v.set_GradCol(21, -1);
    v.set_GradDir(21, 1);
    v.set_Opacity(21, 100);
    v.set_Color(22, -1);
    v.set_GradCol(22, -1);
    v.set_GradDir(22, 1);
    v.set_Opacity(22, 100);
    v.set_Color(23, -1);
    v.set_GradCol(23, -1);
    v.set_GradDir(23, 1);
    v.set_Opacity(23, 100);
    v.set_BorderType(1, 4);
    v.set_BorderType(2, 4);
    v.set_BorderType(3, 4);
    v.set_BorderType(4, 1);
    v.set_BorderType(5, 2);
    v.set_BorderType(6, 4);
    v.set_Font(1, "Tahoma,,8");
    v.set_Font(2, "Tahoma,,8");
    v.set_Font(3, "Tahoma,B,8");
    v.set_Font(4, "Tahoma,,8");
    v.set_Font(5, "Tahoma,,8");
    v.set_Font(6, "Tahoma,,8");
    v.set_HorizontalScale(0);
    v.set_LetterSpacing(0);
    v.set_WordSpacing(0);
    v.set_CBorColor(1, 13684944);
    v.set_CBorWidth(1, 1);
    v.set_CBorType(1, 1);
    v.set_CBorPadding(1, 1);
    v.set_CBorColor(2, 13684944);
    v.set_CBorWidth(2, 0);
    v.set_CBorType(2, 1);
    v.set_CBorPadding(2, 1);
    v.set_CBorColor(3, 13684944);
    v.set_CBorWidth(3, 1);
    v.set_CBorType(3, 1);
    v.set_CBorPadding(3, 1);
    v.set_CBorColor(4, 13684944);
    v.set_CBorWidth(4, 0);
    v.set_CBorType(4, 1);
    v.set_CBorPadding(4, 1);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_ZEN, v);
    v.iGuid = "6F85177E-2EB3-4C60-861F-213F12F8D4F0";
    v.set_Alignment(1, 1);
    v.set_Alignment(2, 3);
    v.set_Alignment(3, 1);
    v.set_ControlType(1);
    v.set_ClassName("");
    v.set_Mask("");
    v.set_Cursor("");
    v.set_RowOffset(0);
    v.set_HeaderOffset(0);
    v.set_Flags(786689);
    v.set_Color(1, 2105376);
    v.set_GradCol(1, -1);
    v.set_GradDir(1, 1);
    v.set_Opacity(1, 100);
    v.set_Color(2, 2105376);
    v.set_GradCol(2, -1);
    v.set_GradDir(2, 1);
    v.set_Opacity(2, 100);
    v.set_Color(3, 139296);
    v.set_GradCol(3, -1);
    v.set_GradDir(3, 1);
    v.set_Opacity(3, 100);
    v.set_Color(4, 16777215);
    v.set_GradCol(4, -1);
    v.set_GradDir(4, 1);
    v.set_Opacity(4, 100);
    v.set_Color(5, 16777215);
    v.set_GradCol(5, -1);
    v.set_GradDir(5, 1);
    v.set_Opacity(5, 100);
    v.set_Color(6, 16054778);
    v.set_GradCol(6, -1);
    v.set_GradDir(6, 1);
    v.set_Opacity(6, 100);
    v.set_Color(7, 16054778);
    v.set_GradCol(7, -1);
    v.set_GradDir(7, 3);
    v.set_Opacity(7, 100);
    v.set_Color(8, 14869218);
    v.set_GradCol(8, 14869218);
    v.set_GradDir(8, 3);
    v.set_Opacity(8, 100);
    v.set_Color(9, 16446446);
    v.set_GradCol(9, -1);
    v.set_GradDir(9, 1);
    v.set_Opacity(9, 100);
    v.set_Color(10, -1);
    v.set_GradCol(10, -1);
    v.set_GradDir(10, 1);
    v.set_Opacity(10, 100);
    v.set_Color(11, 13684944);
    v.set_GradCol(11, -1);
    v.set_GradDir(11, 1);
    v.set_Opacity(11, 100);
    v.set_Color(12, -1);
    v.set_GradCol(12, -1);
    v.set_GradDir(12, 1);
    v.set_Opacity(12, 100);
    v.set_Color(13, 2105376);
    v.set_GradCol(13, -1);
    v.set_GradDir(13, 1);
    v.set_Opacity(13, 100);
    v.set_Color(14, 14811106);
    v.set_GradCol(14, -1);
    v.set_GradDir(14, 1);
    v.set_Opacity(14, 100);
    v.set_Color(15, 15856627);
    v.set_GradCol(15, -1);
    v.set_GradDir(15, 1);
    v.set_Opacity(15, 100);
    v.set_Color(16, 15658477);
    v.set_GradCol(16, -1);
    v.set_GradDir(16, 1);
    v.set_Opacity(16, 100);
    v.set_Color(17, -1);
    v.set_GradCol(17, -1);
    v.set_GradDir(17, 1);
    v.set_Opacity(17, 100);
    v.set_Color(18, -1);
    v.set_GradCol(18, -1);
    v.set_GradDir(18, 1);
    v.set_Opacity(18, 100);
    v.set_Color(19, -1);
    v.set_GradCol(19, -1);
    v.set_GradDir(19, 1);
    v.set_Opacity(19, 100);
    v.set_Color(20, -1);
    v.set_GradCol(20, -1);
    v.set_GradDir(20, 1);
    v.set_Opacity(20, 100);
    v.set_Color(21, -1);
    v.set_GradCol(21, -1);
    v.set_GradDir(21, 1);
    v.set_Opacity(21, 100);
    v.set_Color(22, 16777215);
    v.set_GradCol(22, -1);
    v.set_GradDir(22, 1);
    v.set_Opacity(22, 100);
    v.set_Color(23, 16777215);
    v.set_GradCol(23, -1);
    v.set_GradDir(23, 1);
    v.set_Opacity(23, 100);
    v.set_BorderType(1, 9);
    v.set_BorderType(2, 9);
    v.set_BorderType(3, 4);
    v.set_BorderType(4, 1);
    v.set_BorderType(5, 2);
    v.set_BorderType(6, 4);
    v.set_Font(1, "Arial,,10");
    v.set_Font(2, "Arial,,10");
    v.set_Font(3, "Arial,B,9");
    v.set_Font(4, "Arial,,10");
    v.set_Font(5, "Arial,,10");
    v.set_Font(6, "Tahoma,,8");
    v.set_HorizontalScale(0);
    v.set_LetterSpacing(0);
    v.set_WordSpacing(0);
    v.set_CBorColor(1, 13684944);
    v.set_CBorWidth(1, 4);
    v.set_CBorType(1, 1);
    v.set_CBorPadding(1, 10);
    v.set_CBorColor(2, 13684944);
    v.set_CBorWidth(2, 4);
    v.set_CBorType(2, 2);
    v.set_CBorPadding(2, 10);
    v.set_CBorColor(3, 13684944);
    v.set_CBorWidth(3, 4);
    v.set_CBorType(3, 1);
    v.set_CBorPadding(3, 10);
    v.set_CBorColor(4, 13684944);
    v.set_CBorWidth(4, 4);
    v.set_CBorType(4, 2);
    v.set_CBorPadding(4, 10);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BOOTSTRAP, v);
    v.iGuid = "2B3455F0-983B-48AE-98B1-50ECD716A704";
    v.set_Alignment(1, 1);
    v.set_Alignment(2, 3);
    v.set_Alignment(3, 1);
    v.set_ControlType(1);
    v.set_ClassName("");
    v.set_Mask("");
    v.set_Cursor("");
    v.set_RowOffset(0);
    v.set_HeaderOffset(0);
    v.set_Flags(786689);
    v.set_Color(1, 2105376);
    v.set_GradCol(1, -1);
    v.set_GradDir(1, 1);
    v.set_Opacity(1, 100);
    v.set_Color(2, 2105376);
    v.set_GradCol(2, -1);
    v.set_GradDir(2, 1);
    v.set_Opacity(2, 100);
    v.set_Color(3, 139296);
    v.set_GradCol(3, -1);
    v.set_GradDir(3, 1);
    v.set_Opacity(3, 100);
    v.set_Color(4, -1);
    v.set_GradCol(4, -1);
    v.set_GradDir(4, 1);
    v.set_Opacity(4, 100);
    v.set_Color(5, -1);
    v.set_GradCol(5, -1);
    v.set_GradDir(5, 1);
    v.set_Opacity(5, 100);
    v.set_Color(6, 16054778);
    v.set_GradCol(6, -1);
    v.set_GradDir(6, 1);
    v.set_Opacity(6, 100);
    v.set_Color(7, -1);
    v.set_GradCol(7, -1);
    v.set_GradDir(7, 1);
    v.set_Opacity(7, 100);
    v.set_Color(8, 14869218);
    v.set_GradCol(8, 14869218);
    v.set_GradDir(8, 3);
    v.set_Opacity(8, 100);
    v.set_Color(9, 16446446);
    v.set_GradCol(9, -1);
    v.set_GradDir(9, 1);
    v.set_Opacity(9, 100);
    v.set_Color(10, -1);
    v.set_GradCol(10, -1);
    v.set_GradDir(10, 1);
    v.set_Opacity(10, 100);
    v.set_Color(11, 13684944);
    v.set_GradCol(11, -1);
    v.set_GradDir(11, 1);
    v.set_Opacity(11, 100);
    v.set_Color(12, -1);
    v.set_GradCol(12, -1);
    v.set_GradDir(12, 1);
    v.set_Opacity(12, 100);
    v.set_Color(13, 2105376);
    v.set_GradCol(13, -1);
    v.set_GradDir(13, 1);
    v.set_Opacity(13, 100);
    v.set_Color(14, 14811106);
    v.set_GradCol(14, -1);
    v.set_GradDir(14, 1);
    v.set_Opacity(14, 100);
    v.set_Color(15, -1);
    v.set_GradCol(15, -1);
    v.set_GradDir(15, 1);
    v.set_Opacity(15, 100);
    v.set_Color(16, 15658477);
    v.set_GradCol(16, -1);
    v.set_GradDir(16, 1);
    v.set_Opacity(16, 100);
    v.set_Color(17, -1);
    v.set_GradCol(17, -1);
    v.set_GradDir(17, 1);
    v.set_Opacity(17, 100);
    v.set_Color(18, -1);
    v.set_GradCol(18, -1);
    v.set_GradDir(18, 1);
    v.set_Opacity(18, 100);
    v.set_Color(19, -1);
    v.set_GradCol(19, -1);
    v.set_GradDir(19, 1);
    v.set_Opacity(19, 100);
    v.set_Color(20, -1);
    v.set_GradCol(20, -1);
    v.set_GradDir(20, 1);
    v.set_Opacity(20, 100);
    v.set_Color(21, -1);
    v.set_GradCol(21, -1);
    v.set_GradDir(21, 1);
    v.set_Opacity(21, 100);
    v.set_Color(22, 16777215);
    v.set_GradCol(22, -1);
    v.set_GradDir(22, 1);
    v.set_Opacity(22, 100);
    v.set_Color(23, 16777215);
    v.set_GradCol(23, -1);
    v.set_GradDir(23, 1);
    v.set_Opacity(23, 100);
    v.set_BorderType(1, 4);
    v.set_BorderType(2, 1);
    v.set_BorderType(3, 4);
    v.set_BorderType(4, 1);
    v.set_BorderType(5, 2);
    v.set_BorderType(6, 4);
    v.set_Font(1, "Arial,,10");
    v.set_Font(2, "Arial,,10");
    v.set_Font(3, "Arial,B,9");
    v.set_Font(4, "Arial,,10");
    v.set_Font(5, "Arial,,10");
    v.set_Font(6, "Tahoma,,8");
    v.set_HorizontalScale(0);
    v.set_LetterSpacing(0);
    v.set_WordSpacing(0);
    v.set_CBorColor(1, 13684944);
    v.set_CBorWidth(1, 4);
    v.set_CBorType(1, 1);
    v.set_CBorPadding(1, 10);
    v.set_CBorColor(2, 13684944);
    v.set_CBorWidth(2, 4);
    v.set_CBorType(2, 2);
    v.set_CBorPadding(2, 10);
    v.set_CBorColor(3, 13684944);
    v.set_CBorWidth(3, 4);
    v.set_CBorType(3, 1);
    v.set_CBorPadding(3, 10);
    v.set_CBorColor(4, 13684944);
    v.set_CBorWidth(4, 4);
    v.set_CBorType(4, 2);
    v.set_CBorPadding(4, 10);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_IONIC, v);
    v.iGuid = "07637538-6611-4269-97B3-CE5E4B5846B2";
    v.set_Alignment(1, 1);
    v.set_Alignment(2, 2);
    v.set_Alignment(3, 1);
    v.set_ControlType(1);
    v.set_ClassName("");
    v.set_Mask("");
    v.set_Cursor("");
    v.set_RowOffset(0);
    v.set_HeaderOffset(0);
    v.set_Flags(786433);
    v.set_Color(1, 2105376);
    v.set_GradCol(1, -1);
    v.set_GradDir(1, 1);
    v.set_Opacity(1, 100);
    v.set_Color(2, 2105376);
    v.set_GradCol(2, -1);
    v.set_GradDir(2, 1);
    v.set_Opacity(2, 100);
    v.set_Color(3, 139296);
    v.set_GradCol(3, -1);
    v.set_GradDir(3, 1);
    v.set_Opacity(3, 100);
    v.set_Color(4, -1);
    v.set_GradCol(4, -1);
    v.set_GradDir(4, 1);
    v.set_Opacity(4, 100);
    v.set_Color(5, -1);
    v.set_GradCol(5, -1);
    v.set_GradDir(5, 1);
    v.set_Opacity(5, 100);
    v.set_Color(6, 16777215);
    v.set_GradCol(6, -1);
    v.set_GradDir(6, 1);
    v.set_Opacity(6, 100);
    v.set_Color(7, -1);
    v.set_GradCol(7, -1);
    v.set_GradDir(7, 1);
    v.set_Opacity(7, 100);
    v.set_Color(8, 14869218);
    v.set_GradCol(8, 14869218);
    v.set_GradDir(8, 3);
    v.set_Opacity(8, 100);
    v.set_Color(9, -1);
    v.set_GradCol(9, -1);
    v.set_GradDir(9, 1);
    v.set_Opacity(9, 100);
    v.set_Color(10, -1);
    v.set_GradCol(10, -1);
    v.set_GradDir(10, 1);
    v.set_Opacity(10, 100);
    v.set_Color(11, 13684944);
    v.set_GradCol(11, -1);
    v.set_GradDir(11, 1);
    v.set_Opacity(11, 100);
    v.set_Color(12, -1);
    v.set_GradCol(12, -1);
    v.set_GradDir(12, 1);
    v.set_Opacity(12, 100);
    v.set_Color(13, 2105376);
    v.set_GradCol(13, -1);
    v.set_GradDir(13, 1);
    v.set_Opacity(13, 100);
    v.set_Color(14, 14811106);
    v.set_GradCol(14, -1);
    v.set_GradDir(14, 1);
    v.set_Opacity(14, 100);
    v.set_Color(15, -1);
    v.set_GradCol(15, -1);
    v.set_GradDir(15, 1);
    v.set_Opacity(15, 100);
    v.set_Color(16, -1);
    v.set_GradCol(16, -1);
    v.set_GradDir(16, 1);
    v.set_Opacity(16, 100);
    v.set_Color(17, -1);
    v.set_GradCol(17, -1);
    v.set_GradDir(17, 1);
    v.set_Opacity(17, 100);
    v.set_Color(18, -1);
    v.set_GradCol(18, -1);
    v.set_GradDir(18, 1);
    v.set_Opacity(18, 100);
    v.set_Color(19, -1);
    v.set_GradCol(19, -1);
    v.set_GradDir(19, 1);
    v.set_Opacity(19, 100);
    v.set_Color(20, -1);
    v.set_GradCol(20, -1);
    v.set_GradDir(20, 1);
    v.set_Opacity(20, 100);
    v.set_Color(21, -1);
    v.set_GradCol(21, -1);
    v.set_GradDir(21, 1);
    v.set_Opacity(21, 100);
    v.set_Color(22, 16777215);
    v.set_GradCol(22, -1);
    v.set_GradDir(22, 1);
    v.set_Opacity(22, 100);
    v.set_Color(23, 16777215);
    v.set_GradCol(23, -1);
    v.set_GradDir(23, 1);
    v.set_Opacity(23, 100);
    v.set_BorderType(1, 9);
    v.set_BorderType(2, 9);
    v.set_BorderType(3, 4);
    v.set_BorderType(4, 2);
    v.set_BorderType(5, 2);
    v.set_BorderType(6, 2);
    v.set_Font(1, "Arial,,12");
    v.set_Font(2, "Arial,,12");
    v.set_Font(3, "Arial,B,9");
    v.set_Font(4, "Arial,,12");
    v.set_Font(5, "Arial,,10");
    v.set_Font(6, "Tahoma,,8");
    v.set_HorizontalScale(0);
    v.set_LetterSpacing(0);
    v.set_WordSpacing(0);
    v.set_CBorColor(1, 13684944);
    v.set_CBorWidth(1, 0);
    v.set_CBorType(1, 1);
    v.set_CBorPadding(1, 32);
    v.set_CBorColor(2, 13684944);
    v.set_CBorWidth(2, 0);
    v.set_CBorType(2, 2);
    v.set_CBorPadding(2, 10);
    v.set_CBorColor(3, 13684944);
    v.set_CBorWidth(3, 4);
    v.set_CBorType(3, 1);
    v.set_CBorPadding(3, 10);
    v.set_CBorColor(4, 13684944);
    v.set_CBorWidth(4, 0);
    v.set_CBorType(4, 2);
    v.set_CBorPadding(4, 10);
    //
    v = new VisAttrObj();
    VisualStyleList.set_VisualAttribute(MyGlb.VIS_BOOTSTRAPZEN, v);
    v.iGuid = "59C38EA6-B610-4409-A6F8-9C59916F708A";
    v.set_Alignment(1, 1);
    v.set_Alignment(2, 3);
    v.set_Alignment(3, 1);
    v.set_ControlType(1);
    v.set_ClassName("");
    v.set_Mask("");
    v.set_Cursor("");
    v.set_RowOffset(0);
    v.set_HeaderOffset(0);
    v.set_Flags(786689);
    v.set_Color(1, 2105376);
    v.set_GradCol(1, -1);
    v.set_GradDir(1, 1);
    v.set_Opacity(1, 100);
    v.set_Color(2, 2105376);
    v.set_GradCol(2, -1);
    v.set_GradDir(2, 1);
    v.set_Opacity(2, 100);
    v.set_Color(3, 139296);
    v.set_GradCol(3, -1);
    v.set_GradDir(3, 1);
    v.set_Opacity(3, 100);
    v.set_Color(4, 16382457);
    v.set_GradCol(4, -1);
    v.set_GradDir(4, 1);
    v.set_Opacity(4, 100);
    v.set_Color(5, 16777215);
    v.set_GradCol(5, -1);
    v.set_GradDir(5, 1);
    v.set_Opacity(5, 100);
    v.set_Color(6, 15790320);
    v.set_GradCol(6, -1);
    v.set_GradDir(6, 1);
    v.set_Opacity(6, 100);
    v.set_Color(7, 6710886);
    v.set_GradCol(7, -1);
    v.set_GradDir(7, 1);
    v.set_Opacity(7, 100);
    v.set_Color(8, 14869218);
    v.set_GradCol(8, 14869218);
    v.set_GradDir(8, 3);
    v.set_Opacity(8, 100);
    v.set_Color(9, 13421772);
    v.set_GradCol(9, -1);
    v.set_GradDir(9, 1);
    v.set_Opacity(9, 100);
    v.set_Color(10, -1);
    v.set_GradCol(10, -1);
    v.set_GradDir(10, 1);
    v.set_Opacity(10, 100);
    v.set_Color(11, 13684944);
    v.set_GradCol(11, -1);
    v.set_GradDir(11, 1);
    v.set_Opacity(11, 100);
    v.set_Color(12, -1);
    v.set_GradCol(12, -1);
    v.set_GradDir(12, 1);
    v.set_Opacity(12, 100);
    v.set_Color(13, 2105376);
    v.set_GradCol(13, -1);
    v.set_GradDir(13, 1);
    v.set_Opacity(13, 100);
    v.set_Color(14, 14811106);
    v.set_GradCol(14, -1);
    v.set_GradDir(14, 1);
    v.set_Opacity(14, 100);
    v.set_Color(15, -1);
    v.set_GradCol(15, -1);
    v.set_GradDir(15, 1);
    v.set_Opacity(15, 100);
    v.set_Color(16, 15658477);
    v.set_GradCol(16, -1);
    v.set_GradDir(16, 1);
    v.set_Opacity(16, 100);
    v.set_Color(17, -1);
    v.set_GradCol(17, -1);
    v.set_GradDir(17, 1);
    v.set_Opacity(17, 100);
    v.set_Color(18, -1);
    v.set_GradCol(18, -1);
    v.set_GradDir(18, 1);
    v.set_Opacity(18, 100);
    v.set_Color(19, -1);
    v.set_GradCol(19, -1);
    v.set_GradDir(19, 1);
    v.set_Opacity(19, 100);
    v.set_Color(20, -1);
    v.set_GradCol(20, -1);
    v.set_GradDir(20, 1);
    v.set_Opacity(20, 100);
    v.set_Color(21, -1);
    v.set_GradCol(21, -1);
    v.set_GradDir(21, 1);
    v.set_Opacity(21, 100);
    v.set_Color(22, 16777215);
    v.set_GradCol(22, -1);
    v.set_GradDir(22, 1);
    v.set_Opacity(22, 100);
    v.set_Color(23, 16777215);
    v.set_GradCol(23, -1);
    v.set_GradDir(23, 1);
    v.set_Opacity(23, 100);
    v.set_BorderType(1, 4);
    v.set_BorderType(2, 1);
    v.set_BorderType(3, 4);
    v.set_BorderType(4, 1);
    v.set_BorderType(5, 2);
    v.set_BorderType(6, 4);
    v.set_Font(1, "Arial,,10");
    v.set_Font(2, "Arial,,10");
    v.set_Font(3, "Arial,B,9");
    v.set_Font(4, "Arial,,10");
    v.set_Font(5, "Arial,,10");
    v.set_Font(6, "Tahoma,,8");
    v.set_HorizontalScale(0);
    v.set_LetterSpacing(0);
    v.set_WordSpacing(0);
    v.set_CBorColor(1, 13684944);
    v.set_CBorWidth(1, 4);
    v.set_CBorType(1, 1);
    v.set_CBorPadding(1, 10);
    v.set_CBorColor(2, 13684944);
    v.set_CBorWidth(2, 4);
    v.set_CBorType(2, 2);
    v.set_CBorPadding(2, 10);
    v.set_CBorColor(3, 13684944);
    v.set_CBorWidth(3, 4);
    v.set_CBorType(3, 1);
    v.set_CBorPadding(3, 10);
    v.set_CBorColor(4, 13684944);
    v.set_CBorWidth(4, 4);
    v.set_CBorType(4, 2);
    v.set_CBorPadding(4, 10);
    HelpFile = "";
    //
    // Listing cached images
    //
    // Initializing WebServices URLs
    //
    SetHelpFile(HelpFile);
    ErrObj = new ErrorHandler(this);
    //
    // RD3
    RD3EntryPoint = "Cfaid.htm";
    //
    if (!ParamsObj().Theme.equals("seattle"))
      set_SideMenuWidth(163);
  }
  
  
  // **********************************************
  // La sessione è stata distrutta
  // **********************************************
  public void valueUnbound(HttpSessionBindingEvent event)
  {
    try
    {
      super.valueUnbound(event);
      //
      TerminateApp();
    }
    catch (Exception e) {}
    finally
    {
      try
      {
        EndRequest();
      }
      catch (Exception e1) {}
    }
    //
    // Deleting Temp Files & PDF Files
    ListIterator i = TempFiles.listIterator(0);
    while (i.hasNext())
    {
      try
      {
        String s=(String)i.next();
        File f= new File(s);
        f.delete();
      }
      catch (Exception e)
      {
      }
    }
    i = PDFPrints.listIterator(0);
    while (i.hasNext())
    {
      try
      {
        PDFPrint p =(PDFPrint)i.next();
        if (p.AutoDelete)
        {
          File f= new File(RealPath+"/"+p.PDFFile);
          f.delete();
        }
      }
      catch (Exception e)
      {
      }
    }
  }
  
  
  // **********************************************
  // Componenti
  // **********************************************
  public void ShiftFrmConst(int frmOfs) { MyGlb.ShiftFrmConst(frmOfs, this); }
  public int IMDBOffset() { return MyImdbInit.IMDB_OFFSET; }
  public void CreateComponents() 
  {
    // Creating components
    BlobindecompObject = (Blobindecomp.MyWebEntryPoint)GetApplication().GetCompFromNameSpace("Blobindecomp");
    if (BlobindecompObject == null || !BlobindecompObject.SharedInstance)
      BlobindecompObject = new Blobindecomp.MyWebEntryPoint(null);
    BlobindecompObject.CompNameSpace = "Blobindecomp";
    BlobindecompObject.AttachCompTo(this);
    //
    // Creation of Global Variables
  }

  // **********************************************
  // Crea i ruoli del componente
  // **********************************************
  public void CreateCompRoles()
  {
    // Se non l'ho ancora fatto, creo il ruolo
    if (RolObj == null)
    {
      IDConnection iDB = null;
      //
      RolObj = new MyRoles(this);
      //
      Cf4armDBObject.WebInit(this); iDB = null; if (CompOwner != null) iDB = CompOwner.GetDBByName("Cf4armDB"); else if (CompOwnerNT != null) iDB = CompOwnerNT.GetDBByName("Cf4armDB"); if (iDB != null) Cf4armDBObject.DB = iDB;
      RTCObj.AppGuid = "28CB08B1-6612-481F-984E-8CC5C1860039";
      RTCObj.PrjGuid = "50E96D74-FEBE-4C7B-A539-1136AFBC982E";
      //
      // Chiamo il metodo base
      super.CreateCompRoles();
      //
      // Ho allineato tutti i componenti... ri-sincronizzo tutte le IMDB delle
      // variabili globali (ora tutte le strutture IMDB sono state mergiate tra loro)
      //
      // Passo ai miei figli
      ListIterator pos = CompList.listIterator();
      while (pos.hasNext())
      {
        WebEntryPoint cmp = (WebEntryPoint)pos.next();
        cmp.CreateCompRoles();
      }
    }
  }

  // **********************************************
  // Crea un'istanza di una classe DO a partire dal nome
  // e lo inserisce nella collection
  // **********************************************
  public IDDocument CreateDocument(String ClassName)
  {
    IDDocument d = MyMDOInit.CreateDocument(ClassName, this);
    if (d == null)
    {
      // Io non ci sono riuscito... se ho dei componenti provo con loro
      ListIterator pos = CompList.listIterator();
      while (pos.hasNext())
      {
        WebEntryPoint cmp = (WebEntryPoint)pos.next();
        //
        // Se questo componente ci riesce, ho finito
        d = cmp.CreateDocument(ClassName);
        if (d != null)
          break;
      }
    }
    if (d!=null)
      d.SetMainFrm(this, IMDB);
    return d;
  }

  // **********************************************
  // Crea un'istanza di una classe DO a partire dal nome
  // e lo inserisce nella collection
  // **********************************************
  public boolean CreateDocument(IDCollection IDColl, String ClassName)
  {
    try
    {
      IDDocument d = MyMDOInit.CreateDocument(ClassName, this);
      if (d == null)
      {
        // Io non ci sono riuscito... se ho dei componenti provo con loro
        ListIterator pos = CompList.listIterator();
        while (pos.hasNext())
        {
          WebEntryPoint cmp = (WebEntryPoint)pos.next();
          //
          // Se questo componente ci riesce, ho finito
          if (cmp.CreateDocument(IDColl, ClassName))
            return true;
        }
        //
        // Nessun componente ne sa nulla... esco
        return false;
      }
      //
      d.SetMainFrm(MainFrm, IMDB);
      d.Init();
      d.set_Inserted(true);
      IDColl.Add(d);
      IDColl.MoveLast();
      d.OnInserting();
      if (d.Parent()!=null) d.Parent().ReconnectChildren(9999);
      //
      // OK
      return true;
    }
    catch (Exception e)
    {
      return false;
    }
  }

   // **********************************************
  // Crea un documento dall'assembly giusto
  // **********************************************
  public IDDocument GetFromDNA(IDVariant DNA, boolean FromCache, int NumLevel, boolean SkipLoad)
  {
    return IDDocument.GetFromDNA(DNA, FromCache, NumLevel, this, IMDB, SkipLoad);
  }

  // **********************************************
  // Gestisce una nuova richiesta
  // **********************************************
  public synchronized void HandleRequest(HttpServletRequest req,HttpServletResponse resp)
  {
    try
    {
      super.HandleRequest(req, resp);
      //
      String WebItem=null, WebEvent=null, UrlData=null; 
      //
      // Prelevo il path base
      if (RealPath.length()==0)
      {
        if (req != null)
          AppPath = req.getContextPath();
        else
          AppPath = "/Cfaid";
        AppName = AppPath + "/Cfaid.htm";
        RealPath= Parent().getRealPath(AppPath+"/images/splash.act.gif");
        //
        // Deploy da WAR
        if (RealPath == null)
          RealPath = "";
        else
          RealPath = RealPath.substring(0,RealPath.length()-(AppPath+"/images/splash.act.gif").length());
        iTempPath = RealPath + File.separator + "temp";
        //
        try
        {
          // Se non ci sono le cartelle "temp" e "logs" le creo
          File dirTemp = new File(TempPath());
          if (!dirTemp.exists())
            dirTemp.mkdir();
          //
          File dirLogs = new File(RealPath + File.separator + "logs");
          if (DTTObj.Level > 0 && !dirLogs.exists())
            dirLogs.mkdir();
        }
        catch (Exception e) { }
        //
        RTCObj.LoadRTCConst();
        //
        // Ora che RTC è inizializzato, inizializzo anche l'error handler
        ErrObj.Init();
        //
        // Ora che RTC è inizializzato e conosco il path, inizializzo anche il voice handler
        VoiceObj.Init();
      }
      Request = req;
      Response = resp;
      //
      DTTObj.AddRequest(this);
      //
      if (Request!=null)
      {
        // Estraggo i parametri dall'URL
        ExtractUrlParams(Request);
        boolean flCmd = true;
        if (ActiveForm()!=null && ActiveForm().UploadingPanel!=null)
          flCmd = false;
        if (UrlParams.size() == 0 && flCmd)
          ExtractUrlParams2(Request.getParameter("cmd")); // Provo con CMD (form-rd)
        if (UrlParams.size() == 0 && flCmd)
          ExtractUrlParams2(Request.getParameter("ss")); // Provo con CMD proveniente da RD
      }
      else if (IsServerSession())
        ExtractUrlParams2(SessionQueryString);
      //
      if (RolObj==null)
      {
        RolObj = new MyRoles(this);
        //
        Cf4armDBObject.WebInit(this);
        RTCObj.AppGuid = "28CB08B1-6612-481F-984E-8CC5C1860039";
        RTCObj.PrjGuid = "50E96D74-FEBE-4C7B-A539-1136AFBC982E";
      }
      //
      // Aggiorno i componenti
      BeginCompRequest();
      //
      // Inizio richiesta (analisi UserAgent)
      BeginRequest();
      //
      // Verifico se non è una richiesta a WebAPI
      WebApiObject.IsWebApiRequest = (WebApiObject.CheckUri().length() != 0);
      //
      // Solo se non è un item di test... il test chiama l'IWApp al momento di partire e
      // la init verrà fatta in quel momento
      if ((req!=null && (req.getParameter("WCI")==null || !req.getParameter("WCI").equals(MyGlb.ITEM_TEST))) || IsServerSession())
        RolObj.InitRoles(); // Scatena la InitApp!
      //
      if (Request != null && MyParamsObj().ResponseBufferSize>8)
        Response.setBufferSize(MyParamsObj().ResponseBufferSize*1024);
      //
      if (Request != null)
      {
        WebItem = req.getParameter("WCI");
        WebEvent= req.getParameter("WCE");
        UrlData = req.getParameter("WCU");
      }
      if (WebItem == null) WebItem = "";
      if (WebEvent == null) WebEvent = "";
      if (UrlData == null) UrlData = "";
      //
      SetUrlData(UrlData);
      //
      if (Request != null)
      {
        if (!WebItem.equals(MyGlb.ITEM_BLOB) && !WebItem.equals(MyGlb.ITEM_STREAM))
        {
          OpenResponse(false);
          //
          // Uso UTF8 solo se sono in RD3 (in RD2 devo usare Latin1 per il frame RD)
          boolean useUTF8 = false;
          if (ParamsObj().UseRD3)
            useUTF8 = true;
          //
          // Anche per la sincronizzazione rispondo sempre in UTF-8
          if (WebItem.equals(MyGlb.ITEM_SYNC))
          {
            useUTF8 = true;
            Response.setCharacterEncoding("UTF-8");
          }
          //
          if (useUTF8)
          {
            OutputStreamWriter osw = new OutputStreamWriter(OutStr, "UTF-8");
            Out=new PrintWriter(osw);
          }
          else
          {
            Out=new PrintWriter(OutStr);
          }
          Response.setContentType("text/html");
        }
        else
          OpenResponse(true); // No compressione per i blob
      }
      //
      // Ri-aggiorno i componenti... potrebbe essere cambiato qualcosa (es: nati ruoli, creato stream Out)...
      BeginCompRequest();
      //
      // Se c'è il comando URL, chiamo l'evento
      //
      IDVariant cmd = GetUrlParam();
      if (cmd.stringValue().length()>0)
      {
        DTTObj.SetRequestName("Command " + cmd.toString(), "Query String Command Detected", DTTRequest.PRI_DATA);
        //
        boolean ro = RolObj.CheckRole();
        boolean cr = false;
        if (ro)
          cr = CmdObj.ExecCmdCode(cmd.stringValue()); // Solo se utente già loggato!
        if (!ro || !cr)
        {
          // Lancio evento, non era gestita da un comando
          DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 152, "MainFrm.BeginRequest", "Fire OnCommand(" + cmd.toString() + ") event");
          OnCommand(cmd);
          if (!ro && RolObj.CheckRole())
          {
            MainFrm.DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 114, "OnCommand", "Bypass login (Session Role set while handling a command)");
            // No login will occur, need to activate app manually
            //
            FireAfterLogin();
          }          
          //
          // Se è il CMD che indica il ritorno online di una app OWA
          if (RolObj.CheckRole() && cmd.stringValue().equals("OWABackOnline"))
          {
            WebItem = Glb.ITEM_RD3;
            WebEvent = "OWABackOnline";
          }
        }
        //
        if (cmd.stringValue().equals("?IDVER"))
          DumpVersions(true);
        if (cmd.stringValue().equals("?DEBUG"))
          OpenDebugWindow();
        if (cmd.stringValue().equals("?DTTOK"))
        {
          DTTObj.DTTStarted = true;
          set_AlertMessage(new IDVariant("DTT Started"));
        }
        if (cmd.stringValue().equals("?DTTKO"))
        {
          DTTObj.DTTStarted = false;
          set_AlertMessage(new IDVariant("DTT Stopped"));
        }
        //
        // a CMD is arrived, disable Session Number checking
        IntSesNumber = 0;
      }
      //
      // Dopo NPQ 940 (migliorato LOGIN1.HTM passando WCI, WCE e WCU in POST) c'è un problema
      // se premo F5... se mi arriva IWLOGIN ed ho già un ruolo attivo, annullo l'item
      if (WebItem.equals(MyGlb.ITEM_LOGIN) && RolObj.CheckRole())
      {
        WebItem = "";
        WebEvent = "";
        UrlData = "";
        //
        // Se c'è l'RD3 meglio resettare anche il motore RD3
        if (ParamsObj().UseRD3)
          RD3Reset();
      }
      //
      if (!IsServerSession())
      {
        // Selezione del WEBITEM tramite stringa
        //
        try
        {
          if (WebItem.equals(MyGlb.ITEM_APP))
            IWApp_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_LOGIN))
            IWLogin_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_LOGOFF))
            IWLogoff_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_MENU))
            IWMenu_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_SBIND))
            IWSbInd_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_FORM))
            IWForm_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_FORMLIST))
            IWFormList_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_BLOB))
            IWBlob_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_UPLOAD))
            IWUpload_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_FILES))
            IWFiles_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_TREE_EXP))
            IWTreeExp_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_TREE_CLICK))
            IWTreeClick_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_TREE_DROP))
            IWTreeDrop_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_GRAPH_CLICK))
            IWGraphClick_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_DTT))
            IWDTT_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_TEST))
            IWTest_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_HELP))
            IWHelp_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_FRAMES))
            IWFrames_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_RD))
            IWRD_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_W3C))
            IW3C_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_RD3))
            IWRD3_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_SYNC))
            IWSync_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_STREAM))
            IWStream_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_OWA))
            IWOwa_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_OAUTH))
            IWOAuth_UserEvent(WebEvent);
          else if (WebItem.equals(MyGlb.ITEM_QUERY))
            IWQuery_UserEvent(WebEvent);
          else if (!WebApiObject.HandleRequest())
          {
            if (UseRD)
            {
              if (!DTTObj.TestEnabled  && !iParamsObj.UseRD3)
                IWFrames_UserEvent(WebEvent);
              else
                IWApp_UserEvent(WebEvent);
            }
            else
              IWApp_UserEvent(WebEvent);
          }
        }
        catch(Exception ex)
        {
          MainFrm.DTTObj.AddException("", "MainFrm", "Exception while handling event WCI="+WebItem+" WCE="+WebEvent+" URL="+UrlData, ex);
          MainFrm.ErrObj.ProcError("MainFrm", "WCI="+WebItem+" WCE="+WebEvent+" URL="+UrlData, ex);
          RenderPage();
        }
      }
    }
    catch(Exception e)
    {
      FatalErrorResponse(e);
    }
    finally
    {
      try
      {
        EndRequest();
      }
      catch (Exception e1)
      {
        e1.printStackTrace(System.err);
      }
      //
      try
      {
        if (Out!=null)
        {
          Out.close();
        }
        if (OutStr!=null)
        {
          OutStr.flush();
          OutStr.close();
        }
      }
      catch (Exception e)
      {
        e.printStackTrace(System.err);
      }
      //
      Request = null;
      Response = null;
      OutStr = null;
      Out = null;
      //
      // Componenti
      EndCompRequest();
    }
  }  

  public void FireAfterLogin()
  {
    RolObj.ApplyRoles(0, null);
    DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 20, "MainFrm", "Fire AfterLogin event");
    AfterLogin();
    TimerObj.ActivateTimers (0, true);
  }

  // **********************************************
  // Check for user login
  // **********************************************
  public void IWLogin_UserEvent(String EventName)
  {
    // Siccome posso arrivare qui dall'RD3 se l'utente preme F5, devo
    // mostrare nuovamente il desktop
    RD3Reset();
    //
    // Check for user data...
    IDVariant Valid, sUser, sPass;
    //
    String uName = Request.getParameter("UserName");
    if (uName != null && UTF8Encode)
    {
      try { uName = new String(uName.getBytes("8859_1"), "UTF-8"); } catch (Exception e) { e.printStackTrace(System.err); }
    }
    String pwd = Request.getParameter("PassWord");
    if (pwd != null && UTF8Encode)
    {
      try { pwd = new String(pwd.getBytes("8859_1"), "UTF-8"); } catch (Exception e) { e.printStackTrace(System.err); }
    }
    //
    sUser = new IDVariant(uName);
    sPass = new IDVariant(pwd);
    Valid = new IDVariant(true);
    RolObj.glbUser = new IDVariant(sUser);
    //
    DTTObj.SetRequestName("Login", "Login procedure", DTTRequest.PRI_ITEM);
    DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 150, "MainFrm.Login", "Fire OnLogin event");
    DTTObj.AddTestItem("USERNAME", DTTEngine.TST_APPLOGUP, sUser.stringValue(), "");
    if (sUser.stringValue().length() == 0)
      DTTObj.AddHelpItem(0, 0, 0, 0, "Lascia vuoto il campo UserName");
    else
      DTTObj.AddHelpItem(0, 0, 0, 0, "Scrivi " + sUser.stringValue() + " nel campo UserName");
    DTTObj.AddTestItem("PASSWORD", DTTEngine.TST_APPLOGUP, sPass.stringValue(), "");
    if (sPass.stringValue().length() == 0)
      DTTObj.AddHelpItem(0, 0, 0, 0, "Lascia vuoto il campo Password");
    else
      DTTObj.AddHelpItem(0, 0, 0, 0, "Scrivi " + sPass.stringValue() + " nel campo Password");
    DTTObj.AddTestItem("LOGIN", DTTEngine.TST_APPLOGIN, "", "");
    DTTObj.AddHelpItem(0, 0, 0, 0, "Clicca sul bottone LOGIN");
    MainFrm.Login(sUser, sPass, Valid);
    //
    if (RolObj.CheckRole())
      FireAfterLogin();
    else
      DTTObj.AddMsg(DTTEngine.DTTMSG_WARN, "", 8, "MainFrm.Login", "Login failed (User Role not set)");
    //
    RenderPage();
  }


  // **********************************************
  // Premuto pulsante logoff
  // **********************************************
  public void IWLogoff_UserEvent(String EventName)
  {
    String s="";
    //
    DTTObj.SetRequestName("Logoff", "Logoff button pressed", DTTRequest.PRI_CMD);
    DTTObj.AddTestItem("", DTTEngine.TST_LOGOFF, "Logoff", "");
    DTTObj.AddHelpItem(0, 0, 0, 0, "Clicca sul bottone LOGOFF");
    //
    // Lancio Evento
    IDVariant skip = new IDVariant();
    IDVariant cancel = new IDVariant();
    DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 197, "MainFrm.OnLogoff", "Logoff button pressed: firing OnLogoff Event");      
    OnLogoff(skip, cancel);
    if (cancel.isTrue())
    {
      DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 197, "MainFrm.OnLogoff", "Logoff was canceled by OnLogoff Event");      
      if (RDStatus == MyGlb.RD_ACTIVE)
        RenderDifferences();
      return;
    }
    if (skip.isFalse())
    {
      // Tento di chiudere tutte le form
      LinkedList c = new LinkedList(StackForm);
      ListIterator i = c.listIterator();
      //    
      while (i.hasNext())
      {
        WebForm f = (WebForm) i.next();
        UnloadForm(f.FormIdx, false);
      }
      //
      if (DockedForm()!=null)
        UnloadForm(DockedForm().FormIdx, false);
      //
      if (StackForm.size()>0)
        cancel = IDVariant.TRUE;
    }
    if (cancel.isTrue())
    {
      DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 197, "MainFrm.Logoff", "Logoff was canceled because not all forms can be closed");
      if (RDStatus == MyGlb.RD_ACTIVE)
        RenderDifferences();
      return;
    }
    //            
    if (DTTObj.TestRunning || DTTObj.RecordRunning)
    {
      Out.print("<html>");
      Out.print("<head>");
      Out.print("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1252\">");
      Out.print("<script language=\"javascript\" type=\"text/javascript\">");
      if (DTTObj.RecordRunning)
        Out.print("top.window.close();");
      else
        Out.print("window.parent.frames('Control').NextStep();");
      Out.print("</script>");
      Out.print("</head>");
      Out.print("</html>");
      //
      // Mettiamo sempre e solo un messaggio (se no ci saranno delle differenze!)
      //if (DTTObj.RecordRunning)
      //  DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 23, "MainFrm.Logoff", "Record termination");
      //else
      DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 23, "MainFrm.Logoff", "Test termination");
    }
    else
    {
      if (LogoffURL.length() > 0 && !LogoffURL.equals("???"))
        s = LogoffURL;
      else
      {
        if (UseRD)
        {
          if (ParamsObj().UseRD3)
            s = AppName;
          else if (DTTObj.TestEnabled)
            s = UrlFor(MyGlb.ITEM_APP,"");
          else
            s = UrlFor(MyGlb.ITEM_FRAMES,"");
        }
        else
          s = UrlFor(MyGlb.ITEM_APP,"");
      }
      //
      DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 23, "MainFrm.Logoff", "Redirect to " + s);
      if (RDStatus == MyGlb.RD_ACTIVE)
      {
        RDExitURL = s;
        RenderDifferences();
      }
      else
      {
        try 
        {
          if (ParamsObj().UseRD3)
            RD3AddEvent("redirect",s);
          else
            Response.sendRedirect(s); 
        } 
        catch (Exception e) 
        { 
          e.printStackTrace(System.err); 
        }
      }
    }
    //
    Request.getSession().invalidate();
  }


  // **********************************************
  // Fatal Error (a component or framework error)
  // **********************************************
  public void FatalErrorResponse(Exception e)
  {
    super.FatalErrorResponse(e);
    //
    try
    {
      if (Out != null)
        e.printStackTrace(Out);
      //
      e.printStackTrace(System.err);
    }
    catch (Exception e1)
    {
    }
  }


  // **********************************************
  // Before end, close database connections
  // **********************************************
  public void EndRequest()  throws SQLException
  {
    CloseAllDBConnections();
    //
    super.EndRequest();
  }


  // **********************************************
  // Close database connections
  // **********************************************
  public void CloseAllDBConnections() throws SQLException
  {
    //
    Cf4armDBObject.CloseConnection();
    //
  }


  // **********************************************
  // Opens the right output stream
  // **********************************************
  public void OpenResponse(boolean flNoCompr)
  {
    try
    {
      if (!flNoCompr && MyParamsObj().CompressResponse.equals("YES"))
      {
        String encodings = Request.getHeader("Accept-Encoding");
        if (encodings!=null && encodings.indexOf("gzip")!=-1)
        {
          // GZIP
          if (encodings.indexOf("x-gzip")!=-1)
            Response.setHeader("Content-Encoding","x-gzip");
          else
            Response.setHeader("Content-Encoding","gzip");
          OutStr=new GZIPOutputStream(Response.getOutputStream());
        }
        else
        {
          if (encodings!=null && encodings.indexOf("compress")!=-1)
          {
            // ZIP
            if (encodings.indexOf("x-compress")!=-1)
              Response.setHeader("Content-Encoding","x-compress");
            else
              Response.setHeader("Content-Encoding","compress");
            ZipOutputStream z = new ZipOutputStream(Response.getOutputStream());
            z.putNextEntry(new ZipEntry("dummy name"));
            OutStr=z;
          }
          else
          {
            // No compression
            OutStr = Response.getOutputStream();
          }
        }
        Response.setHeader("Vary","Accept-Encoding");
      }
      else
      {
        // Compression is disabled
        OutStr = Response.getOutputStream();
      }
    }
    catch(Exception e)
    {
      
    }
  }


  // **********************************************
  // Render current page
  // **********************************************
  public void RenderPage()
  {
    // Se è attivo l'RD4, vado di ShowDestop... non ho altro da aggiungere
    if (ParamsObj().UseRD4)
    {
      ShowDesktop();
      return;
    }
    //
    // In RD3 avviato, RD2 avviato o RD0 se non è già stato programmato un messaggio all'utente vedo se è previsto un riavvio dell'applicazione
    if (((UseRD && iParamsObj.UseRD3 && DesktopRendered) || (UseRD && !iParamsObj.UseRD3 && RDStatus == Glb.RD_ACTIVE) || !UseRD) && AlertMessage().stringValue().length() == 0)
      CheckRestartWarning();
    //
    // Se il debug è attivo (non TRACE), vedo se occorre mostrare errori all'utente
    if (DTTObj.Level > 0 && !DTTObj.TraceEnabled && !ErrObj.IsError())
      DTTObj.ShowReqErrors();
    //
    // Popup menu
    int PopupMenu_CmdSetIdx = 0;
    int PopupMenu_FormIdx = 0;
    //
    if (DisableRender)
    {
      DisableRender=false;
      return;
    }
    //
    boolean onlyform = WidgetMode;
    //
    String s=Request.getParameter("WCU");
    int p = (s==null)?-1:s.indexOf("TT");
    if (p > -1)
    {
      p=p+2;
      int f=p;
      while(f<s.length() && Character.isDigit(s.charAt(f)))
        f++;
      try
      {
        TreeScrollTop = Integer.parseInt(s.substring(p,f));
      }
      catch(Exception e)
      {
        TreeScrollTop = 0;
      }
    }
    //
    set_ClickCounter(ClickCounter() + 1);
    RefreshNextClick = false;
    //
    SetUrlData("");
    //
    // True Popup
    if (RDStatus!=Glb.RD_DISABLED && ParamsObj().TruePopup)
    {
      if (IEVer>=600 && ActiveForm()!=null)
        onlyform = (ActiveForm().OpenAs != Glb.OPEN_MDI) || WidgetMode;
    }
    //
    // Need to redirect?
    //
    String pWCI=Request.getParameter("WCI");
    if ((!iParamsObj.UseRD3 || (pWCI!=null && pWCI.equals("IWBlob"))) && RDStatus!=MyGlb.RD_ACTIVE && RedirectTo().stringValue().length()>0 && !RedirectNewWindow() && !DTTObj.TestRunning)
    {
      DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 6, "MainFrm.RenderPage", "Redirecting to " + RedirectTo().toString());
      //
      // Se sono in RD3 (e la richiesta è di tipo IWBlob: vedi sopra)
      // e se devo gestire i file in streaming ...
      if (iParamsObj.UseRD3 && DeleteAfterDownload)
      {
        // Questo è l'unico caso in RD3 nel quale serve inviare dell'HTML
        // in quanto il download di un blob apre già una nuova finestra e non si aspetta dell'XML
        // Codice replicato dall'RD3RenderDifferences
        try
        {
          // Se il file è locale all'applicazione
          File f = new File(Glb.ToAbsolutePath(this, RedirectTo().stringValue()));
          if (f.exists())
          {
            set_RedirectTo(new IDVariant(UrlFor(Glb.ITEM_STREAM)));
            FileToSend = f.getAbsolutePath();
          }
        }
        catch (Exception e)
        {
        }
      }
      //
      WriteStr("<html>\n");
      WriteStr("<head>\n");
      WriteStr("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1252\">\n");
      WriteStr("<title>\n");
      WriteStr("" + GetPageTitle() + "\n");
      WriteStr("</title>\n");
      WriteStr("<link rel=stylesheet type=\"text/css\" href=\"iw.css\">\n");
      WriteStr("</head>\n");
      WriteStr("<frameset>\n");
      WriteStr("<frame src=\"" + RedirectTo() + "\">\n");
      WriteStr("</frameset>\n");
      WriteStr("</html>\n");
      //
      // Se c'è RD3, lo spedisce e svuota lui... a meno che non sia uno scaricamento di BLOB
      // In questo caso occorre svuotarlo comunque!
      if (!iParamsObj.UseRD3 || (pWCI!=null && pWCI.equals("IWBlob")))
        set_RedirectTo(new IDVariant());
        //
      //RefreshNextClick = True;
      return;
    }
    //
    // Updating IMDB
    //
    TimerObj.Tick(this);
    UpdateIMDBState();
    //
    if (!RolObj.CheckRole())
    {
      // Show login screen
      //
      ShowLogin();
      return;
    }
    //
    ResIdx = 0;
    //
    // Gestione del Trace
    DTTTrace();
    //
    // Gestione rendering differenziale
    if (UseRD)
    {
      if (RDStatus == MyGlb.RD_ACTIVE)
      {
        RenderDifferences(onlyform);
        return;
      }
      //
      if (iParamsObj.UseRD3 && !PreDesktopRendered)
      {
        PreDesktopRendered = true;
        //
        WriteStr("<html><head>");
        WriteStr("<script>window.location.href = window.location.href;</script>");
        WriteStr("</head></html>");
        return;
      }
      //
      if(iParamsObj.UseRD3 && DesktopRendered)
      {
        RenderDifferences3();
        return;
      }
      //
      if(iParamsObj.UseRD3 && !DesktopRendered)
      {
        ShowDesktop();
        DesktopRendered = true;
        return;
      }
    }
    //
    if (ParamsObj().HtmlConstraints==MyGlb.WEBVALID_STRICT)
      WriteStr("<!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01//EN\" \"http://www.w3.org/TR/html4/strict.dtd\">");
    WriteStr("<html>");
    WriteStr("<head>");
    WriteStr("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">");
    WriteStr("<meta http-equiv=\"X-UA-Compatible\" content=\"IE=EmulateIE7\">");
    if (ParamsObj().IWCacheControl.equals("CACHE") || UseRD)
    {
      WriteStr("<meta http-equiv=\"Pragma\" content=\"no-cache\">");
      WriteStr("<meta http-equiv=\"Expires\" content=\"-1\">");    
    }
    if (!UseRD)
    {
      if (RefreshInterval().intValue() > -1)
        WriteStr("<meta http-equiv=\"refresh\" content=\"" + RefreshInterval().intValue() + ";url=" + UrlFor(MyGlb.ITEM_APP, "") + "\">");
    }
    WriteStr("<title>");
    WriteStr(GetPageTitle());
    WriteStr("</title>");
    WriteStr("<link rel=stylesheet type=\"text/css\" href=\"iw.css\">");
    if (DTTObj.HelpGenerationActive)
      WriteStr("<link rel=stylesheet type=\"text/css\" href=\"dtt.css\">");
    WriteStr("<link rel=stylesheet type=\"text/css\" href=\"custom.css\">");
    //
    // client mask?
    if (ParamsObj().UseClientMask)
      WriteStr("<script type=\"text/javascript\" src=\"maskedinp.js\"></script>");
    WriteStr("<script type=\"text/javascript\" src=\"ijlib.js\"></script>");
    WriteStr("<script type=\"text/javascript\" src=\"dragdrop.js\"></script>");
    WriteStr("<script type=\"text/javascript\" src=\"custom.js\"></script>");
    //
    // Form JScript events
    //
    WriteStr("<script type=\"text/javascript\">");
    WriteStr("function InitBody() { ");
    if (!ParamsObj().UseFK)
      WriteStr("UseFK=false;");
    else
    {
      WriteStr("HLColorED=\"" + Glb.GetWebColor(VisualStyleList.Color(1, Glb.VISCLR_EDITING)) + "\";");
      if (VisualStyleList.GradCol(1, Glb.VISCLR_EDITING) != -1)
        WriteStr("HLColorEDFlt=\"" + Glb.GetWebGradient(VisualStyleList.Color(1, Glb.VISCLR_EDITING), VisualStyleList.GradCol(1, Glb.VISCLR_EDITING), VisualStyleList.GradDir(1, Glb.VISCLR_EDITING)) + "\";");
      else
        WriteStr("HLColorEDFlt=\"" + Glb.GetWebOpacity(VisualStyleList.Opacity(1, Glb.VISCLR_EDITING)) + "\";");
    }
    if (!ParamsObj().UseDoubleClick)
      WriteStr("UseDBLCLK=false;");
    if (ParamsObj().HtmlConstraints==MyGlb.WEBVALID_STRICT)
      WriteStr("StrictHTML=true;");
    if (ParamsObj().UseClientMask)
    {
      WriteStr("glbDecSep='" + (ParamsObj().UseDecimalDot ? '.' : ',') + "';");
      WriteStr("glbThoSep='" + (ParamsObj().UseDecimalDot ? ',' : '.') + "';");
    }
    WriteStr("ResizeTables(); ");
    WriteStr(" ChangeRowDelay=" + (ParamsObj().UseFK?ParamsObj().ChangeRowDelay:0) + ";");
    if (ActiveForm()!=null)
    {
      WriteStr("try {");
      if (ActiveForm().ScrollTop >= 0)
        WriteStr(" document.body.scrollTop = " + ActiveForm().ScrollTop + "; ");
      if (ActiveForm().ActiveElement.length()>0)      
        WriteStr(" if (document.all(\"" + ActiveForm().ActiveElement + "\")!=null) document.all(\"" + ActiveForm().ActiveElement + "\").focus(); ");
      WriteStr("} catch (e) {}");
    }
    if (TreeScrollTop > 0)
    {
      WriteStr("try {");
      WriteStr("document.getElementById(\"TREE\").scrollTop = " + TreeScrollTop + ";");
      WriteStr("} catch (e) {}");
    }
    if (RedirectNewWindow() && !DTTObj.TestRunning)
    {
      set_RedirectTo(IDL.Replace(RedirectTo(), new IDVariant("\\"), new IDVariant("/")));
      if (RedirectFeatures().stringValue().toLowerCase().indexOf("modal")>-1)
        WriteStr("window.showModalDialog(" + MyGlb.JSEncode2(RedirectTo()));
      else
        WriteStr("window.open(" + MyGlb.JSEncode2(RedirectTo()));
      if (RedirectFeatures().stringValue().length()>0)
        WriteStr(", null, " + MyGlb.JSEncode(RedirectFeatures()));
      WriteStr("); ");
    }
    if (AlertMessage()!=null && AlertMessage().stringValue().length()>0 && !DTTObj.TestRunning && !DTTObj.HelpGenerationActive)
      WriteStr("alert(" + MyGlb.JSEncode2(AlertMessage()) + "); ");
    //
    // Stampo senza RD?
    RenderPDFPrints();
    //
    WriteStr(" } </script>");
    //
    WriteStr("</head>");
    WriteStr("<body");
    if (WidgetMode)
      WriteStr(" style=\"overflow:hidden\"");
    else if (ParamsObj().HtmlConstraints!=MyGlb.WEBVALID_NONE)
      WriteStr(" style=\"overflow:visible\"");
    //
    String js = "InitBody();";
    //
    // Se il test è in esecuzione chiamo il prossimo step
    if (DTTObj.TestRunning || DTTObj.HelpGenerationActive)
      js = js + "try{window.parent.frames('Control').NextStep();}catch(e){}";
    //
    if (UseRD)
    {
      if (RDStatus != MyGlb.RD_DISABLED)
      {
        js = js + " ChangeTarget();";
        // Solo ora carico l'altro frame che farà poi il change target
        js = js + " GetFrame(window.parent.frames,'RD').location.href='" + UrlFor(MyGlb.ITEM_RD, "") + "';";
      }
      if (UseRD && ParamsObj().TruePopup)
      {
        if (IEVer>=600 && ActiveForm()!=null)
        {
          WebForm af = ActiveForm();
          if (af.OpenAs != Glb.OPEN_MDI)
            js = js + " rp(" + af.FormLeft + ", " + af.FormTop + ", " + af.FormWidth + ", " + af.FormHeight + ");";
        }
      }
    }
    // Se è stato richiesto il menu contestuale, lo mostro
    if (!MenuIdx.equals("") && RDStatus!=Glb.RD_ACTIVE)
    {
      // Recupero la direzione corrente
      int Dir = 0;
      if (MenuIdx.indexOf("|") != -1)
      {
        Dir = Integer.parseInt(MenuIdx.substring(MenuIdx.indexOf("|") + 1));
        MenuIdx = MenuIdx.substring(0, MenuIdx.indexOf("|"));
      }
      else
        Dir = 1; // Default: Bottom
      //
      // Recupero il CmdSet ed il FormIdx
      String ObjIDs;
      int FormIdx;
      PopupMenu_CmdSetIdx = Integer.parseInt(MenuIdx.substring(0, MenuIdx.indexOf(":")));
      MenuIdx = MenuIdx.substring(MenuIdx.indexOf(":") + 1);
      ObjIDs = MenuIdx.substring(0, MenuIdx.indexOf(":"));
      MenuIdx = MenuIdx.substring(MenuIdx.indexOf(":") + 1);
      PopupMenu_FormIdx = Integer.parseInt(MenuIdx);
      if (PopupMenu_FormIdx == -1)
      {
        if (ActiveForm() != null)
          PopupMenu_FormIdx = ActiveForm().FormIdx;
        else
          PopupMenu_FormIdx = 0;
      }
      //
      // Scrivo il comando che posizionerà il popup menu
      js = js + "popupshow_NoRD('" + ObjIDs + "|" + Dir + "');";
    }
    //
    // FK per custom commands...
    // NPQ 428: tasti FK anche con RD non attivo
    String FK = WebFrame.GetCCFK();
    if (FK.length()>0)
      js += "if (!StdFKInit) " + FK;
    //
    //
    if (!js.equals(""))
      WriteStr(" onload=\"" + js + "\"");
    //
    set_RedirectNewWindow(false);
    set_RedirectTo(new IDVariant());
    set_RedirectFeatures(new IDVariant());
    set_AlertMessage(new IDVariant(""));
    WriteStr(">");
    //
    if (onlyform)
    {
      WriteStr("<table id=ExtTable cellspacing=\"0\" cellpadding=\"0\">"); // Primary Frame Definition
      WriteStr("<tr><td id=ActiveForm valign=\"top\">"); // Page Definition
      RenderActiveForm(true);
      WriteStr("</td></tr></table>");
    }
    else
    {
      WriteStr("<div id=hdr>");
      RenderHeader();
      WriteStr("</div><table id=ExtTable cellspacing=0 cellpadding=0>"); // Primary Frame Definition
      WriteStr("<tr>");
      //
      // Menu Bar
      WriteStr("<td id=MenuTable style=\"width:1px;vertical-align:top\">"); // Menu Frame Definition
      RenderMenuBar();
      //
      WriteStr("</td><td id=RightTables><table id=RightTable cellspacing=\"0\" cellpadding=\"0\"><tr><td id=StatusBarTable>");
      RenderStatusBar();
      WriteStr("</td></tr><tr><td id=ToolBarTable>");
      //
      if (CmdObj.IsToolbarPresent())
      {
        WriteStr("<table id=ToolBar><tr>"); // Tool Bar Definition
        //
        //
        CmdObj.RenderToolbar();
        //
        //
        WriteStr("</tr></table>");
      }
      WriteStr("</td></tr><tr>");
      //
      IntSesNumber = (int)(Math.random() * 2147483647); // New internal session number
      //
      WriteStr("<td id=PageTable>"); // Page Definition
      RenderPageTable();
      WriteStr("</td></tr>");
      //
      // Closing primary table
      WriteStr("</table></td></tr></table>");
    }
    //
    if ((ShowCalendar || RDStatus==Glb.RD_FRAMES) && (ParamsObj().HtmlConstraints!=MyGlb.WEBVALID_STRICT || (UseRD && RDStatus!=Glb.RD_DISABLED)))
    {
      // Creating popup calendar
      WriteStr("<script type=\"text/javascript\" src=\"calpopup.js\"></script>");
      WriteStr("<script event=onclick() for=document>");
      WriteStr("document.all.calpopup.style.display=\"none\";</script>");
      WriteStr("<iframe id=calpopup style=\"display:none;z-index:100;width:157px;height:162px;position:absolute\"");
      WriteStr("marginwidth=0 marginheight=0 src=\"calpopup.htm\" frameborder=0 noresize scrolling=no></iframe>");
      ShowCalendar = false;
    }
    //
    if (RDStatus == Glb.RD_FRAMES && UseRD)
      WriteStr("<iframe id=delaydlg style=\"display:none;z-index:100;position:absolute;filter:progid:DXImageTransform.Microsoft.Shadow(color=gray,direction=135,strength=3)\" marginwidth=5 marginheight=5 src=\"delaydlg.htm\" frameborder=0 noresize scrolling=no progrbar='" + ProgrBarFileName() + "'></iframe>");
    //    
    // Se è attivo l'Help generation aggiungo 2 iframes per le label di help
    if (DTTObj.HelpGeneration)
    {
      WriteStr("<div id=\"reqdiv\" class=HelpReqDiv style=\"display:none\"></div>");
      WriteStr("<div id=\"reqVdiv\" class=HelpReqDiv style=\"display:none\"></div>");
      WriteStr("<div id=\"itemdiv\" class=HelpItemDiv style=\"display:none\"></div>");
      WriteStr("<img id=\"helpcurs\" class=HelpCurs src=\"dttimg/helpcurs.gif\" style=\"display:none\">");
    }
    //
    // Se c'era da mostrare un menu popup, lo faccio
    if (!MenuIdx.equals("") && RDStatus!=Glb.RD_ACTIVE)
    {
      CmdObj.RenderPopupMenu(PopupMenu_CmdSetIdx, PopupMenu_FormIdx);
      MenuIdx = "";
    }
    //
    // Inserisco l'oggetto per la stampa PDF
    WriteStr("<div id=\"dpdf\"></div>");
    RenderTrayletCommand(); // Renderizza l'IFRAME per chiamare la traylet!    
    //
    WriteStr("</body>");
    //
    if ((ParamsObj().IWCacheControl.equals("CACHE") || UseRD) && ParamsObj().HtmlConstraints!=MyGlb.WEBVALID_STRICT)
    {
      WriteStr("<head>");
      WriteStr("<meta http-equiv=\"Pragma\" content=\"no-cache\">");
      WriteStr("<meta http-equiv=\"Expires\" content=\"-1\">");    
      WriteStr("</head>");    
    }
    WriteStr("</html>");
    SetUrlData(""); // Disabilito URL per evitare problemi al debugger
    //
    if (UseRD)
    {
      if (RDStatus != MyGlb.RD_DISABLED)
        ResetRD();
    }
  }


  // **********************************************
  // Esegue render docked e active form
  // **********************************************
  public void RenderPageTable()
  {
    //
    WriteStr("\n");
    WriteStr("\n");
    //
    WriteStr("<table class=wh100 cellspacing=\"0\" cellpadding=\"0\"><tr>");
    LastDockType = (DockedForm() != null) ? DockedForm().DockType : 0;
    if (LastDockType == 0 || LastDockType == Glb.FORMDOCK_LEFT || LastDockType == Glb.FORMDOCK_TOP)
    {
      WriteStr("<td id=dockform style=\"height:10px\">");
      RenderDockedForm();
    }
    else
    {
      WriteStr("<td id=ActiveForm>");
      RenderActiveForm();
    }
    //
    WriteStr("</td>");
    if (LastDockType == Glb.FORMDOCK_TOP || LastDockType == Glb.FORMDOCK_BOTTOM)
      WriteStr("</tr><tr>");
    //
    if (LastDockType == 0 || LastDockType == Glb.FORMDOCK_LEFT || LastDockType == Glb.FORMDOCK_TOP)
    {
      WriteStr("<td id=ActiveForm>");
      RenderActiveForm();
    }
    else
    {
      WriteStr("<td id=dockform style=\"height:10px\">");
      RenderDockedForm();
    }
    WriteStr("</td></tr></table>");
    //
    WriteStr("\n");
    WriteStr("\n");
    //
  }

  // **********************************************
  // Status bar clicking events
  // **********************************************
  public void IWSbInd_UserEvent(String EventName)
  {
    if (RefreshNextClick && !ParamsObj().UseRD3)
    {
      RenderPage();
      return;
    }
    //
    DispatchToComp("IWSbInd_UserEvent", new Object[] { EventName });
    //
    if (RolObj.CheckRole())
    {
      //
      //
      // Cerco l'indicatore corrispondente
      AIndicator ind = null;
      for (int i=1; i<IndObj.Indicators.length; i++)
      {
        if (IndObj.Indicators[i] == null)
          continue;
        //
        if (IndObj.Indicators[i].Code.equals(EventName))
        {
          ind = IndObj.Indicators[i];
          break;
        }
      }
      if (ind != null)
      {
        DTTObj.SetRequestName("Indicator " + ind.Code + " click", "Indicator " + ind.Code + " click", DTTRequest.PRI_CMD);
        DTTObj.AddTestItem(ind.iGuid, DTTEngine.TST_INDIC, "Indicator " + ind.Code + " action", "");
        DTTObj.AddHelpItem(0, 0, 0, 0, "Premi l'indicatore " + ind.Code);
      }
    }
    else
      DTTObj.AddMsg(DTTEngine.DTTMSG_WARN, "", 19, "MainFrm.StatusBarHandler", "Unhandled Status Bar command: undefined session role");
    //
    if (!ParamsObj().UseRD3)
      RenderPage();
  }

  // **********************************************
  // W3C Validation
  // **********************************************
  public void IW3C_UserEvent(String EventName)
  {
    // Salvo il vecchio stato
    int oldrd = RDStatus;
    boolean oldhlp = DTTObj.HelpGenerationActive;
    //
    // Disabilito l'RD
    RDStatus = Glb.RD_DISABLED;
    //
    // Direct Output (vedi WriteStr)
    DTTObj.HelpGenerationActive = false;
    //
    WriteStr("<html>\n");
    WriteStr("<head>\n");
    WriteStr("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1252\">\n");
    WriteStr("<title>Validating HTML</title>\n");
    WriteStr("<link rel=stylesheet type=\"text/css\" href=\"iw.css\">\n");
    WriteStr("<script type=\"text/javascript\">\n");
    WriteStr("function done()\n");
    WriteStr("{\n");
    WriteStr("theform.submit();\n");
    WriteStr("setTimeout('n()', 400);\n");
    WriteStr("}\n");
    WriteStr("function n()\n");
    WriteStr("{\n");
    WriteStr("prog.innerText += '.';\n");
    WriteStr("setTimeout('n()', 400);\n");
    WriteStr("}\n");
    WriteStr("</script>\n");
    WriteStr("</head>\n");
    WriteStr("<body onload=\"done()\" style=\"background-color:white\">\n");
    WriteStr("<center>\n");
    WriteStr("<table style=\"margin-top:30px;border-top: 2 dotted #000080;border-bottom: 2 dotted #000080\" cellpadding=\"5\" cellspacing=\"5\">\n");
    WriteStr("<tr><td><img src=\"dttimg/idi.gif\"></td><td style=\"font-size:26pt;font-weight:bold;color:gray\">Validating HTML</td></tr>\n");
    WriteStr("<tr><td>&nbsp;</td><td id=prog style=\"font-size:26pt;font-weight:bold;color:gray\"></td></tr></table></center>\n");
    WriteStr("<form id=\"theform\" method=\"post\" enctype=\"multipart/form-data\" action=\"http://validator.w3.org/check\">\n");
    WriteStr("<input id=\"ss\" name=\"ss\" type=hidden value=\"1\"/>\n");
    WriteStr("<textarea style=\"display:none\" cols=\"10\" rows=\"10\" name=\"fragment\" id=\"fragment\">\n");
    //
    // Buffered Output (vedi WriteStr)
    DTTObj.HelpGenerationActive = true;
    //
    // Renderizzo la pagina encodandola
    ResIdx = 0;
    RenderPage();
    Out.print(Glb.HTMLEncode(ResBuf.substring(0,ResIdx)));
    ResIdx = 0;
    //
    // Direct Output (vedi WriteStr)
    DTTObj.HelpGenerationActive = false;
    //
    WriteStr("</textarea>\n");
    WriteStr("</form>\n");
    WriteStr("</body>\n");
    WriteStr("</html>\n");
    //
    // Ripristino il tutto
    RDStatus = oldrd;
    DTTObj.HelpGenerationActive = oldhlp;
  }

  // **********************************************
  // Gestione delle FORMS
  // **********************************************
  public void Show(int FormIdx, int flModal)
  {
    Show(FormIdx, flModal, null);
  }
  public void Show(int FormIdx, int OpenAs, Object ParentObj)
  {
    int Owner = 0;
    IDVariant Cancel = new IDVariant();
    //
    // Se non è RD3 allora la form deve essere parte dell'MDI
    if (OpenAs == Glb.OPEN_POPUP && RDLevel() < 3)
    {
      OpenAs = Glb.OPEN_MDI;
    }
    //
    // Check if docked form is open
    if (DockedForm()!=null && DockedForm().FormIdx == FormIdx)
    {
      DockedForm().set_Visible(true);
      DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 14, "MainFrm.Show", "Form " + DockedForm().Caption() + " already open and docked");
      return;
    }
    //
    // Check is form is already open
    WebForm f = GetFormByIndex(FormIdx);
    if (f!=null)
    {
      DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 14, "MainFrm.Show", "Form " + f.Caption() + " already open: bringing to front");
      f.set_Visible(true);
      //
      // In RD2 non è mai docked perchè è stato controllato prima, in RD3 può invece essere docked: in quel caso saltiamo la BringToFront e 
      // scriviamo il messaggio che avremmo scritto in RD2
      if (f.Docked)
      {
        DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 14, "MainFrm.Show", "Form " + f.Caption() + " already open and docked");
        //
        if (UseZones() && ScreenZone(f.DockType) != null)
        {
          ScreenZone(f.DockType).set_SelectedForm(f.FormIdx);
        }
      }
      else
        BringToFront(FormIdx);
      return;
    }
    //
    RDForm = true; // Dovrò ridisegnare l'intera form!
    WebForm OldForm = ActiveForm();
    //
    // Se non è MDI o sono su mobile (dove memorizzo l'owner anche se è MDI)
    WebForm parentF = null;
    if (OpenAs != Glb.OPEN_MDI || IsMobile())
    {
      // Se la videata è MDI non tengo conto dell'ActiveForm
      parentF = (OpenAs != Glb.OPEN_MDI ? ActiveForm() : null);
      if (ParentObj!=null && ParentObj instanceof WebForm)
        parentF = (WebForm) ParentObj;
      //
      // Se da una DOCKED apro una MDI, non le attacco tra loro
      // Ma se è SmartPhone devo comunque attaccarle perché su smartphone c'è una sola videata aperta
      if (parentF != null && parentF.Docked && OpenAs == Glb.OPEN_MDI && !IsSmartPhone())
        parentF = null;
      //
      if (parentF!=null)
      {
        Owner = parentF.FormIdx;
        //
        if (OpenAs != Glb.OPEN_MDI)
        {
          // Dato che la nuova form è modale, controllo se la form corrente vuole deattivarsi
          // Se non vuole... non apro la nuova form
          parentF.Form_Deactivate(Cancel);
          parentF.SubForm_Deactivate(Cancel);
          if (Cancel.isTrue())
          {
            DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 12, "MainFrm.Show", "The new form has not been shown, because the parent form " + parentF.Caption() + " refuses to deactivate (cancel := true)");
            return;
          }
        }
      }
      else if (OpenAs != Glb.OPEN_MDI)
        Owner = 32767; // Altrimenti non viene riconosciuta come form modale
    }
    //
    WebForm newform = null;
    fine:
    {
      if (FormIdx==MyGlb.FRM_DIGITATESTO) { newform = new DigitaTesto(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEACCESEPRE) { newform = new SceltaAccertamentiEsercizioPrecedente(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTASOGGET) { newform = new SceltaSoggetti(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELSOGGOMON) { newform = new SceltaSoggettiOmonimi(); break fine; }
      if (FormIdx==MyGlb.FRM_SELECATEFISC) { newform = new SelezioneCategorieFiscali(); break fine; }
      if (FormIdx==MyGlb.FRM_CLASSIFICAZI) { newform = new Classificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOPRODUT) { newform = new ElencoProduttori(); break fine; }
      if (FormIdx==MyGlb.FRM_MODELLI) { newform = new Modelli(); break fine; }
      if (FormIdx==MyGlb.FRM_SELEZICAUSAL) { newform = new SelezionaCausale(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELDELLDISL) { newform = new SceltaDellaDislocazione(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAFATTOR) { newform = new SceltaFattori(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTACENTRI) { newform = new SceltaCentri(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELFATTCONT) { newform = new SceltaFattoriContropartita(); break fine; }
      if (FormIdx==MyGlb.FRM_COMUNI_243) { newform = new SelezioneComuni(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAIMPEGN) { newform = new SceltaImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELIMPEPROV) { newform = new SceltaImpegnoProvenienza(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELIMPEANNO) { newform = new SceltaImpegnoAnno(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEIMPANNPRE) { newform = new SceltaImpegnoAnnoPrecedente(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELIMPEPERS) { newform = new SceltaImpegnoPersonalizzato(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELIMPEORDI) { newform = new SceltaImpegnoOrdine(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTIMPEGUT) { newform = new SceltaImpegnoUT(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELSUBIMPUT) { newform = new SceltaSubImpegnoUT(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELSUBIMPUO) { newform = new SceltaSubImpegnoUO(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELOBIEPERS) { newform = new SceltaObiettiviPers(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELVOCIECON) { newform = new SceltaVociEconomiche(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEVOCECCOFI) { newform = new SceltaVociEconomicheConFiltri(); break fine; }
      if (FormIdx==MyGlb.FRM_CODICIPTC) { newform = new CodiciPTC(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELCODIGEST) { newform = new SceltaCodiciGestionali(); break fine; }
      if (FormIdx==MyGlb.FRM_SCECODGECOFI) { newform = new SceltaCodiciGestionaliConFiltri(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPOBOLLATO) { newform = new TipoBollato(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAVINCOL) { newform = new SceltaVincolo(); break fine; }
      if (FormIdx==MyGlb.FRM_SELEZIOBANCA) { newform = new SelezioneBanca(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTADOCUME) { newform = new SceltaDocumenti(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTADELIBE) { newform = new SceltaDelibere(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAPROPOS) { newform = new SceltaProposte(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAACCERT) { newform = new SceltaAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_SCECAPARSEUO) { newform = new SceltaCapitoloArtSenzaUO(); break fine; }
      if (FormIdx==MyGlb.FRM_SCECAPARCOUO) { newform = new SceltaCapitoloArtConUO(); break fine; }
      if (FormIdx==MyGlb.FRM_ELVOPECOSTEF) { newform = new ElencoVociPegConStanziamentoEffettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_ELVOPECOSTSI) { newform = new ElencoVociPegConStanziamentoSimulato(); break fine; }
      if (FormIdx==MyGlb.FRM_FINSUBIMPFIN) { newform = new FinanziamentiSubImpFin(); break fine; }
      if (FormIdx==MyGlb.FRM_FINANZIMPFIN) { newform = new FinanziamentiImpFin(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELFINAOPER) { newform = new SceltaFinanziamentoOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTACATEGO) { newform = new SceltaCategorie(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELCODIINTE) { newform = new SceltaCodiciIntervento(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEQUIDELSOG) { newform = new SceltaQuietanzeDelSoggetto(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAOPERE) { newform = new SceltaOpere(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEFINIMPACC) { newform = new SceltaFinanziamentiImpAcc(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELFINASUBI) { newform = new SceltaFinanziamentiSubimp(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAOBIETT) { newform = new SceltaObiettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELPROGIND1) { newform = new SceltaProgettoIndice1(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELPROGINDI) { newform = new SceltaProgettoIndice2(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEPROCFPATT) { newform = new SceltaProgettoCfpegAttivo(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEPROCFATVA) { newform = new SceltaProgettoCfpegAttivoVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELOBIEVARI) { newform = new SceltaObiettiviVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEOBIVAFUBI) { newform = new SceltaObiettiviVariazioniFunzBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAPROGET) { newform = new SceltaProgetti(); break fine; }
      if (FormIdx==MyGlb.FRM_SCVOPEGPECOO) { newform = new SceltaVocePEGPersonalizzataConObiettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_SCVOPEGPESEO) { newform = new SceltaVocePEGPersonalizzataSenzaObiettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_SCVOPEGPENCO) { newform = new SceltaVocePEGPersonalizzataNUOVAConObiettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_SCVOPEGPENSO) { newform = new SceltaVocePEGPersonalizzataNUOVASenzaObiettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_SCPRCFVNVPEG) { newform = new SceltaProgettoCfpegVariazioniNuovaVocePEG(); break fine; }
      if (FormIdx==MyGlb.FRM_SCOBVANUVOPE) { newform = new SceltaObiettiviVariazioniNuovaVocePeg(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEVOPEGDABI) { newform = new SceltaVocePEGDaBil(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEVOPEGNOBI) { newform = new SceltaVocePEGNoBil(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTESTMAIL) { newform = new SceltaTestiMail(); break fine; }
      if (FormIdx==MyGlb.FRM_SELEZITITOLI) { newform = new SelezioneTitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTITOTIPO) { newform = new SceltaTitoliTipologie(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELMISSPROG) { newform = new SceltaMissioniProgrammi(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPITOLTERZI) { newform = new CapitoliTerzi(); break fine; }
      if (FormIdx==MyGlb.FRM_FUNZIONI) { newform = new Funzioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SERVIZI) { newform = new Servizi(); break fine; }
      if (FormIdx==MyGlb.FRM_PROGRAMMI) { newform = new Programmi(); break fine; }
      if (FormIdx==MyGlb.FRM_SELEZIFLESSI) { newform = new SelezioneFlessibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVENTIVO) { newform = new Preventivo(); break fine; }
      if (FormIdx==MyGlb.FRM_CONSUNTIVO) { newform = new Consuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_UNITAORGANIZ) { newform = new UnitaOrganizzative(); break fine; }
      if (FormIdx==MyGlb.FRM_SCVOPEGSCAUC) { newform = new SceltaVocePEGSoloCollegateAUoCodrec1(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELPROPBOZZ) { newform = new SceltaProposteBozza(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELDATALIMI) { newform = new SceltaDataLimite(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAVARIAZ) { newform = new SceltaVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTPOLPROG) { newform = new SceltaPolProgetti(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOFINANZ) { newform = new ElencoFinanziamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELDISDILIQ) { newform = new SceltaDistinteDiLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_CODICIUTENZE) { newform = new CodiciUtenze(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTACCERUT) { newform = new SceltaAccertamentiUT(); break fine; }
      if (FormIdx==MyGlb.FRM_CODICIMONITO) { newform = new CodiciMonitoraggio(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELUNITORGA) { newform = new SceltaUnitaOrganizzative(); break fine; }
      if (FormIdx==MyGlb.FRM_SCCACOUODICO) { newform = new SceltaCapitoloConUODiCompetenza(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAASSEST) { newform = new SceltaAssestamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEDAVISSTRI) { newform = new SceltaDaVistaStrutturaRicl(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTARICLAS) { newform = new SceltaRiclassificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTCAPITFS) { newform = new SceltaCapitoliFS(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEVOCPEDL77) { newform = new SceltaVocePegDL77(); break fine; }
      if (FormIdx==MyGlb.FRM_SCECAPARTARM) { newform = new SceltaCapitoloArtArm(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTIPOVARI) { newform = new SceltaTipoVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEOBIEGEST) { newform = new SchedeObiettiviGestionali(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTACOFOG) { newform = new SceltaCOFOG(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELCOFOTRAS) { newform = new SceltaCOFOGTrasco(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELMACRLIV4) { newform = new SceltaMacroLiv4(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEVARPERESI) { newform = new SceltaVariazionePerEsigibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_SCCADACAECUJ) { newform = new SceltaCapitoliDaCAPECAPUOJOIN(); break fine; }
      if (FormIdx==MyGlb.FRM_MUTUI) { newform = new Mutui(); break fine; }
      if (FormIdx==MyGlb.FRM_SCECRONONDEF) { newform = new SceltaCronoprogrammiNonDef(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTACCPROV) { newform = new SceltaAccProvenienza(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELSUBIPROV) { newform = new SceltaSubimpegnoProvenienza(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELOPERCRON) { newform = new SceltaOpereCrono(); break fine; }
      if (FormIdx==MyGlb.FRM_SCECAPARARRE) { newform = new SceltaCapitoloArtArmRes(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEFATCONRIC) { newform = new SceltaFattoriContropartitaRicl(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEFATCOPAAT) { newform = new SceltaFattoriContropartitaPassAtt(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEFINPIACRO) { newform = new SceltaFinanziamentiPianoCronoprogramma(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEVOCTECOPE) { newform = new SceltaVoceTecnicaOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELACCEANNO) { newform = new SceltaAccertamentiAnno(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELFINABILF) { newform = new SceltaFinanziamentoBILFIN(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELOPERBIFI) { newform = new SceltaOpereBifin(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEOBIDIGEDU) { newform = new SceltaObiettiviDiGestioneDUP(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEFATOCONUT) { newform = new SceltaFattoriOContropartitaUtenze(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEUODACAPUO) { newform = new SceltaUODaCAPUO(); break fine; }
      if (FormIdx==MyGlb.FRM_SCUODACABIUO) { newform = new SceltaUODaCAPBILUO(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOOPERE) { newform = new ElencoOpere(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELPERIRIAC) { newform = new SceltaPeriodoRiaccertamento(); break fine; }
      if (FormIdx==MyGlb.FRM_SCMALI4SEMIP) { newform = new SceltaMacroLiv4SenzaMissProg(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTMACR4E5) { newform = new SceltaMacro4E5(); break fine; }
      if (FormIdx==MyGlb.FRM_SCECOFCOMIPR) { newform = new SceltaCofogConMissProg(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEDEINVENT) { newform = new SchedeInventario(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELSTRUCONT) { newform = new SceltaStrutturaConti(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOSULLOPER) { newform = new InformazioniSullOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORMFINAN1) { newform = new InformazioniFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORMPROPOS) { newform = new InformazioniProposta(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOSUVOCBIL) { newform = new InformazioneSuVoceBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOPDCONTI) { newform = new InfoPDConti(); break fine; }
      if (FormIdx==MyGlb.FRM_INFPROVOCPEG) { newform = new InfoProgettiVocePeg(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOBIVOCPEG) { newform = new InfoObiettiviVocePeg(); break fine; }
      if (FormIdx==MyGlb.FRM_FINAVOCIBILA) { newform = new FinanziamentiVociBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVINIZOPER) { newform = new PrevisioniInizialiOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZIOPERA) { newform = new VariazioniOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCEDICOMOPE) { newform = new AccertamentiDiCompetenzaOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPEGDICOMPE) { newform = new ImpegniDiCompetenza(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIPROVOPER) { newform = new VariazioniProvvisorieOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCEARESIOPE) { newform = new AccertamentiAResiduoOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPEGNARESID) { newform = new ImpegniAResiduo(); break fine; }
      if (FormIdx==MyGlb.FRM_SUBIMPEGOPER) { newform = new SubImpegniOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIDAOPERA) { newform = new LiquidazioniOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDIDICOMOPE) { newform = new OrdinativiDiCompetenzaOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDIARESIOPE) { newform = new OrdinativiAResiduoOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_MANDDICOMOPE) { newform = new MandatiDiCompetenzaOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_MANDARESIOPE) { newform = new MandatiAResiduoOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVINIZFINA) { newform = new PrevisioniInizialiFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZFINANZ) { newform = new VariazioniFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCEDICOMFIN) { newform = new AccertamentiDiCompetenzaFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIPROVFINA) { newform = new VariazioniProvvisorieFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCEARESIFIN) { newform = new AccertamentiAResiduoFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_SUBIMPEGFINA) { newform = new SubImpegniFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIDFINANZ) { newform = new LiquidazioniFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDIDICOMFIN) { newform = new OrdinativiDiCompetenzaFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDIARESIFIN) { newform = new OrdinativiAResiduoFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_MANDDICOMFIN) { newform = new MandatiDiCompetenzaFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_MANDARESIFIN) { newform = new MandatiAResiduoFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_MANDATEMESSI) { newform = new MandatiEmessi(); break fine; }
      if (FormIdx==MyGlb.FRM_MANEMEESPRFI) { newform = new MandatiEmessiEserciziPrecedentiFin(); break fine; }
      if (FormIdx==MyGlb.FRM_PAGAMENTI) { newform = new Pagamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_PAGESEPREFIN) { newform = new PagamentiEserciziPrecedentiFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINAEMESSI) { newform = new OrdinativiEmessi(); break fine; }
      if (FormIdx==MyGlb.FRM_RISCOSSIONI) { newform = new Riscossioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDEMEESPRFI) { newform = new OrdinativiEmessiEserciziPrecedentiFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_RISESEPREFIN) { newform = new RiscossioniEserciziPrecedentiFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZIONI) { newform = new Variazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_STANPROGCFPE) { newform = new StanziamentiProgettoCfpeg(); break fine; }
      if (FormIdx==MyGlb.FRM_STANSULLOBIE) { newform = new StanziamentiSullObiettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOQUIETANZ) { newform = new InfoQuietanza(); break fine; }
      if (FormIdx==MyGlb.FRM_INFODISPOSIZ) { newform = new InfoDisposizioni(); break fine; }
      if (FormIdx==MyGlb.FRM_INFODISTLIQU) { newform = new InfoDistinteLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORMDELIBE) { newform = new InformazioniDelibera(); break fine; }
      if (FormIdx==MyGlb.FRM_INFODELIBERA) { newform = new InfoDelibera(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOORDINATI) { newform = new InfoOrdinativo(); break fine; }
      if (FormIdx==MyGlb.FRM_INFSUVOCBI77) { newform = new InformazioneSuVoceBilancio77(); break fine; }
      if (FormIdx==MyGlb.FRM_PIANDEICON77) { newform = new PianoDeiConti77(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAESERCI) { newform = new SceltaEsercizio(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAUFFICI) { newform = new SceltaUfficio(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEMASTRUTT) { newform = new SchemaStruttura(); break fine; }
      if (FormIdx==MyGlb.FRM_STRUTTURA) { newform = new Struttura(); break fine; }
      if (FormIdx==MyGlb.FRM_NUOVSUSTRBIL) { newform = new NuovoSuStrutturaBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIRICLASSI) { newform = new TipiRiclassificazione(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEMIRICLAS) { newform = new SchemiRiclassificazione(); break fine; }
      if (FormIdx==MyGlb.FRM_STRUTTRICLAS) { newform = new StrutturaRiclassificazione(); break fine; }
      if (FormIdx==MyGlb.FRM_NUOVSUSTRRIC) { newform = new NuovoSuStrutturaRiclassificazione(); break fine; }
      if (FormIdx==MyGlb.FRM_PROGRAMCOFOG) { newform = new ProgrammiCofog(); break fine; }
      if (FormIdx==MyGlb.FRM_CODICILIBERI) { newform = new CodiciLiberi(); break fine; }
      if (FormIdx==MyGlb.FRM_CGECGU) { newform = new CgeCgu(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIMOTIVARI) { newform = new TipiMotivazioniVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIVARIAZI1) { newform = new TipiVariazione1(); break fine; }
      if (FormIdx==MyGlb.FRM_FINANZIAMENT) { newform = new Finanziamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_OPERE) { newform = new Opere(); break fine; }
      if (FormIdx==MyGlb.FRM_FINANPERCONT) { newform = new FinanziamentiPerContributo(); break fine; }
      if (FormIdx==MyGlb.FRM_TITOLI) { newform = new Titoli(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPICONTTERZ) { newform = new CapitoliContoTerzi(); break fine; }
      if (FormIdx==MyGlb.FRM_FUNZIOSERVIZ) { newform = new FunzioniServizi(); break fine; }
      if (FormIdx==MyGlb.FRM_VINCOLI) { newform = new Vincoli(); break fine; }
      if (FormIdx==MyGlb.FRM_ALLEGATI) { newform = new Allegati(); break fine; }
      if (FormIdx==MyGlb.FRM_CODICICERTIF) { newform = new CodiciCertificati(); break fine; }
      if (FormIdx==MyGlb.FRM_FLESSIBILITA) { newform = new Flessibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_PROGRAPROGET) { newform = new ProgrammiProgetti(); break fine; }
      if (FormIdx==MyGlb.FRM_CENTRDICOSTO) { newform = new CentriDiCosto(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIMOTIVAZI) { newform = new TipiMotivazione(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIVARIAZIO) { newform = new TipiVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIVARICRON) { newform = new TipiVariazioneCronoprogrammi(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIAVANZO) { newform = new TipiAvanzo(); break fine; }
      if (FormIdx==MyGlb.FRM_CAUSALI) { newform = new Causali(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIBOLLO) { newform = new TipiBollo(); break fine; }
      if (FormIdx==MyGlb.FRM_FIRME) { newform = new Firme(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTRISTRAOR) { newform = new ContributiStraordinari(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIINCARICO) { newform = new TipiIncarico(); break fine; }
      if (FormIdx==MyGlb.FRM_VOCITECNOPER) { newform = new VociTecnicheOpere(); break fine; }
      if (FormIdx==MyGlb.FRM_CODICIFISCAL) { newform = new CodiciFiscali(); break fine; }
      if (FormIdx==MyGlb.FRM_CAUSALFISCAL) { newform = new CausaliFiscali(); break fine; }
      if (FormIdx==MyGlb.FRM_CAUSALIIRAP) { newform = new CausaliIRAP(); break fine; }
      if (FormIdx==MyGlb.FRM_CAUSALPREVID) { newform = new CausaliPrevidenziali(); break fine; }
      if (FormIdx==MyGlb.FRM_CAUSALIINAIL) { newform = new CausaliINAIL(); break fine; }
      if (FormIdx==MyGlb.FRM_CATEGOSOGGET) { newform = new CategorieSoggetti(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPISCADENZA) { newform = new TipiScadenza(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIQUIETANZ) { newform = new TipiQuietanza(); break fine; }
      if (FormIdx==MyGlb.FRM_CATEGODOCUME) { newform = new CategorieDocumenti(); break fine; }
      if (FormIdx==MyGlb.FRM_UFFICI) { newform = new Uffici(); break fine; }
      if (FormIdx==MyGlb.FRM_CAUSALSOSPEN) { newform = new CausaliSospensione(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIREGISTRO) { newform = new TipiRegistro(); break fine; }
      if (FormIdx==MyGlb.FRM_ESENZIONI) { newform = new Esenzioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ATTIVITA) { newform = new Attivita(); break fine; }
      if (FormIdx==MyGlb.FRM_CODICISTATIS) { newform = new CodiciStatistici(); break fine; }
      if (FormIdx==MyGlb.FRM_REGISTRI) { newform = new Registri(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIESECUTIV) { newform = new TipiEsecutivita(); break fine; }
      if (FormIdx==MyGlb.FRM_FATTORI) { newform = new Fattori(); break fine; }
      if (FormIdx==MyGlb.FRM_CENTRI) { newform = new Centri(); break fine; }
      if (FormIdx==MyGlb.FRM_CLASSICONTAB) { newform = new ClassiContabili(); break fine; }
      if (FormIdx==MyGlb.FRM_FATTORIOLD) { newform = new FattoriOld(); break fine; }
      if (FormIdx==MyGlb.FRM_PREFERENZE) { newform = new Preferenze(); break fine; }
      if (FormIdx==MyGlb.FRM_PREFERENZWEB) { newform = new PreferenzeWeb(); break fine; }
      if (FormIdx==MyGlb.FRM_PARTRAATTCON) { newform = new ParametriTrasparenzaAttiConcessione(); break fine; }
      if (FormIdx==MyGlb.FRM_ASSTIPCOSEPC) { newform = new AssociazioneTipiCostoEPCF(); break fine; }
      if (FormIdx==MyGlb.FRM_ENTE) { newform = new Ente(); break fine; }
      if (FormIdx==MyGlb.FRM_ENTEINFORMAZ) { newform = new EnteInformazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_TESORIERE) { newform = new Tesoriere(); break fine; }
      if (FormIdx==MyGlb.FRM_TESORIINFORM) { newform = new TesoriereInformazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_NUMERAZIONI) { newform = new Numerazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_NUMERAINFORM) { newform = new NumerazioniInformazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_TESTISTAMPE) { newform = new TestiStampe(); break fine; }
      if (FormIdx==MyGlb.FRM_VOCIECON) { newform = new VociEcon(); break fine; }
      if (FormIdx==MyGlb.FRM_COMPETENZE) { newform = new Competenze(); break fine; }
      if (FormIdx==MyGlb.FRM_ASSESSORATI) { newform = new Assessorati(); break fine; }
      if (FormIdx==MyGlb.FRM_DELIBERE) { newform = new Delibere(); break fine; }
      if (FormIdx==MyGlb.FRM_DELIBERA) { newform = new Delibera(); break fine; }
      if (FormIdx==MyGlb.FRM_MOVIMEDELIBE) { newform = new MovimentiDelibera(); break fine; }
      if (FormIdx==MyGlb.FRM_ESECUTPROPOS) { newform = new EsecutivitaProposte(); break fine; }
      if (FormIdx==MyGlb.FRM_ESECPRODAGS4) { newform = new EsecutivitaProposteDaGs4(); break fine; }
      if (FormIdx==MyGlb.FRM_MOVIMEPROPOS) { newform = new MovimentiProposte(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMPAPROPOS) { newform = new StampaProposte(); break fine; }
      if (FormIdx==MyGlb.FRM_SERVIZDIRETT) { newform = new ServiziDiretti(); break fine; }
      if (FormIdx==MyGlb.FRM_ATTRIALSERVI) { newform = new AttribuzioneAlServizio(); break fine; }
      if (FormIdx==MyGlb.FRM_ELECAPSERDIR) { newform = new ElencoCapitoliServiziDiretti(); break fine; }
      if (FormIdx==MyGlb.FRM_SERDIRFIDACA) { newform = new ServiziDirettiFinanziatiDalCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_SOGGETTI) { newform = new Soggetti(); break fine; }
      if (FormIdx==MyGlb.FRM_SOGGETTO) { newform = new Soggetto(); break fine; }
      if (FormIdx==MyGlb.FRM_GENSOGPERECO) { newform = new GenerazioneSoggettiPerEconomato(); break fine; }
      if (FormIdx==MyGlb.FRM_CORRISREGION) { newform = new CorrispondenzaRegioni(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTROSOGGET) { newform = new ControlloSoggetti(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRCONTSOGG) { newform = new EstrattoContoSoggetto(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTAGMANDAT) { newform = new DettagliMandato(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTAGORDINA) { newform = new DettagliOrdinativo(); break fine; }
      if (FormIdx==MyGlb.FRM_TOTALEENTRAT) { newform = new TotaleEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_TOTALESPESA) { newform = new TotaleSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTFATTSPES) { newform = new DettagliFattureSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTFATTENTR) { newform = new DettagliFattureEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCUDEBICODI) { newform = new DocumentiDebitoriCodificati(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTABDOCUME) { newform = new ContabilizzazioneDocumenti(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCDEBNONCOD) { newform = new DocumentiDebitoriNonCodificati(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTABILIIVA) { newform = new ContabilizzazioneIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTFINAECON) { newform = new ContabilizzazioneFinanziariaEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSIACCERT) { newform = new EmissioneAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSACC) { newform = new EmissAcc(); break fine; }
      if (FormIdx==MyGlb.FRM_CAUSALEPERIO) { newform = new CausaliEPeriodi(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCPERIMPCON) { newform = new DocumentiPerImputazioneContabile(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCPERIMPECO) { newform = new DocumentiPerImputazioneEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCUMPERQUIE) { newform = new DocumentiPerQuietanza(); break fine; }
      if (FormIdx==MyGlb.FRM_SCADENZIARIO) { newform = new Scadenziario(); break fine; }
      if (FormIdx==MyGlb.FRM_CORRISPETTIV) { newform = new Corrispettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRATTCONTO) { newform = new EstrattoConto(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCUMEAPERTI) { newform = new DocumentiAperti(); break fine; }
      if (FormIdx==MyGlb.FRM_PROTOCOLLO) { newform = new Protocollo(); break fine; }
      if (FormIdx==MyGlb.FRM_RENDICMANDAT) { newform = new RendicontoMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_RENDMANDRIVO) { newform = new RendicontoMandatiRivoli(); break fine; }
      if (FormIdx==MyGlb.FRM_RENDICFATTUR) { newform = new RendicontoFatture(); break fine; }
      if (FormIdx==MyGlb.FRM_RENFATPERRIV) { newform = new RendicontoFatturePersonalizzazioneRivoli(); break fine; }
      if (FormIdx==MyGlb.FRM_PROVVELIQUID) { newform = new ProvvedimentoLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_SITLIQPECOUT) { newform = new SituazioneLiquidazioniPerCodiceUtenza(); break fine; }
      if (FormIdx==MyGlb.FRM_SITLIQPERIMP) { newform = new SituazioneLiquidazioniPerImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_GENEIMPUECO2) { newform = new GenerazioneImputazioneEconomica2(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOINCASS) { newform = new ElencoIncassi(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEINCAGGINC) { newform = new ElencoIncassiAggiornaIncassi(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISCORRINCA) { newform = new EmissioneCorrispettiviIncassi(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISORDIINCA) { newform = new EmissioneOrdinativiIncassi(); break fine; }
      if (FormIdx==MyGlb.FRM_CARICAINCASS) { newform = new CaricamentoIncassi(); break fine; }
      if (FormIdx==MyGlb.FRM_FATTURE) { newform = new Fatture(); break fine; }
      if (FormIdx==MyGlb.FRM_FATTURA) { newform = new Fattura(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIDOCUMENT) { newform = new TipiDocumento(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPUTAZIONI) { newform = new Imputazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIDAZIONI) { newform = new Liquidazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINATIVI) { newform = new Ordinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOLIQUID) { newform = new ElencoLiquidazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOORDINA) { newform = new ElencoOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFICHE) { newform = new Rettifiche(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCUMENTI) { newform = new Documenti(); break fine; }
      if (FormIdx==MyGlb.FRM_ACQUIMMAFATT) { newform = new AcquisizioneImmagineFattura(); break fine; }
      if (FormIdx==MyGlb.FRM_SCANSIONE) { newform = new Scansione(); break fine; }
      if (FormIdx==MyGlb.FRM_ACQUIMMAIRID) { newform = new AcquisizioneImmagineIride(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOFATTURA) { newform = new InfoFattura(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDICOLLAFAT) { newform = new OrdiniCollegatiAFattura(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENFILEINVI) { newform = new ElencoFileInviati(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENFATDAINV) { newform = new ElencoFattureDaInviare(); break fine; }
      if (FormIdx==MyGlb.FRM_CREFILXMCOFA) { newform = new CreaFileXMLComunicazioneFatture(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUALDESCRI) { newform = new VisualizzaDescrizione(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTFATTINVI) { newform = new DettaglioFattureInviate(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEFILZIPINV) { newform = new ElencoFileZIPInviati(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPOFILEESIT) { newform = new ImportFileEsito(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUALIESITO) { newform = new VisualizzaEsito(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEFATCOMFAT) { newform = new ElencoFattureComunicazioneFatture(); break fine; }
      if (FormIdx==MyGlb.FRM_DISTLIQUTECN) { newform = new DistinteLiquidazioneTecniche(); break fine; }
      if (FormIdx==MyGlb.FRM_RETMASUOSUFA) { newform = new RettificaMassivaUOSuFatture(); break fine; }
      if (FormIdx==MyGlb.FRM_SEGNRETMASU1) { newform = new SegnalazioniRettifaMassivaUO(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPODAFILCSV) { newform = new ImportaDaFileCSV(); break fine; }
      if (FormIdx==MyGlb.FRM_RISULTELABOR) { newform = new RisultatoElaborazione(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMCOLLBOLL) { newform = new EliminaCollegamentoBolla(); break fine; }
      if (FormIdx==MyGlb.FRM_INSERDAORDIN) { newform = new InserimentoDaOrdine(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTROFATTUR) { newform = new ControlloFatture(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTAGIMPEGN) { newform = new DettagliImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_INSERDABOLLA) { newform = new InserimentoDaBolla(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOORDINI) { newform = new InfoOrdini(); break fine; }
      if (FormIdx==MyGlb.FRM_BUONO) { newform = new Buono(); break fine; }
      if (FormIdx==MyGlb.FRM_CATEGOPRODOT) { newform = new CategoriaProdotto(); break fine; }
      if (FormIdx==MyGlb.FRM_VOCIECONOMIC) { newform = new VociEconomiche(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFIMPEGN) { newform = new RettificaImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENFATTORDI) { newform = new ElencoFattureOrdine(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOBOLLE) { newform = new ElencoBolle(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUAZDETTAG) { newform = new SituazioneDettaglio(); break fine; }
      if (FormIdx==MyGlb.FRM_CARICAMEFILE) { newform = new CaricamentoFile(); break fine; }
      if (FormIdx==MyGlb.FRM_SMISTAFATTUR) { newform = new SmistamentoFatture(); break fine; }
      if (FormIdx==MyGlb.FRM_CONFIGUTENZE) { newform = new ConfigurazioneUtenze(); break fine; }
      if (FormIdx==MyGlb.FRM_NOTIFICHE) { newform = new Notifiche(); break fine; }
      if (FormIdx==MyGlb.FRM_FATTURELETTR) { newform = new FattureElettroniche(); break fine; }
      if (FormIdx==MyGlb.FRM_MODASSUNPEAC) { newform = new ModificaAssegnaUnitaPerAccettazione(); break fine; }
      if (FormIdx==MyGlb.FRM_INSENUOVSOGG) { newform = new InserimentoNuovoSoggetto(); break fine; }
      if (FormIdx==MyGlb.FRM_SELEZISOGGET) { newform = new SelezioneSoggetto(); break fine; }
      if (FormIdx==MyGlb.FRM_MODASSUNIMUL) { newform = new ModificaAssegnaUnitaMULTISEL(); break fine; }
      if (FormIdx==MyGlb.FRM_MOTIVARIFIUT) { newform = new MotivazioneRifiuto(); break fine; }
      if (FormIdx==MyGlb.FRM_SEGNALAZIONI) { newform = new Segnalazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_RIEPILOGOIVA) { newform = new RiepilogoIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCENOTDICRE) { newform = new AccettaNotaDiCredito(); break fine; }
      if (FormIdx==MyGlb.FRM_DODACOAREFEV) { newform = new DocumentiDaCollegareARettificaFEVEN(); break fine; }
      if (FormIdx==MyGlb.FRM_IVA) { newform = new IVA(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIORESIGIB) { newform = new AggiornamentoEsigibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_NUMERAZIOIVA) { newform = new NumerazioneIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_CONFERMAIVA) { newform = new ConfermaIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_VENTILAZIIVA) { newform = new VentilazioneIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_CALCOIVAVENT) { newform = new CalcoloIVAVentilata(); break fine; }
      if (FormIdx==MyGlb.FRM_PERCEDIINCID) { newform = new PercentualiDiIncidenza(); break fine; }
      if (FormIdx==MyGlb.FRM_REGIACQUVEND) { newform = new RegistroAcquistiVendite(); break fine; }
      if (FormIdx==MyGlb.FRM_REGISTCORRIS) { newform = new RegistroCorrispettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_REGRIEACQVEN) { newform = new RegistroRiepilogativoAcquistiVendite(); break fine; }
      if (FormIdx==MyGlb.FRM_REGRIEACVESO) { newform = new RegistroRiepilogativoAcquistiVenditeSospesi(); break fine; }
      if (FormIdx==MyGlb.FRM_REGIRIEPCORR) { newform = new RegistroRiepilogativoCorrispettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_VERIFICAIVA) { newform = new VerificaIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_VERIFIVASOSP) { newform = new VerificaIVASospesi(); break fine; }
      if (FormIdx==MyGlb.FRM_COIVAINATDIE) { newform = new ControlloIVAInAttesaDiEsigibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIDAZIIVA) { newform = new LiquidazioneIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQIVAPERLIV) { newform = new LiquidazioneIVAPersLivorno(); break fine; }
      if (FormIdx==MyGlb.FRM_COMLIQPERIVA) { newform = new ComunicazioneLiquidazioniPeriodicheIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_DATCOMLIQIVA) { newform = new DatiComunicazioneLiqIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRAIVAEXCE) { newform = new EstrazioneIVAExcel(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTDAPECOIVA) { newform = new EstrazioneDatiPerControlloIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_COLLEGCAPITO) { newform = new CollegamentoCapitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_ESIIVAFALIPA) { newform = new EsigibilitaIVAFattureLiquidateParzialmente(); break fine; }
      if (FormIdx==MyGlb.FRM_UTENZE) { newform = new Utenze(); break fine; }
      if (FormIdx==MyGlb.FRM_DISTIDILIQU1) { newform = new DistintaDiLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISLIQDADIS) { newform = new EmissioneLiquidazioniDaDistinta(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENDISDILIQ) { newform = new ElencoDistinteDiLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEANOLIQUTE) { newform = new ElencoAnomalieLiquidazioniUtenze(); break fine; }
      if (FormIdx==MyGlb.FRM_CARICAFATTUR) { newform = new CaricamentoFatture(); break fine; }
      if (FormIdx==MyGlb.FRM_CARICACONSUM) { newform = new CaricamentoConsumi(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCUMECORRIS) { newform = new DocumentiCorrispettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOCORRISPE) { newform = new InfoCorrispettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFBOLLAT) { newform = new RettificaBollato(); break fine; }
      if (FormIdx==MyGlb.FRM_INTEGRAZIPCC) { newform = new IntegrazionePCC(); break fine; }
      if (FormIdx==MyGlb.FRM_INSEDOCDACFA) { newform = new InserisciDocumentiDaCfa(); break fine; }
      if (FormIdx==MyGlb.FRM_ESITCOMUAPCC) { newform = new EsitoComunicazioneAPCC(); break fine; }
      if (FormIdx==MyGlb.FRM_REICOMRICPCC) { newform = new ReinviaComunicaRicezionePCC(); break fine; }
      if (FormIdx==MyGlb.FRM_COMUNCONTPCC) { newform = new ComunicaContabilizzazionePCC(); break fine; }
      if (FormIdx==MyGlb.FRM_COMUNSCADPCC) { newform = new ComunicaScadutoPCC(); break fine; }
      if (FormIdx==MyGlb.FRM_FILECOMUNPCC) { newform = new FileComunicazioniPCC(); break fine; }
      if (FormIdx==MyGlb.FRM_ANNUFILECORR) { newform = new AnnullaFileCorrente(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTAGDOCUME) { newform = new DettaglioDocumenti(); break fine; }
      if (FormIdx==MyGlb.FRM_CAMBAZIOANNU) { newform = new CambiaAzioneAnnulla(); break fine; }
      if (FormIdx==MyGlb.FRM_RENDMODIDOCU) { newform = new RendiModificabileDocumento(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPESIRICPCC) { newform = new ImportaEsitoRicezionePCC(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCETMANUPCC) { newform = new AccettazioneManualePCC(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOSTEPFATT) { newform = new InfoStepFattura(); break fine; }
      if (FormIdx==MyGlb.FRM_PIADEICONLIS) { newform = new PianoDeiContiList(); break fine; }
      if (FormIdx==MyGlb.FRM_INSEAGGPDCON) { newform = new InserimentoAggiornamentoPDConti(); break fine; }
      if (FormIdx==MyGlb.FRM_INSESUESESUC) { newform = new InserimentoSuEserciziSuccessivi(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGAUTIMECOL) { newform = new AggiornamentoAutomaticoImputazioniEconomicheOLD(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOUO) { newform = new ElencoUO(); break fine; }
      if (FormIdx==MyGlb.FRM_FINANZISUCAP) { newform = new FinanziamentiSuCap(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENFINAPIAN) { newform = new ElencoFinanziamentiPiano(); break fine; }
      if (FormIdx==MyGlb.FRM_CORRISCAPITO) { newform = new CorrispondenzeCapitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_INSECAPSUCF4) { newform = new InserimentoCapitoloSuCF4(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIORMOVIME) { newform = new AggiornaMovimentazione(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTUOSUCAPI) { newform = new RettificaUOSuCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_CONUOPIADECO) { newform = new ControlliUOPianoDeiConti(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPSENIMPECO) { newform = new CapitoliSenzaImputazioniEconomiche(); break fine; }
      if (FormIdx==MyGlb.FRM_ASSOCENAICAP) { newform = new AssociaCentroAiCapitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_ANOASSCENACA) { newform = new AnomalieAssociazioneCentroACapitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMECPIDECO) { newform = new ElencoImputazioniEconomichePianoDeiConti(); break fine; }
      if (FormIdx==MyGlb.FRM_RECECOSUMOAU) { newform = new RecuperoEconomicaSuMovimentiAUTOMATICO(); break fine; }
      if (FormIdx==MyGlb.FRM_MOVSENIMPECO) { newform = new MovimentiSenzaImputazioneEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCSENIMPECO) { newform = new DocumentiSenzaImputazioneEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_RECRETECSUMO) { newform = new RecuperoRettificaEconomicaSuMovimenti(); break fine; }
      if (FormIdx==MyGlb.FRM_ASSOIMPUECON) { newform = new AssociaImputazioniEconomiche(); break fine; }
      if (FormIdx==MyGlb.FRM_LOGCANUNIORG) { newform = new LogCancellazioniUnitaOrganizzative(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIMASSIUO) { newform = new RettificaMassivaUO(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIUNIAICAP) { newform = new AggiungiUnitaAiCapitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_SEGNRETMASUO) { newform = new SegnalazioniRettificaMassivaUO(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFIUNITA) { newform = new RettificaUnita(); break fine; }
      if (FormIdx==MyGlb.FRM_DIFFSUESESUC) { newform = new DifferenzeSuEserciziSuccessivi(); break fine; }
      if (FormIdx==MyGlb.FRM_RETUOPERCAOT) { newform = new RettificaUOPerCambioOttica(); break fine; }
      if (FormIdx==MyGlb.FRM_ASSEGUOCAPIT) { newform = new AssegnazioneUOCapitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIVALCOMUO) { newform = new AggiornaValoriComuniUO(); break fine; }
      if (FormIdx==MyGlb.FRM_ERRRETUOCAOT) { newform = new ErroriRettificaUOCambioOttica(); break fine; }
      if (FormIdx==MyGlb.FRM_LOGRETUOCAOT) { newform = new LogRettificaUOCambioOttica(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIDEFINUO) { newform = new RettificaDefinitivaUO(); break fine; }
      if (FormIdx==MyGlb.FRM_AGTIAVSUCAAU) { newform = new AggiornaTipoAvanzoSuCapitoliAutomatico(); break fine; }
      if (FormIdx==MyGlb.FRM_AGTIAVSUCAMA) { newform = new AggiornaTipoAvanzoSuCapitoliManuale(); break fine; }
      if (FormIdx==MyGlb.FRM_ESERCIFINANZ) { newform = new EserciziFinanziari(); break fine; }
      if (FormIdx==MyGlb.FRM_STANBILAEFF1) { newform = new StanziamentiBilancioEffettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_STANBILASIM1) { newform = new StanziamentiBilancioSimulato(); break fine; }
      if (FormIdx==MyGlb.FRM_STANZIAMENUO) { newform = new StanziamentiUO(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPIFUORSTRU) { newform = new CapitoliFuoriStruttura(); break fine; }
      if (FormIdx==MyGlb.FRM_STANPLUREFFE) { newform = new StanziamentiPluriennaliEffettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_STANPLURSIMU) { newform = new StanziamentiPluriennaliSimulato(); break fine; }
      if (FormIdx==MyGlb.FRM_STANBILEFFVG) { newform = new StanziamentiBilancioEffettivoVg(); break fine; }
      if (FormIdx==MyGlb.FRM_STANZIAMUOVG) { newform = new StanziamentiUOVg(); break fine; }
      if (FormIdx==MyGlb.FRM_STANBILSIMVG) { newform = new StanziamentiBilancioSimulatoVg(); break fine; }
      if (FormIdx==MyGlb.FRM_STANZIAUOVG1) { newform = new StanziamentiUOVg1(); break fine; }
      if (FormIdx==MyGlb.FRM_CRONOPROGRAM) { newform = new Cronoprogrammi(); break fine; }
      if (FormIdx==MyGlb.FRM_INSAGGCRONOP) { newform = new InsagginfoCronoprogramma(); break fine; }
      if (FormIdx==MyGlb.FRM_DEFINICRONOP) { newform = new DefinizioneCronoprogramma(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENVARDACON) { newform = new ElencoVariazioniDaConfermare(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTCOMPIMPO) { newform = new DettaglioComposizioneImporti(); break fine; }
      if (FormIdx==MyGlb.FRM_STAELEVAFUAG) { newform = new StampaElencoVariazioniFunAgg(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMPACRONOP) { newform = new StampaCronoprogramma(); break fine; }
      if (FormIdx==MyGlb.FRM_QUADECONFINA) { newform = new QuadroEconomicoFinanziario(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOCRONOP) { newform = new ElencoCronoprogrammi(); break fine; }
      if (FormIdx==MyGlb.FRM_GENEIMPDAPIA) { newform = new GenerazioneImpegniDaPiano(); break fine; }
      if (FormIdx==MyGlb.FRM_FINDACROFAS1) { newform = new FinanziamentiDaCronoFase1(); break fine; }
      if (FormIdx==MyGlb.FRM_FINDACROFAS2) { newform = new FinanziamentiDaCronoFase2(); break fine; }
      if (FormIdx==MyGlb.FRM_PARAMETRIFSC) { newform = new ParametriFSC(); break fine; }
      if (FormIdx==MyGlb.FRM_DEFITIPOCALC) { newform = new DefinizioneTipoCalcolo(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGITIPOCALC) { newform = new AggiornaTipoCalcolo(); break fine; }
      if (FormIdx==MyGlb.FRM_FCDDEBILPREV) { newform = new FCDDEBilPrevisione(); break fine; }
      if (FormIdx==MyGlb.FRM_FCDDEARENDIC) { newform = new FCDDEARendiconto(); break fine; }
      if (FormIdx==MyGlb.FRM_CALCFCDINGES) { newform = new CalcoloFCDDEInGestione(); break fine; }
      if (FormIdx==MyGlb.FRM_FCDDINFOACCE) { newform = new FCDDEInfoAccertato(); break fine; }
      if (FormIdx==MyGlb.FRM_FCDDINFOINCA) { newform = new FCDDEInfoIncassato(); break fine; }
      if (FormIdx==MyGlb.FRM_FCDINFINCREN) { newform = new FCDDEInfoIncassatoRend(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGVALCOFCRE) { newform = new AggiornaValoriComuniFCDDERend(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPICALCCASS) { newform = new TipiCalcoloCassa(); break fine; }
      if (FormIdx==MyGlb.FRM_PERCCALCSTAN) { newform = new PercentualiCalcoloStanziamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_DUPLSUALTESE) { newform = new DuplicaSuAltroEsercizio(); break fine; }
      if (FormIdx==MyGlb.FRM_GENERABILANC) { newform = new GenerazioneBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_CALIMPBILSIM) { newform = new CalcoliImportiBilancioSimulato(); break fine; }
      if (FormIdx==MyGlb.FRM_CALIMPBILEFF) { newform = new CalcoliImportiBilancioEffettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_PASSSUBILEFF) { newform = new PassaggioSuBilancioEffettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_GENENUOVBILA) { newform = new GenerazioneNuovoBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_GENENUOVFINA) { newform = new GenerazioneNuoviFinanziamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIAUTOBILA) { newform = new AggiornamentoAutomaticoBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_VODEBISCSIAI) { newform = new VociDelBilancioSimulatoConStanziamentoInferioreAgliImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_RIEIMPACCPLU) { newform = new RiemissioneImpAccPluriennali(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHECOMPSTAN) { newform = new SchedeComposizioneStanziamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMBILASIMU) { newform = new EliminazioneBilancioSimulato(); break fine; }
      if (FormIdx==MyGlb.FRM_APERNUOVBILA) { newform = new AperturaNuovoBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_PARABILAPREV) { newform = new ParametriBilancioPrev(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMBILAPREV) { newform = new StampeBilancioPrev(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMBILAAGGI) { newform = new StampeBilancioAggiornato(); break fine; }
      if (FormIdx==MyGlb.FRM_BILAENTRPREV) { newform = new BilancioEntratePrev(); break fine; }
      if (FormIdx==MyGlb.FRM_RISUAMMNEPRE) { newform = new RisultatoAmmNePresunto(); break fine; }
      if (FormIdx==MyGlb.FRM_RISAMMPRE201) { newform = new RisultatoAmmPresunto2014(); break fine; }
      if (FormIdx==MyGlb.FRM_LIMITIINDEBI) { newform = new LimitiIndebitamento(); break fine; }
      if (FormIdx==MyGlb.FRM_FCDDEPREV) { newform = new FCDDEPrev(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENRESIESER) { newform = new ElencoResiduiEsercizio(); break fine; }
      if (FormIdx==MyGlb.FRM_QUAGENRIAPR1) { newform = new QuadroGeneraleRiassuntivoPrev(); break fine; }
      if (FormIdx==MyGlb.FRM_QUAGENRIAAGG) { newform = new QuadroGeneraleRiassuntivoAgg(); break fine; }
      if (FormIdx==MyGlb.FRM_EQUIDIBILPRE) { newform = new EquilibriDiBilancioPrev(); break fine; }
      if (FormIdx==MyGlb.FRM_EQUILBILAAGG) { newform = new EquilibriBilancioAgg(); break fine; }
      if (FormIdx==MyGlb.FRM_VERIFIVINCOL) { newform = new VerificaVincoli(); break fine; }
      if (FormIdx==MyGlb.FRM_COMPOSFPVAGG) { newform = new ComposizioneFPVAgg(); break fine; }
      if (FormIdx==MyGlb.FRM_PARAOBIEPREV) { newform = new ParametriObiettivoPrev(); break fine; }
      if (FormIdx==MyGlb.FRM_ALLEBILA1PRE) { newform = new AllegatiBilancioA1Prev(); break fine; }
      if (FormIdx==MyGlb.FRM_ALLEBILA2PRE) { newform = new AllegatiBilancioA2Prev(); break fine; }
      if (FormIdx==MyGlb.FRM_ALLEBILA3PRE) { newform = new AllegatiBilancioA3Prev(); break fine; }
      if (FormIdx==MyGlb.FRM_BILANPERCAPI) { newform = new BilancioPerCapitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_PEGAGGENTSPE) { newform = new PegAggiornatoEntrataSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_BILPERCAPAGG) { newform = new BilancioPerCapitoliAggiornato(); break fine; }
      if (FormIdx==MyGlb.FRM_BILANCPREVIS) { newform = new BilancioPrevisione(); break fine; }
      if (FormIdx==MyGlb.FRM_RIEGENSPEPRE) { newform = new RiepilogoGeneraleSpesePreventivo(); break fine; }
      if (FormIdx==MyGlb.FRM_FUNZIODELEGA) { newform = new FunzioniDelegate(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTCOMUINTE) { newform = new ContributiComunitariInternazionali(); break fine; }
      if (FormIdx==MyGlb.FRM_QUAGENRIAPRE) { newform = new QuadroGeneraleRiassuntivoPreventivo(); break fine; }
      if (FormIdx==MyGlb.FRM_BILANCPLURIE) { newform = new BilancioPluriennale(); break fine; }
      if (FormIdx==MyGlb.FRM_BILANCAGGIOR) { newform = new BilancioAggiornato(); break fine; }
      if (FormIdx==MyGlb.FRM_PEGPREVENTIV) { newform = new PegPreventivo(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVIPERSERV) { newform = new PrevisioniPerServizio(); break fine; }
      if (FormIdx==MyGlb.FRM_PREPERSETOPE) { newform = new PrevisioniPerSettoreOperativo(); break fine; }
      if (FormIdx==MyGlb.FRM_PREPERCEDICO) { newform = new PrevisioniPerCentroDiCosto(); break fine; }
      if (FormIdx==MyGlb.FRM_PREPERUNDIGE) { newform = new PrevisioniPerUnitaDiGestione(); break fine; }
      if (FormIdx==MyGlb.FRM_PREPERUNDIUT) { newform = new PrevisioniPerUnitaDiUtilizzo(); break fine; }
      if (FormIdx==MyGlb.FRM_PREPERTIDISP) { newform = new PrevisioniPerTipologiaDiSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVIPERPROG) { newform = new PrevisioniPerProgramma(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVIPERVINC) { newform = new PrevisioniPerVincolo(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVIPERFLES) { newform = new PrevisioniPerFlessibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVISFINANZ) { newform = new PrevisioniFinanziamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVSERINECO) { newform = new PrevisioniServiziInEconomia(); break fine; }
      if (FormIdx==MyGlb.FRM_AMMINITRASPA) { newform = new AmministrazioneTrasparente(); break fine; }
      if (FormIdx==MyGlb.FRM_PEGPLURIENNA) { newform = new PegPluriennale(); break fine; }
      if (FormIdx==MyGlb.FRM_PEGAGGIORNAT) { newform = new PegAggiornato(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCORESIDU) { newform = new ElencoResidui(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRADATIRPP) { newform = new EstrazioneDatiRPP(); break fine; }
      if (FormIdx==MyGlb.FRM_VERIFIANOMAL) { newform = new VerificaAnomalie(); break fine; }
      if (FormIdx==MyGlb.FRM_PARABILACONS) { newform = new ParametriBilancioCons(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMBILACONS) { newform = new StampeBilancioCons(); break fine; }
      if (FormIdx==MyGlb.FRM_BILAENTRCONS) { newform = new BilancioEntrateCons(); break fine; }
      if (FormIdx==MyGlb.FRM_CERTPARAOBIE) { newform = new CertificazioneParametriObiettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_EQUIDIBILCON) { newform = new EquilibriDiBilancioCons(); break fine; }
      if (FormIdx==MyGlb.FRM_QUAGENRIACON) { newform = new QuadroGeneraleRiassuntivoCons(); break fine; }
      if (FormIdx==MyGlb.FRM_RISULDIAMMIN) { newform = new RisultatoDiAmministrazione(); break fine; }
      if (FormIdx==MyGlb.FRM_FCDDECONS) { newform = new FCDDECons(); break fine; }
      if (FormIdx==MyGlb.FRM_QUARIAGESCAS) { newform = new QuadroRiassuntivoGestioneCassa(); break fine; }
      if (FormIdx==MyGlb.FRM_RESIDARIPCON) { newform = new ResiduiDaRiportareCons(); break fine; }
      if (FormIdx==MyGlb.FRM_PARAOBIECONS) { newform = new ParametriObiettiviCons(); break fine; }
      if (FormIdx==MyGlb.FRM_ALLEBILA1CON) { newform = new AllegatiBilancioA1Cons(); break fine; }
      if (FormIdx==MyGlb.FRM_ALLEBILA2CON) { newform = new AllegatiBilancioA2Cons(); break fine; }
      if (FormIdx==MyGlb.FRM_ALLEBILA3CON) { newform = new AllegatiBilancioA3Cons(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTOCONSOLD) { newform = new ContoConsuntivoOld(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTDATCERCON) { newform = new EstrazioneDatiCertificatoConsuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTODELTESO) { newform = new ContoDelTesoriere(); break fine; }
      if (FormIdx==MyGlb.FRM_PEGCONSUNOLD) { newform = new PEGConsuntivoOld(); break fine; }
      if (FormIdx==MyGlb.FRM_QUADGENERIAS) { newform = new QuadroGeneraleRiassuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_SERVIINECONO) { newform = new ServiziInEconomia(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAAIRESID) { newform = new VariazioniAiResidui(); break fine; }
      if (FormIdx==MyGlb.FRM_SERINECOPECO) { newform = new ServiziInEconomiaPegConsuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_VARAIRESPECO) { newform = new VariazioniAiResiduiPegConsuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_BILPERCAPCON) { newform = new BilancioPerCapitoliConsuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIDABUDCE4) { newform = new VariazioniDaBudgetCe4(); break fine; }
      if (FormIdx==MyGlb.FRM_ESECUTVARIAZ) { newform = new EsecutivitaVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ESECVARDAGS4) { newform = new EsecutivitaVariazioniDaGs4(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZATESOR) { newform = new VariazioniATesoreria(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUVARITRAT) { newform = new SituazioneVariazioniTrattate(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORMVARIAZ) { newform = new InformazioniVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZDEFINI) { newform = new VariazioniDefinitive(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTREMVARIAZ) { newform = new EstremiVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZPROVVI) { newform = new VariazioniProvvisorie(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPCONVAPRAN) { newform = new CapitoliConVarProvAnomalie(); break fine; }
      if (FormIdx==MyGlb.FRM_GENEVARDACRO) { newform = new GenerazioneVariazioniDaCronoprogramma(); break fine; }
      if (FormIdx==MyGlb.FRM_LANGENVARCR1) { newform = new LanciaGeneraVarCrono(); break fine; }
      if (FormIdx==MyGlb.FRM_FASE1ESTRPRO) { newform = new Fase1EstremiProvvedimento(); break fine; }
      if (FormIdx==MyGlb.FRM_FASE2VARIIMP) { newform = new Fase2VariazioniImpegnabile(); break fine; }
      if (FormIdx==MyGlb.FRM_PRESINCARPRO) { newform = new PresaInCaricoProposte(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTBOZZPROP) { newform = new DettagliBozzaProposta(); break fine; }
      if (FormIdx==MyGlb.FRM_BOZZEVARIAZI) { newform = new BozzeVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_INSAGGBOZVAR) { newform = new InserimentoAggiornamentoBozzeVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_PARCONDISRE1) { newform = new ParametriControlloDisponibilitaRep1(); break fine; }
      if (FormIdx==MyGlb.FRM_TOTALIBOZZA) { newform = new TotaliBozza(); break fine; }
      if (FormIdx==MyGlb.FRM_REPOCONTDIS1) { newform = new ReportControlloDisponibilita1(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTROQUADRA) { newform = new ControlloQuadratura(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENVARIBOZZ) { newform = new ElencoVariazioniBozza(); break fine; }
      if (FormIdx==MyGlb.FRM_PARELEPRSOAN) { newform = new ParametriElencoProposteSospeseAnnullate(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEPROSOSANN) { newform = new ElencoProposteSospeseAnnullate(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGITIPOVARI) { newform = new AggiornamentoTipoVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIOBILAPEG) { newform = new AggiornamentoBilancioPEG(); break fine; }
      if (FormIdx==MyGlb.FRM_SPOSSUDIVBOZ) { newform = new SpostamentoSuDiversaBozza(); break fine; }
      if (FormIdx==MyGlb.FRM_ASSOBOZZAVAR) { newform = new AssociazioneBozzaAVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_DISSBOZDAVAR) { newform = new DissociazioneBozzaDaVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUAZPROPOS) { newform = new SituazioneProposte(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTAGPROPOS) { newform = new DettagliProposta(); break fine; }
      if (FormIdx==MyGlb.FRM_SOLLCHIUPROP) { newform = new SollecitoChiusuraProposta(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIABILAPEG) { newform = new VariazioniBilancioPEG(); break fine; }
      if (FormIdx==MyGlb.FRM_DEVADAVABIPE) { newform = new DettagliVariazioneDaVariazioniBilancioPeg(); break fine; }
      if (FormIdx==MyGlb.FRM_GENEVARIPROV) { newform = new GenerazioneVariazioniProvvisorie(); break fine; }
      if (FormIdx==MyGlb.FRM_PARAALLEVARI) { newform = new ParametriAllegatoVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_REPOALLEVARI) { newform = new ReportAllegatoVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENVARIGENE) { newform = new ElencoVariazioniGenerate(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMVARIPROV) { newform = new EliminazioneVariazioniProvvisorie(); break fine; }
      if (FormIdx==MyGlb.FRM_INSUVOBIPEVA) { newform = new InfoSuVoceBilancioPerVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUPROGVARI) { newform = new SituazioneProgettoVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUOBIEVARI) { newform = new SituazioneObiettivoVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_INFFINPERVAR) { newform = new InformazioniFinanziamentoPerVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_INFSULOPPEVA) { newform = new InformazioniSullOperaPerVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_STORICSCHEDA) { newform = new StoricoScheda(); break fine; }
      if (FormIdx==MyGlb.FRM_STORICOFASE) { newform = new StoricoFase(); break fine; }
      if (FormIdx==MyGlb.FRM_STAVAPEGPEOB) { newform = new StampaVariazioniPEGPerObiettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_SPECDIGITEST) { newform = new SpecialDigitaTesto(); break fine; }
      if (FormIdx==MyGlb.FRM_ASSESTAMENTI) { newform = new Assestamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_ALLEGAVARIAZ) { newform = new AllegatoVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_COMPOSVARIAZ) { newform = new ComposizioneVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_COMPOVARIFPV) { newform = new ComposizioneVariazioniFPV(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTQUADPLU1) { newform = new ControlloQuadraturaPluriennali(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTRVARPROV) { newform = new ControlloVarProvvisorie(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOVARIAZ) { newform = new ElencoVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENVARICAPI) { newform = new ElencoVariazioniCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_REISCDAIMPEG) { newform = new ReiscrizioniDaImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIEQUDIBIL) { newform = new VariazioniEquilibriDiBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAPERFINA) { newform = new VariazioniPerFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAPERPROG) { newform = new VariazioniPerProgetto(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAPERESIG) { newform = new VariazioniPerEsigibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTQUADPLUR) { newform = new ControlloQuadraturaPluri(); break fine; }
      if (FormIdx==MyGlb.FRM_VARESICOCOAN) { newform = new VariazioniEsigConsCorrAntic(); break fine; }
      if (FormIdx==MyGlb.FRM_GENVARPEESCO) { newform = new GenerazioneVariazioniPerEsigConsuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMIVARESIG) { newform = new EliminazioneVarEsig(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIESIDIENT) { newform = new VariazioniEsigDiEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_GENVARESIENT) { newform = new GenerazioneVariazioniEsigEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGITIPOAVA1) { newform = new AggiornamentoTipoAvanzo(); break fine; }
      if (FormIdx==MyGlb.FRM_VARPERTIPAVA) { newform = new VariazioniPerTipoAvanzo(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGITIPOAVAN) { newform = new AggiornaTipoAvanzo(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGTIPAVSUMO) { newform = new AggiornaTipoAvanzoSuMovimentazione(); break fine; }
      if (FormIdx==MyGlb.FRM_GESTIOAVANZO) { newform = new GestioneAvanzo(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMGESTAVAN) { newform = new StampaGestioneAvanzo(); break fine; }
      if (FormIdx==MyGlb.FRM_SALDTIPIAVAN) { newform = new SaldiTipiAvanzo(); break fine; }
      if (FormIdx==MyGlb.FRM_PARAAVANESER) { newform = new ParametriAvanzoEsercizio(); break fine; }
      if (FormIdx==MyGlb.FRM_AVANZOESERCI) { newform = new AvanzoEsercizio(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTAGAVANZO) { newform = new DettagliAvanzo(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUAZGENERA) { newform = new SituazioneGenerale(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUAZDODICE) { newform = new SituazioneDodicesimi(); break fine; }
      if (FormIdx==MyGlb.FRM_SITPERPRISEM) { newform = new SituazionePercentualePrimoSemestre(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUAPERCLAS) { newform = new SituazionePerClassificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SITGENPEUNOR) { newform = new SituazioneGeneralePerUnitaOrganizzativa(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUTIPDISPE) { newform = new SituazioneTipologiaDiSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_SITCAPPECAFI) { newform = new SitCapitoliPerCategorieFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_SICAPEFOFIUO) { newform = new SitCapitoliPerFontiFinanziamentoUO(); break fine; }
      if (FormIdx==MyGlb.FRM_SITPERCLAMIS) { newform = new SituazioniPerClassificazioniMissioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SITPECLMIEMA) { newform = new SituazioniPerClassificazioniMissioniEMacro(); break fine; }
      if (FormIdx==MyGlb.FRM_SITPERCLTITI) { newform = new SituazioniPerClassificazioniTitoloTipologia(); break fine; }
      if (FormIdx==MyGlb.FRM_SITPERCLAMAC) { newform = new SituazioniPerClassificazioniMacroaggregato(); break fine; }
      if (FormIdx==MyGlb.FRM_SITPERALTCLA) { newform = new SituazioniPerAltreClassificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_CASSA) { newform = new Cassa(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENIMPECASS) { newform = new ElencoImpegniCassa(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENACCECASS) { newform = new ElencoAccertamentiCassa(); break fine; }
      if (FormIdx==MyGlb.FRM_DATICERTIFIC) { newform = new DatiCertificato(); break fine; }
      if (FormIdx==MyGlb.FRM_CERTIFICATO) { newform = new Certificato(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCODIMANC) { newform = new ElencoCodiciMancanti(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRAZIOBDAP) { newform = new EstrazioniBDAP(); break fine; }
      if (FormIdx==MyGlb.FRM_GESTIONEBDAP) { newform = new GestioneBDAP(); break fine; }
      if (FormIdx==MyGlb.FRM_DATCONANAREN) { newform = new DatiContabiliAnaliticiRendiconto(); break fine; }
      if (FormIdx==MyGlb.FRM_DATCONANAPRE) { newform = new DatiContabiliAnaliticiPrevisione(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEMDIBILAN) { newform = new SchemiDiBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPEGNO) { newform = new Impegno(); break fine; }
      if (FormIdx==MyGlb.FRM_FORMVARIAZIO) { newform = new FormVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_MOVIMVINCIMP) { newform = new MovimentiVincoloImp(); break fine; }
      if (FormIdx==MyGlb.FRM_MOVIMVINCACC) { newform = new MovimentiVincoloAcc(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUAZVINCOL) { newform = new SituazioneVincolo(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELIMPEORES) { newform = new SceltaImpegnoOResiduo(); break fine; }
      if (FormIdx==MyGlb.FRM_SUBIMPEGNO) { newform = new SubImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_FORMVARISUBI) { newform = new FormVariazioniSubimp(); break fine; }
      if (FormIdx==MyGlb.FRM_FINANZSUBIMP) { newform = new FinanziamentiSubimp(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORMIMPEGN) { newform = new InformazioniImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOVARIIMPE) { newform = new InfoVariazioniImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORMFINANZ) { newform = new InformazioneFinanziamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORMPLURIE) { newform = new InformazioniPluriennali(); break fine; }
      if (FormIdx==MyGlb.FRM_DDISPONIMONO) { newform = new DDisponibilitaMono(); break fine; }
      if (FormIdx==MyGlb.FRM_CF4WIMPSDISP) { newform = new CF4WEBIMPSUBDISPONIBILITA(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINIDISPOS) { newform = new OrdiniDisposizioni(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORSUBIMPE) { newform = new InformazioniSubImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_INFFINSUBIMP) { newform = new InformazioniFinanziamentiSubImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_GENIMPPERECO) { newform = new GenerazioneImpegniPerEconomato(); break fine; }
      if (FormIdx==MyGlb.FRM_GENEIMPDAESI) { newform = new GenerazioneImpegniDaEsigibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_PARGENIMDAES) { newform = new ParametriGenerazioneImpegniDaEsigibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEANOIMPREI) { newform = new ElencoAnomalieImpegniReiscritti(); break fine; }
      if (FormIdx==MyGlb.FRM_GENEIMPDACRO) { newform = new GenerazioneImpegniDaCronoprogramma(); break fine; }
      if (FormIdx==MyGlb.FRM_PARGENIMDACR) { newform = new ParametriGenerazioneImpegniDaCronoprogramma(); break fine; }
      if (FormIdx==MyGlb.FRM_GEVAIMDACDVB) { newform = new GenerazioneVariazioniImpegniDaCronoDaVarBil(); break fine; }
      if (FormIdx==MyGlb.FRM_LANGENVARCRO) { newform = new LanciaGeneraVarimpCrono(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENIMPEREIS) { newform = new ElencoImpegniReiscritti(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFIOPERA) { newform = new RettificaOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTICAPIIMP) { newform = new RettificaCapitoloImp(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNAIMPEGN) { newform = new GiornaleImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEDAINCARI) { newform = new SchedaIncarichi(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZIMPEGN) { newform = new VariazioniImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_INCARIIMPEGN) { newform = new IncarichiImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPEAUTODISP) { newform = new ImpegnoAutomaticoDisponibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSIIMPEGN) { newform = new EmissioneImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_STORIAIMPEGN) { newform = new StoriaImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMSTORIMPE) { newform = new StampaStoriaImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_STORIASUBIMP) { newform = new StoriaSubimpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_FINANZIAMEN1) { newform = new Finanziamenti1(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZSUBIMP) { newform = new VariazioniSubimpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELVOCEECON) { newform = new SceltaVoceEcon(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCERTAMENTI) { newform = new Accertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZIONACC) { newform = new VariazioniAcc(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOACCEFORM) { newform = new InfoAccertamentiForm(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOPLURIENN) { newform = new InfoPluriennali(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOOPERE) { newform = new InfoOpere(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEACCPEFUAC) { newform = new SceltaAccertamentiPerFunzioniAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFFINANZ) { newform = new RettificaFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFCAPITO) { newform = new RettificaCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNAACCERT) { newform = new GiornaleAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZACCERT) { newform = new VariazioniAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_OPERE1) { newform = new Opere1(); break fine; }
      if (FormIdx==MyGlb.FRM_GENEACCDAESI) { newform = new GenerazioneAccertamentiDaEsigibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_PARGENACDAES) { newform = new ParametriGenerazioneAccertamentiDaEsigibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEANOACCREI) { newform = new ElencoAnomalieAccertamentiReiscritti(); break fine; }
      if (FormIdx==MyGlb.FRM_PERIODRIACCE) { newform = new PeriodiRiaccertamento(); break fine; }
      if (FormIdx==MyGlb.FRM_PROVARIMPSUB) { newform = new ProposteVariazioniImpegniSubimpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIVALOCOM1) { newform = new AggiornaValoriComuni(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENPROPMODI) { newform = new ElencoProposteModificate(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIMPRADASU) { newform = new AggiornaImportoRagDaSubimpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_GENVARPROVAR) { newform = new GenerazioneVariazioniProposteVar(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMINVARIAZ) { newform = new EliminazioneVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_PROPODASUBIM) { newform = new ProposteDaSubimpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMALLEPROP) { newform = new StampaAllegatoProposta(); break fine; }
      if (FormIdx==MyGlb.FRM_CHIUSUORDINI) { newform = new ChiusuraOrdini(); break fine; }
      if (FormIdx==MyGlb.FRM_CHIUMASSORDI) { newform = new ChiusuraMassivaOrdini(); break fine; }
      if (FormIdx==MyGlb.FRM_SITPROVARRIA) { newform = new SituazioneProposteVariazioniRiacc(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRAZPROPOS) { newform = new EstrazioneProposte(); break fine; }
      if (FormIdx==MyGlb.FRM_PARDIFIMPSUB) { newform = new ParametriDifferenzeImpegniSubimpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_DIFFIMPESUBI) { newform = new DifferenzeImpegniSubimpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTALIQUID) { newform = new SceltaLiquidazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIDAZIONE) { newform = new Liquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGVALCOMLIQ) { newform = new AggiornamentoValoriComuniLiq(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOLIQUIDAZ) { newform = new InfoLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMLIQINDIS) { newform = new EliminaLiquidazioniInDistinta(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTGRUPLIQU) { newform = new DettagliGruppoLiquidazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSLIQULIQ) { newform = new EmissioneLiquidazioniLiq(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTRDISPLIQ) { newform = new ControlloDisponibilitaLiq(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPCONDINEGR) { newform = new CapitoliConDisponibilitaNegativaGRL(); break fine; }
      if (FormIdx==MyGlb.FRM_CACODINEDAAL) { newform = new CapitoliConDisponibilitaNegativaDALAL(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPCONDINECG) { newform = new CapitoliConDisponibilitaNegativaCG4(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPCONDINEIM) { newform = new CapitoliConDisponibilitaNegativaImputazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_CACODINELIIE) { newform = new CapitoliConDisponibilitaNegativaLiqInEmissione(); break fine; }
      if (FormIdx==MyGlb.FRM_CACODINEDIOR) { newform = new CapitoliConDisponibilitaNegativaDistOrdini(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTROIMPUTA) { newform = new ControlloImputazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTDISPPURO) { newform = new ControlloDispoPuro(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIAUTOIMPE) { newform = new AggiornamentoAutomaticoImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRAIMPULIQ) { newform = new EstrazioneImputazioniLiq(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUVERSRITE) { newform = new LiquidazioneVersamentoRitenute(); break fine; }
      if (FormIdx==MyGlb.FRM_FORMRETTIMPE) { newform = new FormRettificaImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFSUBIMP) { newform = new RettificaSubimpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNALIQUID) { newform = new GiornaleLiquidazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQPERPRODEL) { newform = new LiquidazioniPerPropostaDelibera(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUDADISECO) { newform = new LiquidazioniDaDistintaEconomato(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTDISPFULI) { newform = new ControlloDisponibilitaFuli(); break fine; }
      if (FormIdx==MyGlb.FRM_DISTIDILIQUI) { newform = new DistinteDiLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_EMILIQDISECO) { newform = new EmissioneLiquidazioniDistEco(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTCONTDIST) { newform = new ControlloContabileDistinta(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSILIQUID) { newform = new EmissioneLiquidazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIVALOCOMU) { newform = new AggiornamentoValoriComuni(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUPARZDIST) { newform = new LiquidazioneParzialeDistinta(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQDISCASECO) { newform = new LiquidazioneDistintaCassaEconomale(); break fine; }
      if (FormIdx==MyGlb.FRM_SCDIDIRICAEC) { newform = new SceltaDistinteDiRimborsoCassaEconomale(); break fine; }
      if (FormIdx==MyGlb.FRM_EMILIQCASECO) { newform = new EmissioneLiquidazioniCassaEco(); break fine; }
      if (FormIdx==MyGlb.FRM_FASE1ESTRLIQ) { newform = new Fase1EstremiLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_FAS2ALTDATLI) { newform = new Fase2AltriDatiLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_FAS3FATDALIQ) { newform = new Fase3FattureDaLiquidare(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTRSOGGLIQ) { newform = new ControlloSoggettiLiq(); break fine; }
      if (FormIdx==MyGlb.FRM_CARICSOGGLIQ) { newform = new CaricamentoSoggettiLiq(); break fine; }
      if (FormIdx==MyGlb.FRM_EMLIIVPERECH) { newform = new EmissioneLiqIVAPerReverseCharge(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSLIQUIRC) { newform = new EmissioneLiquidazioniRC(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMPADISTIN) { newform = new StampaDistinte(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUORDIAGRU) { newform = new LiquidazioniOrdinativiAGruppi(); break fine; }
      if (FormIdx==MyGlb.FRM_DISPOPUROORD) { newform = new DisponibilitaPuroOrd(); break fine; }
      if (FormIdx==MyGlb.FRM_DUPLICGRUPPO) { newform = new DuplicaGruppo(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGVALCOORLI) { newform = new AggiornamentoValoriComuniOrdLiq(); break fine; }
      if (FormIdx==MyGlb.FRM_MOVIMEAGRUPP) { newform = new MovimentiAGruppi(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTGRUPMOVI) { newform = new DettagliGruppoMovimenti(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSIMOVIME) { newform = new EmissioneMovimenti(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGVALCOMMOV) { newform = new AggiornamentoValoriComuniMov(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPDAFILSUGR) { newform = new ImportDaFileSuGruppo(); break fine; }
      if (FormIdx==MyGlb.FRM_MANDATI) { newform = new Mandati(); break fine; }
      if (FormIdx==MyGlb.FRM_PAGAMEMANDAT) { newform = new PagamentiMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_PAGMANPERFLU) { newform = new PagamentiMandatiPerFlusso(); break fine; }
      if (FormIdx==MyGlb.FRM_NUOVIPAGAMEN) { newform = new NuoviPagamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORMMANDAT) { newform = new InformazioneMandato(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOPAGAMAND) { newform = new InfoPagamentiMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISAUTOMAND) { newform = new EmissioneAutomaticaMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTROANTICI) { newform = new ControlloAnticipazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTCODIGEST) { newform = new ControlloCodiciGestionali(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTROEQUITA) { newform = new ControlloEquitalia(); break fine; }
      if (FormIdx==MyGlb.FRM_CONCODTRAEL1) { newform = new ControlloCodiciTransazioneElementare(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTQUIESCAD) { newform = new ControlloQuietanzeScadute(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISMANUDIST) { newform = new EmissioneManualeDistinta(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENMANINDIS) { newform = new ElencoMandatiInDistinta(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQDAEMEINMA) { newform = new LiquidazioniDaEmettereInMandato(); break fine; }
      if (FormIdx==MyGlb.FRM_AVVISDIPAGAM) { newform = new AvvisiDiPagamento(); break fine; }
      if (FormIdx==MyGlb.FRM_CONFAVVDIPAG) { newform = new ConfermaAvvisiDiPagamento(); break fine; }
      if (FormIdx==MyGlb.FRM_CONAVVDIPAAN) { newform = new ConfermaAvvisiDiPagamentoAncona(); break fine; }
      if (FormIdx==MyGlb.FRM_ANNULLPAGAME) { newform = new AnnullaPagamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_PAGAMECOMPLE) { newform = new PagamentoCompleto(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIMPDIMAN) { newform = new RettificaImpegnoDiMandato(); break fine; }
      if (FormIdx==MyGlb.FRM_RETSUBIMDIMA) { newform = new RettificaSubImpegnoDiMandato(); break fine; }
      if (FormIdx==MyGlb.FRM_RIEMINONPAGA) { newform = new RiemissioneNonPagati(); break fine; }
      if (FormIdx==MyGlb.FRM_DISTDITRAMAN) { newform = new DistinteDiTrasmissioneMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNAMANDAT) { newform = new GiornaleMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNAPAGAME) { newform = new GiornalePagamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_MAEMSUCARIIV) { newform = new MandatiEmessiSuCapRilIva(); break fine; }
      if (FormIdx==MyGlb.FRM_INCARICHI) { newform = new Incarichi(); break fine; }
      if (FormIdx==MyGlb.FRM_MANDANONPAGA) { newform = new MandatiNonPagati(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMPAMANDAT) { newform = new StampaMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAAIMANDA) { newform = new VariazioniAiMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_TRASMANDATES) { newform = new TrasmissioneMandatiATesoreria(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISMANUMAND) { newform = new EmissioneManualeMandato(); break fine; }
      if (FormIdx==MyGlb.FRM_RITENUFISCAL) { newform = new RitenuteFiscali(); break fine; }
      if (FormIdx==MyGlb.FRM_RITENPERADDI) { newform = new RitenutePerAddizionale(); break fine; }
      if (FormIdx==MyGlb.FRM_DISTRITEFISC) { newform = new DistintaRitenuteFiscali(); break fine; }
      if (FormIdx==MyGlb.FRM_DISRITPERADD) { newform = new DistintaRitenutePerAddizionale(); break fine; }
      if (FormIdx==MyGlb.FRM_CERTSOSDIIMP) { newform = new CertificatiSostitutiDiImposta(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTROQUADRI) { newform = new ControlloQuadri(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTRIMINIMI) { newform = new ContribuentiMinimi(); break fine; }
      if (FormIdx==MyGlb.FRM_ERRBLOCON770) { newform = new ErroriBloccantiControllo770(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRAZION770) { newform = new Estrazione770(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRAZIONECU) { newform = new EstrazioneCU(); break fine; }
      if (FormIdx==MyGlb.FRM_RITENUTEIRAP) { newform = new RitenuteIrap(); break fine; }
      if (FormIdx==MyGlb.FRM_RITENUPREVID) { newform = new RitenutePrevidenziali(); break fine; }
      if (FormIdx==MyGlb.FRM_RITENUTINAIL) { newform = new RitenuteInail(); break fine; }
      if (FormIdx==MyGlb.FRM_CONINVSOSIMP) { newform = new ConfermaInvioSostitutiImposta(); break fine; }
      if (FormIdx==MyGlb.FRM_MANPERVEIVIS) { newform = new MandatiPerVersIVAIstituzionale(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEEMIMACAEC) { newform = new ElencoEmissMandatiCassaEconomale(); break fine; }
      if (FormIdx==MyGlb.FRM_EMIMANCASECO) { newform = new EmissMandatiCassaEconomale(); break fine; }
      if (FormIdx==MyGlb.FRM_ELLICOIMIIDV) { newform = new ElencoLiquidazioniConImportoIvaIstDaValorizzare(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIPROVMAND) { newform = new AggiornamentoProvvisoriMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_CONDISPROMAN) { newform = new ControlloDisponibilitaProvMan(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISMANDAPRO) { newform = new EmissioneMandatiDaProvvisori(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGAUTMANPRO) { newform = new AggiornamentoAutomaticoMandatiProvv(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELMANDPROV) { newform = new SceltaMandatiProvvisori(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINACOLLEG) { newform = new OrdinativiCollegati(); break fine; }
      if (FormIdx==MyGlb.FRM_FORMORDINATI) { newform = new FormOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINATIVO) { newform = new Ordinativo(); break fine; }
      if (FormIdx==MyGlb.FRM_INCASSI) { newform = new Incassi(); break fine; }
      if (FormIdx==MyGlb.FRM_INCASPERFLUS) { newform = new IncassiPerFlusso(); break fine; }
      if (FormIdx==MyGlb.FRM_NUOVIINCASSI) { newform = new NuoviIncassi(); break fine; }
      if (FormIdx==MyGlb.FRM_NUOORDCOACAU) { newform = new NuovoOrdinativoConAccAutomatico(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTGRUPORDI) { newform = new DettagliGruppoOrdinativo(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSORDIORD) { newform = new EmissioneOrdinativiOrd(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTRDISPORD) { newform = new ControlloDisponibilitaOrd(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIPROVORDI) { newform = new AggiornamentoProvvisoriOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISORDDAPRO) { newform = new EmissioneOrdinativiDaProvvisori(); break fine; }
      if (FormIdx==MyGlb.FRM_CONDISPROORD) { newform = new ControlloDisponibilitaProvOrd(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIORAUTOMA) { newform = new AggiornamentoAutomatico(); break fine; }
      if (FormIdx==MyGlb.FRM_PROVVDAREGOL) { newform = new ProvvisoriDaRegolarizzare(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIAUTOACCE1) { newform = new AggiornamentoAutomaticoAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMPAORDINA) { newform = new StampaOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_AVVISDIRISCO) { newform = new AvvisiDiRiscossione(); break fine; }
      if (FormIdx==MyGlb.FRM_DISTDITRAORD) { newform = new DistintaDiTrasmissioneOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTCODIGES1) { newform = new ControlloCodiciGestionali1(); break fine; }
      if (FormIdx==MyGlb.FRM_CONCODTRAELE) { newform = new ControlloCodiciTransElementare(); break fine; }
      if (FormIdx==MyGlb.FRM_INCASSCOMPLE) { newform = new IncassoCompleto(); break fine; }
      if (FormIdx==MyGlb.FRM_ANNULLINCASS) { newform = new AnnullaIncassi(); break fine; }
      if (FormIdx==MyGlb.FRM_RIEORDNONINC) { newform = new RiemissioneOrdinativiNonIncassati(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFACCERT) { newform = new RettificaAccertamento(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINDARITEN) { newform = new OrdinativiDaRitenute(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDPERSPLPAY) { newform = new OrdinativiPerSplitPayment(); break fine; }
      if (FormIdx==MyGlb.FRM_VERIFIORDINA) { newform = new VerificaOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINDACORRI) { newform = new OrdinativiDaCorrispettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINDAIMPUT) { newform = new OrdinativiDaImputazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSIORDINA) { newform = new EmissioneOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDDADISCAEC) { newform = new OrdinativiDaDistintaCassaEconomale(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEDISVECAEC) { newform = new SceltaDistinteVersamentoCassaEconomale(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISORDDADIS) { newform = new EmissioneOrdinativiDaDistinta(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNAORDINA) { newform = new GiornaleOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNAINCASS) { newform = new GiornaleIncassi(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINNONINCA) { newform = new OrdinativiNonIncassati(); break fine; }
      if (FormIdx==MyGlb.FRM_SOLLEDIRISCO) { newform = new SollecitiDiRiscossione(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZORDINA) { newform = new VariazioniOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_TRASORDIATES) { newform = new TrasmissioneOrdinativiATesoreria(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRAZIMPUTA1) { newform = new EstrazioneImputazioniOrd(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRATTOCCP) { newform = new EstrattoCCP(); break fine; }
      if (FormIdx==MyGlb.FRM_MANCOLPERCOM) { newform = new MandatiCollegatiPerCompensazione(); break fine; }
      if (FormIdx==MyGlb.FRM_FLUSMANDREVE) { newform = new FlussiMandatiReversali(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNDICASSA) { newform = new GiornaleDiCassa(); break fine; }
      if (FormIdx==MyGlb.FRM_ANNULLMANDAT) { newform = new AnnulliMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZMANDAT) { newform = new VariazioniMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_SOSTITMANDAT) { newform = new SostituzioniMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_CAMDISTANOIN) { newform = new CambiDiStatoNonInviati(); break fine; }
      if (FormIdx==MyGlb.FRM_CERCA) { newform = new Cerca(); break fine; }
      if (FormIdx==MyGlb.FRM_ANNULLIORD) { newform = new AnnulliOrd(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZIONORD) { newform = new VariazioniOrd(); break fine; }
      if (FormIdx==MyGlb.FRM_SOSTITUZIORD) { newform = new SostituzioniOrd(); break fine; }
      if (FormIdx==MyGlb.FRM_CAMDISTNOIN1) { newform = new CambiDiStatoNonInviati1(); break fine; }
      if (FormIdx==MyGlb.FRM_CERCA1) { newform = new Cerca1(); break fine; }
      if (FormIdx==MyGlb.FRM_INVMANEORDIN) { newform = new InvioMandatoEOrdinativoInformatico(); break fine; }
      if (FormIdx==MyGlb.FRM_ANOMALIINVIO) { newform = new AnomalieInvio(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMINAZIONE) { newform = new Eliminazione(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTIPOELIM) { newform = new SceltaTipoEliminazione(); break fine; }
      if (FormIdx==MyGlb.FRM_RICPAGINDATE) { newform = new RicezionePagamentiIncassiDaTesoreria(); break fine; }
      if (FormIdx==MyGlb.FRM_REPORTERRORI) { newform = new ReportErrori(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENERROAUTO) { newform = new ElencoErroriAuto(); break fine; }
      if (FormIdx==MyGlb.FRM_CARICAPROVVI) { newform = new CaricamentoProvvisori(); break fine; }
      if (FormIdx==MyGlb.FRM_CARICAIMPUTA) { newform = new CaricamentoImputazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_BILANDIENTRA) { newform = new BilancioDiEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_BILANDISPESA) { newform = new BilancioDiSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_PROGETENTRAT) { newform = new ProgettiEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_PROGETTSPESA) { newform = new ProgettiSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZENTRAT) { newform = new VariazioniEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZISPESA) { newform = new VariazioniSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_BILSORMEZUNI) { newform = new BilancioSorboloMezzaniUnione(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPEGNACCERT) { newform = new ImpegniAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_MANDATORDINA) { newform = new MandatiOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCERPERCLAS) { newform = new AccertamentiPerClassificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCERPERDEBI) { newform = new AccertamentiPerDebitore(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCPERIMPECO) { newform = new AccertamentiPerImputazioneEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCERPERCAPI) { newform = new AccertamentiPerCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPEGPERCLAS) { newform = new ImpegniPerClassificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPEGPERBENE) { newform = new ImpegniPerBeneficiario(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPPERIMPECO) { newform = new ImpegniPerImputazioneEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPEGPERCAPI) { newform = new ImpegniPerCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_SUBIMPERCLAS) { newform = new SubimpegniPerClassificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SUBIMPERBENE) { newform = new SubimpegniPerBeneficiario(); break fine; }
      if (FormIdx==MyGlb.FRM_SUBPERIMPECO) { newform = new SubimpegniPerImputazioneEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_SUBIMPERCAPI) { newform = new SubimpegniPerCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIPERCLAS) { newform = new LiquidazioniPerClassificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIPERBENE) { newform = new LiquidazioniPerBeneficiario(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQPERCODITE) { newform = new LiquidazionePerContabileDiTesoreria(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIPERIMPE) { newform = new LiquidazioniPerImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIPERSUBI) { newform = new LiquidazioniPerSubimpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQPERIMPECO) { newform = new LiquidazioniPerImputazioneEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINPERCLAS) { newform = new OrdinativiPerClassificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINPERDEBI) { newform = new OrdinativiPerDebitore(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDPERCODITE) { newform = new OrdinativiPerContabileDiTesoreria(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINPERACCE) { newform = new OrdinativiPerAccertamento(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDPERIMPECO) { newform = new OrdinativiPerImputazioneEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUAZICASSA) { newform = new SituazioneCassa(); break fine; }
      if (FormIdx==MyGlb.FRM_SITCASPERVIN) { newform = new SituazioneCassaPerVincolo(); break fine; }
      if (FormIdx==MyGlb.FRM_SALDIVINCOLI) { newform = new SaldiVincoli(); break fine; }
      if (FormIdx==MyGlb.FRM_PROSTRIDICAS) { newform = new ProspettoTrimestraleDiCassa(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNAVINCOL) { newform = new GiornaleVincoli(); break fine; }
      if (FormIdx==MyGlb.FRM_SINTEDICASSA) { newform = new SintesiDiCassa(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUAZCOMPET) { newform = new SituazioneCompetenza(); break fine; }
      if (FormIdx==MyGlb.FRM_MASTROMANDAT) { newform = new MastroMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_MASTROORDINA) { newform = new MastroOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_MASTROIMPEGN) { newform = new MastroImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_MASTROACCERT) { newform = new MastroAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_MASTROGENERA) { newform = new MastroGenerale(); break fine; }
      if (FormIdx==MyGlb.FRM_VOCIPATTO) { newform = new VociPatto(); break fine; }
      if (FormIdx==MyGlb.FRM_MONITORADATI) { newform = new MonitoraggioDati(); break fine; }
      if (FormIdx==MyGlb.FRM_REPOMONIDATI) { newform = new ReportMonitoraggioDati(); break fine; }
      if (FormIdx==MyGlb.FRM_MONITOPREVEN) { newform = new MonitoraggioPreventivo(); break fine; }
      if (FormIdx==MyGlb.FRM_REPOMONIPREV) { newform = new ReportMonitoraggioPreventivo(); break fine; }
      if (FormIdx==MyGlb.FRM_COMUVARDIBIL) { newform = new ComunicazioneVariazioniDiBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_COMVARDELFPV) { newform = new ComunicazioneVariazioniDelFPV(); break fine; }
      if (FormIdx==MyGlb.FRM_COMESEOGESPR) { newform = new ComunicazioneEsercizioOGestioneProvv(); break fine; }
      if (FormIdx==MyGlb.FRM_STANZCONRESI) { newform = new StanziamentiConResidui(); break fine; }
      if (FormIdx==MyGlb.FRM_COMUALTESRES) { newform = new ComunicazioneAlTesoriereResidui(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPLORCAPITO) { newform = new EsploratorePerCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPLOPERBILA) { newform = new EsploratorePerBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPEPIDECOIN) { newform = new EsploratorePerPianoDeiContiIntegrato(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPLPERVLIVE) { newform = new EsploratorePerVLivello(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPLOPERRESP) { newform = new EsploratorePerResponsabile(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPEREADUNDA) { newform = new EsploratorePerResponsabileAdUnaData(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPPERCEDICO) { newform = new EsploratorePerCentroDiCosto(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPPERBENDEB) { newform = new EsploratorePerBenDeb(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPLOPERDELI) { newform = new EsploratorePerDelibera(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPLOPERMACR) { newform = new EsploratorePerMacroaggregati(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPPERUNGECA) { newform = new EsploratorePerUnitaGestioneCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPPERUNGEMA) { newform = new EsploratorePerUnitaGestioneMacroaggregati(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPPERRESMAC) { newform = new EsploratorePerResponsabileMacroaggregati(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPPERFINOP1) { newform = new EsploratorePerFinanziamentoOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPPERCAFIOP) { newform = new EsploratorePerCapitoloFinOpe(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPPERFINOPE) { newform = new EsploratorePerFinopeOpefin(); break fine; }
      if (FormIdx==MyGlb.FRM_STANBILAEFFE) { newform = new StanziamentoBilancioEffettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_STANBILASIMU) { newform = new StanziamentoBilancioSimulato(); break fine; }
      if (FormIdx==MyGlb.FRM_FINAVADIAMEF) { newform = new FinanziamentoAvanzoDiAmministrazioneEffettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_FINALTVOPEEF) { newform = new FinanziamentoAltreVociPegEffettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_FINAVADIAMSI) { newform = new FinanziamentoAvanzoDiAmministrazioneSimulato(); break fine; }
      if (FormIdx==MyGlb.FRM_FINALTVOPESI) { newform = new FinanziamentoAltreVociPegSimulato(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZBILANC) { newform = new VariazioniBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOACCERT) { newform = new ElencoAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCACCEFIN) { newform = new ElencoAccertamentiFin(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEACCFINOPE) { newform = new ElencoAccertamentiFinOpe(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOIMPEGN) { newform = new ElencoImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCIMPEOPE) { newform = new ElencoImpegniOpe(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEIMPFINOPE) { newform = new ElencoImpegniFinOpe(); break fine; }
      if (FormIdx==MyGlb.FRM_SITURESIENTR) { newform = new SituazioneResiduiEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_SITURESISPES) { newform = new SituazioneResiduiSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_CHIUAUTOPREN) { newform = new ChiusuraAutomaticaPrenotazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENLIQUESPL) { newform = new ElencoLiquidazioniEsploratore(); break fine; }
      if (FormIdx==MyGlb.FRM_PARAMPREVPEG) { newform = new ParametriPrevisioniPEG(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUAPREVPEG) { newform = new VisualizzazionePrevisioniPEG(); break fine; }
      if (FormIdx==MyGlb.FRM_PARAMSITUPEG) { newform = new ParametriSituazionePEG(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUASITUPEG) { newform = new VisualizzazioneSituazionePEG(); break fine; }
      if (FormIdx==MyGlb.FRM_PARASITUIMPE) { newform = new ParametriSituazioneImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUSITUIMPE) { newform = new VisualizzazioneSituazioneImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_PARSITSUBIMP) { newform = new ParametriSituazioneSubImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_VISSITSUBIMP) { newform = new VisualizzazioneSituazioneSubImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_PARASITUACCE) { newform = new ParametriSituazioneAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUSITUACCE) { newform = new VisualizzazioneSituazioneAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEDINFOBIL) { newform = new SchedaInformativaBil(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEDINFOMOV) { newform = new SchedaInformativaMov(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEDINFOLIQ) { newform = new SchedaInformativaLiq(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEDCOMPFPV) { newform = new SchedaComposizioneFPV(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHCOMFPVENT) { newform = new SchedaComposizioneFPVEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOVARICRON) { newform = new InfoVariazioneCrono(); break fine; }
      if (FormIdx==MyGlb.FRM_FINANZCRONOP) { newform = new FinanziamentiCronoprogramma(); break fine; }
      if (FormIdx==MyGlb.FRM_INFODISPPROV) { newform = new InfoDispProvv(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEINFOVARI) { newform = new SchedaInformazioniVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTADELPURO) { newform = new DettaglioDelPuro(); break fine; }
      if (FormIdx==MyGlb.FRM_PROPODAUFFIC) { newform = new ProposteDaUffici(); break fine; }
      if (FormIdx==MyGlb.FRM_TOTALIPROPOS) { newform = new TotaliProposta(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTRODISPON) { newform = new ControlloDisponibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTROQUADR1) { newform = new ControlloQuadratura1(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIVARIBILA) { newform = new AggiornamentoVariazioniBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_GENERAVARIAZ) { newform = new GenerazioneVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMVARIGENE) { newform = new EliminazioneVariazioniGenerate(); break fine; }
      if (FormIdx==MyGlb.FRM_DATIBENEFICI) { newform = new DatiBeneficiario(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTOCONSUNT) { newform = new ContoConsuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEANOCODDL7) { newform = new ElencoAnomalieCodiciDL77(); break fine; }
      if (FormIdx==MyGlb.FRM_QUARIADELGES) { newform = new QuadroRiassuntivoDellaGestione(); break fine; }
      if (FormIdx==MyGlb.FRM_AVANZDIAMMIN) { newform = new AvanzoDiAmministrazione(); break fine; }
      if (FormIdx==MyGlb.FRM_PEGCONSUNTIV) { newform = new PEGConsuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_ESDAPECODECO) { newform = new EstrazioneDatiPerCorteDeiConti(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMPEDIRIGE) { newform = new StampeDirigenziali(); break fine; }
      if (FormIdx==MyGlb.FRM_CFAMEST) { newform = new MenuStampe(); break fine; }
      if (FormIdx==MyGlb.FRM_RICLASCAPITO) { newform = new RiclassificazioniCapitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_MOVIMENTAZIO) { newform = new Movimentazione(); break fine; }
      if (FormIdx==MyGlb.FRM_BONLIV5CODEU) { newform = new BonificaLivello5CodEuropeo(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIORLIVEL5) { newform = new AggiornamentoLivello5(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIOCODEURO) { newform = new AggiornamentoCodEuropeo(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPCONCLADIV) { newform = new CapitoliConClasifDiverse(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPITCONANOM) { newform = new CapitoliConAnomalie(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOGENEAPPL) { newform = new InformazioniGeneraliApplicazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_VERIBASEDATI) { newform = new VerificaBaseDati(); break fine; }
      if (FormIdx==MyGlb.FRM_PERSONALIZZA) { newform = new Personalizzazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_REGISTRO) { newform = new Registro(); break fine; }
      if (FormIdx==MyGlb.FRM_APPLICINTEGR) { newform = new ApplicativiIntegrati(); break fine; }
      if (FormIdx==MyGlb.FRM_VALIDAZIFILE) { newform = new ValidazioneFile(); break fine; }
      if (FormIdx==MyGlb.FRM_CONSOLERRORI) { newform = new ConsolleErrori(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMPCONPARA) { newform = new StampaConParametri(); break fine; }
      if (FormIdx==MyGlb.FRM_ALBEROESTRAZ) { newform = new AlberoEstrazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUMODIESTR) { newform = new VisualizzaModificaEstrazione(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPORTAZDATI) { newform = new EsportazioneDati(); break fine; }
      if (FormIdx==MyGlb.FRM_ANTEPRIMDATI) { newform = new AnteprimaDati(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCODOCUME) { newform = new ElencoDocumenti(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUALESTRAZ) { newform = new VisualizzatoreEstrazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_CATEGORIE) { newform = new Categorie(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPORTESTRAZ) { newform = new ImportaEstrazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUALSELECT) { newform = new VisualizzaSelect(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUDESCIMPO) { newform = new VisualizzaDescrizioneImport(); break fine; }
      if (FormIdx==MyGlb.FRM_STATISTICHE) { newform = new Statistiche(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUASELELOG) { newform = new VisualizzaSelectLog(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUINFOQUER) { newform = new VisualizzaInfoQuery(); break fine; }
      if (FormIdx==MyGlb.FRM_STAPREPERCAP) { newform = new StampePrevisionePerCapitolo(); break fine; }
    }
    if (newform != null)
      set_ActiveForm(newform);
    //
    ActiveForm().ActivedTick = ClickCounter() + 1;
    StackForm.addFirst(ActiveForm()); 
    ActiveForm().Owner = Owner;
    //
    // Inizializzo il testo del back-button
    if (parentF != null && parentF.OpenAs == Glb.OPEN_MDI && OpenAs == Glb.OPEN_MDI && !ActiveForm().Docked)
      ActiveForm().set_BackButTxt(parentF.Caption().stringValue());
    //
    if (ParamsObj().TruePopup && UseRD)
    {
      if (OpenAs!=0 && IEVer>=600)
      {
        // Se avevo già programmato la chiusura della stessa form, la annullo... la vecchia
        // form verrà sostituita da questa. Altrimenti programmo l'apertura.
        // Sempre che la modale non sia stata chiusa in malomodo... in quel caso... devo
        // aprirne una nuova!
        if (RDClosePopup && !RDPopupClosedForcibly && FormIdx==ClosingForm)
          RDClosePopup = false;
        else
          RDOpenPopup = true;
      }
      //
      // Se c'era già una chiusura in corso di una popup e la nuova form
      // che è stata aperta non è una popup, aspetto a chiudere la modale
      if (RDClosePopup)
        RDDelayPopup = true;
    }
    //
    ActiveForm().OpenAs = OpenAs;
    //
    WebForm oldActiveForm = ActiveForm();
    ActiveForm().Init(this, false, false);
    //
    // Se il programmatore non ha già definito il testo del back button da sè:
    // su smartphone mostro il back-button anche nel caso di modali con closeonselection 
    // (per poterle chiudere senza selezione) solo se la videata non mostra la sua caption 
    // ma quella del pannello (se lo fa i bottoni X e V sono già presenti nella toolbar della videata)
    if (ActiveForm() != null && ActiveForm().BackButTxt().length() == 0 && parentF != null && OpenAs == Glb.OPEN_MODAL && IsSmartPhone() && ActiveForm().CloseOnSelection && ActiveForm().VisualFlag(Glb.FORMVISPROP_HASCAPTION) == 0)
      ActiveForm().set_BackButTxt(parentF.Caption().stringValue());
    //
    // Se è cambiata la form attiva può essere successo che è stata chiusa la videata appena aperta...
    if (oldActiveForm != ActiveForm())
    {
      // Se la vecchia form, quella appena aperta, è ancora nello stack form... devo proseguire
      boolean flIsStillOpen = false;
      ListIterator i = StackForm.listIterator();
      while (i.hasNext())
      {
        if ((WebForm)i.next() == oldActiveForm)
        {
          flIsStillOpen = true;
          break;
        }
      }
      //
      // Se è stata chiusa... non devo proseguire!
      if (!flIsStillOpen)
        return;
    }
    //
    // Proseguo... informo l'RD3 che deve aprire questa form
    RD3Event ev = RD3AddEvent("open","frm:"+FormIdx);
    if (OpenAs!=0)
      ev.SetAttribute("openas", Integer.toString(OpenAs));
    //
    // Se è cambiata l'ActiveForm, allora potrebbe essere successo che nell'evento di OnLoad:
    // 1) è stata aperta o attivata un'altra form
    // 2) la form è stata resa invisibile
    // 3) la form è stata chiusa
    // In questo caso attivo la vecchia form, se non ce ne è nessuna attiva
    if (oldActiveForm != ActiveForm())
    {
      // Se è uno dei casi 2 o 3 e non c'erano altre form già aperte, ActiveForm diventa NULL
      // In questo caso ripristino la form attiva
      if (ActiveForm() == null)
        set_ActiveForm(OldForm);
      //
      // Informo l'RD3 che occorre attivare questa form
      if (ActiveForm() != null)
        RD3AddEvent("activateform", "frm:" + ActiveForm().FormIdx);
      return;
    }
    //
    // Docked Forms
    if (ActiveForm().Docked)
    {
      if (!ParamsObj().UseRD3)
      {
        RDDockForm = true;
        if (DockedForm() != null) // Sostituzione Docked Form
        {
          UnloadForm(DockedForm().FormIdx,false);
          set_DockedForm(null); // Forzo Chiusura
        }
        StackForm.remove(ActiveForm());
        set_DockedForm(ActiveForm());
        set_ActiveForm(OldForm);
        //
        f = DockedForm();
        f.Form_Activate(); // Fire activate event
        f.SubForm_Activate();
        //
        // Ridimensiono il client size!
        if (f.DockType == Glb.FORMDOCK_LEFT || f.DockType == Glb.FORMDOCK_RIGHT)
          ResizeClient(ScreenW() - f.OrgWidth + f.GetPadding(false) + 1, ScreenH(), false);
        else
          ResizeClient(ScreenW(), ScreenH() - f.OrgHeight + f.GetPadding(true) + 1, false);      
        return;
      }
      else
      {
        // Gestione Form Docked RD3
        // Devo sostituire un'eventuale DockedForm sullo stesso lato
        if (!UseZones())
        {
          for (int t=0;t<StackForm.size();t++)
          {
            WebForm frm = (WebForm)StackForm.get(t);
            if (frm.Docked && frm.DockType == ActiveForm().DockType && frm.FormIdx != ActiveForm().FormIdx)
            {
              UnloadForm(frm.FormIdx, false);
              break;
            }
          }
        }
        //
        WebForm dkf = ActiveForm();
        set_ActiveForm(OldForm);
        //
        if (UseZones() && ScreenZone(dkf.DockType) != null)
          ScreenZone(dkf.DockType).set_SelectedForm(dkf.FormIdx);
        else
        {
          dkf.Form_Activate(); // Fire activate event
          dkf.SubForm_Activate();
        }
        //
        return;
      }
    }
    
    //
    // Se è modale ho già chiesto
    if (OldForm!=null && OpenAs==0)
    {
      OldForm.Form_Deactivate(Cancel);
      OldForm.SubForm_Deactivate(Cancel);
    }
    //
    if (Cancel.isFalse())  
    {  
      SetHelpFile(ActiveForm().HelpFile);
      f = ActiveForm();
      f.Form_Activate(); // Fire activate event
      f.SubForm_Activate();
    }
    else
    {
      DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 12, "MainFrm.Show", "The form " + ActiveForm().Caption() + " has been shown, but the form " + OldForm.Caption() + " refuses to deactivate (cancel := true)");
      set_ActiveForm(OldForm);
      //
      RD3AddEvent("activateform", "frm:" + ActiveForm().FormIdx);
    }
  }

  // **********************************************
  // Crea una nuova istanza di form a partire dall'indice
  // **********************************************
  public WebForm CreateFormByIndex(int FormIdx)
  {
    WebForm newform = null;
    fine:
    {
      if (FormIdx==MyGlb.FRM_DIGITATESTO) { newform = new DigitaTesto(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEACCESEPRE) { newform = new SceltaAccertamentiEsercizioPrecedente(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTASOGGET) { newform = new SceltaSoggetti(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELSOGGOMON) { newform = new SceltaSoggettiOmonimi(); break fine; }
      if (FormIdx==MyGlb.FRM_SELECATEFISC) { newform = new SelezioneCategorieFiscali(); break fine; }
      if (FormIdx==MyGlb.FRM_CLASSIFICAZI) { newform = new Classificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOPRODUT) { newform = new ElencoProduttori(); break fine; }
      if (FormIdx==MyGlb.FRM_MODELLI) { newform = new Modelli(); break fine; }
      if (FormIdx==MyGlb.FRM_SELEZICAUSAL) { newform = new SelezionaCausale(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELDELLDISL) { newform = new SceltaDellaDislocazione(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAFATTOR) { newform = new SceltaFattori(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTACENTRI) { newform = new SceltaCentri(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELFATTCONT) { newform = new SceltaFattoriContropartita(); break fine; }
      if (FormIdx==MyGlb.FRM_COMUNI_243) { newform = new SelezioneComuni(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAIMPEGN) { newform = new SceltaImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELIMPEPROV) { newform = new SceltaImpegnoProvenienza(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELIMPEANNO) { newform = new SceltaImpegnoAnno(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEIMPANNPRE) { newform = new SceltaImpegnoAnnoPrecedente(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELIMPEPERS) { newform = new SceltaImpegnoPersonalizzato(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELIMPEORDI) { newform = new SceltaImpegnoOrdine(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTIMPEGUT) { newform = new SceltaImpegnoUT(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELSUBIMPUT) { newform = new SceltaSubImpegnoUT(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELSUBIMPUO) { newform = new SceltaSubImpegnoUO(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELOBIEPERS) { newform = new SceltaObiettiviPers(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELVOCIECON) { newform = new SceltaVociEconomiche(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEVOCECCOFI) { newform = new SceltaVociEconomicheConFiltri(); break fine; }
      if (FormIdx==MyGlb.FRM_CODICIPTC) { newform = new CodiciPTC(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELCODIGEST) { newform = new SceltaCodiciGestionali(); break fine; }
      if (FormIdx==MyGlb.FRM_SCECODGECOFI) { newform = new SceltaCodiciGestionaliConFiltri(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPOBOLLATO) { newform = new TipoBollato(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAVINCOL) { newform = new SceltaVincolo(); break fine; }
      if (FormIdx==MyGlb.FRM_SELEZIOBANCA) { newform = new SelezioneBanca(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTADOCUME) { newform = new SceltaDocumenti(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTADELIBE) { newform = new SceltaDelibere(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAPROPOS) { newform = new SceltaProposte(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAACCERT) { newform = new SceltaAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_SCECAPARSEUO) { newform = new SceltaCapitoloArtSenzaUO(); break fine; }
      if (FormIdx==MyGlb.FRM_SCECAPARCOUO) { newform = new SceltaCapitoloArtConUO(); break fine; }
      if (FormIdx==MyGlb.FRM_ELVOPECOSTEF) { newform = new ElencoVociPegConStanziamentoEffettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_ELVOPECOSTSI) { newform = new ElencoVociPegConStanziamentoSimulato(); break fine; }
      if (FormIdx==MyGlb.FRM_FINSUBIMPFIN) { newform = new FinanziamentiSubImpFin(); break fine; }
      if (FormIdx==MyGlb.FRM_FINANZIMPFIN) { newform = new FinanziamentiImpFin(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELFINAOPER) { newform = new SceltaFinanziamentoOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTACATEGO) { newform = new SceltaCategorie(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELCODIINTE) { newform = new SceltaCodiciIntervento(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEQUIDELSOG) { newform = new SceltaQuietanzeDelSoggetto(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAOPERE) { newform = new SceltaOpere(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEFINIMPACC) { newform = new SceltaFinanziamentiImpAcc(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELFINASUBI) { newform = new SceltaFinanziamentiSubimp(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAOBIETT) { newform = new SceltaObiettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELPROGIND1) { newform = new SceltaProgettoIndice1(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELPROGINDI) { newform = new SceltaProgettoIndice2(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEPROCFPATT) { newform = new SceltaProgettoCfpegAttivo(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEPROCFATVA) { newform = new SceltaProgettoCfpegAttivoVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELOBIEVARI) { newform = new SceltaObiettiviVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEOBIVAFUBI) { newform = new SceltaObiettiviVariazioniFunzBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAPROGET) { newform = new SceltaProgetti(); break fine; }
      if (FormIdx==MyGlb.FRM_SCVOPEGPECOO) { newform = new SceltaVocePEGPersonalizzataConObiettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_SCVOPEGPESEO) { newform = new SceltaVocePEGPersonalizzataSenzaObiettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_SCVOPEGPENCO) { newform = new SceltaVocePEGPersonalizzataNUOVAConObiettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_SCVOPEGPENSO) { newform = new SceltaVocePEGPersonalizzataNUOVASenzaObiettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_SCPRCFVNVPEG) { newform = new SceltaProgettoCfpegVariazioniNuovaVocePEG(); break fine; }
      if (FormIdx==MyGlb.FRM_SCOBVANUVOPE) { newform = new SceltaObiettiviVariazioniNuovaVocePeg(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEVOPEGDABI) { newform = new SceltaVocePEGDaBil(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEVOPEGNOBI) { newform = new SceltaVocePEGNoBil(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTESTMAIL) { newform = new SceltaTestiMail(); break fine; }
      if (FormIdx==MyGlb.FRM_SELEZITITOLI) { newform = new SelezioneTitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTITOTIPO) { newform = new SceltaTitoliTipologie(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELMISSPROG) { newform = new SceltaMissioniProgrammi(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPITOLTERZI) { newform = new CapitoliTerzi(); break fine; }
      if (FormIdx==MyGlb.FRM_FUNZIONI) { newform = new Funzioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SERVIZI) { newform = new Servizi(); break fine; }
      if (FormIdx==MyGlb.FRM_PROGRAMMI) { newform = new Programmi(); break fine; }
      if (FormIdx==MyGlb.FRM_SELEZIFLESSI) { newform = new SelezioneFlessibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVENTIVO) { newform = new Preventivo(); break fine; }
      if (FormIdx==MyGlb.FRM_CONSUNTIVO) { newform = new Consuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_UNITAORGANIZ) { newform = new UnitaOrganizzative(); break fine; }
      if (FormIdx==MyGlb.FRM_SCVOPEGSCAUC) { newform = new SceltaVocePEGSoloCollegateAUoCodrec1(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELPROPBOZZ) { newform = new SceltaProposteBozza(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELDATALIMI) { newform = new SceltaDataLimite(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAVARIAZ) { newform = new SceltaVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTPOLPROG) { newform = new SceltaPolProgetti(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOFINANZ) { newform = new ElencoFinanziamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELDISDILIQ) { newform = new SceltaDistinteDiLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_CODICIUTENZE) { newform = new CodiciUtenze(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTACCERUT) { newform = new SceltaAccertamentiUT(); break fine; }
      if (FormIdx==MyGlb.FRM_CODICIMONITO) { newform = new CodiciMonitoraggio(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELUNITORGA) { newform = new SceltaUnitaOrganizzative(); break fine; }
      if (FormIdx==MyGlb.FRM_SCCACOUODICO) { newform = new SceltaCapitoloConUODiCompetenza(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAASSEST) { newform = new SceltaAssestamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEDAVISSTRI) { newform = new SceltaDaVistaStrutturaRicl(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTARICLAS) { newform = new SceltaRiclassificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTCAPITFS) { newform = new SceltaCapitoliFS(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEVOCPEDL77) { newform = new SceltaVocePegDL77(); break fine; }
      if (FormIdx==MyGlb.FRM_SCECAPARTARM) { newform = new SceltaCapitoloArtArm(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTIPOVARI) { newform = new SceltaTipoVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEOBIEGEST) { newform = new SchedeObiettiviGestionali(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTACOFOG) { newform = new SceltaCOFOG(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELCOFOTRAS) { newform = new SceltaCOFOGTrasco(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELMACRLIV4) { newform = new SceltaMacroLiv4(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEVARPERESI) { newform = new SceltaVariazionePerEsigibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_SCCADACAECUJ) { newform = new SceltaCapitoliDaCAPECAPUOJOIN(); break fine; }
      if (FormIdx==MyGlb.FRM_MUTUI) { newform = new Mutui(); break fine; }
      if (FormIdx==MyGlb.FRM_SCECRONONDEF) { newform = new SceltaCronoprogrammiNonDef(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTACCPROV) { newform = new SceltaAccProvenienza(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELSUBIPROV) { newform = new SceltaSubimpegnoProvenienza(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELOPERCRON) { newform = new SceltaOpereCrono(); break fine; }
      if (FormIdx==MyGlb.FRM_SCECAPARARRE) { newform = new SceltaCapitoloArtArmRes(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEFATCONRIC) { newform = new SceltaFattoriContropartitaRicl(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEFATCOPAAT) { newform = new SceltaFattoriContropartitaPassAtt(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEFINPIACRO) { newform = new SceltaFinanziamentiPianoCronoprogramma(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEVOCTECOPE) { newform = new SceltaVoceTecnicaOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELACCEANNO) { newform = new SceltaAccertamentiAnno(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELFINABILF) { newform = new SceltaFinanziamentoBILFIN(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELOPERBIFI) { newform = new SceltaOpereBifin(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEOBIDIGEDU) { newform = new SceltaObiettiviDiGestioneDUP(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEFATOCONUT) { newform = new SceltaFattoriOContropartitaUtenze(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEUODACAPUO) { newform = new SceltaUODaCAPUO(); break fine; }
      if (FormIdx==MyGlb.FRM_SCUODACABIUO) { newform = new SceltaUODaCAPBILUO(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOOPERE) { newform = new ElencoOpere(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELPERIRIAC) { newform = new SceltaPeriodoRiaccertamento(); break fine; }
      if (FormIdx==MyGlb.FRM_SCMALI4SEMIP) { newform = new SceltaMacroLiv4SenzaMissProg(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTMACR4E5) { newform = new SceltaMacro4E5(); break fine; }
      if (FormIdx==MyGlb.FRM_SCECOFCOMIPR) { newform = new SceltaCofogConMissProg(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEDEINVENT) { newform = new SchedeInventario(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELSTRUCONT) { newform = new SceltaStrutturaConti(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOSULLOPER) { newform = new InformazioniSullOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORMFINAN1) { newform = new InformazioniFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORMPROPOS) { newform = new InformazioniProposta(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOSUVOCBIL) { newform = new InformazioneSuVoceBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOPDCONTI) { newform = new InfoPDConti(); break fine; }
      if (FormIdx==MyGlb.FRM_INFPROVOCPEG) { newform = new InfoProgettiVocePeg(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOBIVOCPEG) { newform = new InfoObiettiviVocePeg(); break fine; }
      if (FormIdx==MyGlb.FRM_FINAVOCIBILA) { newform = new FinanziamentiVociBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVINIZOPER) { newform = new PrevisioniInizialiOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZIOPERA) { newform = new VariazioniOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCEDICOMOPE) { newform = new AccertamentiDiCompetenzaOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPEGDICOMPE) { newform = new ImpegniDiCompetenza(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIPROVOPER) { newform = new VariazioniProvvisorieOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCEARESIOPE) { newform = new AccertamentiAResiduoOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPEGNARESID) { newform = new ImpegniAResiduo(); break fine; }
      if (FormIdx==MyGlb.FRM_SUBIMPEGOPER) { newform = new SubImpegniOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIDAOPERA) { newform = new LiquidazioniOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDIDICOMOPE) { newform = new OrdinativiDiCompetenzaOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDIARESIOPE) { newform = new OrdinativiAResiduoOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_MANDDICOMOPE) { newform = new MandatiDiCompetenzaOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_MANDARESIOPE) { newform = new MandatiAResiduoOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVINIZFINA) { newform = new PrevisioniInizialiFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZFINANZ) { newform = new VariazioniFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCEDICOMFIN) { newform = new AccertamentiDiCompetenzaFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIPROVFINA) { newform = new VariazioniProvvisorieFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCEARESIFIN) { newform = new AccertamentiAResiduoFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_SUBIMPEGFINA) { newform = new SubImpegniFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIDFINANZ) { newform = new LiquidazioniFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDIDICOMFIN) { newform = new OrdinativiDiCompetenzaFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDIARESIFIN) { newform = new OrdinativiAResiduoFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_MANDDICOMFIN) { newform = new MandatiDiCompetenzaFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_MANDARESIFIN) { newform = new MandatiAResiduoFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_MANDATEMESSI) { newform = new MandatiEmessi(); break fine; }
      if (FormIdx==MyGlb.FRM_MANEMEESPRFI) { newform = new MandatiEmessiEserciziPrecedentiFin(); break fine; }
      if (FormIdx==MyGlb.FRM_PAGAMENTI) { newform = new Pagamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_PAGESEPREFIN) { newform = new PagamentiEserciziPrecedentiFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINAEMESSI) { newform = new OrdinativiEmessi(); break fine; }
      if (FormIdx==MyGlb.FRM_RISCOSSIONI) { newform = new Riscossioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDEMEESPRFI) { newform = new OrdinativiEmessiEserciziPrecedentiFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_RISESEPREFIN) { newform = new RiscossioniEserciziPrecedentiFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZIONI) { newform = new Variazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_STANPROGCFPE) { newform = new StanziamentiProgettoCfpeg(); break fine; }
      if (FormIdx==MyGlb.FRM_STANSULLOBIE) { newform = new StanziamentiSullObiettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOQUIETANZ) { newform = new InfoQuietanza(); break fine; }
      if (FormIdx==MyGlb.FRM_INFODISPOSIZ) { newform = new InfoDisposizioni(); break fine; }
      if (FormIdx==MyGlb.FRM_INFODISTLIQU) { newform = new InfoDistinteLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORMDELIBE) { newform = new InformazioniDelibera(); break fine; }
      if (FormIdx==MyGlb.FRM_INFODELIBERA) { newform = new InfoDelibera(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOORDINATI) { newform = new InfoOrdinativo(); break fine; }
      if (FormIdx==MyGlb.FRM_INFSUVOCBI77) { newform = new InformazioneSuVoceBilancio77(); break fine; }
      if (FormIdx==MyGlb.FRM_PIANDEICON77) { newform = new PianoDeiConti77(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAESERCI) { newform = new SceltaEsercizio(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTAUFFICI) { newform = new SceltaUfficio(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEMASTRUTT) { newform = new SchemaStruttura(); break fine; }
      if (FormIdx==MyGlb.FRM_STRUTTURA) { newform = new Struttura(); break fine; }
      if (FormIdx==MyGlb.FRM_NUOVSUSTRBIL) { newform = new NuovoSuStrutturaBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIRICLASSI) { newform = new TipiRiclassificazione(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEMIRICLAS) { newform = new SchemiRiclassificazione(); break fine; }
      if (FormIdx==MyGlb.FRM_STRUTTRICLAS) { newform = new StrutturaRiclassificazione(); break fine; }
      if (FormIdx==MyGlb.FRM_NUOVSUSTRRIC) { newform = new NuovoSuStrutturaRiclassificazione(); break fine; }
      if (FormIdx==MyGlb.FRM_PROGRAMCOFOG) { newform = new ProgrammiCofog(); break fine; }
      if (FormIdx==MyGlb.FRM_CODICILIBERI) { newform = new CodiciLiberi(); break fine; }
      if (FormIdx==MyGlb.FRM_CGECGU) { newform = new CgeCgu(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIMOTIVARI) { newform = new TipiMotivazioniVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIVARIAZI1) { newform = new TipiVariazione1(); break fine; }
      if (FormIdx==MyGlb.FRM_FINANZIAMENT) { newform = new Finanziamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_OPERE) { newform = new Opere(); break fine; }
      if (FormIdx==MyGlb.FRM_FINANPERCONT) { newform = new FinanziamentiPerContributo(); break fine; }
      if (FormIdx==MyGlb.FRM_TITOLI) { newform = new Titoli(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPICONTTERZ) { newform = new CapitoliContoTerzi(); break fine; }
      if (FormIdx==MyGlb.FRM_FUNZIOSERVIZ) { newform = new FunzioniServizi(); break fine; }
      if (FormIdx==MyGlb.FRM_VINCOLI) { newform = new Vincoli(); break fine; }
      if (FormIdx==MyGlb.FRM_ALLEGATI) { newform = new Allegati(); break fine; }
      if (FormIdx==MyGlb.FRM_CODICICERTIF) { newform = new CodiciCertificati(); break fine; }
      if (FormIdx==MyGlb.FRM_FLESSIBILITA) { newform = new Flessibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_PROGRAPROGET) { newform = new ProgrammiProgetti(); break fine; }
      if (FormIdx==MyGlb.FRM_CENTRDICOSTO) { newform = new CentriDiCosto(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIMOTIVAZI) { newform = new TipiMotivazione(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIVARIAZIO) { newform = new TipiVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIVARICRON) { newform = new TipiVariazioneCronoprogrammi(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIAVANZO) { newform = new TipiAvanzo(); break fine; }
      if (FormIdx==MyGlb.FRM_CAUSALI) { newform = new Causali(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIBOLLO) { newform = new TipiBollo(); break fine; }
      if (FormIdx==MyGlb.FRM_FIRME) { newform = new Firme(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTRISTRAOR) { newform = new ContributiStraordinari(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIINCARICO) { newform = new TipiIncarico(); break fine; }
      if (FormIdx==MyGlb.FRM_VOCITECNOPER) { newform = new VociTecnicheOpere(); break fine; }
      if (FormIdx==MyGlb.FRM_CODICIFISCAL) { newform = new CodiciFiscali(); break fine; }
      if (FormIdx==MyGlb.FRM_CAUSALFISCAL) { newform = new CausaliFiscali(); break fine; }
      if (FormIdx==MyGlb.FRM_CAUSALIIRAP) { newform = new CausaliIRAP(); break fine; }
      if (FormIdx==MyGlb.FRM_CAUSALPREVID) { newform = new CausaliPrevidenziali(); break fine; }
      if (FormIdx==MyGlb.FRM_CAUSALIINAIL) { newform = new CausaliINAIL(); break fine; }
      if (FormIdx==MyGlb.FRM_CATEGOSOGGET) { newform = new CategorieSoggetti(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPISCADENZA) { newform = new TipiScadenza(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIQUIETANZ) { newform = new TipiQuietanza(); break fine; }
      if (FormIdx==MyGlb.FRM_CATEGODOCUME) { newform = new CategorieDocumenti(); break fine; }
      if (FormIdx==MyGlb.FRM_UFFICI) { newform = new Uffici(); break fine; }
      if (FormIdx==MyGlb.FRM_CAUSALSOSPEN) { newform = new CausaliSospensione(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIREGISTRO) { newform = new TipiRegistro(); break fine; }
      if (FormIdx==MyGlb.FRM_ESENZIONI) { newform = new Esenzioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ATTIVITA) { newform = new Attivita(); break fine; }
      if (FormIdx==MyGlb.FRM_CODICISTATIS) { newform = new CodiciStatistici(); break fine; }
      if (FormIdx==MyGlb.FRM_REGISTRI) { newform = new Registri(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIESECUTIV) { newform = new TipiEsecutivita(); break fine; }
      if (FormIdx==MyGlb.FRM_FATTORI) { newform = new Fattori(); break fine; }
      if (FormIdx==MyGlb.FRM_CENTRI) { newform = new Centri(); break fine; }
      if (FormIdx==MyGlb.FRM_CLASSICONTAB) { newform = new ClassiContabili(); break fine; }
      if (FormIdx==MyGlb.FRM_FATTORIOLD) { newform = new FattoriOld(); break fine; }
      if (FormIdx==MyGlb.FRM_PREFERENZE) { newform = new Preferenze(); break fine; }
      if (FormIdx==MyGlb.FRM_PREFERENZWEB) { newform = new PreferenzeWeb(); break fine; }
      if (FormIdx==MyGlb.FRM_PARTRAATTCON) { newform = new ParametriTrasparenzaAttiConcessione(); break fine; }
      if (FormIdx==MyGlb.FRM_ASSTIPCOSEPC) { newform = new AssociazioneTipiCostoEPCF(); break fine; }
      if (FormIdx==MyGlb.FRM_ENTE) { newform = new Ente(); break fine; }
      if (FormIdx==MyGlb.FRM_ENTEINFORMAZ) { newform = new EnteInformazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_TESORIERE) { newform = new Tesoriere(); break fine; }
      if (FormIdx==MyGlb.FRM_TESORIINFORM) { newform = new TesoriereInformazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_NUMERAZIONI) { newform = new Numerazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_NUMERAINFORM) { newform = new NumerazioniInformazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_TESTISTAMPE) { newform = new TestiStampe(); break fine; }
      if (FormIdx==MyGlb.FRM_VOCIECON) { newform = new VociEcon(); break fine; }
      if (FormIdx==MyGlb.FRM_COMPETENZE) { newform = new Competenze(); break fine; }
      if (FormIdx==MyGlb.FRM_ASSESSORATI) { newform = new Assessorati(); break fine; }
      if (FormIdx==MyGlb.FRM_DELIBERE) { newform = new Delibere(); break fine; }
      if (FormIdx==MyGlb.FRM_DELIBERA) { newform = new Delibera(); break fine; }
      if (FormIdx==MyGlb.FRM_MOVIMEDELIBE) { newform = new MovimentiDelibera(); break fine; }
      if (FormIdx==MyGlb.FRM_ESECUTPROPOS) { newform = new EsecutivitaProposte(); break fine; }
      if (FormIdx==MyGlb.FRM_ESECPRODAGS4) { newform = new EsecutivitaProposteDaGs4(); break fine; }
      if (FormIdx==MyGlb.FRM_MOVIMEPROPOS) { newform = new MovimentiProposte(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMPAPROPOS) { newform = new StampaProposte(); break fine; }
      if (FormIdx==MyGlb.FRM_SERVIZDIRETT) { newform = new ServiziDiretti(); break fine; }
      if (FormIdx==MyGlb.FRM_ATTRIALSERVI) { newform = new AttribuzioneAlServizio(); break fine; }
      if (FormIdx==MyGlb.FRM_ELECAPSERDIR) { newform = new ElencoCapitoliServiziDiretti(); break fine; }
      if (FormIdx==MyGlb.FRM_SERDIRFIDACA) { newform = new ServiziDirettiFinanziatiDalCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_SOGGETTI) { newform = new Soggetti(); break fine; }
      if (FormIdx==MyGlb.FRM_SOGGETTO) { newform = new Soggetto(); break fine; }
      if (FormIdx==MyGlb.FRM_GENSOGPERECO) { newform = new GenerazioneSoggettiPerEconomato(); break fine; }
      if (FormIdx==MyGlb.FRM_CORRISREGION) { newform = new CorrispondenzaRegioni(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTROSOGGET) { newform = new ControlloSoggetti(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRCONTSOGG) { newform = new EstrattoContoSoggetto(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTAGMANDAT) { newform = new DettagliMandato(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTAGORDINA) { newform = new DettagliOrdinativo(); break fine; }
      if (FormIdx==MyGlb.FRM_TOTALEENTRAT) { newform = new TotaleEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_TOTALESPESA) { newform = new TotaleSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTFATTSPES) { newform = new DettagliFattureSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTFATTENTR) { newform = new DettagliFattureEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCUDEBICODI) { newform = new DocumentiDebitoriCodificati(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTABDOCUME) { newform = new ContabilizzazioneDocumenti(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCDEBNONCOD) { newform = new DocumentiDebitoriNonCodificati(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTABILIIVA) { newform = new ContabilizzazioneIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTFINAECON) { newform = new ContabilizzazioneFinanziariaEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSIACCERT) { newform = new EmissioneAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSACC) { newform = new EmissAcc(); break fine; }
      if (FormIdx==MyGlb.FRM_CAUSALEPERIO) { newform = new CausaliEPeriodi(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCPERIMPCON) { newform = new DocumentiPerImputazioneContabile(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCPERIMPECO) { newform = new DocumentiPerImputazioneEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCUMPERQUIE) { newform = new DocumentiPerQuietanza(); break fine; }
      if (FormIdx==MyGlb.FRM_SCADENZIARIO) { newform = new Scadenziario(); break fine; }
      if (FormIdx==MyGlb.FRM_CORRISPETTIV) { newform = new Corrispettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRATTCONTO) { newform = new EstrattoConto(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCUMEAPERTI) { newform = new DocumentiAperti(); break fine; }
      if (FormIdx==MyGlb.FRM_PROTOCOLLO) { newform = new Protocollo(); break fine; }
      if (FormIdx==MyGlb.FRM_RENDICMANDAT) { newform = new RendicontoMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_RENDMANDRIVO) { newform = new RendicontoMandatiRivoli(); break fine; }
      if (FormIdx==MyGlb.FRM_RENDICFATTUR) { newform = new RendicontoFatture(); break fine; }
      if (FormIdx==MyGlb.FRM_RENFATPERRIV) { newform = new RendicontoFatturePersonalizzazioneRivoli(); break fine; }
      if (FormIdx==MyGlb.FRM_PROVVELIQUID) { newform = new ProvvedimentoLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_SITLIQPECOUT) { newform = new SituazioneLiquidazioniPerCodiceUtenza(); break fine; }
      if (FormIdx==MyGlb.FRM_SITLIQPERIMP) { newform = new SituazioneLiquidazioniPerImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_GENEIMPUECO2) { newform = new GenerazioneImputazioneEconomica2(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOINCASS) { newform = new ElencoIncassi(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEINCAGGINC) { newform = new ElencoIncassiAggiornaIncassi(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISCORRINCA) { newform = new EmissioneCorrispettiviIncassi(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISORDIINCA) { newform = new EmissioneOrdinativiIncassi(); break fine; }
      if (FormIdx==MyGlb.FRM_CARICAINCASS) { newform = new CaricamentoIncassi(); break fine; }
      if (FormIdx==MyGlb.FRM_FATTURE) { newform = new Fatture(); break fine; }
      if (FormIdx==MyGlb.FRM_FATTURA) { newform = new Fattura(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPIDOCUMENT) { newform = new TipiDocumento(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPUTAZIONI) { newform = new Imputazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIDAZIONI) { newform = new Liquidazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINATIVI) { newform = new Ordinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOLIQUID) { newform = new ElencoLiquidazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOORDINA) { newform = new ElencoOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFICHE) { newform = new Rettifiche(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCUMENTI) { newform = new Documenti(); break fine; }
      if (FormIdx==MyGlb.FRM_ACQUIMMAFATT) { newform = new AcquisizioneImmagineFattura(); break fine; }
      if (FormIdx==MyGlb.FRM_SCANSIONE) { newform = new Scansione(); break fine; }
      if (FormIdx==MyGlb.FRM_ACQUIMMAIRID) { newform = new AcquisizioneImmagineIride(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOFATTURA) { newform = new InfoFattura(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDICOLLAFAT) { newform = new OrdiniCollegatiAFattura(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENFILEINVI) { newform = new ElencoFileInviati(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENFATDAINV) { newform = new ElencoFattureDaInviare(); break fine; }
      if (FormIdx==MyGlb.FRM_CREFILXMCOFA) { newform = new CreaFileXMLComunicazioneFatture(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUALDESCRI) { newform = new VisualizzaDescrizione(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTFATTINVI) { newform = new DettaglioFattureInviate(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEFILZIPINV) { newform = new ElencoFileZIPInviati(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPOFILEESIT) { newform = new ImportFileEsito(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUALIESITO) { newform = new VisualizzaEsito(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEFATCOMFAT) { newform = new ElencoFattureComunicazioneFatture(); break fine; }
      if (FormIdx==MyGlb.FRM_DISTLIQUTECN) { newform = new DistinteLiquidazioneTecniche(); break fine; }
      if (FormIdx==MyGlb.FRM_RETMASUOSUFA) { newform = new RettificaMassivaUOSuFatture(); break fine; }
      if (FormIdx==MyGlb.FRM_SEGNRETMASU1) { newform = new SegnalazioniRettifaMassivaUO(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPODAFILCSV) { newform = new ImportaDaFileCSV(); break fine; }
      if (FormIdx==MyGlb.FRM_RISULTELABOR) { newform = new RisultatoElaborazione(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMCOLLBOLL) { newform = new EliminaCollegamentoBolla(); break fine; }
      if (FormIdx==MyGlb.FRM_INSERDAORDIN) { newform = new InserimentoDaOrdine(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTROFATTUR) { newform = new ControlloFatture(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTAGIMPEGN) { newform = new DettagliImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_INSERDABOLLA) { newform = new InserimentoDaBolla(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOORDINI) { newform = new InfoOrdini(); break fine; }
      if (FormIdx==MyGlb.FRM_BUONO) { newform = new Buono(); break fine; }
      if (FormIdx==MyGlb.FRM_CATEGOPRODOT) { newform = new CategoriaProdotto(); break fine; }
      if (FormIdx==MyGlb.FRM_VOCIECONOMIC) { newform = new VociEconomiche(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFIMPEGN) { newform = new RettificaImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENFATTORDI) { newform = new ElencoFattureOrdine(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOBOLLE) { newform = new ElencoBolle(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUAZDETTAG) { newform = new SituazioneDettaglio(); break fine; }
      if (FormIdx==MyGlb.FRM_CARICAMEFILE) { newform = new CaricamentoFile(); break fine; }
      if (FormIdx==MyGlb.FRM_SMISTAFATTUR) { newform = new SmistamentoFatture(); break fine; }
      if (FormIdx==MyGlb.FRM_CONFIGUTENZE) { newform = new ConfigurazioneUtenze(); break fine; }
      if (FormIdx==MyGlb.FRM_NOTIFICHE) { newform = new Notifiche(); break fine; }
      if (FormIdx==MyGlb.FRM_FATTURELETTR) { newform = new FattureElettroniche(); break fine; }
      if (FormIdx==MyGlb.FRM_MODASSUNPEAC) { newform = new ModificaAssegnaUnitaPerAccettazione(); break fine; }
      if (FormIdx==MyGlb.FRM_INSENUOVSOGG) { newform = new InserimentoNuovoSoggetto(); break fine; }
      if (FormIdx==MyGlb.FRM_SELEZISOGGET) { newform = new SelezioneSoggetto(); break fine; }
      if (FormIdx==MyGlb.FRM_MODASSUNIMUL) { newform = new ModificaAssegnaUnitaMULTISEL(); break fine; }
      if (FormIdx==MyGlb.FRM_MOTIVARIFIUT) { newform = new MotivazioneRifiuto(); break fine; }
      if (FormIdx==MyGlb.FRM_SEGNALAZIONI) { newform = new Segnalazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_RIEPILOGOIVA) { newform = new RiepilogoIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCENOTDICRE) { newform = new AccettaNotaDiCredito(); break fine; }
      if (FormIdx==MyGlb.FRM_DODACOAREFEV) { newform = new DocumentiDaCollegareARettificaFEVEN(); break fine; }
      if (FormIdx==MyGlb.FRM_IVA) { newform = new IVA(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIORESIGIB) { newform = new AggiornamentoEsigibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_NUMERAZIOIVA) { newform = new NumerazioneIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_CONFERMAIVA) { newform = new ConfermaIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_VENTILAZIIVA) { newform = new VentilazioneIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_CALCOIVAVENT) { newform = new CalcoloIVAVentilata(); break fine; }
      if (FormIdx==MyGlb.FRM_PERCEDIINCID) { newform = new PercentualiDiIncidenza(); break fine; }
      if (FormIdx==MyGlb.FRM_REGIACQUVEND) { newform = new RegistroAcquistiVendite(); break fine; }
      if (FormIdx==MyGlb.FRM_REGISTCORRIS) { newform = new RegistroCorrispettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_REGRIEACQVEN) { newform = new RegistroRiepilogativoAcquistiVendite(); break fine; }
      if (FormIdx==MyGlb.FRM_REGRIEACVESO) { newform = new RegistroRiepilogativoAcquistiVenditeSospesi(); break fine; }
      if (FormIdx==MyGlb.FRM_REGIRIEPCORR) { newform = new RegistroRiepilogativoCorrispettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_VERIFICAIVA) { newform = new VerificaIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_VERIFIVASOSP) { newform = new VerificaIVASospesi(); break fine; }
      if (FormIdx==MyGlb.FRM_COIVAINATDIE) { newform = new ControlloIVAInAttesaDiEsigibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIDAZIIVA) { newform = new LiquidazioneIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQIVAPERLIV) { newform = new LiquidazioneIVAPersLivorno(); break fine; }
      if (FormIdx==MyGlb.FRM_COMLIQPERIVA) { newform = new ComunicazioneLiquidazioniPeriodicheIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_DATCOMLIQIVA) { newform = new DatiComunicazioneLiqIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRAIVAEXCE) { newform = new EstrazioneIVAExcel(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTDAPECOIVA) { newform = new EstrazioneDatiPerControlloIVA(); break fine; }
      if (FormIdx==MyGlb.FRM_COLLEGCAPITO) { newform = new CollegamentoCapitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_ESIIVAFALIPA) { newform = new EsigibilitaIVAFattureLiquidateParzialmente(); break fine; }
      if (FormIdx==MyGlb.FRM_UTENZE) { newform = new Utenze(); break fine; }
      if (FormIdx==MyGlb.FRM_DISTIDILIQU1) { newform = new DistintaDiLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISLIQDADIS) { newform = new EmissioneLiquidazioniDaDistinta(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENDISDILIQ) { newform = new ElencoDistinteDiLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEANOLIQUTE) { newform = new ElencoAnomalieLiquidazioniUtenze(); break fine; }
      if (FormIdx==MyGlb.FRM_CARICAFATTUR) { newform = new CaricamentoFatture(); break fine; }
      if (FormIdx==MyGlb.FRM_CARICACONSUM) { newform = new CaricamentoConsumi(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCUMECORRIS) { newform = new DocumentiCorrispettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOCORRISPE) { newform = new InfoCorrispettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFBOLLAT) { newform = new RettificaBollato(); break fine; }
      if (FormIdx==MyGlb.FRM_INTEGRAZIPCC) { newform = new IntegrazionePCC(); break fine; }
      if (FormIdx==MyGlb.FRM_INSEDOCDACFA) { newform = new InserisciDocumentiDaCfa(); break fine; }
      if (FormIdx==MyGlb.FRM_ESITCOMUAPCC) { newform = new EsitoComunicazioneAPCC(); break fine; }
      if (FormIdx==MyGlb.FRM_REICOMRICPCC) { newform = new ReinviaComunicaRicezionePCC(); break fine; }
      if (FormIdx==MyGlb.FRM_COMUNCONTPCC) { newform = new ComunicaContabilizzazionePCC(); break fine; }
      if (FormIdx==MyGlb.FRM_COMUNSCADPCC) { newform = new ComunicaScadutoPCC(); break fine; }
      if (FormIdx==MyGlb.FRM_FILECOMUNPCC) { newform = new FileComunicazioniPCC(); break fine; }
      if (FormIdx==MyGlb.FRM_ANNUFILECORR) { newform = new AnnullaFileCorrente(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTAGDOCUME) { newform = new DettaglioDocumenti(); break fine; }
      if (FormIdx==MyGlb.FRM_CAMBAZIOANNU) { newform = new CambiaAzioneAnnulla(); break fine; }
      if (FormIdx==MyGlb.FRM_RENDMODIDOCU) { newform = new RendiModificabileDocumento(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPESIRICPCC) { newform = new ImportaEsitoRicezionePCC(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCETMANUPCC) { newform = new AccettazioneManualePCC(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOSTEPFATT) { newform = new InfoStepFattura(); break fine; }
      if (FormIdx==MyGlb.FRM_PIADEICONLIS) { newform = new PianoDeiContiList(); break fine; }
      if (FormIdx==MyGlb.FRM_INSEAGGPDCON) { newform = new InserimentoAggiornamentoPDConti(); break fine; }
      if (FormIdx==MyGlb.FRM_INSESUESESUC) { newform = new InserimentoSuEserciziSuccessivi(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGAUTIMECOL) { newform = new AggiornamentoAutomaticoImputazioniEconomicheOLD(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOUO) { newform = new ElencoUO(); break fine; }
      if (FormIdx==MyGlb.FRM_FINANZISUCAP) { newform = new FinanziamentiSuCap(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENFINAPIAN) { newform = new ElencoFinanziamentiPiano(); break fine; }
      if (FormIdx==MyGlb.FRM_CORRISCAPITO) { newform = new CorrispondenzeCapitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_INSECAPSUCF4) { newform = new InserimentoCapitoloSuCF4(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIORMOVIME) { newform = new AggiornaMovimentazione(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTUOSUCAPI) { newform = new RettificaUOSuCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_CONUOPIADECO) { newform = new ControlliUOPianoDeiConti(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPSENIMPECO) { newform = new CapitoliSenzaImputazioniEconomiche(); break fine; }
      if (FormIdx==MyGlb.FRM_ASSOCENAICAP) { newform = new AssociaCentroAiCapitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_ANOASSCENACA) { newform = new AnomalieAssociazioneCentroACapitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMECPIDECO) { newform = new ElencoImputazioniEconomichePianoDeiConti(); break fine; }
      if (FormIdx==MyGlb.FRM_RECECOSUMOAU) { newform = new RecuperoEconomicaSuMovimentiAUTOMATICO(); break fine; }
      if (FormIdx==MyGlb.FRM_MOVSENIMPECO) { newform = new MovimentiSenzaImputazioneEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_DOCSENIMPECO) { newform = new DocumentiSenzaImputazioneEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_RECRETECSUMO) { newform = new RecuperoRettificaEconomicaSuMovimenti(); break fine; }
      if (FormIdx==MyGlb.FRM_ASSOIMPUECON) { newform = new AssociaImputazioniEconomiche(); break fine; }
      if (FormIdx==MyGlb.FRM_LOGCANUNIORG) { newform = new LogCancellazioniUnitaOrganizzative(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIMASSIUO) { newform = new RettificaMassivaUO(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIUNIAICAP) { newform = new AggiungiUnitaAiCapitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_SEGNRETMASUO) { newform = new SegnalazioniRettificaMassivaUO(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFIUNITA) { newform = new RettificaUnita(); break fine; }
      if (FormIdx==MyGlb.FRM_DIFFSUESESUC) { newform = new DifferenzeSuEserciziSuccessivi(); break fine; }
      if (FormIdx==MyGlb.FRM_RETUOPERCAOT) { newform = new RettificaUOPerCambioOttica(); break fine; }
      if (FormIdx==MyGlb.FRM_ASSEGUOCAPIT) { newform = new AssegnazioneUOCapitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIVALCOMUO) { newform = new AggiornaValoriComuniUO(); break fine; }
      if (FormIdx==MyGlb.FRM_ERRRETUOCAOT) { newform = new ErroriRettificaUOCambioOttica(); break fine; }
      if (FormIdx==MyGlb.FRM_LOGRETUOCAOT) { newform = new LogRettificaUOCambioOttica(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIDEFINUO) { newform = new RettificaDefinitivaUO(); break fine; }
      if (FormIdx==MyGlb.FRM_AGTIAVSUCAAU) { newform = new AggiornaTipoAvanzoSuCapitoliAutomatico(); break fine; }
      if (FormIdx==MyGlb.FRM_AGTIAVSUCAMA) { newform = new AggiornaTipoAvanzoSuCapitoliManuale(); break fine; }
      if (FormIdx==MyGlb.FRM_ESERCIFINANZ) { newform = new EserciziFinanziari(); break fine; }
      if (FormIdx==MyGlb.FRM_STANBILAEFF1) { newform = new StanziamentiBilancioEffettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_STANBILASIM1) { newform = new StanziamentiBilancioSimulato(); break fine; }
      if (FormIdx==MyGlb.FRM_STANZIAMENUO) { newform = new StanziamentiUO(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPIFUORSTRU) { newform = new CapitoliFuoriStruttura(); break fine; }
      if (FormIdx==MyGlb.FRM_STANPLUREFFE) { newform = new StanziamentiPluriennaliEffettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_STANPLURSIMU) { newform = new StanziamentiPluriennaliSimulato(); break fine; }
      if (FormIdx==MyGlb.FRM_STANBILEFFVG) { newform = new StanziamentiBilancioEffettivoVg(); break fine; }
      if (FormIdx==MyGlb.FRM_STANZIAMUOVG) { newform = new StanziamentiUOVg(); break fine; }
      if (FormIdx==MyGlb.FRM_STANBILSIMVG) { newform = new StanziamentiBilancioSimulatoVg(); break fine; }
      if (FormIdx==MyGlb.FRM_STANZIAUOVG1) { newform = new StanziamentiUOVg1(); break fine; }
      if (FormIdx==MyGlb.FRM_CRONOPROGRAM) { newform = new Cronoprogrammi(); break fine; }
      if (FormIdx==MyGlb.FRM_INSAGGCRONOP) { newform = new InsagginfoCronoprogramma(); break fine; }
      if (FormIdx==MyGlb.FRM_DEFINICRONOP) { newform = new DefinizioneCronoprogramma(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENVARDACON) { newform = new ElencoVariazioniDaConfermare(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTCOMPIMPO) { newform = new DettaglioComposizioneImporti(); break fine; }
      if (FormIdx==MyGlb.FRM_STAELEVAFUAG) { newform = new StampaElencoVariazioniFunAgg(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMPACRONOP) { newform = new StampaCronoprogramma(); break fine; }
      if (FormIdx==MyGlb.FRM_QUADECONFINA) { newform = new QuadroEconomicoFinanziario(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOCRONOP) { newform = new ElencoCronoprogrammi(); break fine; }
      if (FormIdx==MyGlb.FRM_GENEIMPDAPIA) { newform = new GenerazioneImpegniDaPiano(); break fine; }
      if (FormIdx==MyGlb.FRM_FINDACROFAS1) { newform = new FinanziamentiDaCronoFase1(); break fine; }
      if (FormIdx==MyGlb.FRM_FINDACROFAS2) { newform = new FinanziamentiDaCronoFase2(); break fine; }
      if (FormIdx==MyGlb.FRM_PARAMETRIFSC) { newform = new ParametriFSC(); break fine; }
      if (FormIdx==MyGlb.FRM_DEFITIPOCALC) { newform = new DefinizioneTipoCalcolo(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGITIPOCALC) { newform = new AggiornaTipoCalcolo(); break fine; }
      if (FormIdx==MyGlb.FRM_FCDDEBILPREV) { newform = new FCDDEBilPrevisione(); break fine; }
      if (FormIdx==MyGlb.FRM_FCDDEARENDIC) { newform = new FCDDEARendiconto(); break fine; }
      if (FormIdx==MyGlb.FRM_CALCFCDINGES) { newform = new CalcoloFCDDEInGestione(); break fine; }
      if (FormIdx==MyGlb.FRM_FCDDINFOACCE) { newform = new FCDDEInfoAccertato(); break fine; }
      if (FormIdx==MyGlb.FRM_FCDDINFOINCA) { newform = new FCDDEInfoIncassato(); break fine; }
      if (FormIdx==MyGlb.FRM_FCDINFINCREN) { newform = new FCDDEInfoIncassatoRend(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGVALCOFCRE) { newform = new AggiornaValoriComuniFCDDERend(); break fine; }
      if (FormIdx==MyGlb.FRM_TIPICALCCASS) { newform = new TipiCalcoloCassa(); break fine; }
      if (FormIdx==MyGlb.FRM_PERCCALCSTAN) { newform = new PercentualiCalcoloStanziamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_DUPLSUALTESE) { newform = new DuplicaSuAltroEsercizio(); break fine; }
      if (FormIdx==MyGlb.FRM_GENERABILANC) { newform = new GenerazioneBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_CALIMPBILSIM) { newform = new CalcoliImportiBilancioSimulato(); break fine; }
      if (FormIdx==MyGlb.FRM_CALIMPBILEFF) { newform = new CalcoliImportiBilancioEffettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_PASSSUBILEFF) { newform = new PassaggioSuBilancioEffettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_GENENUOVBILA) { newform = new GenerazioneNuovoBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_GENENUOVFINA) { newform = new GenerazioneNuoviFinanziamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIAUTOBILA) { newform = new AggiornamentoAutomaticoBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_VODEBISCSIAI) { newform = new VociDelBilancioSimulatoConStanziamentoInferioreAgliImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_RIEIMPACCPLU) { newform = new RiemissioneImpAccPluriennali(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHECOMPSTAN) { newform = new SchedeComposizioneStanziamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMBILASIMU) { newform = new EliminazioneBilancioSimulato(); break fine; }
      if (FormIdx==MyGlb.FRM_APERNUOVBILA) { newform = new AperturaNuovoBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_PARABILAPREV) { newform = new ParametriBilancioPrev(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMBILAPREV) { newform = new StampeBilancioPrev(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMBILAAGGI) { newform = new StampeBilancioAggiornato(); break fine; }
      if (FormIdx==MyGlb.FRM_BILAENTRPREV) { newform = new BilancioEntratePrev(); break fine; }
      if (FormIdx==MyGlb.FRM_RISUAMMNEPRE) { newform = new RisultatoAmmNePresunto(); break fine; }
      if (FormIdx==MyGlb.FRM_RISAMMPRE201) { newform = new RisultatoAmmPresunto2014(); break fine; }
      if (FormIdx==MyGlb.FRM_LIMITIINDEBI) { newform = new LimitiIndebitamento(); break fine; }
      if (FormIdx==MyGlb.FRM_FCDDEPREV) { newform = new FCDDEPrev(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENRESIESER) { newform = new ElencoResiduiEsercizio(); break fine; }
      if (FormIdx==MyGlb.FRM_QUAGENRIAPR1) { newform = new QuadroGeneraleRiassuntivoPrev(); break fine; }
      if (FormIdx==MyGlb.FRM_QUAGENRIAAGG) { newform = new QuadroGeneraleRiassuntivoAgg(); break fine; }
      if (FormIdx==MyGlb.FRM_EQUIDIBILPRE) { newform = new EquilibriDiBilancioPrev(); break fine; }
      if (FormIdx==MyGlb.FRM_EQUILBILAAGG) { newform = new EquilibriBilancioAgg(); break fine; }
      if (FormIdx==MyGlb.FRM_VERIFIVINCOL) { newform = new VerificaVincoli(); break fine; }
      if (FormIdx==MyGlb.FRM_COMPOSFPVAGG) { newform = new ComposizioneFPVAgg(); break fine; }
      if (FormIdx==MyGlb.FRM_PARAOBIEPREV) { newform = new ParametriObiettivoPrev(); break fine; }
      if (FormIdx==MyGlb.FRM_ALLEBILA1PRE) { newform = new AllegatiBilancioA1Prev(); break fine; }
      if (FormIdx==MyGlb.FRM_ALLEBILA2PRE) { newform = new AllegatiBilancioA2Prev(); break fine; }
      if (FormIdx==MyGlb.FRM_ALLEBILA3PRE) { newform = new AllegatiBilancioA3Prev(); break fine; }
      if (FormIdx==MyGlb.FRM_BILANPERCAPI) { newform = new BilancioPerCapitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_PEGAGGENTSPE) { newform = new PegAggiornatoEntrataSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_BILPERCAPAGG) { newform = new BilancioPerCapitoliAggiornato(); break fine; }
      if (FormIdx==MyGlb.FRM_BILANCPREVIS) { newform = new BilancioPrevisione(); break fine; }
      if (FormIdx==MyGlb.FRM_RIEGENSPEPRE) { newform = new RiepilogoGeneraleSpesePreventivo(); break fine; }
      if (FormIdx==MyGlb.FRM_FUNZIODELEGA) { newform = new FunzioniDelegate(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTCOMUINTE) { newform = new ContributiComunitariInternazionali(); break fine; }
      if (FormIdx==MyGlb.FRM_QUAGENRIAPRE) { newform = new QuadroGeneraleRiassuntivoPreventivo(); break fine; }
      if (FormIdx==MyGlb.FRM_BILANCPLURIE) { newform = new BilancioPluriennale(); break fine; }
      if (FormIdx==MyGlb.FRM_BILANCAGGIOR) { newform = new BilancioAggiornato(); break fine; }
      if (FormIdx==MyGlb.FRM_PEGPREVENTIV) { newform = new PegPreventivo(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVIPERSERV) { newform = new PrevisioniPerServizio(); break fine; }
      if (FormIdx==MyGlb.FRM_PREPERSETOPE) { newform = new PrevisioniPerSettoreOperativo(); break fine; }
      if (FormIdx==MyGlb.FRM_PREPERCEDICO) { newform = new PrevisioniPerCentroDiCosto(); break fine; }
      if (FormIdx==MyGlb.FRM_PREPERUNDIGE) { newform = new PrevisioniPerUnitaDiGestione(); break fine; }
      if (FormIdx==MyGlb.FRM_PREPERUNDIUT) { newform = new PrevisioniPerUnitaDiUtilizzo(); break fine; }
      if (FormIdx==MyGlb.FRM_PREPERTIDISP) { newform = new PrevisioniPerTipologiaDiSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVIPERPROG) { newform = new PrevisioniPerProgramma(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVIPERVINC) { newform = new PrevisioniPerVincolo(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVIPERFLES) { newform = new PrevisioniPerFlessibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVISFINANZ) { newform = new PrevisioniFinanziamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_PREVSERINECO) { newform = new PrevisioniServiziInEconomia(); break fine; }
      if (FormIdx==MyGlb.FRM_AMMINITRASPA) { newform = new AmministrazioneTrasparente(); break fine; }
      if (FormIdx==MyGlb.FRM_PEGPLURIENNA) { newform = new PegPluriennale(); break fine; }
      if (FormIdx==MyGlb.FRM_PEGAGGIORNAT) { newform = new PegAggiornato(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCORESIDU) { newform = new ElencoResidui(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRADATIRPP) { newform = new EstrazioneDatiRPP(); break fine; }
      if (FormIdx==MyGlb.FRM_VERIFIANOMAL) { newform = new VerificaAnomalie(); break fine; }
      if (FormIdx==MyGlb.FRM_PARABILACONS) { newform = new ParametriBilancioCons(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMBILACONS) { newform = new StampeBilancioCons(); break fine; }
      if (FormIdx==MyGlb.FRM_BILAENTRCONS) { newform = new BilancioEntrateCons(); break fine; }
      if (FormIdx==MyGlb.FRM_CERTPARAOBIE) { newform = new CertificazioneParametriObiettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_EQUIDIBILCON) { newform = new EquilibriDiBilancioCons(); break fine; }
      if (FormIdx==MyGlb.FRM_QUAGENRIACON) { newform = new QuadroGeneraleRiassuntivoCons(); break fine; }
      if (FormIdx==MyGlb.FRM_RISULDIAMMIN) { newform = new RisultatoDiAmministrazione(); break fine; }
      if (FormIdx==MyGlb.FRM_FCDDECONS) { newform = new FCDDECons(); break fine; }
      if (FormIdx==MyGlb.FRM_QUARIAGESCAS) { newform = new QuadroRiassuntivoGestioneCassa(); break fine; }
      if (FormIdx==MyGlb.FRM_RESIDARIPCON) { newform = new ResiduiDaRiportareCons(); break fine; }
      if (FormIdx==MyGlb.FRM_PARAOBIECONS) { newform = new ParametriObiettiviCons(); break fine; }
      if (FormIdx==MyGlb.FRM_ALLEBILA1CON) { newform = new AllegatiBilancioA1Cons(); break fine; }
      if (FormIdx==MyGlb.FRM_ALLEBILA2CON) { newform = new AllegatiBilancioA2Cons(); break fine; }
      if (FormIdx==MyGlb.FRM_ALLEBILA3CON) { newform = new AllegatiBilancioA3Cons(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTOCONSOLD) { newform = new ContoConsuntivoOld(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTDATCERCON) { newform = new EstrazioneDatiCertificatoConsuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTODELTESO) { newform = new ContoDelTesoriere(); break fine; }
      if (FormIdx==MyGlb.FRM_PEGCONSUNOLD) { newform = new PEGConsuntivoOld(); break fine; }
      if (FormIdx==MyGlb.FRM_QUADGENERIAS) { newform = new QuadroGeneraleRiassuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_SERVIINECONO) { newform = new ServiziInEconomia(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAAIRESID) { newform = new VariazioniAiResidui(); break fine; }
      if (FormIdx==MyGlb.FRM_SERINECOPECO) { newform = new ServiziInEconomiaPegConsuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_VARAIRESPECO) { newform = new VariazioniAiResiduiPegConsuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_BILPERCAPCON) { newform = new BilancioPerCapitoliConsuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIDABUDCE4) { newform = new VariazioniDaBudgetCe4(); break fine; }
      if (FormIdx==MyGlb.FRM_ESECUTVARIAZ) { newform = new EsecutivitaVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ESECVARDAGS4) { newform = new EsecutivitaVariazioniDaGs4(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZATESOR) { newform = new VariazioniATesoreria(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUVARITRAT) { newform = new SituazioneVariazioniTrattate(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORMVARIAZ) { newform = new InformazioniVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZDEFINI) { newform = new VariazioniDefinitive(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTREMVARIAZ) { newform = new EstremiVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZPROVVI) { newform = new VariazioniProvvisorie(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPCONVAPRAN) { newform = new CapitoliConVarProvAnomalie(); break fine; }
      if (FormIdx==MyGlb.FRM_GENEVARDACRO) { newform = new GenerazioneVariazioniDaCronoprogramma(); break fine; }
      if (FormIdx==MyGlb.FRM_LANGENVARCR1) { newform = new LanciaGeneraVarCrono(); break fine; }
      if (FormIdx==MyGlb.FRM_FASE1ESTRPRO) { newform = new Fase1EstremiProvvedimento(); break fine; }
      if (FormIdx==MyGlb.FRM_FASE2VARIIMP) { newform = new Fase2VariazioniImpegnabile(); break fine; }
      if (FormIdx==MyGlb.FRM_PRESINCARPRO) { newform = new PresaInCaricoProposte(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTBOZZPROP) { newform = new DettagliBozzaProposta(); break fine; }
      if (FormIdx==MyGlb.FRM_BOZZEVARIAZI) { newform = new BozzeVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_INSAGGBOZVAR) { newform = new InserimentoAggiornamentoBozzeVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_PARCONDISRE1) { newform = new ParametriControlloDisponibilitaRep1(); break fine; }
      if (FormIdx==MyGlb.FRM_TOTALIBOZZA) { newform = new TotaliBozza(); break fine; }
      if (FormIdx==MyGlb.FRM_REPOCONTDIS1) { newform = new ReportControlloDisponibilita1(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTROQUADRA) { newform = new ControlloQuadratura(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENVARIBOZZ) { newform = new ElencoVariazioniBozza(); break fine; }
      if (FormIdx==MyGlb.FRM_PARELEPRSOAN) { newform = new ParametriElencoProposteSospeseAnnullate(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEPROSOSANN) { newform = new ElencoProposteSospeseAnnullate(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGITIPOVARI) { newform = new AggiornamentoTipoVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIOBILAPEG) { newform = new AggiornamentoBilancioPEG(); break fine; }
      if (FormIdx==MyGlb.FRM_SPOSSUDIVBOZ) { newform = new SpostamentoSuDiversaBozza(); break fine; }
      if (FormIdx==MyGlb.FRM_ASSOBOZZAVAR) { newform = new AssociazioneBozzaAVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_DISSBOZDAVAR) { newform = new DissociazioneBozzaDaVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUAZPROPOS) { newform = new SituazioneProposte(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTAGPROPOS) { newform = new DettagliProposta(); break fine; }
      if (FormIdx==MyGlb.FRM_SOLLCHIUPROP) { newform = new SollecitoChiusuraProposta(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIABILAPEG) { newform = new VariazioniBilancioPEG(); break fine; }
      if (FormIdx==MyGlb.FRM_DEVADAVABIPE) { newform = new DettagliVariazioneDaVariazioniBilancioPeg(); break fine; }
      if (FormIdx==MyGlb.FRM_GENEVARIPROV) { newform = new GenerazioneVariazioniProvvisorie(); break fine; }
      if (FormIdx==MyGlb.FRM_PARAALLEVARI) { newform = new ParametriAllegatoVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_REPOALLEVARI) { newform = new ReportAllegatoVariazione(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENVARIGENE) { newform = new ElencoVariazioniGenerate(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMVARIPROV) { newform = new EliminazioneVariazioniProvvisorie(); break fine; }
      if (FormIdx==MyGlb.FRM_INSUVOBIPEVA) { newform = new InfoSuVoceBilancioPerVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUPROGVARI) { newform = new SituazioneProgettoVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUOBIEVARI) { newform = new SituazioneObiettivoVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_INFFINPERVAR) { newform = new InformazioniFinanziamentoPerVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_INFSULOPPEVA) { newform = new InformazioniSullOperaPerVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_STORICSCHEDA) { newform = new StoricoScheda(); break fine; }
      if (FormIdx==MyGlb.FRM_STORICOFASE) { newform = new StoricoFase(); break fine; }
      if (FormIdx==MyGlb.FRM_STAVAPEGPEOB) { newform = new StampaVariazioniPEGPerObiettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_SPECDIGITEST) { newform = new SpecialDigitaTesto(); break fine; }
      if (FormIdx==MyGlb.FRM_ASSESTAMENTI) { newform = new Assestamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_ALLEGAVARIAZ) { newform = new AllegatoVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_COMPOSVARIAZ) { newform = new ComposizioneVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_COMPOVARIFPV) { newform = new ComposizioneVariazioniFPV(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTQUADPLU1) { newform = new ControlloQuadraturaPluriennali(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTRVARPROV) { newform = new ControlloVarProvvisorie(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOVARIAZ) { newform = new ElencoVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENVARICAPI) { newform = new ElencoVariazioniCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_REISCDAIMPEG) { newform = new ReiscrizioniDaImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIEQUDIBIL) { newform = new VariazioniEquilibriDiBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAPERFINA) { newform = new VariazioniPerFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAPERPROG) { newform = new VariazioniPerProgetto(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAPERESIG) { newform = new VariazioniPerEsigibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTQUADPLUR) { newform = new ControlloQuadraturaPluri(); break fine; }
      if (FormIdx==MyGlb.FRM_VARESICOCOAN) { newform = new VariazioniEsigConsCorrAntic(); break fine; }
      if (FormIdx==MyGlb.FRM_GENVARPEESCO) { newform = new GenerazioneVariazioniPerEsigConsuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMIVARESIG) { newform = new EliminazioneVarEsig(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIESIDIENT) { newform = new VariazioniEsigDiEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_GENVARESIENT) { newform = new GenerazioneVariazioniEsigEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGITIPOAVA1) { newform = new AggiornamentoTipoAvanzo(); break fine; }
      if (FormIdx==MyGlb.FRM_VARPERTIPAVA) { newform = new VariazioniPerTipoAvanzo(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGITIPOAVAN) { newform = new AggiornaTipoAvanzo(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGTIPAVSUMO) { newform = new AggiornaTipoAvanzoSuMovimentazione(); break fine; }
      if (FormIdx==MyGlb.FRM_GESTIOAVANZO) { newform = new GestioneAvanzo(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMGESTAVAN) { newform = new StampaGestioneAvanzo(); break fine; }
      if (FormIdx==MyGlb.FRM_SALDTIPIAVAN) { newform = new SaldiTipiAvanzo(); break fine; }
      if (FormIdx==MyGlb.FRM_PARAAVANESER) { newform = new ParametriAvanzoEsercizio(); break fine; }
      if (FormIdx==MyGlb.FRM_AVANZOESERCI) { newform = new AvanzoEsercizio(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTAGAVANZO) { newform = new DettagliAvanzo(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUAZGENERA) { newform = new SituazioneGenerale(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUAZDODICE) { newform = new SituazioneDodicesimi(); break fine; }
      if (FormIdx==MyGlb.FRM_SITPERPRISEM) { newform = new SituazionePercentualePrimoSemestre(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUAPERCLAS) { newform = new SituazionePerClassificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SITGENPEUNOR) { newform = new SituazioneGeneralePerUnitaOrganizzativa(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUTIPDISPE) { newform = new SituazioneTipologiaDiSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_SITCAPPECAFI) { newform = new SitCapitoliPerCategorieFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_SICAPEFOFIUO) { newform = new SitCapitoliPerFontiFinanziamentoUO(); break fine; }
      if (FormIdx==MyGlb.FRM_SITPERCLAMIS) { newform = new SituazioniPerClassificazioniMissioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SITPECLMIEMA) { newform = new SituazioniPerClassificazioniMissioniEMacro(); break fine; }
      if (FormIdx==MyGlb.FRM_SITPERCLTITI) { newform = new SituazioniPerClassificazioniTitoloTipologia(); break fine; }
      if (FormIdx==MyGlb.FRM_SITPERCLAMAC) { newform = new SituazioniPerClassificazioniMacroaggregato(); break fine; }
      if (FormIdx==MyGlb.FRM_SITPERALTCLA) { newform = new SituazioniPerAltreClassificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_CASSA) { newform = new Cassa(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENIMPECASS) { newform = new ElencoImpegniCassa(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENACCECASS) { newform = new ElencoAccertamentiCassa(); break fine; }
      if (FormIdx==MyGlb.FRM_DATICERTIFIC) { newform = new DatiCertificato(); break fine; }
      if (FormIdx==MyGlb.FRM_CERTIFICATO) { newform = new Certificato(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCODIMANC) { newform = new ElencoCodiciMancanti(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRAZIOBDAP) { newform = new EstrazioniBDAP(); break fine; }
      if (FormIdx==MyGlb.FRM_GESTIONEBDAP) { newform = new GestioneBDAP(); break fine; }
      if (FormIdx==MyGlb.FRM_DATCONANAREN) { newform = new DatiContabiliAnaliticiRendiconto(); break fine; }
      if (FormIdx==MyGlb.FRM_DATCONANAPRE) { newform = new DatiContabiliAnaliticiPrevisione(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEMDIBILAN) { newform = new SchemiDiBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPEGNO) { newform = new Impegno(); break fine; }
      if (FormIdx==MyGlb.FRM_FORMVARIAZIO) { newform = new FormVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_MOVIMVINCIMP) { newform = new MovimentiVincoloImp(); break fine; }
      if (FormIdx==MyGlb.FRM_MOVIMVINCACC) { newform = new MovimentiVincoloAcc(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUAZVINCOL) { newform = new SituazioneVincolo(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELIMPEORES) { newform = new SceltaImpegnoOResiduo(); break fine; }
      if (FormIdx==MyGlb.FRM_SUBIMPEGNO) { newform = new SubImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_FORMVARISUBI) { newform = new FormVariazioniSubimp(); break fine; }
      if (FormIdx==MyGlb.FRM_FINANZSUBIMP) { newform = new FinanziamentiSubimp(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORMIMPEGN) { newform = new InformazioniImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOVARIIMPE) { newform = new InfoVariazioniImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORMFINANZ) { newform = new InformazioneFinanziamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORMPLURIE) { newform = new InformazioniPluriennali(); break fine; }
      if (FormIdx==MyGlb.FRM_DDISPONIMONO) { newform = new DDisponibilitaMono(); break fine; }
      if (FormIdx==MyGlb.FRM_CF4WIMPSDISP) { newform = new CF4WEBIMPSUBDISPONIBILITA(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINIDISPOS) { newform = new OrdiniDisposizioni(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORSUBIMPE) { newform = new InformazioniSubImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_INFFINSUBIMP) { newform = new InformazioniFinanziamentiSubImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_GENIMPPERECO) { newform = new GenerazioneImpegniPerEconomato(); break fine; }
      if (FormIdx==MyGlb.FRM_GENEIMPDAESI) { newform = new GenerazioneImpegniDaEsigibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_PARGENIMDAES) { newform = new ParametriGenerazioneImpegniDaEsigibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEANOIMPREI) { newform = new ElencoAnomalieImpegniReiscritti(); break fine; }
      if (FormIdx==MyGlb.FRM_GENEIMPDACRO) { newform = new GenerazioneImpegniDaCronoprogramma(); break fine; }
      if (FormIdx==MyGlb.FRM_PARGENIMDACR) { newform = new ParametriGenerazioneImpegniDaCronoprogramma(); break fine; }
      if (FormIdx==MyGlb.FRM_GEVAIMDACDVB) { newform = new GenerazioneVariazioniImpegniDaCronoDaVarBil(); break fine; }
      if (FormIdx==MyGlb.FRM_LANGENVARCRO) { newform = new LanciaGeneraVarimpCrono(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENIMPEREIS) { newform = new ElencoImpegniReiscritti(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFIOPERA) { newform = new RettificaOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTICAPIIMP) { newform = new RettificaCapitoloImp(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNAIMPEGN) { newform = new GiornaleImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEDAINCARI) { newform = new SchedaIncarichi(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZIMPEGN) { newform = new VariazioniImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_INCARIIMPEGN) { newform = new IncarichiImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPEAUTODISP) { newform = new ImpegnoAutomaticoDisponibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSIIMPEGN) { newform = new EmissioneImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_STORIAIMPEGN) { newform = new StoriaImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMSTORIMPE) { newform = new StampaStoriaImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_STORIASUBIMP) { newform = new StoriaSubimpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_FINANZIAMEN1) { newform = new Finanziamenti1(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZSUBIMP) { newform = new VariazioniSubimpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELVOCEECON) { newform = new SceltaVoceEcon(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCERTAMENTI) { newform = new Accertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZIONACC) { newform = new VariazioniAcc(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOACCEFORM) { newform = new InfoAccertamentiForm(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOPLURIENN) { newform = new InfoPluriennali(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOOPERE) { newform = new InfoOpere(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEACCPEFUAC) { newform = new SceltaAccertamentiPerFunzioniAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFFINANZ) { newform = new RettificaFinanziamento(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFCAPITO) { newform = new RettificaCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNAACCERT) { newform = new GiornaleAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZACCERT) { newform = new VariazioniAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_OPERE1) { newform = new Opere1(); break fine; }
      if (FormIdx==MyGlb.FRM_GENEACCDAESI) { newform = new GenerazioneAccertamentiDaEsigibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_PARGENACDAES) { newform = new ParametriGenerazioneAccertamentiDaEsigibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEANOACCREI) { newform = new ElencoAnomalieAccertamentiReiscritti(); break fine; }
      if (FormIdx==MyGlb.FRM_PERIODRIACCE) { newform = new PeriodiRiaccertamento(); break fine; }
      if (FormIdx==MyGlb.FRM_PROVARIMPSUB) { newform = new ProposteVariazioniImpegniSubimpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIVALOCOM1) { newform = new AggiornaValoriComuni(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENPROPMODI) { newform = new ElencoProposteModificate(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIMPRADASU) { newform = new AggiornaImportoRagDaSubimpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_GENVARPROVAR) { newform = new GenerazioneVariazioniProposteVar(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMINVARIAZ) { newform = new EliminazioneVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_PROPODASUBIM) { newform = new ProposteDaSubimpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMALLEPROP) { newform = new StampaAllegatoProposta(); break fine; }
      if (FormIdx==MyGlb.FRM_CHIUSUORDINI) { newform = new ChiusuraOrdini(); break fine; }
      if (FormIdx==MyGlb.FRM_CHIUMASSORDI) { newform = new ChiusuraMassivaOrdini(); break fine; }
      if (FormIdx==MyGlb.FRM_SITPROVARRIA) { newform = new SituazioneProposteVariazioniRiacc(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRAZPROPOS) { newform = new EstrazioneProposte(); break fine; }
      if (FormIdx==MyGlb.FRM_PARDIFIMPSUB) { newform = new ParametriDifferenzeImpegniSubimpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_DIFFIMPESUBI) { newform = new DifferenzeImpegniSubimpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTALIQUID) { newform = new SceltaLiquidazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIDAZIONE) { newform = new Liquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGVALCOMLIQ) { newform = new AggiornamentoValoriComuniLiq(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOLIQUIDAZ) { newform = new InfoLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMLIQINDIS) { newform = new EliminaLiquidazioniInDistinta(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTGRUPLIQU) { newform = new DettagliGruppoLiquidazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSLIQULIQ) { newform = new EmissioneLiquidazioniLiq(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTRDISPLIQ) { newform = new ControlloDisponibilitaLiq(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPCONDINEGR) { newform = new CapitoliConDisponibilitaNegativaGRL(); break fine; }
      if (FormIdx==MyGlb.FRM_CACODINEDAAL) { newform = new CapitoliConDisponibilitaNegativaDALAL(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPCONDINECG) { newform = new CapitoliConDisponibilitaNegativaCG4(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPCONDINEIM) { newform = new CapitoliConDisponibilitaNegativaImputazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_CACODINELIIE) { newform = new CapitoliConDisponibilitaNegativaLiqInEmissione(); break fine; }
      if (FormIdx==MyGlb.FRM_CACODINEDIOR) { newform = new CapitoliConDisponibilitaNegativaDistOrdini(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTROIMPUTA) { newform = new ControlloImputazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTDISPPURO) { newform = new ControlloDispoPuro(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIAUTOIMPE) { newform = new AggiornamentoAutomaticoImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRAIMPULIQ) { newform = new EstrazioneImputazioniLiq(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUVERSRITE) { newform = new LiquidazioneVersamentoRitenute(); break fine; }
      if (FormIdx==MyGlb.FRM_FORMRETTIMPE) { newform = new FormRettificaImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFSUBIMP) { newform = new RettificaSubimpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNALIQUID) { newform = new GiornaleLiquidazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQPERPRODEL) { newform = new LiquidazioniPerPropostaDelibera(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUDADISECO) { newform = new LiquidazioniDaDistintaEconomato(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTDISPFULI) { newform = new ControlloDisponibilitaFuli(); break fine; }
      if (FormIdx==MyGlb.FRM_DISTIDILIQUI) { newform = new DistinteDiLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_EMILIQDISECO) { newform = new EmissioneLiquidazioniDistEco(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTCONTDIST) { newform = new ControlloContabileDistinta(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSILIQUID) { newform = new EmissioneLiquidazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIVALOCOMU) { newform = new AggiornamentoValoriComuni(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUPARZDIST) { newform = new LiquidazioneParzialeDistinta(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQDISCASECO) { newform = new LiquidazioneDistintaCassaEconomale(); break fine; }
      if (FormIdx==MyGlb.FRM_SCDIDIRICAEC) { newform = new SceltaDistinteDiRimborsoCassaEconomale(); break fine; }
      if (FormIdx==MyGlb.FRM_EMILIQCASECO) { newform = new EmissioneLiquidazioniCassaEco(); break fine; }
      if (FormIdx==MyGlb.FRM_FASE1ESTRLIQ) { newform = new Fase1EstremiLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_FAS2ALTDATLI) { newform = new Fase2AltriDatiLiquidazione(); break fine; }
      if (FormIdx==MyGlb.FRM_FAS3FATDALIQ) { newform = new Fase3FattureDaLiquidare(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTRSOGGLIQ) { newform = new ControlloSoggettiLiq(); break fine; }
      if (FormIdx==MyGlb.FRM_CARICSOGGLIQ) { newform = new CaricamentoSoggettiLiq(); break fine; }
      if (FormIdx==MyGlb.FRM_EMLIIVPERECH) { newform = new EmissioneLiqIVAPerReverseCharge(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSLIQUIRC) { newform = new EmissioneLiquidazioniRC(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMPADISTIN) { newform = new StampaDistinte(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUORDIAGRU) { newform = new LiquidazioniOrdinativiAGruppi(); break fine; }
      if (FormIdx==MyGlb.FRM_DISPOPUROORD) { newform = new DisponibilitaPuroOrd(); break fine; }
      if (FormIdx==MyGlb.FRM_DUPLICGRUPPO) { newform = new DuplicaGruppo(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGVALCOORLI) { newform = new AggiornamentoValoriComuniOrdLiq(); break fine; }
      if (FormIdx==MyGlb.FRM_MOVIMEAGRUPP) { newform = new MovimentiAGruppi(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTGRUPMOVI) { newform = new DettagliGruppoMovimenti(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSIMOVIME) { newform = new EmissioneMovimenti(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGVALCOMMOV) { newform = new AggiornamentoValoriComuniMov(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPDAFILSUGR) { newform = new ImportDaFileSuGruppo(); break fine; }
      if (FormIdx==MyGlb.FRM_MANDATI) { newform = new Mandati(); break fine; }
      if (FormIdx==MyGlb.FRM_PAGAMEMANDAT) { newform = new PagamentiMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_PAGMANPERFLU) { newform = new PagamentiMandatiPerFlusso(); break fine; }
      if (FormIdx==MyGlb.FRM_NUOVIPAGAMEN) { newform = new NuoviPagamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_INFORMMANDAT) { newform = new InformazioneMandato(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOPAGAMAND) { newform = new InfoPagamentiMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISAUTOMAND) { newform = new EmissioneAutomaticaMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTROANTICI) { newform = new ControlloAnticipazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTCODIGEST) { newform = new ControlloCodiciGestionali(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTROEQUITA) { newform = new ControlloEquitalia(); break fine; }
      if (FormIdx==MyGlb.FRM_CONCODTRAEL1) { newform = new ControlloCodiciTransazioneElementare(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTQUIESCAD) { newform = new ControlloQuietanzeScadute(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISMANUDIST) { newform = new EmissioneManualeDistinta(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENMANINDIS) { newform = new ElencoMandatiInDistinta(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQDAEMEINMA) { newform = new LiquidazioniDaEmettereInMandato(); break fine; }
      if (FormIdx==MyGlb.FRM_AVVISDIPAGAM) { newform = new AvvisiDiPagamento(); break fine; }
      if (FormIdx==MyGlb.FRM_CONFAVVDIPAG) { newform = new ConfermaAvvisiDiPagamento(); break fine; }
      if (FormIdx==MyGlb.FRM_CONAVVDIPAAN) { newform = new ConfermaAvvisiDiPagamentoAncona(); break fine; }
      if (FormIdx==MyGlb.FRM_ANNULLPAGAME) { newform = new AnnullaPagamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_PAGAMECOMPLE) { newform = new PagamentoCompleto(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIMPDIMAN) { newform = new RettificaImpegnoDiMandato(); break fine; }
      if (FormIdx==MyGlb.FRM_RETSUBIMDIMA) { newform = new RettificaSubImpegnoDiMandato(); break fine; }
      if (FormIdx==MyGlb.FRM_RIEMINONPAGA) { newform = new RiemissioneNonPagati(); break fine; }
      if (FormIdx==MyGlb.FRM_DISTDITRAMAN) { newform = new DistinteDiTrasmissioneMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNAMANDAT) { newform = new GiornaleMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNAPAGAME) { newform = new GiornalePagamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_MAEMSUCARIIV) { newform = new MandatiEmessiSuCapRilIva(); break fine; }
      if (FormIdx==MyGlb.FRM_INCARICHI) { newform = new Incarichi(); break fine; }
      if (FormIdx==MyGlb.FRM_MANDANONPAGA) { newform = new MandatiNonPagati(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMPAMANDAT) { newform = new StampaMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAAIMANDA) { newform = new VariazioniAiMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_TRASMANDATES) { newform = new TrasmissioneMandatiATesoreria(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISMANUMAND) { newform = new EmissioneManualeMandato(); break fine; }
      if (FormIdx==MyGlb.FRM_RITENUFISCAL) { newform = new RitenuteFiscali(); break fine; }
      if (FormIdx==MyGlb.FRM_RITENPERADDI) { newform = new RitenutePerAddizionale(); break fine; }
      if (FormIdx==MyGlb.FRM_DISTRITEFISC) { newform = new DistintaRitenuteFiscali(); break fine; }
      if (FormIdx==MyGlb.FRM_DISRITPERADD) { newform = new DistintaRitenutePerAddizionale(); break fine; }
      if (FormIdx==MyGlb.FRM_CERTSOSDIIMP) { newform = new CertificatiSostitutiDiImposta(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTROQUADRI) { newform = new ControlloQuadri(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTRIMINIMI) { newform = new ContribuentiMinimi(); break fine; }
      if (FormIdx==MyGlb.FRM_ERRBLOCON770) { newform = new ErroriBloccantiControllo770(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRAZION770) { newform = new Estrazione770(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRAZIONECU) { newform = new EstrazioneCU(); break fine; }
      if (FormIdx==MyGlb.FRM_RITENUTEIRAP) { newform = new RitenuteIrap(); break fine; }
      if (FormIdx==MyGlb.FRM_RITENUPREVID) { newform = new RitenutePrevidenziali(); break fine; }
      if (FormIdx==MyGlb.FRM_RITENUTINAIL) { newform = new RitenuteInail(); break fine; }
      if (FormIdx==MyGlb.FRM_CONINVSOSIMP) { newform = new ConfermaInvioSostitutiImposta(); break fine; }
      if (FormIdx==MyGlb.FRM_MANPERVEIVIS) { newform = new MandatiPerVersIVAIstituzionale(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEEMIMACAEC) { newform = new ElencoEmissMandatiCassaEconomale(); break fine; }
      if (FormIdx==MyGlb.FRM_EMIMANCASECO) { newform = new EmissMandatiCassaEconomale(); break fine; }
      if (FormIdx==MyGlb.FRM_ELLICOIMIIDV) { newform = new ElencoLiquidazioniConImportoIvaIstDaValorizzare(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIPROVMAND) { newform = new AggiornamentoProvvisoriMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_CONDISPROMAN) { newform = new ControlloDisponibilitaProvMan(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISMANDAPRO) { newform = new EmissioneMandatiDaProvvisori(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGAUTMANPRO) { newform = new AggiornamentoAutomaticoMandatiProvv(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELMANDPROV) { newform = new SceltaMandatiProvvisori(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINACOLLEG) { newform = new OrdinativiCollegati(); break fine; }
      if (FormIdx==MyGlb.FRM_FORMORDINATI) { newform = new FormOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINATIVO) { newform = new Ordinativo(); break fine; }
      if (FormIdx==MyGlb.FRM_INCASSI) { newform = new Incassi(); break fine; }
      if (FormIdx==MyGlb.FRM_INCASPERFLUS) { newform = new IncassiPerFlusso(); break fine; }
      if (FormIdx==MyGlb.FRM_NUOVIINCASSI) { newform = new NuoviIncassi(); break fine; }
      if (FormIdx==MyGlb.FRM_NUOORDCOACAU) { newform = new NuovoOrdinativoConAccAutomatico(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTGRUPORDI) { newform = new DettagliGruppoOrdinativo(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSORDIORD) { newform = new EmissioneOrdinativiOrd(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTRDISPORD) { newform = new ControlloDisponibilitaOrd(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIPROVORDI) { newform = new AggiornamentoProvvisoriOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISORDDAPRO) { newform = new EmissioneOrdinativiDaProvvisori(); break fine; }
      if (FormIdx==MyGlb.FRM_CONDISPROORD) { newform = new ControlloDisponibilitaProvOrd(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIORAUTOMA) { newform = new AggiornamentoAutomatico(); break fine; }
      if (FormIdx==MyGlb.FRM_PROVVDAREGOL) { newform = new ProvvisoriDaRegolarizzare(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIAUTOACCE1) { newform = new AggiornamentoAutomaticoAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMPAORDINA) { newform = new StampaOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_AVVISDIRISCO) { newform = new AvvisiDiRiscossione(); break fine; }
      if (FormIdx==MyGlb.FRM_DISTDITRAORD) { newform = new DistintaDiTrasmissioneOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTCODIGES1) { newform = new ControlloCodiciGestionali1(); break fine; }
      if (FormIdx==MyGlb.FRM_CONCODTRAELE) { newform = new ControlloCodiciTransElementare(); break fine; }
      if (FormIdx==MyGlb.FRM_INCASSCOMPLE) { newform = new IncassoCompleto(); break fine; }
      if (FormIdx==MyGlb.FRM_ANNULLINCASS) { newform = new AnnullaIncassi(); break fine; }
      if (FormIdx==MyGlb.FRM_RIEORDNONINC) { newform = new RiemissioneOrdinativiNonIncassati(); break fine; }
      if (FormIdx==MyGlb.FRM_RETTIFACCERT) { newform = new RettificaAccertamento(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINDARITEN) { newform = new OrdinativiDaRitenute(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDPERSPLPAY) { newform = new OrdinativiPerSplitPayment(); break fine; }
      if (FormIdx==MyGlb.FRM_VERIFIORDINA) { newform = new VerificaOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINDACORRI) { newform = new OrdinativiDaCorrispettivi(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINDAIMPUT) { newform = new OrdinativiDaImputazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISSIORDINA) { newform = new EmissioneOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDDADISCAEC) { newform = new OrdinativiDaDistintaCassaEconomale(); break fine; }
      if (FormIdx==MyGlb.FRM_SCEDISVECAEC) { newform = new SceltaDistinteVersamentoCassaEconomale(); break fine; }
      if (FormIdx==MyGlb.FRM_EMISORDDADIS) { newform = new EmissioneOrdinativiDaDistinta(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNAORDINA) { newform = new GiornaleOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNAINCASS) { newform = new GiornaleIncassi(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINNONINCA) { newform = new OrdinativiNonIncassati(); break fine; }
      if (FormIdx==MyGlb.FRM_SOLLEDIRISCO) { newform = new SollecitiDiRiscossione(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZORDINA) { newform = new VariazioniOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_TRASORDIATES) { newform = new TrasmissioneOrdinativiATesoreria(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRAZIMPUTA1) { newform = new EstrazioneImputazioniOrd(); break fine; }
      if (FormIdx==MyGlb.FRM_ESTRATTOCCP) { newform = new EstrattoCCP(); break fine; }
      if (FormIdx==MyGlb.FRM_MANCOLPERCOM) { newform = new MandatiCollegatiPerCompensazione(); break fine; }
      if (FormIdx==MyGlb.FRM_FLUSMANDREVE) { newform = new FlussiMandatiReversali(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNDICASSA) { newform = new GiornaleDiCassa(); break fine; }
      if (FormIdx==MyGlb.FRM_ANNULLMANDAT) { newform = new AnnulliMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZMANDAT) { newform = new VariazioniMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_SOSTITMANDAT) { newform = new SostituzioniMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_CAMDISTANOIN) { newform = new CambiDiStatoNonInviati(); break fine; }
      if (FormIdx==MyGlb.FRM_CERCA) { newform = new Cerca(); break fine; }
      if (FormIdx==MyGlb.FRM_ANNULLIORD) { newform = new AnnulliOrd(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZIONORD) { newform = new VariazioniOrd(); break fine; }
      if (FormIdx==MyGlb.FRM_SOSTITUZIORD) { newform = new SostituzioniOrd(); break fine; }
      if (FormIdx==MyGlb.FRM_CAMDISTNOIN1) { newform = new CambiDiStatoNonInviati1(); break fine; }
      if (FormIdx==MyGlb.FRM_CERCA1) { newform = new Cerca1(); break fine; }
      if (FormIdx==MyGlb.FRM_INVMANEORDIN) { newform = new InvioMandatoEOrdinativoInformatico(); break fine; }
      if (FormIdx==MyGlb.FRM_ANOMALIINVIO) { newform = new AnomalieInvio(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMINAZIONE) { newform = new Eliminazione(); break fine; }
      if (FormIdx==MyGlb.FRM_SCELTIPOELIM) { newform = new SceltaTipoEliminazione(); break fine; }
      if (FormIdx==MyGlb.FRM_RICPAGINDATE) { newform = new RicezionePagamentiIncassiDaTesoreria(); break fine; }
      if (FormIdx==MyGlb.FRM_REPORTERRORI) { newform = new ReportErrori(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENERROAUTO) { newform = new ElencoErroriAuto(); break fine; }
      if (FormIdx==MyGlb.FRM_CARICAPROVVI) { newform = new CaricamentoProvvisori(); break fine; }
      if (FormIdx==MyGlb.FRM_CARICAIMPUTA) { newform = new CaricamentoImputazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_BILANDIENTRA) { newform = new BilancioDiEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_BILANDISPESA) { newform = new BilancioDiSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_PROGETENTRAT) { newform = new ProgettiEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_PROGETTSPESA) { newform = new ProgettiSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZENTRAT) { newform = new VariazioniEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZISPESA) { newform = new VariazioniSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_BILSORMEZUNI) { newform = new BilancioSorboloMezzaniUnione(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPEGNACCERT) { newform = new ImpegniAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_MANDATORDINA) { newform = new MandatiOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCERPERCLAS) { newform = new AccertamentiPerClassificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCERPERDEBI) { newform = new AccertamentiPerDebitore(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCPERIMPECO) { newform = new AccertamentiPerImputazioneEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_ACCERPERCAPI) { newform = new AccertamentiPerCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPEGPERCLAS) { newform = new ImpegniPerClassificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPEGPERBENE) { newform = new ImpegniPerBeneficiario(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPPERIMPECO) { newform = new ImpegniPerImputazioneEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPEGPERCAPI) { newform = new ImpegniPerCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_SUBIMPERCLAS) { newform = new SubimpegniPerClassificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_SUBIMPERBENE) { newform = new SubimpegniPerBeneficiario(); break fine; }
      if (FormIdx==MyGlb.FRM_SUBPERIMPECO) { newform = new SubimpegniPerImputazioneEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_SUBIMPERCAPI) { newform = new SubimpegniPerCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIPERCLAS) { newform = new LiquidazioniPerClassificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIPERBENE) { newform = new LiquidazioniPerBeneficiario(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQPERCODITE) { newform = new LiquidazionePerContabileDiTesoreria(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIPERIMPE) { newform = new LiquidazioniPerImpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQUIPERSUBI) { newform = new LiquidazioniPerSubimpegno(); break fine; }
      if (FormIdx==MyGlb.FRM_LIQPERIMPECO) { newform = new LiquidazioniPerImputazioneEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINPERCLAS) { newform = new OrdinativiPerClassificazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINPERDEBI) { newform = new OrdinativiPerDebitore(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDPERCODITE) { newform = new OrdinativiPerContabileDiTesoreria(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDINPERACCE) { newform = new OrdinativiPerAccertamento(); break fine; }
      if (FormIdx==MyGlb.FRM_ORDPERIMPECO) { newform = new OrdinativiPerImputazioneEconomica(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUAZICASSA) { newform = new SituazioneCassa(); break fine; }
      if (FormIdx==MyGlb.FRM_SITCASPERVIN) { newform = new SituazioneCassaPerVincolo(); break fine; }
      if (FormIdx==MyGlb.FRM_SALDIVINCOLI) { newform = new SaldiVincoli(); break fine; }
      if (FormIdx==MyGlb.FRM_PROSTRIDICAS) { newform = new ProspettoTrimestraleDiCassa(); break fine; }
      if (FormIdx==MyGlb.FRM_GIORNAVINCOL) { newform = new GiornaleVincoli(); break fine; }
      if (FormIdx==MyGlb.FRM_SINTEDICASSA) { newform = new SintesiDiCassa(); break fine; }
      if (FormIdx==MyGlb.FRM_SITUAZCOMPET) { newform = new SituazioneCompetenza(); break fine; }
      if (FormIdx==MyGlb.FRM_MASTROMANDAT) { newform = new MastroMandati(); break fine; }
      if (FormIdx==MyGlb.FRM_MASTROORDINA) { newform = new MastroOrdinativi(); break fine; }
      if (FormIdx==MyGlb.FRM_MASTROIMPEGN) { newform = new MastroImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_MASTROACCERT) { newform = new MastroAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_MASTROGENERA) { newform = new MastroGenerale(); break fine; }
      if (FormIdx==MyGlb.FRM_VOCIPATTO) { newform = new VociPatto(); break fine; }
      if (FormIdx==MyGlb.FRM_MONITORADATI) { newform = new MonitoraggioDati(); break fine; }
      if (FormIdx==MyGlb.FRM_REPOMONIDATI) { newform = new ReportMonitoraggioDati(); break fine; }
      if (FormIdx==MyGlb.FRM_MONITOPREVEN) { newform = new MonitoraggioPreventivo(); break fine; }
      if (FormIdx==MyGlb.FRM_REPOMONIPREV) { newform = new ReportMonitoraggioPreventivo(); break fine; }
      if (FormIdx==MyGlb.FRM_COMUVARDIBIL) { newform = new ComunicazioneVariazioniDiBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_COMVARDELFPV) { newform = new ComunicazioneVariazioniDelFPV(); break fine; }
      if (FormIdx==MyGlb.FRM_COMESEOGESPR) { newform = new ComunicazioneEsercizioOGestioneProvv(); break fine; }
      if (FormIdx==MyGlb.FRM_STANZCONRESI) { newform = new StanziamentiConResidui(); break fine; }
      if (FormIdx==MyGlb.FRM_COMUALTESRES) { newform = new ComunicazioneAlTesoriereResidui(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPLORCAPITO) { newform = new EsploratorePerCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPLOPERBILA) { newform = new EsploratorePerBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPEPIDECOIN) { newform = new EsploratorePerPianoDeiContiIntegrato(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPLPERVLIVE) { newform = new EsploratorePerVLivello(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPLOPERRESP) { newform = new EsploratorePerResponsabile(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPEREADUNDA) { newform = new EsploratorePerResponsabileAdUnaData(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPPERCEDICO) { newform = new EsploratorePerCentroDiCosto(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPPERBENDEB) { newform = new EsploratorePerBenDeb(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPLOPERDELI) { newform = new EsploratorePerDelibera(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPLOPERMACR) { newform = new EsploratorePerMacroaggregati(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPPERUNGECA) { newform = new EsploratorePerUnitaGestioneCapitolo(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPPERUNGEMA) { newform = new EsploratorePerUnitaGestioneMacroaggregati(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPPERRESMAC) { newform = new EsploratorePerResponsabileMacroaggregati(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPPERFINOP1) { newform = new EsploratorePerFinanziamentoOpera(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPPERCAFIOP) { newform = new EsploratorePerCapitoloFinOpe(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPPERFINOPE) { newform = new EsploratorePerFinopeOpefin(); break fine; }
      if (FormIdx==MyGlb.FRM_STANBILAEFFE) { newform = new StanziamentoBilancioEffettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_STANBILASIMU) { newform = new StanziamentoBilancioSimulato(); break fine; }
      if (FormIdx==MyGlb.FRM_FINAVADIAMEF) { newform = new FinanziamentoAvanzoDiAmministrazioneEffettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_FINALTVOPEEF) { newform = new FinanziamentoAltreVociPegEffettivo(); break fine; }
      if (FormIdx==MyGlb.FRM_FINAVADIAMSI) { newform = new FinanziamentoAvanzoDiAmministrazioneSimulato(); break fine; }
      if (FormIdx==MyGlb.FRM_FINALTVOPESI) { newform = new FinanziamentoAltreVociPegSimulato(); break fine; }
      if (FormIdx==MyGlb.FRM_VARIAZBILANC) { newform = new VariazioniBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOACCERT) { newform = new ElencoAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCACCEFIN) { newform = new ElencoAccertamentiFin(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEACCFINOPE) { newform = new ElencoAccertamentiFinOpe(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCOIMPEGN) { newform = new ElencoImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCIMPEOPE) { newform = new ElencoImpegniOpe(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEIMPFINOPE) { newform = new ElencoImpegniFinOpe(); break fine; }
      if (FormIdx==MyGlb.FRM_SITURESIENTR) { newform = new SituazioneResiduiEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_SITURESISPES) { newform = new SituazioneResiduiSpesa(); break fine; }
      if (FormIdx==MyGlb.FRM_CHIUAUTOPREN) { newform = new ChiusuraAutomaticaPrenotazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENLIQUESPL) { newform = new ElencoLiquidazioniEsploratore(); break fine; }
      if (FormIdx==MyGlb.FRM_PARAMPREVPEG) { newform = new ParametriPrevisioniPEG(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUAPREVPEG) { newform = new VisualizzazionePrevisioniPEG(); break fine; }
      if (FormIdx==MyGlb.FRM_PARAMSITUPEG) { newform = new ParametriSituazionePEG(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUASITUPEG) { newform = new VisualizzazioneSituazionePEG(); break fine; }
      if (FormIdx==MyGlb.FRM_PARASITUIMPE) { newform = new ParametriSituazioneImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUSITUIMPE) { newform = new VisualizzazioneSituazioneImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_PARSITSUBIMP) { newform = new ParametriSituazioneSubImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_VISSITSUBIMP) { newform = new VisualizzazioneSituazioneSubImpegni(); break fine; }
      if (FormIdx==MyGlb.FRM_PARASITUACCE) { newform = new ParametriSituazioneAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUSITUACCE) { newform = new VisualizzazioneSituazioneAccertamenti(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEDINFOBIL) { newform = new SchedaInformativaBil(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEDINFOMOV) { newform = new SchedaInformativaMov(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEDINFOLIQ) { newform = new SchedaInformativaLiq(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEDCOMPFPV) { newform = new SchedaComposizioneFPV(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHCOMFPVENT) { newform = new SchedaComposizioneFPVEntrata(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOVARICRON) { newform = new InfoVariazioneCrono(); break fine; }
      if (FormIdx==MyGlb.FRM_FINANZCRONOP) { newform = new FinanziamentiCronoprogramma(); break fine; }
      if (FormIdx==MyGlb.FRM_INFODISPPROV) { newform = new InfoDispProvv(); break fine; }
      if (FormIdx==MyGlb.FRM_SCHEINFOVARI) { newform = new SchedaInformazioniVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_DETTADELPURO) { newform = new DettaglioDelPuro(); break fine; }
      if (FormIdx==MyGlb.FRM_PROPODAUFFIC) { newform = new ProposteDaUffici(); break fine; }
      if (FormIdx==MyGlb.FRM_TOTALIPROPOS) { newform = new TotaliProposta(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTRODISPON) { newform = new ControlloDisponibilita(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTROQUADR1) { newform = new ControlloQuadratura1(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIVARIBILA) { newform = new AggiornamentoVariazioniBilancio(); break fine; }
      if (FormIdx==MyGlb.FRM_GENERAVARIAZ) { newform = new GenerazioneVariazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_ELIMVARIGENE) { newform = new EliminazioneVariazioniGenerate(); break fine; }
      if (FormIdx==MyGlb.FRM_DATIBENEFICI) { newform = new DatiBeneficiario(); break fine; }
      if (FormIdx==MyGlb.FRM_CONTOCONSUNT) { newform = new ContoConsuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_ELEANOCODDL7) { newform = new ElencoAnomalieCodiciDL77(); break fine; }
      if (FormIdx==MyGlb.FRM_QUARIADELGES) { newform = new QuadroRiassuntivoDellaGestione(); break fine; }
      if (FormIdx==MyGlb.FRM_AVANZDIAMMIN) { newform = new AvanzoDiAmministrazione(); break fine; }
      if (FormIdx==MyGlb.FRM_PEGCONSUNTIV) { newform = new PEGConsuntivo(); break fine; }
      if (FormIdx==MyGlb.FRM_ESDAPECODECO) { newform = new EstrazioneDatiPerCorteDeiConti(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMPEDIRIGE) { newform = new StampeDirigenziali(); break fine; }
      if (FormIdx==MyGlb.FRM_CFAMEST) { newform = new MenuStampe(); break fine; }
      if (FormIdx==MyGlb.FRM_RICLASCAPITO) { newform = new RiclassificazioniCapitoli(); break fine; }
      if (FormIdx==MyGlb.FRM_MOVIMENTAZIO) { newform = new Movimentazione(); break fine; }
      if (FormIdx==MyGlb.FRM_BONLIV5CODEU) { newform = new BonificaLivello5CodEuropeo(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIORLIVEL5) { newform = new AggiornamentoLivello5(); break fine; }
      if (FormIdx==MyGlb.FRM_AGGIOCODEURO) { newform = new AggiornamentoCodEuropeo(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPCONCLADIV) { newform = new CapitoliConClasifDiverse(); break fine; }
      if (FormIdx==MyGlb.FRM_CAPITCONANOM) { newform = new CapitoliConAnomalie(); break fine; }
      if (FormIdx==MyGlb.FRM_INFOGENEAPPL) { newform = new InformazioniGeneraliApplicazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_VERIBASEDATI) { newform = new VerificaBaseDati(); break fine; }
      if (FormIdx==MyGlb.FRM_PERSONALIZZA) { newform = new Personalizzazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_REGISTRO) { newform = new Registro(); break fine; }
      if (FormIdx==MyGlb.FRM_APPLICINTEGR) { newform = new ApplicativiIntegrati(); break fine; }
      if (FormIdx==MyGlb.FRM_VALIDAZIFILE) { newform = new ValidazioneFile(); break fine; }
      if (FormIdx==MyGlb.FRM_CONSOLERRORI) { newform = new ConsolleErrori(); break fine; }
      if (FormIdx==MyGlb.FRM_STAMPCONPARA) { newform = new StampaConParametri(); break fine; }
      if (FormIdx==MyGlb.FRM_ALBEROESTRAZ) { newform = new AlberoEstrazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUMODIESTR) { newform = new VisualizzaModificaEstrazione(); break fine; }
      if (FormIdx==MyGlb.FRM_ESPORTAZDATI) { newform = new EsportazioneDati(); break fine; }
      if (FormIdx==MyGlb.FRM_ANTEPRIMDATI) { newform = new AnteprimaDati(); break fine; }
      if (FormIdx==MyGlb.FRM_ELENCODOCUME) { newform = new ElencoDocumenti(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUALESTRAZ) { newform = new VisualizzatoreEstrazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_CATEGORIE) { newform = new Categorie(); break fine; }
      if (FormIdx==MyGlb.FRM_IMPORTESTRAZ) { newform = new ImportaEstrazioni(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUALSELECT) { newform = new VisualizzaSelect(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUDESCIMPO) { newform = new VisualizzaDescrizioneImport(); break fine; }
      if (FormIdx==MyGlb.FRM_STATISTICHE) { newform = new Statistiche(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUASELELOG) { newform = new VisualizzaSelectLog(); break fine; }
      if (FormIdx==MyGlb.FRM_VISUINFOQUER) { newform = new VisualizzaInfoQuery(); break fine; }
      if (FormIdx==MyGlb.FRM_STAPREPERCAP) { newform = new StampePrevisionePerCapitolo(); break fine; }
    }
    if (newform != null)
    {
      newform.MainFrm = this;
      return newform;
    }
    //
    // Se non ci sono riuscito, provo con i miei componenti
    ListIterator pos = CompList.listIterator();
    while (pos.hasNext())
    {
      WebEntryPoint cmp = (WebEntryPoint)pos.next();
      newform = cmp.CreateFormByIndex(FormIdx);
      if (newform != null)
        return newform;
    }
    //
    return null;
  }

  // **********************************************
  // Gestione delle FORMS / (by name)
  // **********************************************
  public boolean Show(String FormName, int OpenAs)
  {
    return Show(FormName, OpenAs, null);
  }
  public  boolean Show(String FormName, int OpenAs, Object parentObj)
  {
    boolean ris = false;
    //
    try
    {
      WebForm newform = (WebForm)(Class.forName(FormName).newInstance());
      newform.Init(this, false, false);
      Show(newform.FormIdx, OpenAs, parentObj);
    }
    catch(Exception e)
    {
      ;
    }
    return ris;
  }


  // **********************************************************************
  // Open database connection as needed
  // **********************************************************************
  public void OpenConnection(IDConnection DB)
  {
    if (DB == null || DB.IsOpen())
      return; // Not a connection or not closed
    //
    if (DB == Cf4armDBObject.DB) Cf4armDBObject.OpenConnection("", "", "");
  }


  // **********************************************
  // Command Activation Handler
  // **********************************************
  public void CmdClickCB(int CmdIdx)
  {
    DispatchToComp("CmdClickCB", new Object[] { new Integer(CmdIdx) });
    fine:
    {
      if (CmdIdx==MyGlb.CMD_SCELTAESERCI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SCELTAESERCI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SCELTAUFFICI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SCELTAUFFICI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SCHEMASTRUTT+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SCHEMASTRUTT, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_STRUTTURA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_STRUTTURA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TIPIRICLASSI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TIPIRICLASSI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SCHEMIRICLAS+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SCHEMIRICLAS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_STRUTTRICLAS+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_STRUTTRICLAS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PROGRAMCOFOG+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PROGRAMCOFOG, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CODICILIBERI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CODICILIBERI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CODICIGESTIO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CGECGU, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TIPIMOTIVAZ1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TIPIMOTIVARI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TIPIVARIAZI1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TIPIVARIAZI1, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_FINANZIAMEN9+BaseCmdLinIdx)
      {
        MainFrm.ApriFinanziamento();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_OPERE1+BaseCmdLinIdx)
      {
        MainFrm.ApriOpera();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TITOLI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TITOLI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAPICONTTERZ+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CAPICONTTERZ, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_FUNZIOSERVIZ+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_FUNZIOSERVIZ, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ALLEGATI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ALLEGATI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VOCIECONOMIC+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VOCIECON, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CODICICERTIF+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CODICICERTIF, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_FLESSIBILITA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_FLESSIBILITA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PROGRAEPROGE+BaseCmdLinIdx)
      {
        MainFrm.ApriProgrammaProgetto();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CENTRDICOSTO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CENTRDICOSTO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TIPIMOTIVAZI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TIPIMOTIVAZI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TIPIVARIAZIO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TIPIVARIAZIO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TIPIVARICRON+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TIPIVARICRON, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TIPIAVANZO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TIPIAVANZO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VINCOLI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VINCOLI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAUSALI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CAUSALI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TIPIBOLLO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TIPIBOLLO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_FIRME+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_FIRME, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONTRISTRAOR+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CONTRISTRAOR, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TIPIINCARICO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TIPIINCARICO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VOCITECNOPER+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VOCITECNOPER, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CODICIFISCAL+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CODICIFISCAL, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAUSALFISCAL+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CAUSALFISCAL, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAUSALIIRAP+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CAUSALIIRAP, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAUSALPREVID+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CAUSALPREVID, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAUSALIINAIL+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CAUSALIINAIL, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CATEGOSOGGET+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CATEGOSOGGET, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TIPISCADENZA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TIPISCADENZA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TIPIQUIETANZ+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TIPIQUIETANZ, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CATEGODOCUME+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CATEGODOCUME, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_UFFICI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_UFFICI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SMISTAFE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SMISTAFATTUR, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAUSALSOSPEN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CAUSALSOSPEN, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TIPIREGISTRO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TIPIREGISTRO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESENZIONI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ESENZIONI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ATTIVITA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ATTIVITA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CODICISTATIS+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CODICISTATIS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_REGISTRI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_REGISTRI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TIPIESECUTIV+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TIPIESECUTIV, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_FATTORI+BaseCmdLinIdx)
      {
        MainFrm.ApriFattori();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CENTRI+BaseCmdLinIdx)
      {
        MainFrm.ApriCentri();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CLASSICONTAB+BaseCmdLinIdx)
      {
        MainFrm.ApriClassiContabili();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PREFERENZE+BaseCmdLinIdx)
      {
        MainFrm.ApriParametri();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PREFERINFORM+BaseCmdLinIdx)
      {
        MainFrm.ApriProcedureInformazioni();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PARAMETRIWEB+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PREFERENZWEB, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PARTRAATTCON+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PARTRAATTCON, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ASSTIPCOSEPC+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ASSTIPCOSEPC, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ENTE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ENTE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ENTEINFORMAZ+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ENTEINFORMAZ, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TESORIERE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TESORIERE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TESORIINFORM+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TESORIINFORM, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_NUMERAZIONI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_NUMERAZIONI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_NUMERAINFORM+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_NUMERAINFORM, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TESTISTAMPE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TESTISTAMPE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_COMPETENZE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_COMPETENZE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ASSESSORATI+BaseCmdLinIdx)
      {
        MainFrm.LanciaAssessorati();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_DELIBERE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_DELIBERE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESECUTPROPOS+BaseCmdLinIdx)
      {
        MainFrm.ApriEsecutivitàProposte();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESECPRODAGS4+BaseCmdLinIdx)
      {
        MainFrm.ApriEsecutivitàProposteGs4();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_MOVIMEPROPOS+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_MOVIMEPROPOS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_STAMPAPROPOS+BaseCmdLinIdx)
      {
        MainFrm.ApriStampaProposte();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SERVIZDIRETT+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SERVIZDIRETT, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SOGGETTI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SOGGETTI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_INFORMAZIONI+BaseCmdLinIdx)
      {
        MainFrm.ApriInfoSoggetto();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GENSOGPERECO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_GENSOGPERECO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CORRISREGION+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CORRISREGION, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONTROSOGGET+BaseCmdLinIdx)
      {
        MainFrm.ControlloSoggetti();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CARICASOGGET+BaseCmdLinIdx)
      {
        MainFrm.CaricamentoSoggetti();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_Documenti+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_FATTURE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONTROFATTUR+BaseCmdLinIdx)
      {
        MainFrm.ApriControlloFatture();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GENEIMPUECON+BaseCmdLinIdx)
      {
        MainFrm.ApriGenerazioneImputazioniEconomica();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_DOCPERIMPCON+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_DOCPERIMPCON, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_DOCPERIMPECO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_DOCPERIMPECO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_DOCUMPERQUIE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_DOCUMPERQUIE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SCADENZIARIO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SCADENZIARIO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CORRISPETTI1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CORRISPETTIV, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESTRATTCONT1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ESTRATTCONTO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_DOCUMEAPERTI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_DOCUMEAPERTI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PROTOCOLLO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PROTOCOLLO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RENDICMANDAT+BaseCmdLinIdx)
      {
        MainFrm.ApriRendicontoMandati();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RENDICFATTUR+BaseCmdLinIdx)
      {
        MainFrm.ApriRendicontoFatture();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PROVVDILIQUI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PROVVELIQUID, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_LIQPERCODUTE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SITLIQPECOUT, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_LIQUIPERIMPE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SITLIQPERIMP, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELENCOINCASS+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ELENCOINCASS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_IVA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_IVA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_UTENZE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_UTENZE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CORRISPETTIV+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_DOCUMECORRIS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_DEBITOCODIFI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_DOCUDEBICODI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_DEBITNONCODI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_DOCDEBNONCOD, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_EMISSIACCER1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_EMISSIACCERT, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAUSALEPERIO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CAUSALEPERIO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_FATTURELETTR+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_FATTURELETTR, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_INTERSCAMSDI+BaseCmdLinIdx)
      {
        MainFrm.InterscambioSDI();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_COMUNIFATTUR+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ELENFILEINVI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_INTEGRAZIPCC+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_INTEGRAZIPCC, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PIANODEICON1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PIADEICONLIS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CORRISCAPITO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CORRISCAPITO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RETTUOSUCAPI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RETTUOSUCAPI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RETTIMASSIUO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RETTIMASSIUO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RETUOPERCAOT+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RETUOPERCAOT, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESERCIFINANZ+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ESERCIFINANZ, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TIPICALCCASS+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_TIPICALCCASS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCCALCSTAN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PERCCALCSTAN, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GENERABILANC+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_GENERABILANC, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_APERNUOVBIL1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_APERNUOVBILA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CALCBILASIMU+BaseCmdLinIdx)
      {
        MainFrm.MenuCalcoliBilancioSimulato();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CALCBILAEFFE+BaseCmdLinIdx)
      {
        MainFrm.MenuCalcoliBilancioEffettivo();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PASSSUBILEFF+BaseCmdLinIdx)
      {
        MainFrm.PassaggiosuBilancioEffettivo();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELIMBILASIMU+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ELIMBILASIMU, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SCHECOMPSTAN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SCHECOMPSTAN, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_EFFETTIVO+BaseCmdLinIdx)
      {
        MainFrm.ApriStanziamentiEffettivo();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SIMULATO+BaseCmdLinIdx)
      {
        MainFrm.ApriStanziamentiSimulato();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CRONOPROGRAM+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CRONOPROGRAM, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_STAMPACRONOP+BaseCmdLinIdx)
      {
        MainFrm.StampaCronoprogramma();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_STAMELENVAR1+BaseCmdLinIdx)
      {
        MainFrm.StampaElencoVariazioni();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELENCOCRONOP+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ELENCOCRONOP, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PARAMETRI+BaseCmdLinIdx)
      {
        MainFrm.ApriParametriFSC();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_DEFITIPOCALC+BaseCmdLinIdx)
      {
        MainFrm.DefinizioneTipoCalcolo();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CALFCDBILPRE+BaseCmdLinIdx)
      {
        MainFrm.CalcoloGeneraleFondo();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CALCFCDINGES+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CALCFCDINGES, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CALCFCDDAREN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_FCDDEARENDIC, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PARABILAPREV+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PARABILAPREV, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VERIFIANOMAL+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VERIFIANOMAL, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_STAMBILAPREV+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_STAMBILAPREV, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_STAMBILAAGGI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_STAMBILAAGGI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ENTRATA1+BaseCmdLinIdx)
      {
        MainFrm.PrevPegEntrata();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ENTPERCEDIC1+BaseCmdLinIdx)
      {
        MainFrm.PrevPegEntrataCC();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ENTPERUNIOR1+BaseCmdLinIdx)
      {
        MainFrm.PrevPegEntrataUO();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SPESA1+BaseCmdLinIdx)
      {
        MainFrm.PrevPegSpesa();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SPEPERCEDIC1+BaseCmdLinIdx)
      {
        MainFrm.PrevPegSpesaCC();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SPEPERUNIOR1+BaseCmdLinIdx)
      {
        MainFrm.PrevPegSpesaUO();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_BILANPERCAP1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_BILANPERCAPI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ENTRATA+BaseCmdLinIdx)
      {
        MainFrm.PegAggEntrata();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ENTPERCEDICO+BaseCmdLinIdx)
      {
        MainFrm.PegAggEntrataCC();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ENTPERUNIORG+BaseCmdLinIdx)
      {
        MainFrm.PegAggEntrataUO();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SPESA+BaseCmdLinIdx)
      {
        MainFrm.PegAggSpesa();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SPEPERCEDICO+BaseCmdLinIdx)
      {
        MainFrm.PegAggSpesaCC();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SPEPERUNIORG+BaseCmdLinIdx)
      {
        MainFrm.PegAggSpesaUO();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_BILPERCAPAGG+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_BILPERCAPAGG, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_BILANCPREVIS+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_BILANCPREVIS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RIEPSPESGENE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RIEGENSPEPRE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_FUNZIODELEG1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_FUNZIODELEGA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONTCOMUINT1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CONTCOMUINTE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_QUADRORIASSU+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_QUAGENRIAPRE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_BILANCPLURIE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_BILANCPLURIE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_BILANCAGGIOR+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_BILANCAGGIOR, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAPITOPREVEN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PEGPREVENTIV, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PREVIPERSERV+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PREVIPERSERV, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PREPERSETOPE+BaseCmdLinIdx)
      {
        MainFrm.ApriPrevisioniPerSettoreOperativo();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PREPERCEDICO+BaseCmdLinIdx)
      {
        MainFrm.ApriPrevisioniPerCentroDiCosto();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PREPERUNDIGE+BaseCmdLinIdx)
      {
        MainFrm.ApriPrevisioniPerUnitaDiGestione();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PREPERUNDIUT+BaseCmdLinIdx)
      {
        MainFrm.ApriPrevisioniPerUnitaDiUtilizzo();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PREPERTIDISP+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PREPERTIDISP, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PREVIPERPROG+BaseCmdLinIdx)
      {
        MainFrm.ApriPrevisioniPerProgramma();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PREVIPERVINC+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PREVIPERVINC, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PREVIPERFLES+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PREVIPERFLES, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PREVISFINANZ+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PREVISFINANZ, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PREVSERINECO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PREVSERINECO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAPITOPLURIE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PEGPLURIENNA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAPITOAGGIOR+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PEGAGGIORNAT, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_BILANCATESOR+BaseCmdLinIdx)
      {
        MainFrm.ApriBilancioATesoreria();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESTRADATIRPP+BaseCmdLinIdx)
      {
        MainFrm.ApriEstrazioniDatiRPP();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_AMMINITRASP1+BaseCmdLinIdx)
      {
        MainFrm.LanciaStampaAmministrazioneTrasparente();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_AMMITRASDL78+BaseCmdLinIdx)
      {
        MainFrm.LanciaStampaAmministrazioneDL77Prev();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PARABILACONS+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PARABILACONS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_STAMBILACONS+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_STAMBILACONS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_BILANPERCAPI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_BILPERCAPCON, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CERTPARAOBIE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CERTPARAOBIE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_AMMINITRASPA+BaseCmdLinIdx)
      {
        MainFrm.LanciaStampaAmministrazioneTraspCons();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_AMMITRASDL77+BaseCmdLinIdx)
      {
        MainFrm.LanciaStampaAmministrazioneDL77Cons();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONTOCONSOLD+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CONTOCONSOLD, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RIEPGENESPES+BaseCmdLinIdx)
      {
        MainFrm.RiepilogoGeneraleSpese();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_QUADGENERIA1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_QUADGENERIAS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_FUNZIODELEGA+BaseCmdLinIdx)
      {
        MainFrm.FunzioniDelegateBilancioConsuntivo();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONTCOMUINTE+BaseCmdLinIdx)
      {
        MainFrm.StampaContributiComunitariInternazionali();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SERVIINECON1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SERVIINECONO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_QUARIADELGE1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_QUARIADELGES, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIAAIRESI1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VARIAAIRESID, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESTDATCERCON+BaseCmdLinIdx)
      {
        MainFrm.ApriEstrazioniDatiCertificatoConsuntivo();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONTODELTESO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CONTODELTESO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAPITOCONSUN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PEGCONSUNOLD, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIAAIRESID+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VARAIRESPECO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SERVIINECONO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SERINECOPECO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIAZDEFINI+BaseCmdLinIdx)
      {
        MainFrm.CmdEstremiVariazioniDefinitive();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIAZPROVVI+BaseCmdLinIdx)
      {
        MainFrm.CmdEstremiVariazioniProvvisorie();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIADACRONO+BaseCmdLinIdx)
      {
        MainFrm.VariazionidaCronoprogramma();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESIGCONSUNTI+BaseCmdLinIdx)
      {
        MainFrm.VariazioniEsigConsuntivo();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESIGANNOCORR+BaseCmdLinIdx)
      {
        MainFrm.VariazioniEsigAnnoCorrente();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESIGANTICIPA+BaseCmdLinIdx)
      {
        MainFrm.VariazioniEsigAnticipata();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESIGRITAENTR+BaseCmdLinIdx)
      {
        MainFrm.VariazioniEsigRitardataEntrata();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESIGANTIENTR+BaseCmdLinIdx)
      {
        MainFrm.VariazioniEsigAnticipataEntrata();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELIMIVARESIG+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ELIMIVARESIG, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIAZIMPEG1+BaseCmdLinIdx)
      {
        MainFrm.ApriVariazioniImpegnabile();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIDABUDCE4+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VARIDABUDCE4, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESECUTVARIAZ+BaseCmdLinIdx)
      {
        MainFrm.ApriEsecutivitàVariazioni();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESECVARDAGS4+BaseCmdLinIdx)
      {
        MainFrm.ApriEsecutivitàVariazioniGs4();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIAZATESOR+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VARIAZATESOR, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ASSESTAMENTI+BaseCmdLinIdx)
      {
        MainFrm.ApriAssestamenti();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PROPOSTE+BaseCmdLinIdx)
      {
        MainFrm.ApriProposte();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELENCOVARIAZ+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ELENCOVARIAZ, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_COMPOSVARIAZ+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_COMPOSVARIAZ, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_COMPOVARIFPV+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_COMPOVARIFPV, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ALLEGATOVAR+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ALLEGAVARIAZ, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIAPERFINA+BaseCmdLinIdx)
      {
        MainFrm.ApriVariazioniPerFinanziamento();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIAPERPROG+BaseCmdLinIdx)
      {
        MainFrm.ApriVariazioniPerProgetto();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CFAVALRI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VARIAPERESIG, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONTRVARPROV+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CONTRVARPROV, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIEQUDIBIL+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VARIEQUDIBIL, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_AGGITIPOAVAN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_AGGITIPOAVA1, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GESTIOAVANZO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_GESTIOAVANZO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SALDTIPIAVAN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SALDTIPIAVAN, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_AVANZOESERCI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PARAAVANESER, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GENERALE1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SITUAZGENERA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SITUAZDODICE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SITUAZDODICE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SITPERPRISEM+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SITPERPRISEM, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SITUAPERCLAS+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SITUAPERCLAS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SITUTIPDISPE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SITUTIPDISPE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SITGENPEUNOR+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SITGENPEUNOR, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SITCAPPECAFI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SITCAPPECAFI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SICAPEFOFIUO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SICAPEFOFIUO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERMISPROTIT+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SITPERCLAMIS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERMISPROMAC+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SITPECLMIEMA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERTITOLTIPO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SITPERCLTITI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERMACROAGG1+BaseCmdLinIdx)
      {
        MainFrm.ApriStampaRiclMacroaggregati();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCODIIVLIV+BaseCmdLinIdx)
      {
        MainFrm.ApriStampaCodiceIVLiv();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCODIVLIVE+BaseCmdLinIdx)
      {
        MainFrm.ApriStampaCodiceVLiv();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCODICCOFO+BaseCmdLinIdx)
      {
        MainFrm.ApriStampaCodiceCofog();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERFLESSIBIL+BaseCmdLinIdx)
      {
        MainFrm.ApriStampaSitPerFlessibilità();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERTIPOVINCO+BaseCmdLinIdx)
      {
        MainFrm.ApriStampaSitPerVincolo();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERUNITAORGA+BaseCmdLinIdx)
      {
        MainFrm.ApriStampaSitPerDirgen();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PREVENTIVO+BaseCmdLinIdx)
      {
        MainFrm.GeneraDatiCertificatoPreventivo();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONSUNTIVO+BaseCmdLinIdx)
      {
        MainFrm.GeneraDatiCertificatoConsuntivo();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CASSA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CASSA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESTRAZIOBDAP+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ESTRAZIOBDAP, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GESTIONEBDAP+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_GESTIONEBDAP, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_NUOVOIMPEGN1+BaseCmdLinIdx)
      {
        MainFrm.ApriNuovoImpegno();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_NUOVREISIMPE+BaseCmdLinIdx)
      {
        MainFrm.ApriNuovaReiscrizioneImpegno();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAIMFNGS+BaseCmdLinIdx)
      {
        MainFrm.ApriGenImpDaEsig();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAIMFNIC+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_GENEIMPDACRO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GENVARIMDACR+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_GEVAIMDACDVB, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELENIMPEREIS+BaseCmdLinIdx)
      {
        MainFrm.ApriElencoImpegniReiscritti();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELENSUBIREIS+BaseCmdLinIdx)
      {
        MainFrm.AprioElencoSubimpegniReiscritti();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GENIMPPERECO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_GENIMPPERECO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RETTIFIOPERA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RETTIFIOPERA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RETTIFCAPIT1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RETTICAPIIMP, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GIORNAIMPEGN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_GIORNAIMPEGN, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIAZIMPEGN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VARIAZIMPEGN, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_INCARICHI1+BaseCmdLinIdx)
      {
        MainFrm.ApriIncarichi();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SCHEDAINCARI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SCHEDAINCARI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_IMPEAUTODISP+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_IMPEAUTODISP, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_STORIAIMPEGN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_STORIAIMPEGN, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_STASTASTOIMP+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_STAMSTORIMPE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_NUOVOSUBIMP1+BaseCmdLinIdx)
      {
        MainFrm.ApriNuovoSubimpegno();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_NUOVREISSUBI+BaseCmdLinIdx)
      {
        MainFrm.ApriNuovaReiscrizioneSubimpegno();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIAZSUBIMP+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VARIAZSUBIMP, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_STORIASUBIMP+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_STORIASUBIMP, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_NUOVOACCERT1+BaseCmdLinIdx)
      {
        MainFrm.ApriNuovoAccertamento();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_NUOVREISACCE+BaseCmdLinIdx)
      {
        MainFrm.ApriNuovaReiscrizioneAccertamento();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RETTIFFINANZ+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RETTIFFINANZ, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RETTIFCAPITO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RETTIFCAPITO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GIORNAACCERT+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_GIORNAACCERT, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIAZACCERT+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VARIAZACCERT, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GENEACCDAESI+BaseCmdLinIdx)
      {
        MainFrm.ApriGenAccDaEsig();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELENACCEREIS+BaseCmdLinIdx)
      {
        MainFrm.ApriElencoAccertamentiReiscritti();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ACCERTAGRUPP+BaseCmdLinIdx)
      {
        MainFrm.ApriAccertamentiAGruppi();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERIODRIACCE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PERIODRIACCE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PROVARIMPSUB+BaseCmdLinIdx)
      {
        MainFrm.ProposteVariazioniImpegniSubimpegni();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PROPVARIACCE+BaseCmdLinIdx)
      {
        MainFrm.ProposteVariazioniAcc();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESTRAZPROPOS+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ESTRAZPROPOS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SITPROVARRIA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SITPROVARRIA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GENERAVARIA4+BaseCmdLinIdx)
      {
        MainFrm.GenerazioneVariazioni();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELIMINVARIA1+BaseCmdLinIdx)
      {
        MainFrm.EliminazioneVariazioni();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_LIQUIDAZION2+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SCELTALIQUID, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_LIQUIDAGRUPP+BaseCmdLinIdx)
      {
        MainFrm.ApriLiquidazioniAGruppi();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_LIQUIDMULTI1+BaseCmdLinIdx)
      {
        MainFrm.ApriLiquidazioneMultipla();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CARICAIMPUT1+BaseCmdLinIdx)
      {
        MainFrm.ApriCaricamentoImputazioniSpesa();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_AGGIAUTOIMPE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_AGGIAUTOIMPE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONTROIMPUT1+BaseCmdLinIdx)
      {
        MainFrm.ApriControlloImputazioniLiquidazioni();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESTRAZIMPUT1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ESTRAIMPULIQ, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_LIQUIDAZIONE+BaseCmdLinIdx)
      {
        MainFrm.ApriLiquidazioneSP();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_LIQUVERSRITE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_LIQUVERSRITE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RETTIFIMPEGN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_FORMRETTIMPE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RETTIFSUBIMP+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RETTIFSUBIMP, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GIORNALIQUID+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_GIORNALIQUID, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_LIQPERPRODEL+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_LIQPERPRODEL, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_DISTIDILIQUI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_DISTIDILIQUI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONTCONTDIST+BaseCmdLinIdx)
      {
        MainFrm.ApriControlloContabileDistinta();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_LIQUPARZDIST+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_LIQUPARZDIST, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_EMLIIVPERECH+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_EMLIIVPERECH, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_LIQUDADISECO+BaseCmdLinIdx)
      {
        MainFrm.ApriLiquidazioniDaDistintaEconomato();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_LIQDISCASECO+BaseCmdLinIdx)
      {
        MainFrm.ApriLiquidazioniDistintaCassaEconomale();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONTSOGGLIQU+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CONTRSOGGLIQ, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CARISOGGLIQU+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CARICSOGGLIQ, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_MANDATI1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_MANDATI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_LIQDAEMEINMA+BaseCmdLinIdx)
      {
        MainFrm.CmdLiqDaEmettere();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_EMISAUTOMAND+BaseCmdLinIdx)
      {
        MainFrm.ApriEmissioneAutomaticaMandati();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_EMISMANUMAND+BaseCmdLinIdx)
      {
        MainFrm.CmdEmissioneManualeMandato();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_STAMPAMANDAT+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_STAMPAMANDAT, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_AVVISDIPAGAM+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_AVVISDIPAGAM, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_DISTDITRAMAN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_DISTDITRAMAN, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_EMISMANUDIST+BaseCmdLinIdx)
      {
        MainFrm.CmdEmissioneManualeDistinta();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PAGAMECOMPL1+BaseCmdLinIdx)
      {
        MainFrm.ApriPagamentoCompleto();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ANNULLPAGAM1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ANNULLPAGAME, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RETTIMPDIMAN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RETTIMPDIMAN, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RETSUBIMDIMA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RETSUBIMDIMA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GIORNAMANDAT+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_GIORNAMANDAT, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIAZMANDAT+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VARIAAIMANDA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_MANDANONPAGA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_MANDANONPAGA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RIEMINONPAGA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RIEMINONPAGA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GIORNAPAGAME+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_GIORNAPAGAME, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_MAEMSUCARIIV+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_MAEMSUCARIIV, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_INCARICHI+BaseCmdLinIdx)
      {
        MainFrm.ApriIncarichi1();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TRASMANDATES+BaseCmdLinIdx)
      {
        MainFrm.ApriTrasmissioneMandatiATesoreria();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RICEPAGDATES+BaseCmdLinIdx)
      {
        MainFrm.ApriRicezionePagamentiDaTesoreria();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_MANPERVEIVIS+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_MANPERVEIVIS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_EMIMANCASEC1+BaseCmdLinIdx)
      {
        MainFrm.EmissMandatiCassaEconomale();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RITENUFISCAL+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RITENUFISCAL, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RITENPERADDI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RITENPERADDI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_DISTRITEFISC+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_DISTRITEFISC, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_DISRITPERADD+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_DISRITPERADD, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CERTSOSTDIMP+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CERTSOSDIIMP, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONTROQUADRI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CONTROQUADRI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONTRIMINIMI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CONTRIMINIMI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ERRBLOCON770+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ERRBLOCON770, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESTRAZION770+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ESTRAZION770, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESTRAZIONECU+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ESTRAZIONECU, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RITENUTEIRAP+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RITENUTEIRAP, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RITENUPREVID+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RITENUPREVID, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RITENUTINAIL+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RITENUTINAIL, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ANNULLI1+BaseCmdLinIdx)
      {
        MainFrm.ApriAnnulliMandato();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIAZIONI7+BaseCmdLinIdx)
      {
        MainFrm.ApriVariazioniMandato();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SOSTITUZION1+BaseCmdLinIdx)
      {
        MainFrm.ApriSostituzioniMandato();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAMDISTANOI1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CERCA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELIMINAINVI1+BaseCmdLinIdx)
      {
        MainFrm.ApriEliminazioneInviiMandati();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_INVIO1+BaseCmdLinIdx)
      {
        MainFrm.ApriInvioMandati();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RICEZIPAGAME+BaseCmdLinIdx)
      {
        MainFrm.ApriRicezionePagamenti();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELEANOCAFIT1+BaseCmdLinIdx)
      {
        MainFrm.ApriElencoAnomaliFileAutoMan();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CARICAPROVV1+BaseCmdLinIdx)
      {
        MainFrm.ApriCaricamentoProvvisoriMandati();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELEANOCAFIT2+BaseCmdLinIdx)
      {
        MainFrm.ApriElencoAnomaliFileAutoProvvMan();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_AGGIORPROVV1+BaseCmdLinIdx)
      {
        MainFrm.ApriGestioneProvvisoriMandati();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_EMISMANDAPRO+BaseCmdLinIdx)
      {
        MainFrm.ApriEmissioneMandatiDaProvvisori();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ORDINATIVI2+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_FORMORDINATI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ORDINAAGRUPP+BaseCmdLinIdx)
      {
        MainFrm.ApriOrdinativiAGruppi();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CARICAIMPUTA+BaseCmdLinIdx)
      {
        MainFrm.ApriCaricamentoImputazioniEntrata();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_AGGIAUTOACCE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_AGGIAUTOACCE1, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONTROIMPUTA+BaseCmdLinIdx)
      {
        MainFrm.ApriControlloImputazioniOrdinativi();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESTRAIMPUORD+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ESTRAZIMPUTA1, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ORDINATIVI4+BaseCmdLinIdx)
      {
        MainFrm.ApriOrdinativiEP();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CARICAPROVVI+BaseCmdLinIdx)
      {
        MainFrm.ApriCaricamentoProvvisoriOrdinativi();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELEANOCAFIT3+BaseCmdLinIdx)
      {
        MainFrm.ApriElencoAnomaliFileAutoProvvOrd();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_AGGIORPROVVI+BaseCmdLinIdx)
      {
        MainFrm.ApriGestioneProvvisoriOrdinativi();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_EMISORDDAPR1+BaseCmdLinIdx)
      {
        MainFrm.ApriEmissioneOrdinativiDaProvvisori();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ANNULLI2+BaseCmdLinIdx)
      {
        MainFrm.ApriAnnulliOrdinativi();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIAZIONI8+BaseCmdLinIdx)
      {
        MainFrm.ApriVariazioniOrdinativi();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SOSTITUZION2+BaseCmdLinIdx)
      {
        MainFrm.ApriSostituzioniOrdinativi();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAMDISTANOIN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CERCA1, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELIMINAINVII+BaseCmdLinIdx)
      {
        MainFrm.ApriEliminazioneInviiOrdinativi();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_INVIO+BaseCmdLinIdx)
      {
        MainFrm.ApriInvioOrdinativi();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RICEZIINCASS+BaseCmdLinIdx)
      {
        MainFrm.ApriRicezioneIncassi();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELEANOCAFITE+BaseCmdLinIdx)
      {
        MainFrm.ApriElencoAnomaliFileAutoInc();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_STAMPAORDINA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_STAMPAORDINA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_AVVISDIRISCO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_AVVISDIRISCO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_DISTDITRAORD+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_DISTDITRAORD, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONTCODIGEST+BaseCmdLinIdx)
      {
        MainFrm.ApriControlloCodiciGestionali();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONCODTRAELE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CONCODTRAELE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_INCASSCOMPL1+BaseCmdLinIdx)
      {
        MainFrm.ApriIncassoCompleto();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ANNULLINCAS1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ANNULLINCASS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RIEORDNONINC+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RIEORDNONINC, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RETTIFACCERT+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_RETTIFACCERT, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ORDINDARITEN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ORDINDARITEN, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ORDINPERSPRC+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ORDPERSPLPAY, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ORDINDACORRI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ORDINDACORRI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ORDINDAIMPUT+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ORDINDAIMPUT, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ORDDADISCAEC+BaseCmdLinIdx)
      {
        MainFrm.ApriOrdinativiDaDistintaCassaEconomale();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GIORNAORDINA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_GIORNAORDINA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GIORNAINCASS+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_GIORNAINCASS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ORDINNONINCA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ORDINNONINCA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SOLLEDIRISCO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SOLLEDIRISCO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIAZORDINA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VARIAZORDINA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_TRASORDIATES+BaseCmdLinIdx)
      {
        MainFrm.ApriTrasmissioneOrdinativiATesoreria();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RICEINCDATES+BaseCmdLinIdx)
      {
        MainFrm.ApriRicezioniIncassiDaTesoreria();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESTRATTOCCP+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ESTRATTOCCP, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_FLUSMANDREVE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_FLUSMANDREVE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GIORNDICASSA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_GIORNDICASSA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_BILANDIENTRA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_BILANDIENTRA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_BILANDISPESA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_BILANDISPESA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_BILSORMEZUNI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_BILSORMEZUNI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PROGEDIENTRA+BaseCmdLinIdx)
      {
        MainFrm.ApriProgettiDiEntrata();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PROGEDISPESA+BaseCmdLinIdx)
      {
        MainFrm.ApriProgettiDiSpesa();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIADIENTRA+BaseCmdLinIdx)
      {
        MainFrm.ApriVariazioniDiEntrata();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VARIADISPESA+BaseCmdLinIdx)
      {
        MainFrm.ApriVariazioniDiSpesa();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_IMPEGNACCERT+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_IMPEGNACCERT, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_MANDATORDINA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_MANDATORDINA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VOCIPATTO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VOCIPATTO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_MONITORADATI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_MONITORADATI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_MONITOPREVEN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_MONITOPREVEN, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCAPITOLO+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerCapitolo();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERBILANCIO+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerBilancio();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERPIADECOIN+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerPianoConti();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERVLIVELLO+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerVLivello();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERRESPONSAB+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerResponsabile();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERRESADUNDA+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerResponsabileData();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCENTDICOS+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerCentroDiCosto();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERBENEFDEBI+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerBenDeb();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERPROVVDELI+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerDelibera();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERMACROAGGR+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerMacroaggregati();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERUNIGESCAP+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerUOGestione();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERUNIGESMAC+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerUOGestioneMacroaggregati();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERRESPOMACR+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerResponsabileMacroaggregati();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERFINANZIAM+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerFinanziamento();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PEROPERA+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerOpera();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCAPFINOPE+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerCapitoloFinOpe();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERFINANOPER+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerFinOpe();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PEROPERAFINA+BaseCmdLinIdx)
      {
        MainFrm.ApriEsploratorePerOpeFin();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_MENUSTAMPE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CFAMEST, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RICLASCAPITO+BaseCmdLinIdx)
      {
        MainFrm.RiclassificazioneCapitoli();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_MOVIMENTAZIO+BaseCmdLinIdx)
      {
        MainFrm.Movimentazione();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_BONLIV5CODEU+BaseCmdLinIdx)
      {
        MainFrm.ControlloAnomalie();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAPCONCLADIV+BaseCmdLinIdx)
      {
        MainFrm.CapitoliConClasifDiverse();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CAPITCONANOM+BaseCmdLinIdx)
      {
        MainFrm.CapitoliConAnomalie();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CODLIV5GRULI+BaseCmdLinIdx)
      {
        MainFrm.CodLiv5GruppiLiq();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CODLIV5GRUOR+BaseCmdLinIdx)
      {
        MainFrm.CodLiv5GruppiOrd();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CODLIV5IMPMU+BaseCmdLinIdx)
      {
        MainFrm.CodLiv5ImpMutui();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ALBEROESTRAZ+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ALBEROESTRAZ, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VISUALESTRAZ+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VISUALESTRAZ, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CATEGORIE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CATEGORIE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_IMPORTESTRAZ+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_IMPORTESTRAZ, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_DOCUMENTI1+BaseCmdLinIdx)
      {
        ((AlberoEstrazioni)MainFrm.GetForm(MyGlb.FRM_ALBEROESTRAZ,0)).Documenti();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_STATISTICHE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_STATISTICHE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_INFORMGENERA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_INFOGENEAPPL, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VERIBASEDATI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VERIBASEDATI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERSONALIZZA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PERSONALIZZA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_REGISTRO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_REGISTRO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_APPLICINTEGR+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_APPLICINTEGR, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONSOLOGERRO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CONSOLERRORI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_VALIDAZIFILE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_VALIDAZIFILE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_NOTIFICHE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_NOTIFICHE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCLASSIFI1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ACCERPERCLAS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERDEBITORE1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ACCERPERDEBI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERIMPUTECO1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ACCPERIMPECO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCAPITOLO1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ACCERPERCAPI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCLASSIFI2+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_IMPEGPERCLAS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERBENEFICI1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_IMPEGPERBENE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERIMPUTECO2+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_IMPPERIMPECO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCAPITOLO2+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_IMPEGPERCAPI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCLASSIFI3+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SUBIMPERCLAS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERBENEFICI2+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SUBIMPERBENE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERIMPUTECO3+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SUBPERIMPECO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCAPITOLO3+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SUBIMPERCAPI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCLASSIFI4+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_LIQUIPERCLAS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERBENEFICIA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_LIQUIPERBENE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCONTDITE1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_LIQPERCODITE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERIMPEGNO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_LIQUIPERIMPE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERSUBIMPEGN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_LIQUIPERSUBI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERIMPUTECO4+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_LIQPERIMPECO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCLASSIFIC+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ORDINPERCLAS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERDEBITORE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ORDINPERDEBI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERCONTDITES+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ORDPERCODITE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERACCERTAME+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ORDINPERACCE, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PERIMPUTECON+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ORDPERIMPECO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SITUAZICASSA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SITUAZICASSA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SITCASPERVIN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SITCASPERVIN, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SALDIVINCOL1+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SALDIVINCOLI, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PROSTRIDICAS+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PROSTRIDICAS, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GIORNAVINCOL+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_GIORNAVINCOL, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_SINTEDICASSA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SINTEDICASSA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_COMPETENZA+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_SITUAZCOMPET, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_MANDATI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_MASTROMANDAT, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ORDINATIVI5+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_MASTROORDINA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_IMPEGNI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_MASTROIMPEGN, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ACCERTAMENTI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_MASTROACCERT, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_GENERALE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_MASTROGENERA, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_COMUVARDIBIL+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_COMUVARDIBIL, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_COMVARDELFPV+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_COMVARDELFPV, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_COMUSTAESEGP+BaseCmdLinIdx)
      {
        MainFrm.ApriComunicazioniStanzEseGP();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_STANZCONRESI+BaseCmdLinIdx)
      {
        MainFrm.ApriStanziamentiConResiduo();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PROSPELIQUID+BaseCmdLinIdx)
      {
        MainFrm.ApriProspettoLiquidita();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_RESIDUI+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_COMUALTESRES, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_AVANZDIAMMIN+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_AVANZDIAMMIN, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELCANOPRIND7+BaseCmdLinIdx)
      {
        MainFrm.ElencoCapitoliNonPresentiInDL77();
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ELEANOCODDL7+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ELEANOCODDL7, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_CONTOCONSUNT+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_CONTOCONSUNT, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_QUARIADELGES+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_QUARIADELGES, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_PEGCONSUNTIV+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_PEGCONSUNTIV, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_ESDAPECODECO+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_ESDAPECODECO, 0, this);
        break fine;
      }
      if (CmdIdx==MyGlb.CMD_STAMPEDIRIGE+BaseCmdLinIdx)
      {
        MainFrm.Show(MyGlb.FRM_STAMPEDIRIGE, 0, this);
        break fine;
      }
    }
  }
  
  
  // **********************************************
  // Timer Activation Handler
  // **********************************************
  public void TimerTickCB(int TimerIdx)
  {
    DispatchToComp("TimerTickCB", new Object[] { new Integer(TimerIdx) });
    fine:
    {
    }
  }


  // **********************************************
  // Get HTML for logoff Button
  // **********************************************
  public String LogoffButton()
  {
    String HF = "";
    String DTT = "";
    String TEL = "";
    String s = "";
    String bkImg = (ParamsObj().Theme.compareToIgnoreCase("zen") == 0 ? "" : " background-image:url(images/btn_bk.gif);");
    
    if (ActiveHelpFile().length()>0)
      HF = "<a onclick=\"return OpenDoc('" + ActiveHelpFile() + "','Help','" + s + "');\" href=\"\" id=help><img alt=\"Open Help File\" src=\"images/help.gif\" style=\"border:none;" + bkImg + "\"></a>&nbsp;";
    //
    if (DTTObj.Level>0 && !DTTObj.TraceEnabled)
      DTT = "<a onclick=\"return OpenDoc('" + UrlForEnc(MyGlb.ITEM_DTT, "") + "','Debug','');\" href=\"\"><img alt=\"Open Debug Window\" src=\"images/bug.gif\" style=\"border:none;" + bkImg + "\"></a>&nbsp;";
    //
    if (DTTObj.HelpEnabled && DTTObj.CanSendHelpMail(false))
      TEL = "<a href=\"" + UrlFor(MyGlb.ITEM_APP, "") + "&amp;CMD=DTTHELP\"><img alt=\"Request help\" src=\"images/dtthelp.gif\" style=\"border:none;" + bkImg + "\"></a>&nbsp;";
    //
    if (LogoffURL.length() > 0)
      return HF + TEL + DTT + "<a id=\"LOGOFF\" href=\"" + UrlForEnc(MyGlb.ITEM_LOGOFF, "") + "\"><img alt=\"" + 
            RTCObj.GetConst("38ABB688-409C-43A8-BA9F-1ECACD08D957", "Chiude l'applicazione", true) + "\" src=\"images/closex.gif\" style=\"border:none;" + bkImg + "\"></a>";
    else
      return HF + TEL + DTT;
  }

  public String DebugButton()
  {
    if (DTTObj.Level>0 && !DTTObj.TraceEnabled) 
    {
      String bkImg = (ParamsObj().Theme.compareToIgnoreCase("zen") == 0 ? "" : " background-image:url(images/btn_bk.gif);");
      if (IsBootstrap())
        return "<a href=\"" + UrlForEnc(MyGlb.ITEM_DTT, "") + "\" target=Debug><i class='fa fa-bug'></i></a>";
      else
        return "<a href=\"" + UrlForEnc(MyGlb.ITEM_DTT, "") + "\" target=Debug><img alt=\"Open Debug Window\" src=\"images/bug.gif\" style=\"border:none;" + bkImg + "\"></a>";
    }
    //
    return "";
  }

  // **********************************************
  // Show login page
  // **********************************************
  public void ShowLogin()
  {
    // Per il problema dell'F5 dovrò rispondere con una paginetta di pre-desktop
    PreDesktopRendered = false;
    //
    WriteStr("<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 Transitional//EN\">\n");
    WriteStr("<html>\n");
    WriteStr("<head>\n");
    WriteStr("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\">\n");
    WriteStr("<meta http-equiv=\"X-UA-Compatible\" content=\"IE=EmulateIE7\" />\n");
    WriteStr("<link rel=stylesheet type=\"text/css\" href=\"dtt.css\">\n");
    WriteStr("<title>Login Page</title>\n");
    WriteStr("<script language=\"javascript\" type=\"text/javascript\">\n");
    WriteStr("function PlayTest() { try { window.parent.frames('Control').NextRequest(); } catch(e) {}; }\n");
    WriteStr("</script>\n");
    WriteStr("</head>\n");
    WriteStr("\n");
    WriteStr("<body style=\"margin:0;\" onload=\"PlayTest()\">\n");
    WriteStr("<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: collapse; background-color: transparent;\" bordercolor=\"#111111\" width=\"100%\" height=\"100%\">\n");
    WriteStr("<tr>\n");
    WriteStr("<td colspan=3 style=\"background-color:#dee7f6\">&nbsp;</td>\n");
    WriteStr("</tr>\n");
    WriteStr("<tr>\n");
    WriteStr("<td style=\"background-color:#dee7f6;\">&nbsp;</td>\n");
    WriteStr("<td width=\"700\" height=\"450\" valign=\"top\" style=\"background-color: #dee7f6;\">\n");
    WriteStr("<table cellspacing=0 cellpadding=0 style=\"background-color: transparent\">\n");
    WriteStr("<tr>\n");
    WriteStr("<td style=\"width: 8px; height: 8px; background-image:url('images/wtl.gif');\"></td>\n");
    WriteStr("<td style=\"height: 8px; background-image:url('images/wtop.gif');\"></td>\n");
    WriteStr("<td style=\"width: 8px; height: 8px; background-image:url(images/wtr.gif);\"></td>\n");
    WriteStr("</tr>\n");
    WriteStr("<tr>\n");
    WriteStr("<td style=\"width: 8px; background-image:url(images/wleft.gif);\"></td>\n");
    WriteStr("<td style=\"height: 434px; width: 684px; background-color: white; background-image:url(images/splash.gif); background-repeat:no-repeat; background-position: bottom left;\">\n");
    WriteStr("\n");
    WriteStr("             <div style=\"position:relative;top:-30px;left:665px; width: 30px\">" + DebugButton() + "</div>\n");
    WriteStr("<p align=\"center\">\n");
    WriteStr("<img border=\"0\" src=\"images/pow2.gif\" width=\"590\" height=\"70\"><p align=\"center\">\n");
    WriteStr("&nbsp;\n");
    WriteStr("<table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: collapse\" bordercolor=\"#111111\" width=\"100%\" height=\"20\">\n");
    WriteStr("<tr>\n");
    WriteStr("<td width=\"30%\" height=\"20\">&nbsp;</td>\n");
    WriteStr("<td width=\"67%\" height=\"20\"><b><font face=\"Trebuchet MS\" size=\"4\">\n");
    WriteStr("<form method=\"post\" autocomplete=\"off\" name=\"frm\" action=\"Cfaid.htm\">\n");
    WriteStr("<input type=hidden name=WCI value=IWLogin>\n");
    WriteStr("<input type=hidden name=WCE value=Form1>\n");
    WriteStr("<input type=hidden name=WCU>\n");
    WriteStr("                 <font color=\"#BCBC77\">" + Glb.HTMLEncode(Caption(), true, true) + " - </font>\n");
    WriteStr("<font color=\"#004d89\">Login Form</font></b>\n");
    WriteStr("<p><font color=\"#004d89\" face=\"Trebuchet MS\" size=\"2\">Username&nbsp;&nbsp;\n");
    WriteStr("                 <input id=\"USERNAME\" name=\"UserName\" tabindex=\"1\" size=\"20\" style=\"border: 1px solid #BCBC77;color:#004d89;font-family:Trebuchet MS;width:150px;height:20px\" value=\"" + Glb.HTMLEncode(RolObj.glbUser) + "\" />\n");
    WriteStr("<br>Password&nbsp;&nbsp;&nbsp;\n");
    WriteStr("<input id=\"PASSWORD\" type=\"password\" name=\"PassWord\" tabindex=\"2\" size=\"20\" style=\"border:1px solid #BCBC77;color:#004d89;width:150px;height:20px\" >\n");
    WriteStr("<br>&nbsp;</p>\n");
    WriteStr("<p><input id=\"LOGIN\" border=\"0\" src=\"images/login.gif\" name=\"I1\" width=\"83\" height=\"28\" type=\"image\"></p>\n");
    WriteStr("                 <p><font face=\"Trebuchet MS\" size=\"2\"><font color=\"#004d89\">" + MainFrm.RTCObj.GetConst("4D691B94-E528-4AEC-B319-0F18A9049DB3", "Introduci il tuo Username e&nbsp;Password per accedere al sistema, oppure<br>clicca qui per tornare alla <a href=\"http://www.progamma.com\">pagina iniziale</a>", false) + "</font></font></p>\n");
    WriteStr("               	<p style=\"padding-right:40px\"><b><font color=\"#C04040\" face=\"Trebuchet MS\" size=\"2\">" + Glb.HTMLEncode(LoginMessage, true, true) + "</font></b></p>\n");
    WriteStr("<SCRIPT>\n");
    WriteStr("if (document.frm.UserName.value.length==0)\n");
    WriteStr("          					document.frm.UserName.focus();\n");
    WriteStr("else\n");
    WriteStr("          					document.frm.PassWord.focus();\n");
    WriteStr("</SCRIPT>\n");
    WriteStr("</form></td>\n");
    WriteStr("</tr>\n");
    WriteStr("</table>\n");
    WriteStr("\n");
    WriteStr("</td>\n");
    WriteStr("<td style=\"width: 8px; background-image:url(images/wright.gif);\"></td>\n");
    WriteStr("</tr>\n");
    WriteStr("<tr>\n");
    WriteStr("<td style=\"width: 8px; height: 8px; background-image:url(images/wbl.gif);\"></td>\n");
    WriteStr("<td style=\"height: 8px; background-image:url(images/wbottom.gif);\"></td>\n");
    WriteStr("<td style=\"width: 8px; height: 8px; background-image:url(images/wbr.gif);\"></td>\n");
    WriteStr("</tr>\n");
    WriteStr("</table>\n");
    WriteStr("\n");
    WriteStr("</td>\n");
    WriteStr("<td style=\"background-color:#dee7f6\">&nbsp;</td>\n");
    WriteStr("</tr>\n");
    WriteStr("<tr>\n");
    WriteStr("<td style=\"background-color:#dee7f6\" colspan=3>&nbsp;</td>\n");
    WriteStr("</tr>\n");
    WriteStr("</table>\n");
    WriteStr("<div id=\"reqdiv\" class=HelpReqDiv style=\"display:none\"></div>\n");
    WriteStr("<div id=\"reqVdiv\" class=HelpReqDiv style=\"display:none\"></div>\n");
    WriteStr("<div id=\"itemdiv\" class=HelpItemDiv style=\"display:none\"></div>\n");
    WriteStr("<img id=\"helpcurs\" class=HelpCurs src=\"dttimg/helpcurs.gif\" style=\"display:none\">\n");
    WriteStr("</body>\n");
    WriteStr("</html>\n");
    //
  }


  // **********************************************
  // Imposta una url data
  // **********************************************
  public void SetUrlData(String UD)
  {
    URLData = "";
    if (ParamsObj().IWCacheControl.equals("URL"))
      URLData=new Double((Math.random() * 2147483647)).toString();
    //    
    URLData = URLData + UD;
  }

  // **********************************************
  // Esegue il rendering differenziale...
  // **********************************************
  public void RenderDifferences(boolean onlyform)
  {
    String ObjToFocus="";
    if (ActiveForm()!=null)
      ObjToFocus=ActiveForm().ActiveElement;
    //
    // Cappello iniziale
    Out.print("<html>");
    Out.print("<head>");
    Out.print("<meta http-equiv=\"Content-Type\" content=\"text/html; charset=windows-1252\">");
    //
    // La disabilitazione della cache del frame RD NON può essere effettuata mentre
    // apro una popup, altrimenti IE impazzisce e ne apre tantissime.
    if (!RDOpenPopup)
    {
      Out.print("<meta http-equiv=\"Expires\" content=\"-1\">");
      Out.print("<meta http-equiv=\"Pragma\" content=\"no-cache\">");
    }
    //
    Out.print("<script language=\"javascript\" src=\"ijlib.js\"></script>");
    Out.print("<script language=\"javascript\" src=\"dragdrop.js\"></script>");
    Out.print("<script language=\"javascript\" src=\"custom.js\"></script>");
    Out.print("<script language=\"javascript\" type=\"text/javascript\">");
    Out.print("function ApplyRender() { ");
    //
    // Invio nuovamente i dati aggiornati (potrebbero essere cambiati a run-time!)
    if (ParamsObj().UseClientMask)
      Out.print("  SetDD('" + (UseDecimalDot() ? '.' : ',') + "','" + (UseDecimalDot() ? ',' : '.') + "');");
    //
    if (!RDOpenPopup && !RDClosePopup)
    {
      if (!onlyform)
      {
        int dt = (DockedForm() != null) ? DockedForm().DockType : 0;
        if (dt!=LastDockType)
        {
          // Devo fare il render dell'intera DOCK+FORM area
          ResIdx = 0;
          RenderPageTable();
          SendRenderCmd("PageTable");
          RDForm = false;
          RDDockForm = false;
        }
        //
        if (RDHeader)
        {
          // Devo fare il rendering dell'intera header bar
          ResIdx = 0;
          RenderHeader();
          SendRenderCmd("hdr");
        }
        //
        if (CmdObj.RDAll)
        {
          // Devo fare il rendering dell'intera menù bar
          ResIdx = 0;
          RenderMenuBar();
          SendRenderCmd("MenuTable");
        }
        else
        {
          // Analizzo interno del menù
          CmdObj.RenderMenuDifference();
        }
      }
      //
      if (RDForm || (ActiveForm()!=null && ActiveForm().RDUpload))
      {
        // Devo fare il rendering dell'intera active form
        Out.print(WebFrame.GetCCFK());
        ResIdx = 0;
        RenderActiveForm();
        SendRenderCmd("ActiveForm");
        ResIdx = 0;
        RenderFormListInternal();
        SendRenderCmd("FormList");
      }
      else
      {
        if (ActiveForm()!=null)
        {
          if (ActiveForm().RDCaption && !CmdObj.SuppressMenu())
          {
            ResIdx = 0;
            RenderFormListInternal();
            SendRenderCmd("FormList");
          }
          ActiveForm().RenderDifference();
        }
      }
      //
      if (!onlyform)
      {
        if (RDDockForm)
        {
          // Devo fare il rendering dell'intera active form
          ResIdx = 0;
          RenderDockedForm();
          SendRenderCmd("DockForm");
        }
        else
        {
          if (DockedForm()!=null)
            DockedForm().RenderDifference();
        }
        //
        if (RDSB || RDForm)
        {
          ResIdx = 0;
          RenderStatusBar();
          SendRenderCmd("StatusBarTable");
        }
        //
        if (CmdObj.IsTBRD())
        {
          ResIdx = 0;
          if (CmdObj.IsToolbarPresent())
          {
            WriteStr("<table id=ToolBar><tr>"); // Tool Bar Definition            
            //
            //
            CmdObj.RenderToolbar();
            //
            //
            WriteStr("</tr></table>");            
          }
          SendRenderCmd("ToolBarTable");
        }
      }
    }
    else
     {
      if (RDOpenPopup && RDForm && ActiveForm()!=null)
      {
        WebForm fo = GetForm(ActiveForm().Owner, 0, false);
        if (fo!=null)
        {
          fo.RenderDifference();
          fo.ResetRD();
          Out.print(" ApplyRD2();");
        }
      }
    }
    //
    // Cappello finale
    if (!RDOpenPopup && !RDClosePopup)
    {
      Out.print(" window.setTimeout(\"ChangeTarget();\",10);");
      Out.print(" ep('" + (ResTotal/1024) + "-" + ResCount + (GZipEnabled==0 ? " NOZIP" : "") + "');");
      Out.print(" window.setTimeout(\"SetFocus('" + ObjToFocus + "')\",20);");
      if (!RedirectTo().stringValue().equals("") && !DTTObj.TestRunning)
      {
        set_RedirectTo(IDL.Replace(RedirectTo(), new IDVariant("\\"), new IDVariant("/")));
        if (RedirectNewWindow())
        {
          boolean ismodal = false;
          //
          if (RedirectFeatures().stringValue().toLowerCase().indexOf("modal")!=-1)
          {
            Out.print("window.showModalDialog(" + MyGlb.JSEncode2(RedirectTo()));
            ismodal = true;
          }
          else
           {
            Out.print("window.setTimeout(\"window.open(" + MyGlb.JSEncode2(RedirectTo(), "\\\""));
          }
          if (!RedirectFeatures().stringValue().equals(""))
            Out.print(", " + (WidgetMode?"'browser'":"null") + ", " + MyGlb.JSEncode(RedirectFeatures()));
          //
          if (ismodal)
            Out.print("); ");
          else
            Out.print(");\",200); ");
        }
        else
          Out.print(" GetFrame(window.parent.frames,'Main').location.href=" + MyGlb.JSEncode2(RedirectTo()) + "; ");
        //
        // Gestita Redirect
        set_RedirectNewWindow(false);
        set_RedirectTo(new IDVariant(""));
        set_RedirectFeatures(new IDVariant(""));
      }
      //
      RenderPDFPrints();
    }
    //
    // Menu popup su PField
    if (!MenuIdx.equals(""))
    {
      // Recupero la direzione corrente
      IDVariant Dir = null;
      if (MenuIdx.indexOf("|")!=-1)
      {
        Dir = new IDVariant(Integer.parseInt(MenuIdx.substring(MenuIdx.indexOf("|")+1)));
        MenuIdx = MenuIdx.substring(0, MenuIdx.indexOf("|"));
      }
      else
        Dir = new IDVariant(1);   // Default: Bottom
      //
      // Recupero il CmdSet ed il FormIdx
      int CmdSetIdx;
      String ObjIDs;
      int FormIdx;
      CmdSetIdx = Integer.parseInt(MenuIdx.substring(0, MenuIdx.indexOf(":")));
      MenuIdx = MenuIdx.substring(MenuIdx.indexOf(":")+1);
      ObjIDs = MenuIdx.substring(0, MenuIdx.indexOf(":"));
      MenuIdx = MenuIdx.substring(MenuIdx.indexOf(":")+1);
      FormIdx = Integer.parseInt(MenuIdx);
      if (FormIdx==-1)
      {
        if (ActiveForm()!=null)
          FormIdx = ActiveForm().FormIdx;
        else
          FormIdx = 0;
      }
      //
      // Mostro il menu
      ResIdx = 0;
      CmdObj.RenderPopupMenu(CmdSetIdx, FormIdx);
      SendRenderCmd(ObjIDs + "|" + Dir.intValue(), "popup");
      MenuIdx = "";
    }
    //
    if (AlertMessage()!=null && !AlertMessage().stringValue().equals("") && !DTTObj.TestRunning && !DTTObj.HelpGenerationActive)
      Out.print(" msg(" + MyGlb.JSEncode2(AlertMessage()) + "," + AlertType() + "); ");
    //
    if (RDOpenPopup && !RDDelayPopup)
    {
      Rect r = ActiveForm().Frames[1].GetTotalSize();
      int w = r.Width;
      int h = r.Height;
      String rectstr;
      //
      h = h + MyGlb.PAN_OFFS_PAGEY + MyGlb.PAN_OFFS_Y + 4 + 40; // Messages
      w = w + 8;
      if (w < 300) w = 300;
      if (h < 200) h = 200;
      //
      rectstr = "";
      if (ActiveForm().FormLeft!=-1) rectstr = rectstr + "dialogLeft:" + ActiveForm().FormLeft + "px;";
      if (ActiveForm().FormTop!=-1) rectstr = rectstr + "dialogTop:" + ActiveForm().FormTop + "px;";
      if (ActiveForm().FormWidth!=-1) w = ActiveForm().FormWidth;
      if (ActiveForm().FormHeight!=-1) h = ActiveForm().FormHeight;
      rectstr = rectstr + "dialogHeight:" + h + "px;";
      rectstr = rectstr + "dialogWidth:" + w + "px;";
      //
      Out.print(" GetFrame(window.parent.frames,'Main').ModIdx=" + ActiveForm().FormIdx + ";");
      Out.print(" window.showModalDialog(\"" + UrlFor(MyGlb.ITEM_FRAMES, "") + "\",window,\"" + rectstr + "help:no;status:no;resizable:yes;\");");
      Out.print(" GetFrame(window.parent.frames,'Main').EnableClick=3;");
      Out.print(" pb('WCI=IWRD&WCE=" + ActiveForm().FormIdx + "');");
      Out.print(" window.defaultStatus=\"\";");
    }
    else
    {
      if (ScreenW() == 0 || ScreenH() == 0)
      {
        // Se c'è una form aperta che si vuole ridimensionare faccio una richiesta
        boolean ric = false;
        //
        if (DockedForm()!=null && (DockedForm().ResModeH != Glb.FRESMODE_NONE || DockedForm().ResModeW != Glb.FRESMODE_NONE))
          ric = true;
        //
        ListIterator i = StackForm.listIterator();
        //    
        while (!ric && i.hasNext())
        {
          WebForm f = (WebForm)i.next();
          if (f.ResModeH != Glb.FRESMODE_NONE || f.ResModeW != Glb.FRESMODE_NONE)
            ric = true;
        }
        //
        if (ric)
          Out.print(" window.setTimeout(\"pb('');\",10);");
      }
    }
    //
    if (RDClosePopup)
      Out.print(" window.parent.close();");
    //
    if (!RDExitURL.equals(""))
    {
      Out.print(" window.parent.location.href=" + MyGlb.JSEncode2(new IDVariant(RDExitURL)) + "; ");
      RDExitURL = "";
    }
    //
    if (RefreshInterval().intValue() > -1)
      Out.print(" SetRefresh(" + (1000*RefreshInterval().dblValue()) + "); ");
    //
    if (ActiveForm() != null && ActiveForm().ScrollTop >= 0)
      Out.print(" sct(" + ActiveForm().ScrollTop + "); ");
    //
    Out.print(" } </script></head><body onload=\"NextRD();\">");
    //
    // Form
    Out.print("<form id=theform method=post action=\"" + UrlFor(MyGlb.ITEM_RD, "") + "\">");
    Out.print("<input type=hidden id=ss name=ss>");
    Out.print("<input type=hidden id=ace name=ace>");
    Out.print("<input type=hidden id=pd name=pd>");
    Out.print("<input type=hidden id=cmd name=cmd>");
    Out.print("<input type=hidden id=keys name=keys>");
    RenderTrayletCommand(); // Renderizza l'IFRAME per chiamare la traylet!    
    //
    // Vedi commenti sopra
    if (RDOpenPopup)
      Out.print("</form></body></html>");
    else
      Out.print("</form></body><head><meta http-equiv=\"Pragma\" content=\"no-cache\"><meta http-equiv=\"Expires\" content=\"-1\"></head></html>");
    //
    if (!RDOpenPopup && !RDClosePopup)
      ResetRD();
    if (RDDelayPopup)
      RDDelayPopup = false;
    else
      RDOpenPopup = false;
    RDClosePopup = false;
    if (AlertType() == 0)
    {
      ConfStack.clear();
      set_AlertMessage(new IDVariant(""));
    }
  }

  // **********************************************
  // Esegue il rendering dell'header
  // **********************************************
  public void RenderHeader()
  {
    //
    WriteStr("<table border=0 style=\"width:100%\" cellspacing=0 cellpadding=0 id=ApplHeader>\n");
    WriteStr("<tr><td style=\"width:100%\">\n");
    WriteStr("" + MenuButton() + "&nbsp;" + Glb.HTMLEncode(Caption(), true, true) + "</td>\n");
    WriteStr("<td style=\"white-space:nowrap\"><span id=cmdspan class=cmdform>cmd: <input class=cmdinput type=text accesskey=\"c\" maxlength=6 name=cmd id=cmdcode size=6></span></td>\n");
    WriteStr("<td style=\"white-space:nowrap\">" + LogoffButton() + "</td>\n");
    WriteStr("</tr></table>\n");
    //
  }
  
  
  // **********************************************
  // Esegue il rendering della menu bar intera
  // **********************************************
  public void RenderMenuBar()
  {
    if (CmdObj.IsMenuPresent())
    {
      WriteStr("<table class=w100 id=Menu cellspacing=0 cellpadding=0>");
      //
      //
      CmdObj.RenderMenu();
      //
      //
      // Rendering window list
      //
      RenderFormList();
      //
      //
      WriteStr("</table>");
    }
  }

  // **********************************************
  // Esegue il rendering della menu bar intera
  // **********************************************
  public void RenderStatusBar()
  {
    boolean Messages = false;
    //
    if (ActiveForm() != null)
      Messages = ActiveForm().HasMessages();
    if (IndObj.IsStatusBarPresent())
    {
      WriteStr("<div id=StatusBar>"); // Status Bar Definition
      //
      //
      IndObj.Render();
      //
      //
      WriteStr("</div>");
    }
    if (ActiveForm() != null)
      ActiveForm().RenderMessages();
  }
  
  // **********************************************
  // Esegue il rendering dell'intera form!
  // **********************************************
  public void RenderActiveForm() { RenderActiveForm(false); }
  public void RenderActiveForm(boolean flmsg)
  {
    if (ErrObj.IsError())
    {
      ErrObj.Render();
      //RefreshNextClick = True
    }
    else
    {
      if (ActiveForm() != null)
      {
        ActiveForm().ActivedTick = ClickCounter();
        ActiveForm().Render(flmsg);
      }
      else
      {
        WriteStr("<iframe id=welcome src=\"" + WelcomeURL + "\" width=\"100%\" height=\"520px\" frameborder=\"0\"></iframe>\n");
      }
    }
  }
  
  // **********************************************
  // Get parameters
  // **********************************************
  public MyParams MyParamsObj()
  {
    return (MyParams)iParamsObj;
  }
  
  // **********************************************
  // Get DB by name
  // **********************************************
  public IDBObject GetDBObjByName(String Name)
  {
    // Scateno l'evento... se vogliono mi cambiano il nome
    // dandomi il vero nome e preparando il DB come vogliono
    IDVariant TrueName = new IDVariant(Name);
    OnGetDBByName(TrueName);
    Name = TrueName.stringValue();
    //
    if (Name.equals("Cf4armDB")) return Cf4armDBObject;
    //
    if (CompOwner != null)
      return CompOwner.GetDBObjByName(Name);
    else
      return null;
  }

  public void OnOpenPopup(ACommand SrcObj, IDVariant Direction, IDVariant Cancel) 
  {
    DispatchToComp("OnOpenPopup", new Object[] { SrcObj, Direction, Cancel });
  }
  
  public void OnCmdSetCommand(ACommand SrcObj, IDVariant CmdIdx, IDVariant ChildIdx, IDVariant Cancel) 
  {
    DispatchToComp("OnCmdSetCommand", new Object[] { SrcObj, CmdIdx, ChildIdx, Cancel });
  }

  public void OnCmdSetChangeExpand(ACommand SrcObj, IDVariant Expand, IDVariant Cancel)
  {
    DispatchToComp("OnCmdSetChangeExpand", new Object[] { SrcObj, Expand, Cancel });
    if (SrcObj.Code.equals("CAELABOR")) CMDS_CAELABOR_OnCmdSetChangeExpand(Expand, Cancel);
  }
  
  public void OnCmdSetGeneralDrag(ACommand SrcObj, IDVariant DragInfo, IDVariant CmdIdx, IDVariant ChildIdx)
  {
    DispatchToComp("OnCmdSetGeneralDrag", new Object[] { SrcObj, DragInfo, CmdIdx, ChildIdx });
  }
  
  public void OnCmdSetGeneralDrop(ACommand SrcObj, IDVariant DragInfo, IDVariant CmdIdx, IDVariant ChildIdx)
  {
    DispatchToComp("OnCmdSetGeneralDrop", new Object[] { SrcObj, DragInfo, CmdIdx, ChildIdx });
  }

  // **********************************************
  // Update Controls against IMDB variations
  // **********************************************
  public void UpdateControls()
  {
    DispatchToComp("UpdateControls", new Object[] { });
  }
  

  // **********************************************
  // Procedure Definition
  // **********************************************
  // **********************************************************************
  // Apri Scelta Scheda Inventario
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int ApriSceltaSchedaInventario ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Scelta Scheda Inventario Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_SCHEDEINVENT, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_SCHEDEINVENT,(new IDVariant(0)).booleanValue()); 
      }
      MainFrm.Show(MyGlb.FRM_SCHEDEINVENT, (new IDVariant(1)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriSceltaSchedaInventario", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Abilita Estrazioni Impacc
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int AbilitaEstrazioniImpacc ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Abilita Estrazioni Impacc Body
      // Corpo Procedura
      // 
      if (AFC.GetComando(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), (new IDVariant("Estrazioni_Impacc"))).equals((new IDVariant("Estrazioni_Impacc_tv")), true))
      {
        MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_IMPEGNACCERT+BaseCmdLinIdx, (new IDVariant(-1)).booleanValue());
      }
      else
      {
        MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_IMPEGNACCERT+BaseCmdLinIdx, (new IDVariant(0)).booleanValue());
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "AbilitaEstrazioniImpacc", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Abilitazione Buoni
  // **********************************************************************
  public IDVariant AbilitazioneBuoni ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_ABILITAZIONE = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Abilitazione Buoni Body
      // Procedure Body
      // 
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.ABILITAZIONE_BUONI as ESEFABILBUON ");
      SQL.append("from ");
      SQL.append("  ESEFIN A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_ABILITAZIONE = QV.Get("ESEFABILBUON", IDVariant.STRING) ;
      }
      QV.Close();
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        return (new IDVariant(-1));
      }
      else
      {
        if (v_ABILITAZIONE.equals((new IDVariant("SI")), true))
        {
          return (new IDVariant(1));
        }
        else
        {
          return (new IDVariant(-1));
        }
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "AbilitazioneBuoni", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Acc Eseacc
  // Explain which processing is carried out by this procedure
  // Anno Acc:  - Input
  // NumeroAcc:  - Input
  // Capitolo:  - Input/Output
  // Articolo:  - Input/Output
  // **********************************************************************
  public boolean AccEseacc (IDVariant AnnoAcc, IDVariant NumeroAcc, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_RET = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Acc Eseacc Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1, ");
      SQL.append("  A.CAPITOLO as ESEACCCAPITO, ");
      SQL.append("  A.ARTICOLO as ESEACCARTICO ");
      SQL.append("from ");
      SQL.append("  ESEACC A ");
      SQL.append("where (A.ANNO_ACC = " + IDL.CSql(AnnoAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_ACC = " + IDL.CSql(NumeroAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("group by ");
      SQL.append("  A.CAPITOLO, ");
      SQL.append("  A.ARTICOLO ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
        Capitolo.set(QV.Get("ESEACCCAPITO", IDVariant.DECIMAL));
        Articolo.set(QV.Get("ESEACCARTICO", IDVariant.INTEGER));
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
        v_MESSAGGIO = (new IDVariant("Accertamento di Entrata non previsto in Bilancio.", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_MESSAGGIO); 
        v_RET = (new IDVariant(0));
      }
      else
      {
        if (v_CONTATORE.compareTo((new IDVariant(0)), true)>0)
        {
          v_RET = (new IDVariant(-1));
        }
      }
      return v_RET.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "AccEseacc", _e);
      return false;
    }
  }

  // **********************************************************************
  // Acc Presente
  // AnnoAcc:  - Input
  // NumeroAcc:  - Input
  // **********************************************************************
  public IDVariant AccPresente (IDVariant AnnoAcc, IDVariant NumeroAcc)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Acc Presente Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  ACC A ");
      SQL.append("where (A.ANNO_ACC = " + IDL.CSql(AnnoAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_ACC = " + IDL.CSql(NumeroAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
        v_MESSAGGIO = (new IDVariant("Accertamento non Previsto", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_MESSAGGIO); 
        v_RETVAL = (new IDVariant(-1));
      }
      else
      {
        v_RETVAL = (new IDVariant(1));
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "AccPresente", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Apri CSV PCC
  // Nome File - Input
  // Esito:  - Optional - Input
  // **********************************************************************
  public int ApriCSVPCC (IDVariant NomeFile, IDVariant Esito)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDCachedRowSet C2;

    try
    {
      TransCount = 0;
      // 
      // Apri CSV PCC Body
      // Corpo Procedura
      // 
      IDVariant v_FILE = null;
      v_FILE = MainFrm.VBFile.FreeFile();
      MainFrm.VBFile.OpenForOutput(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add((new IDVariant(MainFrm.RealPath)), new IDVariant(System.getProperty("file.separator"))
), (new IDVariant("temp"))), new IDVariant(System.getProperty("file.separator"))
), NomeFile), (new IDVariant(".csv"))), v_FILE, false); 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  DECODE(" + IDL.CSql(Esito, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", -1, A.CLOB_FILE_ESITO, A.CLOB_FILE) as CLOBFILE ");
      SQL.append("from ");
      SQL.append("  PCC_FILE A ");
      SQL.append("where (A.NOME_FILE = " + IDL.CSql(NomeFile, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      C2 = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      C2.setColUnbound(1,true);
      if (!C2.EOF()) C2.MoveNext();
      while (!C2.EOF())
      {
        MainFrm.VBFile.WriteLine(v_FILE, C2.Get("CLOBFILE")); 
        C2.MoveNext();
      }
      C2.Close();
      MainFrm.VBFile.Close(v_FILE); 
      MainFrm.set_RedirectTo(IDL.Add(IDL.Add(IDL.Add((new IDVariant("temp")), new IDVariant(System.getProperty("file.separator"))
), NomeFile), (new IDVariant(".csv"))));
      MainFrm.set_RedirectNewWindow((new IDVariant(-1)).booleanValue());
      MainFrm.set_RedirectFeatures((new IDVariant("save"))); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriCSVPCC", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Pagina Iride
  // Azione:  - Input
  // Doc ID:  - Input
  // Multi DB:  - Optional - Input
  // **********************************************************************
  public int ApriPaginaIride (IDVariant Azione, IDVariant DocID, IDVariant MultiDB)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Pagina Iride Body
      // Corpo Procedura
      // 
      IDVariant v_URL = new IDVariant(0,IDVariant.STRING);
      IDVariant v_UTENTE = new IDVariant(0,IDVariant.STRING);
      v_UTENTE = (new IDVariant("utente="));
      IDVariant v_PSW = new IDVariant(0,IDVariant.STRING);
      v_PSW = (new IDVariant("pwd="));
      IDVariant v_RUOLO = new IDVariant(0,IDVariant.STRING);
      v_RUOLO = (new IDVariant("ruolo="));
      IDVariant v_FUNZIONE = new IDVariant(0,IDVariant.STRING);
      v_FUNZIONE = (new IDVariant("funzione="));
      IDVariant v_DOCID = new IDVariant(0,IDVariant.STRING);
      v_DOCID = (new IDVariant("docid="));
      IDVariant v_AGGIORNA = new IDVariant(0,IDVariant.STRING);
      v_AGGIORNA = (new IDVariant("AGGIORNA="));
      IDVariant v_ENTENOME = new IDVariant(0,IDVariant.STRING);
      v_ENTENOME = (new IDVariant("ENTE_NOME="));
      if (Azione.equals((new IDVariant("P121")), true))
      {
        v_UTENTE = IDL.Add(v_UTENTE, IMDB.Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDUTENP121, 0));
        v_PSW = IDL.Add(v_PSW, IMDB.Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDEPWDP121, 0));
        v_RUOLO = IDL.Add(v_RUOLO, IMDB.Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDRUOLP121, 0));
        v_AGGIORNA = IDL.Add(v_AGGIORNA, IMDB.Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDAGGIP121, 0));
      }
      else if (Azione.equals((new IDVariant("P135")), true))
      {
        v_UTENTE = IDL.Add(v_UTENTE, IMDB.Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDUTENP135, 0));
        v_PSW = IDL.Add(v_PSW, IMDB.Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDEPWDP135, 0));
        v_RUOLO = IDL.Add(v_RUOLO, IMDB.Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDRUOLP135, 0));
        v_AGGIORNA = IDL.Add(v_AGGIORNA, IMDB.Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDAGGIP135, 0));
      }
      else if (Azione.equals((new IDVariant("P140")), true))
      {
        v_UTENTE = IDL.Add(v_UTENTE, IMDB.Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDUTENP140, 0));
        v_PSW = IDL.Add(v_PSW, IMDB.Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDEPWDP140, 0));
        v_RUOLO = IDL.Add(v_RUOLO, IMDB.Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDRUOLP140, 0));
        v_AGGIORNA = IDL.Add(v_AGGIORNA, IMDB.Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDAGGIP140, 0));
      }
      else
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Azione non riconoscita"));
        MainFrm.set_AlertMessage(v_AVVISO); 
        return 0;
      }
      v_URL = IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IMDB.Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDEURLASP, 0), (new IDVariant("?"))), v_UTENTE), (new IDVariant("&"))), v_PSW), (new IDVariant("&"))), v_RUOLO), (new IDVariant("&"))), v_FUNZIONE), Azione), (new IDVariant("&"))), v_DOCID), IDL.ToString(DocID)), (new IDVariant("&"))), v_AGGIORNA);
      if (IDL.NullValue(MultiDB,(new IDVariant(""))).compareTo((new IDVariant("")), true)!=0)
      {
        v_URL = IDL.Add(IDL.Add(IDL.Add(v_URL, (new IDVariant("&"))), v_ENTENOME), IMDB.Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDEENTEASP, 0));
      }
      MainFrm.set_RedirectTo(v_URL);
      MainFrm.set_RedirectNewWindow((new IDVariant(-1)).booleanValue());
      MainFrm.set_RedirectFeatures((new IDVariant(""))); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriPaginaIride", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Report Da Link Esterno
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int ApriReportDaLinkEsterno ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Report Da Link Esterno Body
      // Corpo Procedura
      // 
      IDVariant v_NOMEREPORT = new IDVariant(0,IDVariant.STRING);
      try
      {
        v_NOMEREPORT = MainFrm.GetUrlParam((new IDVariant("RPT")));
      }
      catch (Exception e3)
      {
        v_NOMEREPORT = (new IDVariant(""));
      }
      if (v_NOMEREPORT.compareTo((new IDVariant("")), true)!=0)
      {
        switch (1) // Allows the use of BREAK inside ifs
        {
          default:
          if (v_NOMEREPORT.equals((new IDVariant("Gps_Controllo_Dispo_Puro"))))	
          {
            IDVariant v_VPAR1 = null;
            v_VPAR1 = MainFrm.GetUrlParam((new IDVariant("PAR1")));
            if (IDL.NullValue(v_VPAR1,(new IDVariant(""))).equals((new IDVariant("")), true))
            {
              v_VPAR1 = (new IDVariant("S"));
            }
            IDVariant v_VPAR2 = null;
            v_VPAR2 = MainFrm.GetUrlParam((new IDVariant("PAR2")));
            IDVariant v_VDATA = null;
            v_VDATA = (new IDVariant());
            try
            {
              SQL = new StringBuffer();
              SQL.append("select ");
              SQL.append("  TO_DATE(" + IDL.CSql(v_VPAR2, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ",'dd/mm/yyyy') as TODAFOVPADMY ");
              SQL.append("from ");
              SQL.append("  DUAL A ");
              QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
              if (!QV.EOF()) QV.MoveNext();
              if (!QV.EOF())
              {
                v_VDATA = QV.Get("TODAFOVPADMY", IDVariant.DATETIME) ;
              }
              QV.Close();
            }
            catch (Exception e9)
            {
              v_VDATA = (new IDVariant());
            }
            StampaControlloDisponibilitaPuro(v_VPAR1, v_VDATA);
          }
          break;
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriReportDaLinkEsterno", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Blocca Form
  // blocca le modifiche alla videata passata come parametro
  // par Form - Input
  // **********************************************************************
  public int BloccaForm (WebForm parForm)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Blocca Form Body
      // Corpo Procedura
      // 
      IDVariant v_INUMFORM = null;
      v_INUMFORM = parForm.GetPanelsCount();
      IDVariant J = new IDVariant(0,IDVariant.INTEGER);
      for (; J.compareTo(v_INUMFORM, true)<0; J = IDL.Add(J, (new IDVariant(1))))
      {
        IDPanel v_IDP = null;
        v_IDP = parForm.GetPanel(J);
        v_IDP.set_Locked((new IDVariant(-1)).booleanValue());
        v_IDP.SetFlags (Glb.OBJ_PANEL, 0, ((new IDVariant(0)).booleanValue())? Glb.PAN_CANINSERT : 0, Glb.PAN_CANINSERT); 
        v_IDP.SetFlags (Glb.OBJ_PANEL, 0, ((new IDVariant(0)).booleanValue())? Glb.PAN_CANUPDATE : 0, Glb.PAN_CANUPDATE); 
        v_IDP.SetFlags (Glb.OBJ_PANEL, 0, ((new IDVariant(0)).booleanValue())? Glb.PAN_CANDELETE : 0, Glb.PAN_CANDELETE); 
        // 
        // disabilito tutti i campi del pannello
        // 
        // 
        IDVariant I = new IDVariant(0,IDVariant.INTEGER);
        for (; I.compareTo(new IDVariant(v_IDP.UFields()), true)<0; I = IDL.Add(I, (new IDVariant(1))))
        {
          v_IDP.SetFlags (Glb.OBJ_FIELD, I.intValue(), ((new IDVariant(0)).booleanValue())? Glb.OBJ_ENABLED : 0, Glb.OBJ_ENABLED); 
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "BloccaForm", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Blocco Totale Su Esercizio Finanziario
  // Esercizio - Input
  // Errmsg - Input/Output
  // **********************************************************************
  public boolean BloccoTotaleSuEsercizioFinanziario (IDVariant Esercizio, IDVariant Errmsg)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Blocco Totale Su Esercizio Finanziario Body
      // Corpo Procedura
      // 
      IDVariant v_BLOCCOTOTALE = new IDVariant(0,IDVariant.STRING);
      IDVariant v_FASEBILANCIO = null;
      v_FASEBILANCIO = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.BLOCCO_TOTALE as ESEFBLOCTOTA, ");
      SQL.append("  A.FASE_BILANCIO as ESEFFASEBILA ");
      SQL.append("from ");
      SQL.append("  ESEFIN A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_BLOCCOTOTALE = QV.Get("ESEFBLOCTOTA", IDVariant.STRING) ;
        v_FASEBILANCIO = QV.Get("ESEFFASEBILA", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_FASEBILANCIO.equals((new IDVariant(8)), true) && IDL.NullValue(v_BLOCCOTOTALE,(new IDVariant("NO"))).equals((new IDVariant("SI")), true))
      {
        IDVariant v_ERR = new IDVariant(0,IDVariant.STRING);
        v_ERR = (new IDVariant("Modifica non ammessa per l'esercizio"));
        Errmsg.set(new IDVariant(v_ERR));
        return (new IDVariant(-1)).booleanValue();
      }
      else
      {
        Errmsg.set((new IDVariant()));
        return (new IDVariant(0)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "BloccoTotaleSuEsercizioFinanziario", _e);
      return false;
    }
  }

  // **********************************************************************
  // Calcola Codice Fiscale Dal Catasto
  // Explain which processing is carried out by this procedure
  // Cognome:  - Input
  // Nome:  - Input
  // Data:  - Input
  // Codice Catasto:  - Input
  // Sesso:  - Input
  // **********************************************************************
  public IDVariant CalcolaCodiceFiscaleDalCatasto (IDVariant Cognome, IDVariant Nome, IDVariant Data, IDVariant CodiceCatasto, IDVariant Sesso)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CODICEFISCAL = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Calcola Codice Fiscale Dal Catasto Body
      // Procedure Body
      // 
      v_CODICEFISCAL = (new IDVariant());
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      MainFrm.Cf4armDBObject.CREA_CODICE_FISCALEdalCatasto(IDL.SubStr(Cognome, (new IDVariant(0)), (new IDVariant(40))), IDL.SubStr(Nome, (new IDVariant(0)), (new IDVariant(36))), Data, CodiceCatasto, Sesso, v_CODICEFISCAL);
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
        v_CODICEFISCAL = (new IDVariant(""));
      }
      return v_CODICEFISCAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CalcolaCodiceFiscaleDalCatasto", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Calcolaivaliq
  // Anno Prog:  - Input
  // Numero Prog:  - Input
  // **********************************************************************
  public IDVariant Calcolaivaliq (IDVariant AnnoProg, IDVariant NumeroProg)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Calcolaivaliq Body
      // Corpo Procedura
      // 
      IDVariant v_VCALCOIVALIQ = new IDVariant(0,IDVariant.DECIMAL);
      // IDVariant v_SOMMAIVA = new IDVariant(0,IDVariant.DECIMAL);
      // IDVariant v_SOMMAIVARET = new IDVariant(0,IDVariant.DECIMAL);
      // IDVariant v_SOMMALIQFAT = new IDVariant(0,IDVariant.DECIMAL);
      v_VCALCOIVALIQ = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  CALCOLA_IVA_LIQ(" + IDL.CSql(AnnoProg, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(NumeroProg, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ",'NO') as CAIVLIANPNPN ");
      SQL.append("from ");
      SQL.append("  DUAL A ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCALCOIVALIQ = QV.Get("CAIVLIANPNPN", IDVariant.DECIMAL) ;
      }
      QV.Close();
      return v_VCALCOIVALIQ;
      // SQL = new StringBuffer();
      // SQL.append("select ");
      // SQL.append("  NVL(SUM(DECODE(A.CODICE_DOC, B.CODICE_DOC, NVL(A.IVA, 0), NVL(A.IVA, 0) * -1)), 0) as NVSIEICDFCDN ");
      // SQL.append("from ");
      // SQL.append("  IVA A, ");
      // SQL.append("  FAT B ");
      // QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      // if (!QV.EOF()) QV.MoveNext();
      // if (!QV.EOF())
      // {
      //   v_SOMMAIVA = QV.Get("NVSIEICDFCDN", IDVariant.DECIMAL) ;
      // }
      // QV.Close();
      // SQL = new StringBuffer();
      // SQL.append("select ");
      // SQL.append("  NVL(SUM(DECODE(B.CODICE_DOC, C.CODICE_DOC, NVL(B.IVA, 0), NVL(B.IVA, 0) * -1)), 0) as NVSIEICDFCDN ");
      // SQL.append("from ");
      // SQL.append("  RETFAT A, ");
      // SQL.append("  IVA B, ");
      // SQL.append("  FAT C ");
      // QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      // if (!QV.EOF()) QV.MoveNext();
      // if (!QV.EOF())
      // {
      //   v_SOMMAIVARET = QV.Get("NVSIEICDFCDN", IDVariant.DECIMAL) ;
      // }
      // QV.Close();
      // SQL = new StringBuffer();
      // SQL.append("select ");
      // SQL.append("  NVL(SUM(NVL(A.IMPORTO_IVA, 0)), 0) as NUVASNVLII00 ");
      // SQL.append("from ");
      // SQL.append("  LIQ A ");
      // QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      // if (!QV.EOF()) QV.MoveNext();
      // if (!QV.EOF())
      // {
      //   v_SOMMALIQFAT = QV.Get("NUVASNVLII00", IDVariant.DECIMAL) ;
      // }
      // QV.Close();
      // return (IDL.Sub(IDL.Sub(IDL.NullValue(v_SOMMAIVA,(new IDVariant(0))), IDL.NullValue(v_SOMMAIVARET,(new IDVariant(0)))), IDL.NullValue(v_SOMMALIQFAT,(new IDVariant(0)))));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Calcolaivaliq", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Cap Default Per Impacc
  // Esercizio:  - Input
  // E S:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // Voce Econ:  - Input/Output
  // Tipo Vincolo:  - Input/Output
  // **********************************************************************
  public IDVariant CapDefaultPerImpacc (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo, IDVariant Articolo, IDVariant VoceEcon, IDVariant TipoVincolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Cap Default Per Impacc Body
      // Procedure Body
      // 
      try
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  B.VOCE_ECON as CAPVOCEECON, ");
        SQL.append("  B.TIPO_VINCOLO as CAPTIPOVINCO ");
        SQL.append("from ");
        SQL.append("  VINCOLI A, ");
        SQL.append("  CAP B ");
        SQL.append("where (B.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (B.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (B.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (B.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.CODICE(+) = B.TIPO_VINCOLO) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          VoceEcon.set(QV.Get("CAPVOCEECON", IDVariant.INTEGER));
          TipoVincolo.set(QV.Get("CAPTIPOVINCO", IDVariant.INTEGER));
        }
        QV.Close();
      }
      catch (Exception e3)
      {
        return (new IDVariant(-1));
      }
      // 
      // 
      // 
      // 
      return (new IDVariant(0));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CapDefaultPerImpacc", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Capitolo Presente
  // Esercizio:  - Input
  // ES:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // **********************************************************************
  public boolean CapitoloPresente (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Capitolo Presente Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  CAP A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.compareTo((new IDVariant(0)), true)>0)
      {
        v_RETVAL = (new IDVariant(-1));
      }
      else
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Capitolo non presente", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
        v_RETVAL = (new IDVariant(0));
      }
      return v_RETVAL.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CapitoloPresente", _e);
      return false;
    }
  }

  // **********************************************************************
  // Capitolofpvspesa
  // ES:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // **********************************************************************
  public boolean Capitolofpvspesa (IDVariant ES, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Capitolofpvspesa Body
      // Corpo Procedura
      // 
      if (ES.compareTo((new IDVariant("S")), true)!=0)
      {
        return (new IDVariant(0)).booleanValue();
      }
      IDVariant v_VCOUNT = new IDVariant(0,IDVariant.INTEGER);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  VISTA_RICLASSIFICAZIONI_CAP A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((" + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " BETWEEN A.ESERCIZIO_INIZIO AND NVL(A.ESERCIZIO_SCADENZA, 9999))) ");
      SQL.append("and   (A.E_S = 'S') ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CODICE_TIPO_RICL = 'MACRO') ");
      SQL.append("and   (A.LIVELLO = 4) ");
      SQL.append("and   (GET_FPV_ESPL(A.ESERCIZIO,A.CODICE) = 'SI') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_VCOUNT.compareTo((new IDVariant(0)), true)>0)
      {
        return (new IDVariant(-1)).booleanValue();
      }
      else
      {
        return (new IDVariant(0)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Capitolofpvspesa", _e);
      return false;
    }
  }

  // **********************************************************************
  // Centri Presente
  // Centro:  - Input
  // Scadenza:  - Input
  // **********************************************************************
  public IDVariant CentriPresente (IDVariant Centro, IDVariant Scadenza)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Centri Presente Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  CENTRI A ");
      SQL.append("where (A.CENTRO = " + IDL.CSql(Centro, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((A.DATA_VALIDITA IS NULL) OR A.DATA_VALIDITA >= " + IDL.CSql(Scadenza, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return IDL.NullValue(v_NUMREC,(new IDVariant(0)));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CentriPresente", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Centro Fattore
  // Explain which processing is carried out by this procedure
  // Esercizio:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // Data:  - Input
  // Centro:  - Input/Output
  // Fattore:  - Input/Output
  // **********************************************************************
  public IDVariant CentroFattore (IDVariant Esercizio, IDVariant Capitolo, IDVariant Articolo, IDVariant Data, IDVariant Centro, IDVariant Fattore)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Centro Fattore Body
      // Procedure Body
      // 
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.CENTRO as CAPCENTRO, ");
      SQL.append("  A.FATTORE as CAPFATTORE ");
      SQL.append("from ");
      SQL.append("  CAP A, ");
      SQL.append("  FATTORI B, ");
      SQL.append("  CENTRI C ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = 'S') ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CENTRO = C.CENTRO(+)) ");
      SQL.append("and   ((C.DATA_VALIDITA IS NULL) OR C.DATA_VALIDITA >= " + IDL.CSql(Data, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.FATTORE = B.FATTORE(+)) ");
      SQL.append("and   ((B.DATA_VALIDITA IS NULL) OR B.DATA_VALIDITA >= " + IDL.CSql(Data, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        Centro.set(QV.Get("CAPCENTRO", IDVariant.STRING));
        Fattore.set(QV.Get("CAPFATTORE", IDVariant.STRING));
      }
      QV.Close();
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
        v_RETVAL = (new IDVariant(-1));
      }
      else
      {
        v_RETVAL = (new IDVariant(1));
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CentroFattore", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Centro Fattore Cup Subimp
  // Anno Imp:  - Input
  // Numero Imp:  - Input
  // Anno Subimp:  - Input
  // Numero Subimp:  - Input
  // Centro:  - Input/Output
  // Fattore:  - Input/Output
  // Cig:  - Input/Output
  // Competenza Dal:  - Input/Output
  // Competenza Al:  - Input/Output
  // Cup:  - Input/Output
  // **********************************************************************
  public IDVariant CentroFattoreCupSubimp (IDVariant AnnoImp, IDVariant NumeroImp, IDVariant AnnoSubimp, IDVariant NumeroSubimp, IDVariant Centro, IDVariant Fattore, IDVariant Cig, IDVariant CompetenzaDal, IDVariant CompetenzaAl, IDVariant Cup)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Centro Fattore Cup Subimp Body
      // Procedure Body
      // 
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      if (IDL.NullValue(AnnoSubimp,(new IDVariant(0))).equals((new IDVariant(0)), true) || IDL.NullValue(NumeroSubimp,(new IDVariant(0))).equals((new IDVariant(0)), true))
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.CENTRO as IMPCENTRO, ");
        SQL.append("  A.FATTORE as IMPFATTORE, ");
        SQL.append("  A.COMPETENZA_DAL as IMPCOMPETDAL, ");
        SQL.append("  A.COMPETENZA_AL as IMPCOMPETEAL, ");
        SQL.append("  A.CUP as IMPCUP, ");
        SQL.append("  A.CIG as IMPCIG ");
        SQL.append("from ");
        SQL.append("  IMP A, ");
        SQL.append("  FATTORI B, ");
        SQL.append("  CENTRI C ");
        SQL.append("where (A.NUMERO_IMP = " + IDL.CSql(NumeroImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.ANNO_IMP = " + IDL.CSql(AnnoImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.CENTRO = C.CENTRO(+)) ");
        SQL.append("and   (A.FATTORE = B.FATTORE(+)) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          Centro.set(QV.Get("IMPCENTRO", IDVariant.STRING));
          Fattore.set(QV.Get("IMPFATTORE", IDVariant.STRING));
          CompetenzaDal.set(QV.Get("IMPCOMPETDAL", IDVariant.DATETIME));
          CompetenzaAl.set(QV.Get("IMPCOMPETEAL", IDVariant.DATETIME));
          Cup.set(QV.Get("IMPCUP", IDVariant.STRING));
          Cig.set(QV.Get("IMPCIG", IDVariant.STRING));
        }
        QV.Close();
      }
      else
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.CENTRO as SUBIMPCENTRO, ");
        SQL.append("  A.FATTORE as SUBIMPFATTOR, ");
        SQL.append("  A.COMPETENZA_DAL as SUBIMCOMPDAL, ");
        SQL.append("  A.COMPETENZA_AL as SUBIMCOMPEAL, ");
        SQL.append("  A.CUP as SUBIMPCUP, ");
        SQL.append("  A.CIG as SUBIMPCIG ");
        SQL.append("from ");
        SQL.append("  SUBIMP A, ");
        SQL.append("  FATTORI B, ");
        SQL.append("  CENTRI C ");
        SQL.append("where (A.NUMERO_IMP = " + IDL.CSql(NumeroSubimp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.ANNO_IMP = " + IDL.CSql(AnnoSubimp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.CENTRO = C.CENTRO(+)) ");
        SQL.append("and   (A.FATTORE = B.FATTORE(+)) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          Centro.set(QV.Get("SUBIMPCENTRO", IDVariant.STRING));
          Fattore.set(QV.Get("SUBIMPFATTOR", IDVariant.STRING));
          CompetenzaDal.set(QV.Get("SUBIMCOMPDAL", IDVariant.DATETIME));
          CompetenzaAl.set(QV.Get("SUBIMCOMPEAL", IDVariant.DATETIME));
          Cup.set(QV.Get("SUBIMPCUP", IDVariant.STRING));
          Cig.set(QV.Get("SUBIMPCIG", IDVariant.STRING));
        }
        QV.Close();
      }
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
        v_RETVAL = (new IDVariant(-1));
      }
      else
      {
        v_RETVAL = (new IDVariant(1));
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CentroFattoreCupSubimp", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Cfpeg Attivo
  // **********************************************************************
  public IDVariant CfpegAttivo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_ESERCIZIO = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Cfpeg Attivo Body
      // Procedure Body
      // 
      v_ESERCIZIO = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A_GET_PRIMO_ESERCIZIO_POL as CFDBAGEPRESP ");
      SQL.append("from ");
      SQL.append("  DUAL A ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_ESERCIZIO = QV.Get("CFDBAGEPRESP", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0).compareTo(v_ESERCIZIO, true)>=0)
      {
        return (new IDVariant(1));
      }
      else
      {
        return (new IDVariant(0));
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CfpegAttivo", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Check Codice Fiscale
  // Explain which processing is carried out by this procedure
  // Codice Fiscale:  - Input
  // Sesso:  - Input
  // Comune:  - Input
  // Provincia:  - Input
  // Data Nascita:  - Input
  // Cognome:  - Input
  // Nome:  - Input
  // **********************************************************************
  public IDVariant CheckCodiceFiscale (IDVariant CodiceFiscale, IDVariant Sesso, IDVariant Comune, IDVariant Provincia, IDVariant DataNascita, IDVariant Cognome, IDVariant Nome)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_INTERO = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_ERRORE2 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_ERRORE3 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_ERRORE4 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_ERRORE5 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_ERRORE6 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_ERRORE7 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_ERRORE8 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_ERRORE9 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_ERRORE10 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_ERRORE19 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_ERRORE21 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_ERRORE22 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_ERRORE23 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      v_ERRORE2 = (new IDVariant("Codice errato. In corrispondenza degli identificativi del nominativo, del 1° carattere del codice catasto o del carattere di controllo devono comparire solo caratteri alfabetici [A-Z].", IDVariant.STRING));
      v_ERRORE3 = (new IDVariant("Codice errato.In corrispondenza degli identificativi di anno e giorno di nascita e ultimi 3 caratteri del codice catasto devono essere numerici [0-9].", IDVariant.STRING));
      v_ERRORE4 = (new IDVariant("Codice errato. In corrispondenza del mese deve esserci un carattere alfabetico significativo.", IDVariant.STRING));
      v_ERRORE5 = (new IDVariant("Codice errato. Il Codice Catasto del Comune di Nascita deve essere lo stesso del Codice Fiscale.", IDVariant.STRING));
      v_ERRORE6 = (new IDVariant("Giorno di nascita errato.", IDVariant.STRING));
      v_ERRORE7 = (new IDVariant("Peso relativo ai primi 15 caratteri del Codice Fiscale errato.", IDVariant.STRING));
      v_ERRORE8 = (new IDVariant("Ultimo carattere errato.", IDVariant.STRING));
      v_ERRORE9 = (new IDVariant("Check del codice fiscale errato.", IDVariant.STRING));
      v_ERRORE10 = (new IDVariant("Data di nascita e codice fiscale incompatibili.", IDVariant.STRING));
      v_ERRORE19 = (new IDVariant("Errore non gestito.", IDVariant.STRING));
      v_ERRORE21 = (new IDVariant("Codice errato. Tutti i caratteri della Partita IVA devono essere numerici.", IDVariant.STRING));
      v_ERRORE22 = (new IDVariant("Codice errato. Controllo check Partita IVA fallito.", IDVariant.STRING));
      v_ERRORE23 = (new IDVariant("Codice Fiscale o Partita IVA errato!", IDVariant.STRING));
      // 
      // Check Codice Fiscale Body
      // Procedure Body
      // 
      v_INTERO = IDL.ToCurrency((new IDVariant(0)));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  AD4_CODICE_FISCALE.CONTROLLO(" + IDL.CSql(CodiceFiscale, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ",NVL(" + IDL.CSql(Sesso, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", '*'),NVL(" + IDL.CSql(Comune, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", -1),NVL(" + IDL.CSql(Provincia, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", -1),NVL(" + IDL.CSql(DataNascita, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ", TO_DATE('1900-01-01','YYYY-MM-DD')),NVL(" + IDL.CSql(Cognome, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", '-1'),NVL(" + IDL.CSql(Nome, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", '-1')) as CDCFCCFNVSNV ");
      SQL.append("from ");
      SQL.append("  DUAL A ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_INTERO = QV.Get("CDCFCCFNVSNV", IDVariant.DECIMAL) ;
      }
      QV.Close();
      v_RETVAL = (new IDVariant());
      if (v_INTERO.equals((new IDVariant(-1)), true))
      {
        v_RETVAL = (new IDVariant("Lunghezza Errata!"));
      }
      if (v_INTERO.equals((new IDVariant(-2)), true))
      {
        v_RETVAL = new IDVariant(v_ERRORE2);
      }
      if (v_INTERO.equals((new IDVariant(-3)), true))
      {
        v_RETVAL = new IDVariant(v_ERRORE3);
      }
      if (v_INTERO.equals((new IDVariant(-4)), true))
      {
        v_RETVAL = new IDVariant(v_ERRORE4);
      }
      if (v_INTERO.equals((new IDVariant(-5)), true))
      {
        v_RETVAL = new IDVariant(v_ERRORE5);
      }
      if (v_INTERO.equals((new IDVariant(-6)), true))
      {
        v_RETVAL = new IDVariant(v_ERRORE6);
      }
      if (v_INTERO.equals((new IDVariant(-7)), true))
      {
        v_RETVAL = new IDVariant(v_ERRORE7);
      }
      if (v_INTERO.equals((new IDVariant(-8)), true))
      {
        v_RETVAL = new IDVariant(v_ERRORE8);
      }
      if (v_INTERO.equals((new IDVariant(-9)), true))
      {
        v_RETVAL = new IDVariant(v_ERRORE9);
      }
      if (v_INTERO.equals((new IDVariant(-10)), true))
      {
        v_RETVAL = new IDVariant(v_ERRORE10);
      }
      if (v_INTERO.equals((new IDVariant(-19)), true))
      {
        v_RETVAL = new IDVariant(v_ERRORE19);
      }
      if (v_INTERO.equals((new IDVariant(-21)), true))
      {
        v_RETVAL = new IDVariant(v_ERRORE21);
      }
      if (v_INTERO.equals((new IDVariant(-22)), true))
      {
        v_RETVAL = new IDVariant(v_ERRORE22);
      }
      if (v_INTERO.equals((new IDVariant(30)), true))
      {
        v_RETVAL = new IDVariant(v_ERRORE23);
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CheckCodiceFiscale", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Codice Catasto
  // Explain which processing is carried out by this procedure
  // Provincia:  - Input
  // Comune:  - Input
  // **********************************************************************
  public IDVariant CodiceCatasto (IDVariant Provincia, IDVariant Comune)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CODICECATAST = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Codice Catasto Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.SIGLA_CFIS as COMUSIGLCFIS ");
      SQL.append("from ");
      SQL.append("  AD4_COMUNI A ");
      SQL.append("where (A.PROVINCIA_STATO = " + IDL.CSql(Provincia, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.COMUNE = " + IDL.CSql(Comune, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CODICECATAST = QV.Get("COMUSIGLCFIS", IDVariant.STRING) ;
      }
      QV.Close();
      return v_CODICECATAST;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CodiceCatasto", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Codici Gestionali Lk
  // Explain which processing is carried out by this procedure
  // Codice:  - Input
  // ES:  - Input
  // Anno:  - Input
  // **********************************************************************
  public IDVariant CodiciGestionaliLk (IDVariant Codice, IDVariant ES, IDVariant Anno)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Codici Gestionali Lk Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  CODICI_GESTIONALI A ");
      SQL.append("where (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CODICE = " + IDL.CSql(Codice, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true) || (new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        return (new IDVariant(-1));
      }
      else
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  CODICI_GESTIONALI A ");
        SQL.append("where (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.CODICE = " + IDL.CSql(Codice, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   ((A.SCADENZA IS NULL) OR A.SCADENZA >= " + IDL.CSql(Anno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
        if (v_CONTATORE.equals((new IDVariant(0)), true))
        {
          return (new IDVariant(2));
        }
        else
        {
          return (new IDVariant(1));
        }
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CodiciGestionaliLk", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Cofog Unico Cap
  // Esercizio:  - Input
  // ES:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // **********************************************************************
  public IDVariant CofogUnicoCap (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Cofog Unico Cap Body
      // Corpo Procedura
      // 
      IDVariant v_VCOUNT = new IDVariant(0,IDVariant.INTEGER);
      IDVariant v_VCOFOG = null;
      v_VCOFOG = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1, ");
      SQL.append("  MIN(A.COFOG) as MINPROCOFCOF ");
      SQL.append("from ");
      SQL.append("  PROGRAMMI_COFOG A, ");
      SQL.append("  CAP B ");
      SQL.append("where (B.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (B.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (B.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (B.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (B.CODICE_STRUTTURA = A.PROGRAMMA) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
        v_VCOFOG = QV.Get("MINPROCOFCOF", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_VCOUNT.compareTo((new IDVariant(1)), true)!=0)
      {
        v_VCOFOG = (new IDVariant());
      }
      return v_VCOFOG;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CofogUnicoCap", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Collapseexpandparampanel
  // CollapseExpandParamPanel
  // Commandcode:  - Input
  // Pannello:  - Input
  // **********************************************************************
  public int Collapseexpandparampanel (IDVariant Commandcode, IDPanel Pannello)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Collapseexpandparampanel Body
      // Corpo Procedura
      // 
      IDVariant v_PARAMEIMMESS = new IDVariant(0,IDVariant.STRING);
      v_PARAMEIMMESS = (new IDVariant());
      ACommand v_IDC = null;
      v_IDC = MainFrm.CmdObj.GetCommandByCode(Commandcode.stringValue());
      IDVariant I = new IDVariant(0,IDVariant.INTEGER);
      for (; I.compareTo(new IDVariant(Pannello.UFields()), true)<0; I = IDL.Add(I, (new IDVariant(1))))
      {
        IDVariant v_VALORE = new IDVariant(0,IDVariant.STRING);
        v_VALORE = (new IDVariant());
        IDVariant v_VIS = null;
        v_VIS = (new IDVariant(Pannello.FieldVisible(I.intValue(), (new IDVariant(0)).intValue())));
        IDVariant v_VAL = null;
        v_VAL = Pannello.Value(new IDVariant(Pannello.GetFieldCode(I.intValue())).stringValue());
        if (v_VIS.booleanValue())
        {
          v_VALORE = new IDVariant(v_VAL);
        }
        IDVariant v_CAPTION = new IDVariant(0,IDVariant.STRING);
        v_CAPTION = (new IDVariant());
        v_CAPTION = new IDVariant(Pannello.Header(Glb.OBJ_FIELD,I.intValue()));
        if (!(IDL.IsNull(v_VALORE)))
        {
          v_PARAMEIMMESS = IDL.Add(IDL.Add(IDL.Add(IDL.Add(v_PARAMEIMMESS, v_CAPTION), (new IDVariant(" = "))), v_VALORE), (new IDVariant("\n")));
        }
      }
      Pannello.set_Collapsed(!(Pannello.Collapsed));
      if (!(Pannello.Collapsed))
      {
        if (!(IDL.IsNull(v_PARAMEIMMESS)))
        {
          v_IDC.set_bImage((new IDVariant("collapse_red.gif")).stringValue());
        }
        else
        {
          v_IDC.set_bImage((new IDVariant("collapse.gif")).stringValue());
        }
        v_IDC.set_bCaption((new IDVariant("Collassa il pannello filtri")).stringValue());
        v_IDC.set_bToolTip(IDL.Add((new IDVariant("Collassa il pannello filtri")), (new IDVariant("\n"))).stringValue());
      }
      else
      {
        if (!(IDL.IsNull(v_PARAMEIMMESS)))
        {
          v_IDC.set_bImage((new IDVariant("expand_red.gif")).stringValue());
          v_IDC.set_bCaption((new IDVariant("SONO PRESENTI FILTRI")).stringValue());
          v_IDC.set_bToolTip(new IDVariant(v_PARAMEIMMESS).stringValue());
        }
        else
        {
          v_IDC.set_bImage((new IDVariant("expand.gif")).stringValue());
          v_IDC.set_bCaption((new IDVariant("Espandi il pannello filtri")).stringValue());
          v_IDC.set_bToolTip(IDL.Add((new IDVariant("Espandi il pannello filtri")), (new IDVariant("\n"))).stringValue());
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Collapseexpandparampanel", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Conta Impfin
  // Explain which processing is carried out by this procedure
  // Anno Impegno - Input
  // Numero Impegno - Input
  // **********************************************************************
  public IDVariant ContaImpfin (IDVariant AnnoImpegno, IDVariant NumeroImpegno)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_FINANZIAMENT = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Conta Impfin Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  IMP_FIN A ");
      SQL.append("where (A.ANNO_IMP = " + IDL.CSql(AnnoImpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_IMP = " + IDL.CSql(NumeroImpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(1)), true))
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.FINANZIAMENTO as IMPFINFINANZ ");
        SQL.append("from ");
        SQL.append("  IMP_FIN A ");
        SQL.append("where (A.ANNO_IMP = " + IDL.CSql(AnnoImpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_IMP = " + IDL.CSql(NumeroImpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_FINANZIAMENT = QV.Get("IMPFINFINANZ", IDVariant.INTEGER) ;
        }
        QV.Close();
        v_RETVAL = new IDVariant(v_FINANZIAMENT);
      }
      else
      {
        v_RETVAL = (new IDVariant(-1));
      }
      return v_FINANZIAMENT;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ContaImpfin", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Conta Subimpfin
  // Explain which processing is carried out by this procedure
  // Anno Subimpegno:  - Input
  // Numero Subimpegno:  - Input
  // **********************************************************************
  public IDVariant ContaSubimpfin (IDVariant AnnoSubimpegno, IDVariant NumeroSubimpegno)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_FINANZIAMENT = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Conta Subimpfin Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1, ");
      SQL.append("  MIN(A.FINANZIAMENTO) as MINSUBFINFIN ");
      SQL.append("from ");
      SQL.append("  SUBIMP_FIN A ");
      SQL.append("where (A.ANNO_SUBIMP = " + IDL.CSql(AnnoSubimpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_SUBIMP = " + IDL.CSql(NumeroSubimpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
        v_FINANZIAMENT = QV.Get("MINSUBFINFIN", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(1)), true))
      {
        v_RETVAL = new IDVariant(v_FINANZIAMENT);
      }
      else
      {
        v_RETVAL = (new IDVariant(-1));
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ContaSubimpfin", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Controlla Acc Imp Eco
  // Anno Acc:  - Input
  // Numero Acc:  - Input
  // **********************************************************************
  public IDVariant ControllaAccImpEco (IDVariant AnnoAcc, IDVariant NumeroAcc)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controlla Acc Imp Eco Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  IMP_ECO A, ");
      SQL.append("  PRE B ");
      SQL.append("where (A.ANNO_PRE = B.ANNO_PRE) ");
      SQL.append("and   (A.NUMERO_PRE = B.NUMERO_PRE) ");
      SQL.append("and   (B.ANNO_ACC = " + IDL.CSql(AnnoAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (B.NUMERO_ACC = " + IDL.CSql(NumeroAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return v_NUMREC;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControllaAccImpEco", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Controlla Acc Pre
  // Anno Acc:  - Input
  // Numero Acc:  - Input
  // **********************************************************************
  public IDVariant ControllaAccPre (IDVariant AnnoAcc, IDVariant NumeroAcc)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controlla Acc Pre Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  ACC A, ");
      SQL.append("  PRE B ");
      SQL.append("where (A.ANNO_ACC = B.ANNO_ACC) ");
      SQL.append("and   (A.NUMERO_ACC = B.NUMERO_ACC) ");
      SQL.append("and   ((B.FATTORE IS NULL)) ");
      SQL.append("and   (A.ANNO_ACC = " + IDL.CSql(AnnoAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_ACC = " + IDL.CSql(NumeroAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return v_NUMREC;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControllaAccPre", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Controlla Accertamenti
  // Anno Acc:  - Input
  // Numero Acc:  - Input
  // **********************************************************************
  public IDVariant ControllaAccertamenti (IDVariant AnnoAcc, IDVariant NumeroAcc)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controlla Accertamenti Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  ACC A ");
      SQL.append("where (A.ANNO_ACC = " + IDL.CSql(AnnoAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_ACC = " + IDL.CSql(NumeroAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return v_NUMREC;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControllaAccertamenti", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Controlla Beneficiario
  // Codice Ben:  - Input
  // Data Filtro - Optional - Input
  // **********************************************************************
  public boolean ControllaBeneficiario (IDVariant CodiceBen, IDVariant DataFiltro)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVALUE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controlla Beneficiario Body
      // Procedure Body
      // 
      v_CONTATORE = (new IDVariant(0));
      v_RETVALUE = (new IDVariant(-1));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  BEN A ");
      SQL.append("where (A.CODICE = " + IDL.CSql(CodiceBen, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((NVL(" + IDL.CSql(DataFiltro, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ", TRUNC( SYSDATE )) BETWEEN NVL(A.DAL, TO_DATE('1900-01-01','YYYY-MM-DD')) AND NVL(A.AL, TO_DATE('2999-12-31','YYYY-MM-DD')))) ");
      SQL.append("and   (DECODE(A.D_SCADENZA, to_date(NULL), TO_DATE('2999-12-31','YYYY-MM-DD'), A.D_SCADENZA) >= NVL(" + IDL.CSql(DataFiltro, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ", TRUNC( SYSDATE ))) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        v_RETVALUE = (new IDVariant(0));
        return v_RETVALUE.booleanValue();
      }
      return v_RETVALUE.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControllaBeneficiario", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controlla Centro
  // Centro:  - Input
  // **********************************************************************
  public boolean ControllaCentro (IDVariant Centro)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVALUE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controlla Centro Body
      // Procedure Body
      // 
      v_RETVALUE = (new IDVariant(-1));
      v_CONTATORE = (new IDVariant(0));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  CENTRI A ");
      SQL.append("where (A.CENTRO = " + IDL.CSql(Centro, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((A.DATA_VALIDITA IS NULL) OR A.DATA_VALIDITA >= TRUNC( SYSDATE )) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        v_RETVALUE = (new IDVariant(0));
        return v_RETVALUE.booleanValue();
      }
      return v_RETVALUE.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControllaCentro", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controlla Contropartita
  // Fattore - Input
  // **********************************************************************
  public boolean ControllaContropartita (IDVariant Fattore)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVALUE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controlla Contropartita Body
      // Procedure Body
      // 
      v_CONTATORE = (new IDVariant(0));
      v_RETVALUE = (new IDVariant(-1));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  FATTORI A ");
      SQL.append("where (A.FATTORE = " + IDL.CSql(Fattore, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (NVL(A.DATA_VALIDITA, TRUNC( SYSDATE )) >= TRUNC( SYSDATE )) ");
      SQL.append("and   (A.TIPO = 'A' OR A.TIPO = 'P') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        v_RETVALUE = (new IDVariant(0));
        return v_RETVALUE.booleanValue();
      }
      return v_RETVALUE.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControllaContropartita", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controlla Esefin
  // Esercizio:  - Input
  // **********************************************************************
  public IDVariant ControllaEsefin (IDVariant Esercizio)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_FASE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controlla Esefin Body
      // Procedure Body
      // 
      if (IDL.IsNull(Esercizio))
      {
        return (new IDVariant(0));
      }
      else
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.FASE_BILANCIO as ESEFFASEBILA ");
        SQL.append("from ");
        SQL.append("  ESEFIN A ");
        SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_FASE = QV.Get("ESEFFASEBILA", IDVariant.INTEGER) ;
        }
        QV.Close();
        return v_FASE;
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControllaEsefin", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Controlla Fattore
  // Fattore - Input
  // **********************************************************************
  public boolean ControllaFattore (IDVariant Fattore)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVALUE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controlla Fattore Body
      // Procedure Body
      // 
      v_CONTATORE = (new IDVariant(0));
      v_RETVALUE = (new IDVariant(-1));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  FATTORI A ");
      SQL.append("where (A.FATTORE = " + IDL.CSql(Fattore, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (NVL(A.DATA_VALIDITA, TRUNC( SYSDATE )) >= TRUNC( SYSDATE )) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        v_RETVALUE = (new IDVariant(0));
        return v_RETVALUE.booleanValue();
      }
      return v_RETVALUE.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControllaFattore", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controlla Impegno
  // Numero Impegno:  - Input
  // Anno Impegno:  - Input
  // **********************************************************************
  public boolean ControllaImpegno (IDVariant NumeroImpegno, IDVariant AnnoImpegno)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVALUE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controlla Impegno Body
      // Procedure Body
      // 
      v_RETVALUE = (new IDVariant(-1));
      v_CONTATORE = (new IDVariant(0));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  ESEIMP A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_IMP = " + IDL.CSql(AnnoImpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_IMP = " + IDL.CSql(NumeroImpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        v_RETVALUE = (new IDVariant(0));
        return v_RETVALUE.booleanValue();
      }
      return v_RETVALUE.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControllaImpegno", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controlla NO Righe Iva Fattura Senza Registri
  // True Ok. FALSE Righe senza indicato registro
  // FAT ANNO PROG - Input
  // FAT NUMERO PROG - Input
  // Ritorno Messaggio Errore:  - Input
  // Ritorno Ben In MSG Errore:  - Input
  // Messaggio Errore OUT:  - Input/Output
  // Bloccante O Non Bloccante OUT:  - Optional - Input/Output
  // **********************************************************************
  public boolean ControllaNORigheIvaFatturaSenzaRegistri (IDVariant FATANNOPROG, IDVariant FATNUMEROPROG, IDVariant RitornoMessaggioErrore, IDVariant RitornoBenInMSGErrore, IDVariant MessaggioErroreOUT, IDVariant BloccanteONonBloccanteOUT)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Controlla NO Righe Iva Fattura Senza Registri Body
      // Corpo Procedura
      // 
      IDVariant v_VCONTAIVASEN = new IDVariant(0,IDVariant.INTEGER);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  IVA A, ");
      SQL.append("  FAT B ");
      SQL.append("where (A.ANNO_PROG = " + IDL.CSql(FATANNOPROG, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_PROG = " + IDL.CSql(FATNUMEROPROG, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (B.ANNO_PROG = A.ANNO_PROG) ");
      SQL.append("and   (B.NUMERO_PROG = A.NUMERO_PROG) ");
      SQL.append("and   (NOT ((B.TRATTAMENTO_IVA IS NULL))) ");
      SQL.append("and   ((A.REC_VENDITE IS NULL)) ");
      SQL.append("and   (NVL(A.IVA, 0) <> 0) ");
      SQL.append("and   ((NVL(A.TIPO_REGISTRO, A.TIPO_REGISTRO_S) IS NULL) OR (NVL(A.SERVIZIO, A.TIPO_BOLLATO_S) IS NULL)) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCONTAIVASEN = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      BloccanteONonBloccanteOUT.set(new IDVariant(CONREGLIQFAT));
      if (v_VCONTAIVASEN.compareTo((new IDVariant(0)), true)>0 && IDL.NullValue(RitornoMessaggioErrore,(new IDVariant("NO"))).equals((new IDVariant("SI")), true))
      {
        IDVariant F = new IDVariant(0,IDVariant.STRING);
        F = (new IDVariant("Fattura "));
        IDVariant E = new IDVariant(0,IDVariant.STRING);
        E = (new IDVariant(" sono presenti Dettagli IVA senza indicazione del Registro."));
        IDVariant v_MSGERR = new IDVariant(0,IDVariant.STRING);
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  " + IDL.CSql(F, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || A.NUMERO_DOC || ' del ' || TO_CHAR ( A.D_DATA_DOC,'dd/mm/yyyy') || ' ' || DECODE(A.TRATTAMENTO_IVA, 'SP', 'Split Payment', 'Reverse Charge') || CASE WHEN NVL(" + IDL.CSql(RitornoBenInMSGErrore, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", 'NO') = 'SI' THEN ' - ' || B.RAGIONE_SOCIALE ELSE '' END || ':' || " + IDL.CSql(E, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " as FFNDDTCFDDDD ");
        SQL.append("from ");
        SQL.append("  FAT A, ");
        SQL.append("  BEN B ");
        SQL.append("where (A.ANNO_PROG = " + IDL.CSql(FATANNOPROG, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_PROG = " + IDL.CSql(FATNUMEROPROG, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (B.CODICE(+) = A.CODICE) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_MSGERR = QV.Get("FFNDDTCFDDDD", IDVariant.STRING) ;
        }
        QV.Close();
        MessaggioErroreOUT.set(new IDVariant(v_MSGERR));
      }
      if (v_VCONTAIVASEN.equals((new IDVariant(0)), true))
      {
        return (new IDVariant(-1)).booleanValue();
      }
      else
      {
        return (new IDVariant(0)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControllaNORigheIvaFatturaSenzaRegistri", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controlla Progetto
  // Progetto:  - Input
  // **********************************************************************
  public boolean ControllaProgetto (IDVariant Progetto)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVALUE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controlla Progetto Body
      // Procedure Body
      // 
      v_CONTATORE = (new IDVariant(0));
      v_RETVALUE = (new IDVariant(-1));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  PROGETTI A ");
      SQL.append("where (A.PROGETTO_ID = " + IDL.CSql(Progetto, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        v_RETVALUE = (new IDVariant(0));
        return v_RETVALUE.booleanValue();
      }
      return v_RETVALUE.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControllaProgetto", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controlla Proposta
  // Unità Prop - Input
  // Numero Proposta - Input
  // Anno Proposta:  - Input
  // **********************************************************************
  public boolean ControllaProposta (IDVariant UnitàProp, IDVariant NumeroProposta, IDVariant AnnoProposta)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RET = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controlla Proposta Body
      // Procedure Body
      // 
      v_RET = (new IDVariant(-1));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  PROPOSTE A ");
      SQL.append("where (A.UNITA_PROPONENTE = " + IDL.CSql(UnitàProp, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO = " + IDL.CSql(NumeroProposta, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO = " + IDL.CSql(AnnoProposta, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        v_RET = (new IDVariant(0));
      }
      return v_RET.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControllaProposta", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controlla Quietanza
  // Ben:  - Input
  // **********************************************************************
  public boolean ControllaQuietanza (IDVariant Ben)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVALUE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controlla Quietanza Body
      // Procedure Body
      // 
      v_CONTATORE = (new IDVariant(0));
      v_RETVALUE = (new IDVariant(-1));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  QTN A ");
      SQL.append("where (A.CODICE = " + IDL.CSql(Ben, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((A.SCADENZA IS NULL) OR A.SCADENZA > TRUNC( SYSDATE )) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        v_RETVALUE = (new IDVariant(0));
        return v_RETVALUE.booleanValue();
      }
      return v_RETVALUE.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControllaQuietanza", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controlla Subimpegno
  // Numero Subimpegno:  - Input
  // Anno Subimpegno:  - Input
  // **********************************************************************
  public boolean ControllaSubimpegno (IDVariant NumeroSubimpegno, IDVariant AnnoSubimpegno)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVALUE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controlla Subimpegno Body
      // Procedure Body
      // 
      v_CONTATORE = (new IDVariant(0));
      v_RETVALUE = (new IDVariant(-1));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  VISTA_SUBIMP_UO_UT A ");
      SQL.append("where (A.NUMERO_SUBIMP = " + IDL.CSql(NumeroSubimpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_SUBIMP = " + IDL.CSql(AnnoSubimpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        v_RETVALUE = (new IDVariant(0));
        return v_RETVALUE.booleanValue();
      }
      return v_RETVALUE.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControllaSubimpegno", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controlla Voce P E G
  // Capitolo:  - Input
  // Articolo:  - Input
  // Esercizio:  - Input
  // E S - Input
  // **********************************************************************
  public boolean ControllaVocePEG (IDVariant Capitolo, IDVariant Articolo, IDVariant Esercizio, IDVariant ES)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVALUE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controlla Voce P E G Body
      // Procedure Body
      // 
      v_CONTATORE = (new IDVariant(0));
      v_RETVALUE = (new IDVariant(-1));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  CAP A ");
      SQL.append("where (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ESERCIZIO = NVL(" + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ")) ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        v_RETVALUE = (new IDVariant(0));
        return v_RETVALUE.booleanValue();
      }
      return v_RETVALUE.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControllaVocePEG", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controllaestampamessaggioerrore
  // RITORNA TRUE SE ERRORE ALTRIMENTI FALSE
  // 
  // errorMessage <> empty string e stampa
  // **********************************************************************
  public boolean Controllaestampamessaggioerrore ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Controllaestampamessaggioerrore Body
      // Procedure Body
      // 
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
        return (new IDVariant(-1)).booleanValue();
      }
      return (new IDVariant(0)).booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Controllaestampamessaggioerrore", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controlliivaist
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // Anno Prog - Input
  // Numeroprog:  - Input
  // Importo LIQ - Input
  // Importoiva - Input
  // Importoivaist:  - Input
  // **********************************************************************
  public boolean Controlliivaist (IDVariant AnnoProg, IDVariant Numeroprog, IDVariant ImportoLIQ, IDVariant Importoiva, IDVariant Importoivaist)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Controlliivaist Body
      // Corpo Procedura
      // 
      IDVariant v_VTOTIVA = new IDVariant(0,IDVariant.DECIMAL);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  SUM(A.IVA) as SUMIVA ");
      SQL.append("from ");
      SQL.append("  IVA A ");
      SQL.append("where (A.ANNO_PROG = " + IDL.CSql(AnnoProg, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_PROG = " + IDL.CSql(Numeroprog, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VTOTIVA = QV.Get("SUMIVA", IDVariant.DECIMAL) ;
      }
      QV.Close();
      if (IDL.NullValue(Importoiva,(new IDVariant(0))).compareTo(IDL.NullValue(ImportoLIQ,(new IDVariant(0))), true)>0)
      {
        IDVariant S = new IDVariant(0,IDVariant.STRING);
        S = (new IDVariant("L'importo IVA non può superare l'importo della Liquidazione"));
        MainFrm.set_AlertMessage(S); 
        return (new IDVariant(0)).booleanValue();
      }
      if (IDL.NullValue(Importoivaist,(new IDVariant(0))).compareTo(IDL.NullValue(Importoiva,(new IDVariant(0))), true)>0)
      {
        IDVariant S = new IDVariant(0,IDVariant.STRING);
        S = (new IDVariant("L'importo IVA Istituzionale  non può superare l'importo IVA della Liquidazione"));
        MainFrm.set_AlertMessage(S); 
        return (new IDVariant(0)).booleanValue();
      }
      // 
      // -----------------------------
      // 
      IDVariant v_VFATIMPORTOT = new IDVariant(0,IDVariant.DECIMAL);
      IDVariant v_VFATTRATTIVA = new IDVariant(0,IDVariant.STRING);
      IDVariant v_VATTIVITADOC = new IDVariant(0,IDVariant.STRING);
      // SQL = new StringBuffer();
      // SQL.append("select ");
      // SQL.append("  A.IMPORTO + NVL(A.VARIAZIONI, 0) as FAIMNUVAFAV0, ");
      // SQL.append("  A.TRATTAMENTO_IVA as FATTRATTAIVA, ");
      // SQL.append("  GET_ATTIVITA_DOC(" + IDL.CSql(AnnoProg, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(Numeroprog, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") as GEATDOANPRNU ");
      // SQL.append("from ");
      // SQL.append("  FAT A ");
      // SQL.append("where (A.ANNO_PROG = " + IDL.CSql(AnnoProg, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      // SQL.append("and   (A.NUMERO_PROG = " + IDL.CSql(Numeroprog, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      // QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      // if (!QV.EOF()) QV.MoveNext();
      // if (!QV.EOF())
      // {
      //   v_VFATIMPORTOT = QV.Get("FAIMNUVAFAV0", IDVariant.DECIMAL) ;
      //   v_VFATTRATTIVA = QV.Get("FATTRATTAIVA", IDVariant.STRING) ;
      //   v_VATTIVITADOC = QV.Get("GEATDOANPRNU", IDVariant.STRING) ;
      // }
      // QV.Close();
      // if (IDL.NullValue(v_VFATTRATTIVA,(new IDVariant(""))).compareTo((new IDVariant("")), true)!=0 && v_VATTIVITADOC.equals((new IDVariant("P")), true))
      // {
        // 
        // se liquidata parzialmente
        // 
        // if (ImportoLIQ.compareTo(v_VFATIMPORTOT, true)<0)
        // {
        // }
      // }
      return (new IDVariant(-1)).booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Controlliivaist", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controllo Accertamento Valido
  // Esercizio:  - Input
  // Anno Acc:  - Input
  // Numero Acc:  - Input
  // **********************************************************************
  public boolean ControlloAccertamentoValido (IDVariant Esercizio, IDVariant AnnoAcc, IDVariant NumeroAcc)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Accertamento Valido Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  ESEACC A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_ACC = " + IDL.CSql(AnnoAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_ACC = " + IDL.CSql(NumeroAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0 || v_NUMREC.equals((new IDVariant(0)), true))
      {
        return (new IDVariant(0)).booleanValue();
      }
      else
      {
        return (new IDVariant(-1)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloAccertamentoValido", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controllo Ammissibilità Man Ord Inf
  // Data Inizio:  - Input
  // **********************************************************************
  public boolean ControlloAmmissibilitàManOrdInf (IDVariant DataInizio)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_TIPOLICENZA = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      v_TIPOLICENZA = (new IDVariant("MIF", IDVariant.STRING));
      // 
      // Controllo Ammissibilità Man Ord Inf Body
      // Corpo Procedura
      // 
      if (Licenza(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOISTANZ, 0), v_TIPOLICENZA) && IDL.NullValue(DataInizio,(new IDVariant("2999/12/31# 00:00:00", IDVariant.DATETIME))).compareTo(IDL.Today(), true)<=0)
      {
        return (new IDVariant(-1)).booleanValue();
      }
      else
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Funzionalità non ammessa"));
        MainFrm.set_AlertMessage(v_AVVISO); 
        return (new IDVariant(0)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloAmmissibilitàManOrdInf", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controllo Bilancio
  // Explain which processing is carried out by this procedure
  // Esercizio:  - Input
  // ES:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // **********************************************************************
  public IDVariant ControlloBilancio (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_IMPORTO = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Bilancio Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  MIN(NVL(A.STN_INI_CO, 0) + NVL(A.VARIAZIONI_CO, 0)) as MNVBSIC0NVBV, ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  BIL A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_IMPORTO = QV.Get("MNVBSIC0NVBV", IDVariant.DECIMAL) ;
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0 || v_NUMREC.equals((new IDVariant(0)), true))
      {
        v_RETVAL = (new IDVariant(-1));
      }
      else
      {
        if (v_IMPORTO.equals((new IDVariant(0)), true))
        {
          v_RETVAL = (new IDVariant(0));
        }
        else
        {
          v_RETVAL = (new IDVariant(1));
        }
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloBilancio", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Controllo Bilancio Simulato
  // Esercizio:  - Input
  // ES:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // **********************************************************************
  public IDVariant ControlloBilancioSimulato (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_IMPORTO = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Bilancio Simulato Body
      // Procedure Body
      // 
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  NVL(A.STN_INI_CO, 0) + NVL(A.VARIAZIONI_CO, 0) as NVBSIC0NVBVC ");
      SQL.append("from ");
      SQL.append("  BPR A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_IMPORTO = QV.Get("NVBSIC0NVBVC", IDVariant.DECIMAL) ;
      }
      QV.Close();
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        v_RETVAL = (new IDVariant(-1));
      }
      else
      {
        if (v_IMPORTO.equals((new IDVariant(0)), true))
        {
          v_RETVAL = (new IDVariant(0));
        }
        else
        {
          v_RETVAL = (new IDVariant(1));
        }
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloBilancioSimulato", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Controllo Cap Ordine Ril IVA
  // Anno Buono:  - Input
  // Numero Buono:  - Input
  // Progr Buono:  - Input
  // **********************************************************************
  public boolean ControlloCapOrdineRilIVA (IDVariant AnnoBuono, IDVariant NumeroBuono, IDVariant ProgrBuono)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Controllo Cap Ordine Ril IVA Body
      // Corpo Procedura
      // 
      IDVariant v_VCOUNT = new IDVariant(0,IDVariant.INTEGER);
      IDVariant v_RITORNO = new IDVariant(0,IDVariant.INTEGER);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  DETTAGLI_IMPEGNI_BUONI A, ");
      SQL.append("  IMP B, ");
      SQL.append("  CAP C ");
      SQL.append("where (A.ANNO_BUONO = " + IDL.CSql(AnnoBuono, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_BUONO = " + IDL.CSql(NumeroBuono, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.PROGRESSIVO_BUONO = " + IDL.CSql(ProgrBuono, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (B.ANNO_IMP = A.ANNO_IMP) ");
      SQL.append("and   (B.NUMERO_IMP = A.NUMERO_IMP) ");
      SQL.append("and   (C.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (C.E_S = 'S') ");
      SQL.append("and   (C.CAPITOLO = B.CAPITOLO) ");
      SQL.append("and   (C.ARTICOLO = B.ARTICOLO) ");
      SQL.append("and   (C.IVA = 'SI') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_VCOUNT.compareTo((new IDVariant(0)), true)>0)
      {
        v_RITORNO = (new IDVariant(-1));
      }
      else
      {
        v_RITORNO = (new IDVariant(0));
      }
      return v_RITORNO.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloCapOrdineRilIVA", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controllo Centro Scaduto
  // Centro:  - Input
  // **********************************************************************
  public boolean ControlloCentroScaduto (IDVariant Centro)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Centro Scaduto Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  CENTRI A ");
      SQL.append("where (A.CENTRO = " + IDL.CSql(Centro, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((A.DATA_VALIDITA IS NULL) OR A.DATA_VALIDITA >= TRUNC( SYSDATE )) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0 || v_NUMREC.equals((new IDVariant(0)), true))
      {
        return (new IDVariant(-1)).booleanValue();
      }
      else
      {
        return (new IDVariant(0)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloCentroScaduto", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controllo Cgu Scaduto
  // Esercizio:  - Input
  // Entrata Spesa:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // Cgu:  - Input
  // Voce Econ:  - Input
  // **********************************************************************
  public boolean ControlloCguScaduto (IDVariant Esercizio, IDVariant EntrataSpesa, IDVariant Capitolo, IDVariant Articolo, IDVariant Cgu, IDVariant VoceEcon)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Cgu Scaduto Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  CAP A, ");
      SQL.append("  RICLASSIFICAZIONI_GEST B, ");
      SQL.append("  CODICI_GESTIONALI C, ");
      SQL.append("  RICLASSIFICAZIONI D ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(EntrataSpesa, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (C.CODICE = B.CODICE_GESTIONALE) ");
      SQL.append("and   (B.PROGR_RICLASSIFICAZIONI = D.PROGRESSIVO) ");
      SQL.append("and   (C.E_S = D.E_S) ");
      SQL.append("and   (B.E_S = D.E_S) ");
      SQL.append("and   (B.E_S = " + IDL.CSql(EntrataSpesa, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (D.TITOLO = A.TITOLO) ");
      SQL.append("and   (NVL(D.CATEGORIA, -1) = NVL(A.CATEGORIA, -1)) ");
      SQL.append("and   (NVL(D.COD_INTERVENTO, -1) = NVL(A.COD_INTERVENTO, -1)) ");
      SQL.append("and   (NVL(D.COD_TERZI, -1) = NVL(A.COD_TERZI, -1)) ");
      SQL.append("and   (D.VOCE_ECON = NVL(" + IDL.CSql(VoceEcon, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", D.VOCE_ECON)) ");
      SQL.append("and   ((C.SCADENZA IS NULL) OR C.SCADENZA >= " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (C.CODICE = " + IDL.CSql(Cgu, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0 || v_NUMREC.equals((new IDVariant(0)), true))
      {
        return (new IDVariant(-1)).booleanValue();
      }
      else
      {
        return (new IDVariant(0)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloCguScaduto", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controllo Delibere
  // Explain which processing is carried out by this procedure
  // Sede:  - Input/Output
  // Anno:  - Input/Output
  // Numero:  - Input/Output
  // Conferma:  - Optional - Input
  // **********************************************************************
  public int ControlloDelibere (IDVariant Sede, IDVariant Anno, IDVariant Numero, IDVariant Conferma)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Controllo Delibere Body
      // Procedure Body
      // 
      if (IDL.NullValue(Sede,(new IDVariant(""))).compareTo((new IDVariant("")), true)!=0 && !(IDL.IsNull(Numero)) && !(IDL.IsNull(Anno)))
      {
        IDVariant v_DESCRIZIONE = new IDVariant(0,IDVariant.STRING);
        v_DESCRIZIONE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.DESCRIZIONE as DELDESCRIZIO ");
        SQL.append("from ");
        SQL.append("  DEL A ");
        SQL.append("where (A.SEDE_DEL = " + IDL.CSql(Sede, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.ANNO_DEL = " + IDL.CSql(Anno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_DEL = " + IDL.CSql(Numero, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_DESCRIZIONE = QV.Get("DELDESCRIZIO", IDVariant.STRING) ;
        }
        QV.Close();
        if (GESTIODELIBE.booleanValue() && (IDL.IsNull(v_DESCRIZIONE) || v_DESCRIZIONE.equals((new IDVariant("")), true)))
        {
          if (IDL.IsNull(v_DESCRIZIONE))
          {
            IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
            v_MESSAGGIO = (new IDVariant("Delibera non Presente", IDVariant.STRING));
            Sede.set((new IDVariant()));
            Numero.set((new IDVariant()));
            Anno.set((new IDVariant()));
            MainFrm.set_AlertMessage(v_MESSAGGIO); 
            return 0;
          }
        }
        if (!(GESTIODELIBE.booleanValue()) && (IDL.IsNull(v_DESCRIZIONE) || v_DESCRIZIONE.equals((new IDVariant("")), true)))
        {
          IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
          v_MESSAGGIO = (new IDVariant("Delibera non Esistente. Si desidera Inserirne una nuova ?", IDVariant.STRING));
          IDVariant v_RISPOSTA = new IDVariant(0,IDVariant.INTEGER);
          v_RISPOSTA = (new IDVariant(0, IDVariant.INTEGER));
          if (Conferma.equals((new IDVariant("SI")), true))
          {
            v_RISPOSTA = (new IDVariant(MainFrm.MessageConfirm(v_MESSAGGIO)));
          }
          else
          {
            v_RISPOSTA = (new IDVariant(-1));
          }
          if (!(v_RISPOSTA.booleanValue()))
          {
            return 0;
          }
          else
          {
            IDVariant v_CODICE = null;
            v_CODICE = (new IDVariant());
            SQL = new StringBuffer();
            SQL.append("select ");
            SQL.append("  A.CODICE as T10CODICE ");
            SQL.append("from ");
            SQL.append("  T10 A ");
            SQL.append("where (A.PREVALENTE = 'SI') ");
            QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
            if (!QV.EOF()) QV.MoveNext();
            if (!QV.EOF())
            {
              v_CODICE = QV.Get("T10CODICE", IDVariant.INTEGER) ;
            }
            QV.Close();
            IMDB.set_Value(IMDBDef1.TBL_PARAMETRI25, IMDBDef1.FLD_PARAMETRI25_ROWNAMESEDE, 0, new IDVariant(Sede));
            IMDB.set_Value(IMDBDef1.TBL_PARAMETRI25, IMDBDef1.FLD_PARAMETRI25_ROWNAMEANNO, 0, new IDVariant(Anno));
            IMDB.set_Value(IMDBDef1.TBL_PARAMETRI25, IMDBDef1.FLD_PARAMETRI25_ROWNAMENUMER, 0, new IDVariant(Numero));
            IMDB.set_Value(IMDBDef1.TBL_PARAMETRI25, IMDBDef1.FLD_PARAMETRI25_ROWNAMUPININ, 0, (new IDVariant("Ins")));
            IMDB.set_Value(IMDBDef1.TBL_PARAMETRI25, IMDBDef1.FLD_PARAMETRI25_ROWNAMECLOSE, 0, (new IDVariant("SI")));
            IMDB.set_Value(IMDBDef1.TBL_PARAMETRI25, IMDBDef1.FLD_PARAMETRI25_ROWNAMEESECU, 0, new IDVariant(v_CODICE));
            MainFrm.Show(MyGlb.FRM_DELIBERA, (new IDVariant(-1)).intValue(), this); 
          }
        }
        else
        {
          Sede.set(new IDVariant(Sede));
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloDelibere", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Controllo Delibere Non Da Inserire
  // Explain which processing is carried out by this procedure
  // Sede:  - Input/Output
  // Anno:  - Input/Output
  // Numero:  - Input/Output
  // **********************************************************************
  public int ControlloDelibereNonDaInserire (IDVariant Sede, IDVariant Anno, IDVariant Numero)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Controllo Delibere Non Da Inserire Body
      // Procedure Body
      // 
      if (!(IDL.IsNull(Sede)) && !(IDL.IsNull(Numero)) && !(IDL.IsNull(Anno)))
      {
        IDVariant v_DESCRIZIONE = new IDVariant(0,IDVariant.STRING);
        v_DESCRIZIONE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.DESCRIZIONE as DELDESCRIZIO ");
        SQL.append("from ");
        SQL.append("  DEL A ");
        SQL.append("where (A.SEDE_DEL = " + IDL.CSql(Sede, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.ANNO_DEL = " + IDL.CSql(Anno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_DEL = " + IDL.CSql(Numero, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_DESCRIZIONE = QV.Get("DELDESCRIZIO", IDVariant.STRING) ;
        }
        QV.Close();
        if ((IDL.IsNull(v_DESCRIZIONE) || v_DESCRIZIONE.equals((new IDVariant("")), true)))
        {
          if (IDL.IsNull(v_DESCRIZIONE))
          {
            IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
            v_MESSAGGIO = (new IDVariant("Delibera non Presente", IDVariant.STRING));
            Sede.set((new IDVariant()));
            Numero.set((new IDVariant()));
            Anno.set((new IDVariant()));
            MainFrm.set_AlertMessage(v_MESSAGGIO); 
            return 0;
          }
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloDelibereNonDaInserire", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Controllo Delibere Utenze
  // Sede:  - Input/Output
  // Anno:  - Input/Output
  // Numero:  - Input/Output
  // **********************************************************************
  public int ControlloDelibereUtenze (IDVariant Sede, IDVariant Anno, IDVariant Numero)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Controllo Delibere Utenze Body
      // Procedure Body
      // 
      if (!(IDL.IsNull(Sede)) && !(IDL.IsNull(Numero)) && !(IDL.IsNull(Anno)))
      {
        IDVariant v_DESCRIZIONE = new IDVariant(0,IDVariant.STRING);
        v_DESCRIZIONE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.DESCRIZIONE as DELDESCRIZIO ");
        SQL.append("from ");
        SQL.append("  DEL A ");
        SQL.append("where (A.SEDE_DEL = " + IDL.CSql(Sede, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.ANNO_DEL = " + IDL.CSql(Anno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_DEL = " + IDL.CSql(Numero, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_DESCRIZIONE = QV.Get("DELDESCRIZIO", IDVariant.STRING) ;
        }
        QV.Close();
        if (GESTIODELIBE.booleanValue() && (IDL.IsNull(v_DESCRIZIONE) || v_DESCRIZIONE.equals((new IDVariant("")), true)))
        {
          if (IDL.IsNull(v_DESCRIZIONE))
          {
            IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
            v_MESSAGGIO = (new IDVariant("Delibera non Presente", IDVariant.STRING));
            Sede.set((new IDVariant()));
            Numero.set((new IDVariant()));
            Anno.set((new IDVariant()));
            MainFrm.set_AlertMessage(v_MESSAGGIO); 
            return 0;
          }
        }
        if (!(GESTIODELIBE.booleanValue()) && (IDL.IsNull(v_DESCRIZIONE) || v_DESCRIZIONE.equals((new IDVariant("")), true)))
        {
          IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
          v_MESSAGGIO = (new IDVariant("Delibera non Esistente. Si desidera Inserirne una nuova ?", IDVariant.STRING));
          IDVariant v_CONFERMA = new IDVariant(0,IDVariant.INTEGER);
          v_CONFERMA = (new IDVariant(0, IDVariant.INTEGER));
          v_CONFERMA = (new IDVariant(MainFrm.MessageConfirm(v_MESSAGGIO)));
          if (!(v_CONFERMA.booleanValue()))
          {
            return 0;
          }
          else
          {
            IDVariant v_CODICE = null;
            v_CODICE = (new IDVariant());
            SQL = new StringBuffer();
            SQL.append("select ");
            SQL.append("  A.CODICE as T10CODICE ");
            SQL.append("from ");
            SQL.append("  T10 A ");
            SQL.append("where (A.PREVALENTE = 'SI') ");
            QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
            if (!QV.EOF()) QV.MoveNext();
            if (!QV.EOF())
            {
              v_CODICE = QV.Get("T10CODICE", IDVariant.INTEGER) ;
            }
            QV.Close();
            IMDB.set_Value(IMDBDef1.TBL_PARAMETRI25, IMDBDef1.FLD_PARAMETRI25_ROWNAMESEDE, 0, new IDVariant(Sede));
            IMDB.set_Value(IMDBDef1.TBL_PARAMETRI25, IMDBDef1.FLD_PARAMETRI25_ROWNAMEANNO, 0, new IDVariant(Anno));
            IMDB.set_Value(IMDBDef1.TBL_PARAMETRI25, IMDBDef1.FLD_PARAMETRI25_ROWNAMENUMER, 0, new IDVariant(Numero));
            IMDB.set_Value(IMDBDef1.TBL_PARAMETRI25, IMDBDef1.FLD_PARAMETRI25_ROWNAMUPININ, 0, (new IDVariant("Ins")));
            IMDB.set_Value(IMDBDef1.TBL_PARAMETRI25, IMDBDef1.FLD_PARAMETRI25_ROWNAMECLOSE, 0, (new IDVariant("SI")));
            IMDB.set_Value(IMDBDef1.TBL_PARAMETRI25, IMDBDef1.FLD_PARAMETRI25_ROWNAMEESECU, 0, new IDVariant(v_CODICE));
            MainFrm.Show(MyGlb.FRM_DELIBERA, (new IDVariant(-1)).intValue(), this); 
          }
        }
        else
        {
          IDVariant v_DISABUT = null;
          v_DISABUT = (new IDVariant());
          SQL = new StringBuffer();
          SQL.append("select ");
          SQL.append("  A.DISAB_UTENZE as T11DISABUTEN ");
          SQL.append("from ");
          SQL.append("  T11 A ");
          SQL.append("where (A.CODICE = " + IDL.CSql(Sede, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
          QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
          if (!QV.EOF()) QV.MoveNext();
          if (!QV.EOF())
          {
            v_DISABUT = QV.Get("T11DISABUTEN", IDVariant.STRING) ;
          }
          QV.Close();
          if (v_DISABUT.equals((new IDVariant("SI")), true))
          {
            IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
            v_SMS = (new IDVariant("Sede delibera non abilitata per le Utenze!"));
            Sede.set((new IDVariant()));
            Numero.set((new IDVariant()));
            Anno.set((new IDVariant()));
            MainFrm.set_AlertMessage(v_SMS); 
            return 0;
          }
          Sede.set(new IDVariant(Sede));
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloDelibereUtenze", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Controllo Dettagli Bilancio
  // Esercizio:  - Input
  // ES:  - Input
  // Capitolo:  - Input
  // **********************************************************************
  public IDVariant ControlloDettagliBilancio (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Dettagli Bilancio Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      if (IDL.NullValue(Capitolo,(new IDVariant(0))).compareTo((new IDVariant(0)), true)!=0)
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  BIL A ");
        SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.ARTICOLO <> 0) ");
        SQL.append("and   (NVL(A.STN_INI_CO, 0) > 0) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
      }
      else
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  BIL A ");
        SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.CAPITOLO <> 0) ");
        SQL.append("and   (NVL(A.STN_INI_CO, 0) > 0) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
      }
      if (IDL.NullValue(v_NUMREC,(new IDVariant(0))).compareTo((new IDVariant(0)), true)>0)
      {
        return (new IDVariant(1));
      }
      else
      {
        return (new IDVariant(0));
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloDettagliBilancio", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Controllo Dettagli Bilancio Simulato
  // Esercizio:  - Input
  // ES:  - Input
  // Capitolo:  - Input
  // **********************************************************************
  public IDVariant ControlloDettagliBilancioSimulato (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Dettagli Bilancio Simulato Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      if (IDL.NullValue(Capitolo,(new IDVariant(0))).compareTo((new IDVariant(0)), true)!=0)
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  BPR A ");
        SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.ARTICOLO <> 0) ");
        SQL.append("and   (NVL(A.STN_INI_CO, 0) > 0) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
      }
      else
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  BPR A ");
        SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.CAPITOLO <> 0) ");
        SQL.append("and   (NVL(A.STN_INI_CO, 0) > 0) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
      }
      if (IDL.NullValue(v_NUMREC,(new IDVariant(0))).compareTo((new IDVariant(0)), true)>0)
      {
        return (new IDVariant(1));
      }
      else
      {
        return (new IDVariant(0));
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloDettagliBilancioSimulato", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Controllo Esistenza Banca
  // Abi:  - Input
  // Denominazione:  - Input/Output
  // **********************************************************************
  public IDVariant ControlloEsistenzaBanca (IDVariant Abi, IDVariant Denominazione)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Esistenza Banca Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  MIN(A.DENOMINAZIONE) as MINBANCHDENO, ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  AD4_BANCHE A ");
      SQL.append("where (LPAD(A.ABI, 5, SUBSTR('0', 1, 1)) = LPAD(" + IDL.CSql(Abi, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", 5, SUBSTR('0', 1, 1))) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        Denominazione.set(QV.Get("MINBANCHDENO", IDVariant.STRING));
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return IDL.NullValue(v_NUMREC,(new IDVariant(0)));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloEsistenzaBanca", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Controllo Esistenza Delibere
  // Sede:  - Input
  // Numero:  - Input
  // Anno:  - Input
  // Errmsg:  - Input
  // **********************************************************************
  public IDVariant ControlloEsistenzaDelibere (IDVariant Sede, IDVariant Numero, IDVariant Anno, IDVariant Errmsg)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Esistenza Delibere Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  DEL A ");
      SQL.append("where (A.SEDE_DEL = " + IDL.CSql(Sede, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_DEL = " + IDL.CSql(Anno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_DEL = " + IDL.CSql(Numero, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_NUMREC.equals((new IDVariant(0)), true))
      {
        IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
        v_MESSAGGIO = (new IDVariant("Delibera Inesistente", IDVariant.STRING));
        if (Errmsg.booleanValue())
        {
          MainFrm.set_AlertMessage(v_MESSAGGIO); 
        }
        return (new IDVariant(-1));
      }
      else
      {
        return (new IDVariant(1));
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloEsistenzaDelibere", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Controllo Esistenza Proposte
  // Unità:  - Input
  // Numero:  - Input
  // Anno:  - Input
  // Errmsg:  - Input
  // **********************************************************************
  public IDVariant ControlloEsistenzaProposte (IDVariant Unità, IDVariant Numero, IDVariant Anno, IDVariant Errmsg)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Esistenza Proposte Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      if (!(IDL.IsNull(Unità)) && !(IDL.IsNull(Numero)) && !(IDL.IsNull(Anno)))
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  PROPOSTE A ");
        SQL.append("where (A.UNITA_PROPONENTE = " + IDL.CSql(Unità, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.ANNO = " + IDL.CSql(Anno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO = " + IDL.CSql(Numero, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
      }
      if (v_NUMREC.equals((new IDVariant(0)), true))
      {
        IDVariant v_MESSAGE = new IDVariant(0,IDVariant.STRING);
        v_MESSAGE = (new IDVariant("Proposta Inesistente!", IDVariant.STRING));
        if (Errmsg.booleanValue())
        {
          MainFrm.set_AlertMessage(v_MESSAGE); 
        }
        return (new IDVariant(-1));
      }
      else
      {
        return (new IDVariant(1));
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloEsistenzaProposte", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Controllo Esistenza Sportello
  // Abi:  - Input
  // Cab:  - Input
  // Denominazione:  - Input/Output
  // **********************************************************************
  public IDVariant ControlloEsistenzaSportello (IDVariant Abi, IDVariant Cab, IDVariant Denominazione)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Esistenza Sportello Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  MIN(A.DESCRIZIONE) as MINSPORTDESC, ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  AD4_SPORTELLI A ");
      SQL.append("where (LPAD(A.ABI, 5, SUBSTR('0', 1, 1)) = LPAD(" + IDL.CSql(Abi, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", 5, SUBSTR('0', 1, 1))) ");
      SQL.append("and   (LPAD(A.CAB, 5, SUBSTR('0', 1, 1)) = LPAD(" + IDL.CSql(Cab, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", 5, SUBSTR('0', 1, 1))) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        Denominazione.set(QV.Get("MINSPORTDESC", IDVariant.STRING));
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return IDL.NullValue(v_NUMREC,(new IDVariant(0)));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloEsistenzaSportello", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Controllo Fase Esefin
  // Explain which processing is carried out by this procedure
  // Esercizio:  - Input
  // **********************************************************************
  public IDVariant ControlloFaseEsefin (IDVariant Esercizio)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_FASE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_RESVAR = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Fase Esefin Body
      // Procedure Body
      // 
      v_RESVAR = (new IDVariant());
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.FASE_BILANCIO as ESEFFASEBILA ");
      SQL.append("from ");
      SQL.append("  ESEFIN A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_FASE = QV.Get("ESEFFASEBILA", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_FASE.equals((new IDVariant(0)), true) || v_FASE.compareTo((new IDVariant(7)), true)>0)
      {
        v_RESVAR = (new IDVariant(-1));
      }
      else
      {
        v_RESVAR = (new IDVariant(0));
      }
      return v_RESVAR;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloFaseEsefin", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Controllo Fattore Economico
  // Fattore:  - Input
  // **********************************************************************
  public IDVariant ControlloFattoreEconomico (IDVariant Fattore)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_TIPO = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Controllo Fattore Economico Body
      // Procedure Body
      // 
      if (!(IDL.IsNull(Fattore)))
      {
        v_RETVAL = FattorePresente(Fattore, IDL.Today(), (new IDVariant("")));
        if (v_RETVAL.equals((new IDVariant(-1)), true))
        {
          MainFrm.set_AlertMessage((new IDVariant("Fattore non presente!"))); 
          return (new IDVariant(-1));
        }
        else
        {
          v_RETVAL = (new IDVariant(0));
          v_RETVAL = TipoFattore(Fattore, v_TIPO);
          if (v_RETVAL.compareTo((new IDVariant(-1)), true)<0)
          {
            MainFrm.set_AlertMessage((new IDVariant("Fattore non presente!"))); 
            return (new IDVariant(-1));
          }
          else
          {
            if (v_TIPO.equals((new IDVariant("E")), true))
            {
              IDVariant v_MESSSAGGIO = new IDVariant(0,IDVariant.STRING);
              v_MESSSAGGIO = (new IDVariant("Impossibile inserire un fattore economico!", IDVariant.STRING));
              MainFrm.set_AlertMessage(v_MESSSAGGIO); 
              return (new IDVariant(-1));
            }
            return (new IDVariant(1));
          }
        }
      }
      else
      {
        return (new IDVariant(1));
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloFattoreEconomico", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Controllo Fattore Scaduto
  // Fattore:  - Input
  // **********************************************************************
  public boolean ControlloFattoreScaduto (IDVariant Fattore)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Fattore Scaduto Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  FATTORI A ");
      SQL.append("where (A.FATTORE = " + IDL.CSql(Fattore, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((A.DATA_VALIDITA IS NULL) OR A.DATA_VALIDITA >= TRUNC( SYSDATE )) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0 || v_NUMREC.equals((new IDVariant(0)), true))
      {
        return (new IDVariant(-1)).booleanValue();
      }
      else
      {
        return (new IDVariant(0)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloFattoreScaduto", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controllo Impegno Valido
  // Esercizio:  - Input
  // Anno Imp:  - Input
  // Numero Imp:  - Input
  // **********************************************************************
  public boolean ControlloImpegnoValido (IDVariant Esercizio, IDVariant AnnoImp, IDVariant NumeroImp)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Impegno Valido Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  ESEIMP A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_IMP = " + IDL.CSql(AnnoImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_IMP = " + IDL.CSql(NumeroImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0 || v_NUMREC.equals((new IDVariant(0)), true))
      {
        return (new IDVariant(0)).booleanValue();
      }
      else
      {
        return (new IDVariant(-1)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloImpegnoValido", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controllo Proposte
  // Explain which processing is carried out by this procedure
  // Sede:  - Input/Output
  // Anno:  - Input/Output
  // Numero:  - Input/Output
  // **********************************************************************
  public int ControlloProposte (IDVariant Sede, IDVariant Anno, IDVariant Numero)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Controllo Proposte Body
      // Procedure Body
      // 
      if (!(IDL.IsNull(Sede)) && !(IDL.IsNull(Numero)) && !(IDL.IsNull(Anno)))
      {
        IDVariant v_DESCRIZIONE = new IDVariant(0,IDVariant.STRING);
        v_DESCRIZIONE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.OGGETTO as PROPOSOGGETT ");
        SQL.append("from ");
        SQL.append("  PROPOSTE A ");
        SQL.append("where (A.UNITA_PROPONENTE = " + IDL.CSql(Sede, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.ANNO = " + IDL.CSql(Anno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO = " + IDL.CSql(Numero, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_DESCRIZIONE = QV.Get("PROPOSOGGETT", IDVariant.STRING) ;
        }
        QV.Close();
        if (GESTIODELIBE.booleanValue() && (IDL.IsNull(v_DESCRIZIONE) || v_DESCRIZIONE.equals((new IDVariant("")), true)))
        {
          if (IDL.IsNull(v_DESCRIZIONE))
          {
            IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
            v_MESSAGGIO = (new IDVariant("Proposta non Presente", IDVariant.STRING));
            Sede.set((new IDVariant()));
            Numero.set((new IDVariant()));
            Anno.set((new IDVariant()));
            MainFrm.set_AlertMessage(v_MESSAGGIO); 
            return 0;
          }
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloProposte", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Controllo Scadenza Quietanza
  // Num Quietanza:  - Input
  // Beneficiario:  - Input
  // Data:  - Input
  // **********************************************************************
  public boolean ControlloScadenzaQuietanza (IDVariant NumQuietanza, IDVariant Beneficiario, IDVariant Data)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Scadenza Quietanza Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  QTN A ");
      SQL.append("where (A.NUM_QUIETANZA = " + IDL.CSql(NumQuietanza, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CODICE = " + IDL.CSql(Beneficiario, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((A.SCADENZA IS NULL) OR A.SCADENZA >= " + IDL.CSql(Data, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_NUMREC.equals((new IDVariant(1)), true))
      {
        return (new IDVariant(-1)).booleanValue();
      }
      else
      {
        return (new IDVariant(0)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloScadenzaQuietanza", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controllo Subimpegno Valido
  // Esercizio:  - Input
  // Anno Subimp:  - Input
  // Numero Subimp:  - Input
  // Anno Imp:  - Input/Output
  // Numero Imp:  - Input/Output
  // **********************************************************************
  public boolean ControlloSubimpegnoValido (IDVariant Esercizio, IDVariant AnnoSubimp, IDVariant NumeroSubimp, IDVariant AnnoImp, IDVariant NumeroImp)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Subimpegno Valido Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1, ");
      SQL.append("  MIN(A.ANNO_IMP) as MINESEANNIMP, ");
      SQL.append("  MIN(A.NUMERO_IMP) as MINESENUMIMP ");
      SQL.append("from ");
      SQL.append("  ESESUB A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_SUBIMP = " + IDL.CSql(AnnoSubimp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_SUBIMP = " + IDL.CSql(NumeroSubimp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
        AnnoImp.set(QV.Get("MINESEANNIMP", IDVariant.INTEGER));
        NumeroImp.set(QV.Get("MINESENUMIMP", IDVariant.INTEGER));
      }
      QV.Close();
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0 || v_NUMREC.equals((new IDVariant(0)), true))
      {
        return (new IDVariant(0)).booleanValue();
      }
      else
      {
        return (new IDVariant(-1)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloSubimpegnoValido", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controllo Univocità Documento
  // Anno Doc:  - Input
  // Numero Doc:  - Input
  // Beneficiario:  - Input
  // Entrata Spesa:  - Input
  // **********************************************************************
  public IDVariant ControlloUnivocitàDocumento (IDVariant AnnoDoc, IDVariant NumeroDoc, IDVariant Beneficiario, IDVariant EntrataSpesa)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_BUONI = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Controllo Univocità Documento Body
      // Procedure Body
      // 
      if (PROCEDUBUONI.equals((new IDVariant("SI")), true))
      {
        v_BUONI = (new IDVariant("B"));
      }
      else
      {
        v_BUONI = (new IDVariant("F"));
      }
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  FAT A ");
      SQL.append("where (A.ANNO_DOC = " + IDL.CSql(AnnoDoc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_DOC = " + IDL.CSql(NumeroDoc, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CODICE = " + IDL.CSql(Beneficiario, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((A.CODICE_DOC IN (1, 5, 7) AND " + IDL.CSql(EntrataSpesa, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " = 'S') OR (A.CODICE_DOC IN (2, 3, 6, 8) AND " + IDL.CSql(EntrataSpesa, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " = 'E')) ");
      SQL.append("and   (A.STORNO = 0) ");
      SQL.append("and   ((A.CODICE BETWEEN " + IDL.CSql(Beneficiario, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " AND DECODE(" + IDL.CSql(Beneficiario, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", 0, 999999, " + IDL.CSql(Beneficiario, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "))) ");
      SQL.append("and   ((NVL(A.IMPORTO, 0) + NVL(A.VARIAZIONI, 0) - NVL(A.IMPUTATO, 0)) > 0) ");
      SQL.append("and   ((((LPAD(TO_CHAR ( A.ANNO_PROG ), 4, SUBSTR('0', 1, 1)) || LPAD(TO_CHAR ( A.NUMERO_PROG ), 5, SUBSTR('0', 1, 1))) NOT IN ");
      SQL.append("( ");
      SQL.append("select ");
      SQL.append("  LPAD(TO_CHAR ( B.ANNO_PROG ), 4, SUBSTR('0', 1, 1)) || LPAD(TO_CHAR ( B.NUMERO_PROG ), 5, SUBSTR('0', 1, 1)) ");
      SQL.append("from ");
      SQL.append("  FATTURE_BUONI B ");
      SQL.append(")) AND " + IDL.CSql(v_BUONI, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " = 'B') OR (" + IDL.CSql(v_BUONI, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " = 'F')) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return v_NUMREC;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloUnivocitàDocumento", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Controllo Vincolo Scaduto
  // Vincolo:  - Input
  // **********************************************************************
  public boolean ControlloVincoloScaduto (IDVariant Vincolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Vincolo Scaduto Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  VINCOLI A ");
      SQL.append("where (A.CODICE = " + IDL.CSql(Vincolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((A.SCADENZA IS NULL) OR A.SCADENZA > TRUNC( SYSDATE )) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0 || v_NUMREC.equals((new IDVariant(0)), true))
      {
        return (new IDVariant(-1)).booleanValue();
      }
      else
      {
        return (new IDVariant(0)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloVincoloScaduto", _e);
      return false;
    }
  }

  // **********************************************************************
  // Controllo Voce Peg Valida
  // Esercizio:  - Input
  // ES - Input
  // ProgUO:  - Input
  // Capitolo - Input
  // Articolo:  - Input
  // **********************************************************************
  public IDVariant ControlloVocePegValida (IDVariant Esercizio, IDVariant ES, IDVariant ProgUO, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMRECIMP = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Controllo Voce Peg Valida Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  VISTA_BILANCIO_UO A ");
      SQL.append("where (NVL(A.SCADENZA, TO_DATE((31)||'/'||(12)||'/'||(2999),'dd/mm/yyyy')) >= TRUNC( SYSDATE )) ");
      SQL.append("and   (NVL(A.PROGR_UNITA_ORGANIZZATIVA, -1) = NVL(" + IDL.CSql(ProgUO, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", NVL(A.PROGR_UNITA_ORGANIZZATIVA, -1))) ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.TIPO = 'B') ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMRECIMP = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return v_NUMRECIMP;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloVocePegValida", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Datetostring
  // Converte una data in una stringa
  // Data:  - Input
  // **********************************************************************
  public IDVariant Datetostring (IDVariant Data)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_DATAFINALE = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Datetostring Body
      // Procedure Body
      // 
      v_DATAFINALE = (new IDVariant());
      if (!(IDL.IsNull(Data)))
      {
        v_DATAFINALE = IDL.Add(IDL.FillLR(IDL.ToString(IDL.Day(Data)), (new IDVariant(2)), IDL.ToString((new IDVariant(0))), true), IDL.Add((new IDVariant("/")), IDL.Add(IDL.FillLR(IDL.ToString(IDL.Month(Data)), (new IDVariant(2)), IDL.ToString((new IDVariant(0))), true), IDL.Add((new IDVariant("/")), IDL.ToString(IDL.Year(Data))))));
      }
      return v_DATAFINALE;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Datetostring", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Dati Emissione
  // Anno:  - Input
  // Tipo:  - Input/Output
  // Ordine:  - Input/Output
  // **********************************************************************
  public IDVariant DatiEmissione (IDVariant Anno, IDVariant Tipo, IDVariant Ordine)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Dati Emissione Body
      // Procedure Body
      // 
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.TIPO_EMISSIONE_MANDATI as T99TIPEMIMAN, ");
      SQL.append("  A.ORDINE_EMISSIONE_MANDATI as T99ORDEMIMAN ");
      SQL.append("from ");
      SQL.append("  T99 A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Anno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        Tipo.set(QV.Get("T99TIPEMIMAN", IDVariant.INTEGER));
        Ordine.set(QV.Get("T99ORDEMIMAN", IDVariant.INTEGER));
      }
      QV.Close();
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        return (new IDVariant(-1));
      }
      else
      {
        return (new IDVariant(1));
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "DatiEmissione", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Descrizione Fase Bilancio
  // Codice:  - Input
  // **********************************************************************
  public IDVariant DescrizioneFaseBilancio (IDVariant Codice)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Descrizione Fase Bilancio Body
      // Procedure Body
      // 
      IDVariant v_DESCFASE = new IDVariant(0,IDVariant.STRING);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.DESCRIZIONE as T63DESCRIZIO ");
      SQL.append("from ");
      SQL.append("  T63 A ");
      SQL.append("where (A.CODICE = " + IDL.CSql(Codice, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_DESCFASE = QV.Get("T63DESCRIZIO", IDVariant.STRING) ;
      }
      QV.Close();
      return v_DESCFASE;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "DescrizioneFaseBilancio", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Disabilita Comandi Da Codice
  // **********************************************************************
  public int DisabilitaComandiDaCodice ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Disabilita Comandi Da Codice Body
      // Corpo Procedura
      // 
      if (GESTIODELIBE.booleanValue())
      {
        MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_ESECUTPROPOS+BaseCmdLinIdx, (new IDVariant(0)).booleanValue());
        MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_ESECUTVARIAZ+BaseCmdLinIdx, (new IDVariant(0)).booleanValue());
      }
      else
      {
        MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_ESECPRODAGS4+BaseCmdLinIdx, (new IDVariant(0)).booleanValue());
        MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_ESECVARDAGS4+BaseCmdLinIdx, (new IDVariant(0)).booleanValue());
        MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_STAMPAPROPOS+BaseCmdLinIdx, (new IDVariant(0)).booleanValue());
      }
      if (GESTIOIMPEGN.compareTo((new IDVariant("SI")), true)!=0)
      {
        MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_VARIAZIMPEG1+BaseCmdLinIdx, (new IDVariant(0)).booleanValue());
      }
      if (SIOPEATTIARM.booleanValue())
      {
        MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_CONTCODIGEST+BaseCmdLinIdx, (new IDVariant(0)).booleanValue());
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "DisabilitaComandiDaCodice", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Disp Eff Imp Da GE4
  // **********************************************************************
  public boolean DispEffImpDaGE4 ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Disp Eff Imp Da GE4 Body
      // Corpo Procedura
      // 
      if (TIPOORDINATI.equals((new IDVariant(3)), true) || PROCEDUBUONI.equals((new IDVariant("SI")), true) || ATTILIQ.equals((new IDVariant("SI")), true))
      {
        return (new IDVariant(-1)).booleanValue();
      }
      else
      {
        return (new IDVariant(0)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "DispEffImpDaGE4", _e);
      return false;
    }
  }

  // **********************************************************************
  // Ese Fin
  // Esercizio:  - Input
  // Fase:  - Input/Output
  // Errmsg:  - Input
  // **********************************************************************
  public IDVariant EseFin (IDVariant Esercizio, IDVariant Fase, IDVariant Errmsg)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Ese Fin Body
      // Procedure Body
      // 
      Fase.set((new IDVariant()));
      if (IDL.IsNull(Esercizio))
      {
        return (new IDVariant(0));
      }
      else
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.FASE_BILANCIO as ESEFFASEBILA ");
        SQL.append("from ");
        SQL.append("  ESEFIN A ");
        SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          Fase.set(QV.Get("ESEFFASEBILA", IDVariant.INTEGER));
        }
        QV.Close();
        if (IDL.IsNull(Fase))
        {
          if (Errmsg.booleanValue())
          {
            IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
            v_MESSAGGIO = (new IDVariant("Esercizio Finanziario o Fase di Bilancio non validi!", IDVariant.STRING));
            MainFrm.set_AlertMessage(v_MESSAGGIO); 
          }
          return (new IDVariant(-1));
        }
        else
        {
          return (new IDVariant(1));
        }
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "EseFin", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Esiste Record Bilancio
  // Esercizio:  - Input
  // ES:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // **********************************************************************
  public boolean EsisteRecordBilancio (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Esiste Record Bilancio Body
      // Procedure Body
      // 
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  BIL A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0 || v_NUMREC.equals((new IDVariant(0)), true))
      {
        v_RETVAL = (new IDVariant(0));
      }
      else
      {
        v_RETVAL = (new IDVariant(-1));
      }
      return v_RETVAL.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "EsisteRecordBilancio", _e);
      return false;
    }
  }

  // **********************************************************************
  // Esistenza Capitolo
  // Esercizio:  - Input
  // ES - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // Messaggio Errore - Optional - Input
  // **********************************************************************
  public boolean EsistenzaCapitolo (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo, IDVariant Articolo, IDVariant MessaggioErrore)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Esistenza Capitolo Body
      // Corpo Procedura
      // 
      IDVariant v_VCOUNT = new IDVariant(0,IDVariant.INTEGER);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  VISTA_RICLASSIFICAZIONI_CAP A ");
      SQL.append("where ((" + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " BETWEEN A.ESERCIZIO_INIZIO AND NVL(A.ESERCIZIO_SCADENZA, 9999))) ");
      SQL.append("and   (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CODICE_TIPO_RICL = 'MACRO') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_VCOUNT.equals((new IDVariant(0)), true))
      {
        if (MessaggioErrore.equals((new IDVariant("SI")), true))
        {
          IDVariant S = new IDVariant(0,IDVariant.STRING);
          S = (new IDVariant("Capitolo inesistente"));
          MainFrm.set_AlertMessage(S); 
        }
        return (new IDVariant(0)).booleanValue();
      }
      else
      {
        return (new IDVariant(-1)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "EsistenzaCapitolo", _e);
      return false;
    }
  }

  // **********************************************************************
  // Esistono Trigger Disabilitati
  // **********************************************************************
  public boolean EsistonoTriggerDisabilitati ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Esistono Trigger Disabilitati Body
      // Corpo Procedura
      // 
      IDVariant v_VCOUNT = new IDVariant(0,IDVariant.INTEGER);
      IDVariant B = new IDVariant(0,IDVariant.INTEGER);
      try
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  USER_TRIGGERS A ");
        SQL.append("where (A.STATUS = 'DISABLED') ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
        if (v_VCOUNT.compareTo((new IDVariant(0)), true)>0)
        {
          B = (new IDVariant(-1));
        }
        else
        {
          B = (new IDVariant(0));
        }
      }
      catch (Exception e5)
      {
        B = (new IDVariant(0));
      }
      return B.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "EsistonoTriggerDisabilitati", _e);
      return false;
    }
  }

  // **********************************************************************
  // Fattore Presente
  //  
  // Fattore:  - Input
  // Scadenza:  - Input
  // Patrimoniale - Optional - Input
  // **********************************************************************
  public IDVariant FattorePresente (IDVariant Fattore, IDVariant Scadenza, IDVariant Patrimoniale)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Fattore Presente Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  FATTORI A ");
      SQL.append("where (A.FATTORE = " + IDL.CSql(Fattore, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((A.DATA_VALIDITA IS NULL) OR A.DATA_VALIDITA >= " + IDL.CSql(Scadenza, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (NVL(" + IDL.CSql(Patrimoniale, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", 'NO') = 'NO' OR (NVL(" + IDL.CSql(Patrimoniale, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", 'NO') = 'SI' AND A.TIPO IN ('A', 'P'))) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return IDL.NullValue(v_NUMREC,(new IDVariant(0)));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "FattorePresente", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Fattura Senza Registri IVA
  // Anno Progr:  - Input
  // Numero Progr:  - Input
  // **********************************************************************
  public boolean FatturaSenzaRegistriIVA (IDVariant AnnoProgr, IDVariant NumeroProgr)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Fattura Senza Registri IVA Body
      // Corpo Procedura
      // 
      IDVariant v_VCOUNT = new IDVariant(0,IDVariant.INTEGER);
      IDVariant v_RITORNO = new IDVariant(0,IDVariant.INTEGER);
      IDVariant v_VGETATTIVDOC = new IDVariant(0,IDVariant.STRING);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1, ");
      SQL.append("  MAX(GET_ATTIVITA_DOC(A.ANNO_PROG,A.NUMERO_PROG)) as MAGEADIAPINP ");
      SQL.append("from ");
      SQL.append("  IVA A ");
      SQL.append("where (A.ANNO_PROG = " + IDL.CSql(AnnoProgr, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_PROG = " + IDL.CSql(NumeroProgr, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
        v_VGETATTIVDOC = QV.Get("MAGEADIAPINP", IDVariant.STRING) ;
      }
      QV.Close();
      if (v_VCOUNT.compareTo((new IDVariant(0)), true)>0 && v_VGETATTIVDOC.compareTo((new IDVariant("I")), true)!=0)
      {
        v_VCOUNT = (new IDVariant(0));
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  IVA A ");
        SQL.append("where (A.ANNO_PROG = " + IDL.CSql(AnnoProgr, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_PROG = " + IDL.CSql(NumeroProgr, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   ((A.CODICE_ESENZIONE IS NULL)) ");
        SQL.append("and   (NOT ((A.ALIQUOTA IS NULL))) ");
        SQL.append("and   ((A.TIPO_REGISTRO_S IS NULL)) ");
        SQL.append("and   ((A.TIPO_BOLLATO_S IS NULL)) ");
        SQL.append("and   ((A.SERVIZIO IS NULL)) ");
        SQL.append("and   ((A.TIPO_REGISTRO IS NULL)) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
        if (v_VCOUNT.compareTo((new IDVariant(0)), true)>0)
        {
          v_RITORNO = (new IDVariant(-1));
        }
        else
        {
          v_RITORNO = (new IDVariant(0));
        }
      }
      else
      {
        v_RITORNO = (new IDVariant(-1));
      }
      return v_RITORNO.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "FatturaSenzaRegistriIVA", _e);
      return false;
    }
  }

  // **********************************************************************
  // Fatturasprcconivamista
  // ANNO PROG - Input
  // NUMERO PROG - Input
  // **********************************************************************
  public boolean Fatturasprcconivamista (IDVariant ANNOPROG, IDVariant NUMEROPROG)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Fatturasprcconivamista Body
      // Corpo Procedura
      // 
      IDVariant v_VCOUNT = new IDVariant(0,IDVariant.INTEGER);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  FAT A, ");
      SQL.append("  IVA B, ");
      SQL.append("  T04 C, ");
      SQL.append("  T09 D ");
      SQL.append("where (A.ANNO_PROG = " + IDL.CSql(ANNOPROG, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_PROG = " + IDL.CSql(NUMEROPROG, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.TRATTAMENTO_IVA = 'SP' OR A.TRATTAMENTO_IVA = 'RC') ");
      SQL.append("and   (B.ANNO_PROG = A.ANNO_PROG) ");
      SQL.append("and   (B.NUMERO_PROG = A.NUMERO_PROG) ");
      SQL.append("and   (C.TIPO_REGISTRO = B.TIPO_REGISTRO) ");
      SQL.append("and   (C.TIPO_BOLLATO = B.SERVIZIO) ");
      SQL.append("and   (D.CODICE = C.ATTIVITA) ");
      SQL.append("and   (D.ISTITUZIONALE = 'SI') ");
      SQL.append("and   (EXISTS(");
      SQL.append("( ");
      SQL.append("select ");
      SQL.append("  1 ");
      SQL.append("from ");
      SQL.append("  IVA E, ");
      SQL.append("  T04 t04BIS, ");
      SQL.append("  T09 t09bis ");
      SQL.append("where (E.ANNO_PROG = B.ANNO_PROG) ");
      SQL.append("and   (E.NUMERO_PROG = B.NUMERO_PROG) ");
      SQL.append("and   (E.PROGRESSIVO <> B.PROGRESSIVO) ");
      SQL.append("and   (t04BIS.TIPO_REGISTRO = E.TIPO_REGISTRO) ");
      SQL.append("and   (t04BIS.TIPO_BOLLATO = E.SERVIZIO) ");
      SQL.append("and   (t09bis.CODICE = t04BIS.ATTIVITA) ");
      SQL.append("and   ((t09bis.ISTITUZIONALE IS NULL)) ");
      SQL.append("))) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_VCOUNT.compareTo((new IDVariant(0)), true)>0)
      {
        return (new IDVariant(-1)).booleanValue();
      }
      else
      {
        return (new IDVariant(0)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Fatturasprcconivamista", _e);
      return false;
    }
  }

  // **********************************************************************
  // Fina Lk
  // Finanziamento:  - Input
  // **********************************************************************
  public IDVariant FinaLk (IDVariant Finanziamento)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_FINA = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Fina Lk Body
      // Procedure Body
      // 
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.DESCRIZIONE as FINANZDESCRI ");
      SQL.append("from ");
      SQL.append("  FINANZIAMENTI A ");
      SQL.append("where (A.CODICE = " + IDL.CSql(Finanziamento, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_FINA = QV.Get("FINANZDESCRI", IDVariant.STRING) ;
      }
      QV.Close();
      return (new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "FinaLk", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Finanziamento Fin
  // E S:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // **********************************************************************
  public IDVariant FinanziamentoFin (IDVariant ES, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_IMPORTOFIN = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_VARCOM = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_IMPBIL = new IDVariant(0,IDVariant.DECIMAL);

    try
    {
      TransCount = 0;
      // 
      // Finanziamento Fin Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  SUM(A.STN_INI_CO) as SUBIFISTINCO ");
      SQL.append("from ");
      SQL.append("  BIL_FIN A ");
      SQL.append("where (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_IMPORTOFIN = QV.Get("SUBIFISTINCO", IDVariant.DECIMAL) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  SUM(A.IMPORTO) as SUMVARCOIMPO ");
      SQL.append("from ");
      SQL.append("  VARCOM A ");
      SQL.append("where (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (NOT ((A.FINANZIAMENTO IS NULL))) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VARCOM = QV.Get("SUMVARCOIMPO", IDVariant.DECIMAL) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  SUM(A.STN_INI_CO + A.VARIAZIONI_CO) as SUBISTINCBVC ");
      SQL.append("from ");
      SQL.append("  BIL A ");
      SQL.append("where (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_IMPBIL = QV.Get("SUBISTINCBVC", IDVariant.DECIMAL) ;
      }
      QV.Close();
      if ((IDL.Add(IDL.NullValue(v_IMPORTOFIN,(new IDVariant(0))), IDL.NullValue(v_VARCOM,(new IDVariant(0))))).equals(IDL.NullValue(v_IMPBIL,(new IDVariant(0))), true))
      {
        return (new IDVariant(0));
      }
      else
      {
        if ((IDL.Add(IDL.NullValue(v_IMPORTOFIN,(new IDVariant(0))), IDL.NullValue(v_VARCOM,(new IDVariant(0))))).compareTo(IDL.NullValue(v_IMPBIL,(new IDVariant(0))), true)<0)
        {
          return (new IDVariant(1));
        }
        else
        {
          return (new IDVariant(0));
        }
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "FinanziamentoFin", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Finemese
  // Mese:  - Input
  // Anno:  - Input
  // **********************************************************************
  public IDVariant Finemese (IDVariant Mese, IDVariant Anno)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Finemese Body
      // Procedure Body
      // 
      if (Mese.equals((new IDVariant(1)), true))
      {
        return (new IDVariant(31));
      }
      if (Mese.equals((new IDVariant(2)), true))
      {
        if ((IDL.Mod(Anno, (new IDVariant(4)))).equals((new IDVariant(0)), true) && ((IDL.Mod(Anno, (new IDVariant(100)))).compareTo((new IDVariant(0)), true)!=0 || (IDL.Mod(Anno, (new IDVariant(400)))).equals((new IDVariant(0)), true)))
        {
          return (new IDVariant(29));
        }
        else
        {
          return (new IDVariant(28));
        }
      }
      if (Mese.equals((new IDVariant(3)), true))
      {
        return (new IDVariant(31));
      }
      if (Mese.equals((new IDVariant(4)), true))
      {
        return (new IDVariant(30));
      }
      if (Mese.equals((new IDVariant(5)), true))
      {
        return (new IDVariant(31));
      }
      if (Mese.equals((new IDVariant(6)), true))
      {
        return (new IDVariant(30));
      }
      if (Mese.equals((new IDVariant(7)), true))
      {
        return (new IDVariant(31));
      }
      if (Mese.equals((new IDVariant(8)), true))
      {
        return (new IDVariant(31));
      }
      if (Mese.equals((new IDVariant(9)), true))
      {
        return (new IDVariant(30));
      }
      if (Mese.equals((new IDVariant(10)), true))
      {
        return (new IDVariant(31));
      }
      if (Mese.equals((new IDVariant(11)), true))
      {
        return (new IDVariant(30));
      }
      if (Mese.equals((new IDVariant(12)), true))
      {
        return (new IDVariant(31));
      }
      return (new IDVariant(31));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Finemese", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Fix Charset
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // input - Input
  // **********************************************************************
  public IDVariant FixCharset (IDVariant input)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Fix Charset Body
      // Corpo Procedura
      // 
      IDVariant v_RES = null;
      v_RES = new IDVariant(input);
      FIXCHARSET_CHARTOBEFIX1();
      while (!IMDB.Eof(IMDBDef7.QRY_CHARTOBEFIX1, 0))
      {
        v_RES = IDL.Replace(v_RES, IDL.CHR(IMDB.Value(IMDBDef7.QRY_CHARTOBEFIX1, IMDBDef7.QSL_CHARTOBEFIX1_BADCHATOBEFI, 0)), IMDB.Value(IMDBDef7.QRY_CHARTOBEFIX1, IMDBDef7.QSL_CHARTOBEFIX1_GOOCHATOBEFI, 0));
        IMDB.TblMoveNext(IMDBDef7.QRY_CHARTOBEFIX1, 0);
      }
      return v_RES;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "FixCharset", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Chars To Be Fixed
  // Quali dati devi selezionare con questa query?
  // **********************************************************************
  private void FIXCHARSET_CHARTOBEFIX1() throws SQLException
  {
    IDVariant[] AggrBuff;
    int[] AggrRowCount;
    int AggrCount=0;
    boolean AggrNewGroup = false;

    IMDB.TblTruncate(IMDBDef7.QRY_CHARTOBEFIX1);
    IMDB.TblMoveFirst(IMDBDef7.TBL_CHARTOBEFIXE, 0);
    Loop1: while (!IMDB.Eof(IMDBDef7.TBL_CHARTOBEFIXE, 0))
    {
      IMDB.TblAddNew(IMDBDef7.QRY_CHARTOBEFIX1, 0);
      IMDB.TblLinkRow(IMDBDef7.QRY_CHARTOBEFIX1, 0, IMDBDef7.TBL_CHARTOBEFIXE, 0);
      IMDB.TblLinkField(IMDBDef7.QRY_CHARTOBEFIX1, 0, 0, IMDBDef7.TBL_CHARTOBEFIXE, IMDBDef7.FLD_CHARTOBEFIXE_BADCHATOBEFI, 0);
      IMDB.TblLinkField(IMDBDef7.QRY_CHARTOBEFIX1, 1, 0, IMDBDef7.TBL_CHARTOBEFIXE, IMDBDef7.FLD_CHARTOBEFIXE_GOOCHATOBEFI, 0);
      IMDB.TblMoveNext(IMDBDef7.TBL_CHARTOBEFIXE, 0);
      if (IMDB.Eof(IMDBDef7.TBL_CHARTOBEFIXE, 0))
      {
        IMDB.TblMoveFirst(IMDBDef7.TBL_CHARTOBEFIXE, 0);
      }
      else
      {
        continue Loop1;
      }
      break;
    }
    IMDB.TblMoveFirst(IMDBDef7.QRY_CHARTOBEFIX1, 0);
  }

  // **********************************************************************
  // Fpvattiva
  // **********************************************************************
  public boolean Fpvattiva ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Fpvattiva Body
      // Corpo Procedura
      // 
      IDVariant v_VCOUNT1 = new IDVariant(0,IDVariant.INTEGER);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = 'PRODUCTS/AMV') ");
      SQL.append("and   (UPPER(A.STRINGA) = UPPER('gestione FPV')) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCOUNT1 = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_VCOUNT1.compareTo((new IDVariant(0)), true)>0)
      {
        return (new IDVariant(-1)).booleanValue();
      }
      else
      {
        return (new IDVariant(0)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Fpvattiva", _e);
      return false;
    }
  }

  // **********************************************************************
  // Function Rpp Attiva
  // **********************************************************************
  public IDVariant FunctionRppAttiva ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_ESERCIZIO = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Function Rpp Attiva Body
      // Procedure Body
      // 
      v_ESERCIZIO = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  NVL(MIN(A.ESERCIZIO_RIF), 0) as NUVAMISTPER0 ");
      SQL.append("from ");
      SQL.append("  STANZIAMENTI_PROGETTO A ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_ESERCIZIO = QV.Get("NUVAMISTPER0", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_ESERCIZIO.compareTo((new IDVariant(0)), true)>0 && v_ESERCIZIO.compareTo(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), true)<=0)
      {
        return (new IDVariant(1));
      }
      else
      {
        if (v_ESERCIZIO.equals((new IDVariant(0)), true) || v_ESERCIZIO.compareTo(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), true)>0)
        {
          return (new IDVariant(0));
        }
        else
        {
          return (new IDVariant(-1));
        }
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "FunctionRppAttiva", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Funzione Licenza
  // Controlla la licenza per l'istanza che gli viene passata
  // Istanza:  - Input
  // Licenza:  - Input
  // **********************************************************************
  public boolean FunzioneLicenza (IDVariant Istanza, IDVariant Licenza)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_LICENZA = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Funzione Licenza Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.INSTALLAZIONE as INSTALLAZION ");
      SQL.append("from ");
      SQL.append("  AD4_ISTANZE A ");
      SQL.append("where (A.ISTANZA = " + IDL.CSql(Istanza, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_LICENZA = QV.Get("INSTALLAZION", IDVariant.STRING) ;
      }
      QV.Close();
      if (IDL.Find(v_LICENZA, Licenza).compareTo((new IDVariant(0)), true)>0)
      {
        return (new IDVariant(-1)).booleanValue();
      }
      else
      {
        return (new IDVariant(0)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "FunzioneLicenza", _e);
      return false;
    }
  }

  // **********************************************************************
  // Gestione Importo Max Bollo
  // Tipo:  - Input
  // **********************************************************************
  public IDVariant GestioneImportoMaxBollo (IDVariant Tipo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Gestione Importo Max Bollo Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  T60 A ");
      SQL.append("where (A.TIPO = " + IDL.CSql(Tipo, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (NOT ((A.IMPORTO_MASSIMO IS NULL))) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return v_NUMREC;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GestioneImportoMaxBollo", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Gestione Siope
  // **********************************************************************
  public boolean GestioneSiope ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Gestione Siope Body
      // Procedure Body
      // 
      if (IDL.NullValue(DATAINIZSIOP,(new IDVariant("2999/12/31# 00:00:00", IDVariant.DATETIME))).compareTo(IDL.Today(), true)<=0)
      {
        return (new IDVariant(-1)).booleanValue();
      }
      else
      {
        return (new IDVariant(0)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GestioneSiope", _e);
      return false;
    }
  }

  // **********************************************************************
  // Get Anno Per Bil Fin
  // Capitolo:  - Input
  // Articolo:  - Input
  // E S:  - Input
  // Impegno Residuo:  - Input
  // **********************************************************************
  public IDVariant GetAnnoPerBilFin (IDVariant Capitolo, IDVariant Articolo, IDVariant ES, IDVariant ImpegnoResiduo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Get Anno Per Bil Fin Body
      // Corpo Procedura
      // 
      IDVariant v_RETURN = new IDVariant(0,IDVariant.INTEGER);
      if (ImpegnoResiduo.equals((new IDVariant("I")), true) || ImpegnoResiduo.equals((new IDVariant("Accertamento")), true))
      {
        v_RETURN = IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0);
      }
      else
      {
        IDVariant v_PRIMOESERFIN = new IDVariant(0,IDVariant.INTEGER);
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  GET_PRIMO_ESERCIZIO_FIN as GETPRIESEFIN ");
        SQL.append("from ");
        SQL.append("  DUAL A ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_PRIMOESERFIN = QV.Get("GETPRIESEFIN", IDVariant.INTEGER) ;
        }
        QV.Close();
        if (IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0).compareTo(v_PRIMOESERFIN, true)>=0)
        {
          v_RETURN = IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0);
        }
        else
        {
          IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);
          SQL = new StringBuffer();
          SQL.append("select ");
          SQL.append("  COUNT(*) as COUNT1 ");
          SQL.append("from ");
          SQL.append("  BIL_FIN A ");
          SQL.append("where (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append("and   (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
          if (!QV.EOF()) QV.MoveNext();
          if (!QV.EOF())
          {
            v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
          }
          QV.Close();
          if (v_CONTATORE.compareTo((new IDVariant(0)), true)>0)
          {
            v_RETURN = IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0);
          }
          else
          {
            v_RETURN = new IDVariant(v_PRIMOESERFIN);
          }
        }
      }
      return v_RETURN;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GetAnnoPerBilFin", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Get Bollato Definitivo
  // Tipo Registro - Input
  // Tipo Bollato:  - Input
  // **********************************************************************
  public IDVariant GetBollatoDefinitivo (IDVariant TipoRegistro, IDVariant TipoBollato)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Get Bollato Definitivo Body
      // Corpo Procedura
      // 
      IDVariant v_VT04TIPBOLDE = null;
      v_VT04TIPBOLDE = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.TIPO_BOLLATO_DEF as T04TIPBOLDEF ");
      SQL.append("from ");
      SQL.append("  T04 A ");
      SQL.append("where (A.TIPO_REGISTRO = " + IDL.CSql(TipoRegistro, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.TIPO_BOLLATO = " + IDL.CSql(TipoBollato, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VT04TIPBOLDE = QV.Get("T04TIPBOLDEF", IDVariant.INTEGER) ;
      }
      QV.Close();
      return v_VT04TIPBOLDE;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GetBollatoDefinitivo", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Get Cod Liv 5 Da Cap O Unico
  // Esercizio:  - Input
  // E S:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // **********************************************************************
  public IDVariant GetCodLiv5DaCapOUnico (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Get Cod Liv 5 Da Cap O Unico Body
      // Corpo Procedura
      // 
      IDVariant v_VCOUNT = new IDVariant(0,IDVariant.INTEGER);
      IDVariant v_CODLIVELLO5 = null;
      v_CODLIVELLO5 = (new IDVariant());
      // 
      // porpongo il riclassificato cofog e di livello 5
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.CODICE as VISRICCAPCOD ");
      SQL.append("from ");
      SQL.append("  VISTA_RICLASSIFICAZIONI_CAP A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CODICE_TIPO_RICL = 'MACRO_5') ");
      SQL.append("and   ((" + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " BETWEEN NVL(A.ESERCIZIO_INIZIO, 0) AND NVL(A.ESERCIZIO_SCADENZA, 9999))) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CODLIVELLO5 = QV.Get("VISRICCAPCOD", IDVariant.DECIMAL) ;
      }
      QV.Close();
      if (IDL.IsNull(v_CODLIVELLO5))
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1, ");
        SQL.append("  MIN(A.CODICE) as MINVISSTRICO ");
        SQL.append("from ");
        SQL.append("  VISTA_STRUTTURA_RICL A, ");
        SQL.append("  VISTA_RICLASSIFICAZIONI_CAP B ");
        SQL.append("where (B.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (B.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (B.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (B.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (B.CODICE_TIPO_RICL = 'MACRO') ");
        SQL.append("and   ((" + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " BETWEEN NVL(B.ESERCIZIO_INIZIO, 0) AND NVL(B.ESERCIZIO_SCADENZA, 9999))) ");
        SQL.append("and   (A.CODICE_PADRE = B.CODICE) ");
        SQL.append("and   (A.CODICE_TIPO_RICL = 'MACRO_5') ");
        SQL.append("and   (A.E_S = 'S') ");
        SQL.append("and   (A.LIVELLO = 2) ");
        SQL.append("and   ((" + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " BETWEEN NVL(A.ESERCIZIO_INIZIO, 0) AND NVL(A.ESERCIZIO_SCADENZA, 9999))) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
          v_CODLIVELLO5 = QV.Get("MINVISSTRICO", IDVariant.DECIMAL) ;
        }
        QV.Close();
        if (v_VCOUNT.compareTo((new IDVariant(1)), true)!=0)
        {
          v_CODLIVELLO5 = (new IDVariant());
        }
      }
      return v_CODLIVELLO5;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GetCodLiv5DaCapOUnico", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Get Codice Gestionale Da Cap
  // Capitolo:  - Input
  // Articolo:  - Input
  // **********************************************************************
  public IDVariant GetCodiceGestionaleDaCap (IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CGU = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Get Codice Gestionale Da Cap Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.CODICE_GESTIONALE as CAPCODICGEST ");
      SQL.append("from ");
      SQL.append("  CAP A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = 'S') ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CGU = QV.Get("CAPCODICGEST", IDVariant.INTEGER) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  CODICI_GESTIONALI A ");
      SQL.append("where (A.E_S = 'S') ");
      SQL.append("and   (A.CODICE = " + IDL.CSql(v_CGU, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((A.SCADENZA IS NULL) OR A.SCADENZA >= " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.compareTo((new IDVariant(0)), true)!=0)
      {
        v_RETVAL = new IDVariant(v_CGU);
      }
      else
      {
        v_RETVAL = (new IDVariant());
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GetCodiceGestionaleDaCap", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Get Liv 4 Impegno
  // Anno Imp:  - Input
  // Numero Imp:  - Input
  // **********************************************************************
  public IDVariant GetLiv4Impegno (IDVariant AnnoImp, IDVariant NumeroImp)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Get Liv 4 Impegno Body
      // Corpo Procedura
      // 
      IDVariant v_CODICE = null;
      v_CODICE = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  B.CODICE as VISRICCAPCOD ");
      SQL.append("from ");
      SQL.append("  IMP A, ");
      SQL.append("  VISTA_RICLASSIFICAZIONI_CAP B ");
      SQL.append("where ((" + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " BETWEEN NVL(B.ESERCIZIO_INIZIO, 0) AND NVL(B.ESERCIZIO_SCADENZA, 9999))) ");
      SQL.append("and   (B.CODICE_TIPO_RICL = 'MACRO') ");
      SQL.append("and   (B.ARTICOLO = A.ARTICOLO) ");
      SQL.append("and   (B.CAPITOLO = A.CAPITOLO) ");
      SQL.append("and   (B.E_S = 'S') ");
      SQL.append("and   (B.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_IMP = " + IDL.CSql(AnnoImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_IMP = " + IDL.CSql(NumeroImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CODICE = QV.Get("VISRICCAPCOD", IDVariant.INTEGER) ;
      }
      QV.Close();
      return v_CODICE;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GetLiv4Impegno", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Get Liv4 Da Cap
  // Leggo il codice riclassificato livello 4 da cap
  // Esercizio:  - Input
  // E S:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // **********************************************************************
  public IDVariant GetLiv4DaCap (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Get Liv4 Da Cap Body
      // Procedure Body
      // 
      IDVariant v_VLIVELLO4 = new IDVariant(0,IDVariant.INTEGER);
      v_VLIVELLO4 = (new IDVariant());
      // 
      // porpongo il riclassificato di livello 5
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.CODICE as VISRICCAPCOD ");
      SQL.append("from ");
      SQL.append("  VISTA_RICLASSIFICAZIONI_CAP A ");
      SQL.append("where (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((" + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " BETWEEN NVL(A.ESERCIZIO_INIZIO, 0) AND NVL(A.ESERCIZIO_SCADENZA, 9999))) ");
      SQL.append("and   (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CODICE_TIPO_RICL = 'MACRO') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VLIVELLO4 = QV.Get("VISRICCAPCOD", IDVariant.INTEGER) ;
      }
      QV.Close();
      return v_VLIVELLO4;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GetLiv4DaCap", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Get Liv5 Da Cap
  // Leggo il riclassificato livello 5 da cap
  // Esercizio:  - Input
  // E S:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // **********************************************************************
  public IDVariant GetLiv5DaCap (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Get Liv5 Da Cap Body
      // Procedure Body
      // 
      IDVariant v_CODICE = null;
      v_CODICE = (new IDVariant());
      // 
      // porpongo il riclassificato di livello 5
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.CODICE as VISRICCAPCOD ");
      SQL.append("from ");
      SQL.append("  VISTA_RICLASSIFICAZIONI_CAP A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((" + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " BETWEEN NVL(A.ESERCIZIO_INIZIO, 0) AND NVL(A.ESERCIZIO_SCADENZA, 9999))) ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CODICE_TIPO_RICL = 'MACRO_5') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CODICE = QV.Get("VISRICCAPCOD", IDVariant.DECIMAL) ;
      }
      QV.Close();
      return new IDVariant(v_CODICE,IDVariant.INTEGER);
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GetLiv5DaCap", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Get Minima Quietanza Da Soggetto
  // Ben:  - Input
  // **********************************************************************
  public IDVariant GetMinimaQuietanzaDaSoggetto (IDVariant Ben)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_QT = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Get Minima Quietanza Da Soggetto Body
      // Procedure Body
      // 
      // SQL = new StringBuffer();
      // SQL.append("select ");
      // SQL.append("  MIN(A.NUM_QUIETANZA) as MINQTNNUMQUI ");
      // SQL.append("from ");
      // SQL.append("  QTN A ");
      // SQL.append("where (A.CODICE = " + IDL.CSql(Ben, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      // SQL.append("and   ((A.SCADENZA IS NULL) OR A.SCADENZA > TRUNC( SYSDATE )) ");
      // QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      // if (!QV.EOF()) QV.MoveNext();
      // if (!QV.EOF())
      // {
      //   v_QT = QV.Get("MINQTNNUMQUI", IDVariant.INTEGER) ;
      // }
      // QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  MIN(A.NUM_QUIETANZA) as MINQTNNUMQUI ");
      SQL.append("from ");
      SQL.append("  QTN A ");
      SQL.append("where (A.CODICE = " + IDL.CSql(Ben, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.PREVALENTE = 'SI') ");
      SQL.append("and   ((A.SCADENZA IS NULL) OR A.SCADENZA > TRUNC( SYSDATE )) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_QT = QV.Get("MINQTNNUMQUI", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (IDL.IsNull(v_QT))
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  MIN(A.NUM_QUIETANZA) as MINQTNNUMQUI ");
        SQL.append("from ");
        SQL.append("  QTN A ");
        SQL.append("where (A.CODICE = " + IDL.CSql(Ben, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   ((A.SCADENZA IS NULL) OR A.SCADENZA > TRUNC( SYSDATE )) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_QT = QV.Get("MINQTNNUMQUI", IDVariant.INTEGER) ;
        }
        QV.Close();
      }
      return v_QT;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GetMinimaQuietanzaDaSoggetto", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Get Progetto Da Istanza
  // **********************************************************************
  public IDVariant GetProgettoDaIstanza ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Get Progetto Da Istanza Body
      // Procedure Body
      // 
      IDVariant v_PROGETTO = new IDVariant(0,IDVariant.STRING);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.PROGETTO as ISTANZPROGET ");
      SQL.append("from ");
      SQL.append("  AD4_ISTANZE A ");
      SQL.append("where (A.ISTANZA = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOISTANZ, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_PROGETTO = QV.Get("ISTANZPROGET", IDVariant.STRING) ;
      }
      QV.Close();
      // 
      // 
      // 
      // 
      return v_PROGETTO;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GetProgettoDaIstanza", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Get Progetto Da Cap
  // Capitolo:  - Input
  // Articolo:  - Input
  // ES:  - Input
  // Unita Organizzativa:  - Input
  // indice:  - Input
  // datareg:  - Input
  // Rpp Attiva:  - Input
  // **********************************************************************
  public IDVariant GetProgettoDaCap (IDVariant Capitolo, IDVariant Articolo, IDVariant ES, IDVariant UnitaOrganizzativa, IDVariant indice, IDVariant datareg, IDVariant RppAttiva)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.STRING);
    IDCachedRowSet C2;

    try
    {
      TransCount = 0;
      v_CONTATORE = (new IDVariant(1, IDVariant.INTEGER));
      // 
      // Get Progetto Da Cap Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  D.PROGETTO_ID as PROGEPROGEID, ");
      SQL.append("  DECODE(MAX(" + IDL.CSql(ORDINAPROGET, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + "), NULL, TO_DATE('1900-01-01','YYYY-MM-DD'), NVL(MAX(D.DATA_INIZIO), TO_DATE('1900-01-01','YYYY-MM-DD'))) as STANPROGESPR, ");
      SQL.append("  MAX(D.PROGRAMMA || ' ' || ' - ' || ' ' || D.CODICE || ' ' || ' - ' || ' ' || D.DESCRIZIONE) as STANPROGDESC ");
      SQL.append("from ");
      SQL.append("  STANZIAMENTI_PROGETTO A, ");
      SQL.append("  STANZIAMENTI_PROG_DETTAGLIO B, ");
      SQL.append("  VISTA_BLOCCO_AGGIORNAMENTI C, ");
      SQL.append("  PROGETTI D ");
      SQL.append("where (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.PROGRESSIVO = B.PROGR_STANZIAMENTO) ");
      SQL.append("and   (B.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (C.ESERCIZIO_RIF = A.ESERCIZIO_RIF) ");
      SQL.append("and   (C.ESERCIZIO = B.ESERCIZIO) ");
      SQL.append("and   (C.BLOCCO_TOTALE = 'SI') ");
      SQL.append("and   (D.PROGETTO_ID = A.PROGETTO_ID) ");
      SQL.append("and   (" + IDL.CSql(indice, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " = 1 AND ((D.DATA_FINE_EFFETTIVA IS NULL) OR D.DATA_FINE_EFFETTIVA > " + IDL.CSql(datareg, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ")) ");
      SQL.append("and   (" + IDL.CSql(RppAttiva, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " = 1 AND " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSCFPEATTI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " = 0) ");
      SQL.append("group by ");
      SQL.append("  D.PROGETTO_ID ");
      SQL.append("UNION ALL ");
      SQL.append("select ");
      SQL.append("  G.PROGETTO_ID, ");
      SQL.append("  DECODE(MAX(" + IDL.CSql(ORDINAPROGET, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + "), NULL, TO_DATE('1900-01-01','YYYY-MM-DD'), NVL(MAX(G.DATA_INIZIO), TO_DATE('1900-01-01','YYYY-MM-DD'))), ");
      SQL.append("  MAX(G.PROGRAMMA || ' ' || ' - ' || ' ' || G.CODICE || ' ' || ' - ' || ' ' || G.DESCRIZIONE) ");
      SQL.append("from ");
      SQL.append("  STANZIAMENTI_PROGETTO E, ");
      SQL.append("  STANZIAMENTI_PROG_DETTAGLIO F, ");
      SQL.append("  PROGETTI G ");
      SQL.append("where (E.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (E.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (E.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (E.PROGRESSIVO = F.PROGR_STANZIAMENTO) ");
      SQL.append("and   (F.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (G.PROGETTO_ID = E.PROGETTO_ID) ");
      SQL.append("and   (" + IDL.CSql(indice, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " = 2 AND ((G.DATA_FINE_EFFETTIVA IS NULL) OR G.DATA_FINE_EFFETTIVA > " + IDL.CSql(datareg, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ")) ");
      SQL.append("and   (" + IDL.CSql(RppAttiva, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " = 1 AND " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSCFPEATTI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " = 0) ");
      SQL.append("group by ");
      SQL.append("  G.PROGETTO_ID ");
      SQL.append("UNION ALL ");
      SQL.append("select ");
      SQL.append("  H.PROGETTO_ID, ");
      SQL.append("  DECODE(MAX(" + IDL.CSql(ORDINAPROGET, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + "), NULL, TO_DATE('1900-01-01','YYYY-MM-DD'), NVL(MAX(H.DATA_INIZIO_PROG), TO_DATE('1900-01-01','YYYY-MM-DD'))), ");
      SQL.append("  MAX(H.DES_PROGETTO) ");
      SQL.append("from ");
      SQL.append("  POL_ELENCO_PROG_FC H ");
      SQL.append("where (H.ESERCIZIO >= " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (H.PROGR_UNITA_ORGANIZZATIVA = " + IDL.CSql(UnitaOrganizzativa, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (H.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (H.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (H.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (H.ESERCIZIO_STN = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (" + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSCFPEATTI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " = 1) ");
      SQL.append("group by ");
      SQL.append("  H.PROGETTO_ID ");
      SQL.append("order by 3, 2 ");
      C2 = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      C2.setColUnbound(2,true);
      C2.setColUnbound(3,true);
      if (!C2.EOF()) C2.MoveNext();
      while (!C2.EOF())
      {
        if (v_CONTATORE.equals((new IDVariant(1)), true))
        {
          v_RETVAL = new IDVariant(C2.Get("PROGEPROGEID"));
          break;
        }
        C2.MoveNext();
      }
      C2.Close();
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GetProgettoDaCap", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Get Tipo Avanzo Da Capitolo
  // Se nel capitolo è indicato il tipo avanzo si restituisce
  // il tipo avanzo del capitolo.
  // Se nel capitolo non è indicato il tipo avanzo ma è
  // indicato un tipo vincolo da cui si può ricavare il
  // tipo avanzo si restituisce il tipo avanzo collegato
  // al tipo vincolo del capitolo
  // p Capitolo - Input
  // p Articolo - Input
  // p ES - Input
  // p Esercizio - Input
  // **********************************************************************
  public IDVariant GetTipoAvanzoDaCapitolo (IDVariant pCapitolo, IDVariant pArticolo, IDVariant pES, IDVariant pEsercizio)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Get Tipo Avanzo Da Capitolo Body
      // Corpo Procedura
      // 
      IDVariant v_VTIPOAVANRET = null;
      v_VTIPOAVANRET = (new IDVariant());
      if (IDL.IsNull(pCapitolo) || IDL.IsNull(pArticolo))
      {
        return v_VTIPOAVANRET;
      }
      IDVariant v_VCAPTIPOAVAN = null;
      v_VCAPTIPOAVAN = (new IDVariant());
      IDVariant v_VVINCTIPOAVA = null;
      v_VVINCTIPOAVA = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.TIPO_AVANZO as CAPTIPOAVANZ, ");
      SQL.append("  B.TIPO_AVANZO as VINCTIPOAVAN ");
      SQL.append("from ");
      SQL.append("  CAP A, ");
      SQL.append("  VINCOLI B ");
      SQL.append("where (A.TIPO_VINCOLO = B.CODICE(+)) ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(pCapitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(pArticolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(pES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ESERCIZIO = " + IDL.CSql(pEsercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCAPTIPOAVAN = QV.Get("CAPTIPOAVANZ", IDVariant.DECIMAL) ;
        v_VVINCTIPOAVA = QV.Get("VINCTIPOAVAN", IDVariant.DECIMAL) ;
      }
      QV.Close();
      v_VTIPOAVANRET = new IDVariant(IDL.NullValue(v_VCAPTIPOAVAN,v_VVINCTIPOAVA),IDVariant.INTEGER);
      return v_VTIPOAVANRET;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GetTipoAvanzoDaCapitolo", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Get UO Unica Da Cap
  // Esercizio:  - Input
  // E S:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // **********************************************************************
  public IDVariant GetUOUnicaDaCap (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Get UO Unica Da Cap Body
      // Corpo Procedura
      // 
      IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);
      IDVariant v_PROGRUO = null;
      v_PROGRUO = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1, ");
      SQL.append("  MIN(A.PROGR_UNITA_ORGANIZZATIVA) as MIVIBIUOPRUO ");
      SQL.append("from ");
      SQL.append("  VISTA_BILANCIO_UO A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.TIPO = 'O') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
        v_PROGRUO = QV.Get("MIVIBIUOPRUO", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_NUMREC.compareTo((new IDVariant(1)), true)!=0)
      {
        v_PROGRUO = (new IDVariant());
      }
      return v_PROGRUO;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GetUOUnicaDaCap", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Getdatainiziotrimestre
  // Trimestre: Trimestre passato - Input
  // Esercizio:  - Input
  // **********************************************************************
  public IDVariant Getdatainiziotrimestre (IDVariant Trimestre, IDVariant Esercizio)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Getdatainiziotrimestre Body
      // Procedure Body
      // 
      if (Trimestre.equals((new IDVariant(1)), true))
      {
        // 
        // 31 GENNAIO
        // 
        return IDL.ToDate(Esercizio, (new IDVariant(1)), (new IDVariant(1)));
      }
      if (Trimestre.equals((new IDVariant(2)), true))
      {
        // 
        // APRILE
        // 
        return IDL.ToDate(Esercizio, (new IDVariant(4)), (new IDVariant(1)));
      }
      if (Trimestre.equals((new IDVariant(3)), true))
      {
        // 
        // LUGLIO
        // 
        return IDL.ToDate(Esercizio, (new IDVariant(7)), (new IDVariant(1)));
      }
      if (Trimestre.equals((new IDVariant(4)), true))
      {
        // 
        // OTTOBRE
        // 
        return IDL.ToDate(Esercizio, (new IDVariant(10)), (new IDVariant(1)));
      }
      return (new IDVariant("2999/12/31# 00:00:00", IDVariant.DATETIME));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Getdatainiziotrimestre", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Getdatatrimestre
  // Trimestre: Trimestre passato - Input
  // Esercizio:  - Input
  // **********************************************************************
  public IDVariant Getdatatrimestre (IDVariant Trimestre, IDVariant Esercizio)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Getdatatrimestre Body
      // Procedure Body
      // 
      if (Trimestre.equals((new IDVariant(1)), true))
      {
        // 
        // 31-Marzo-Esercizio passato
        // 
        return IDL.ToDate(Esercizio, (new IDVariant(3)), (new IDVariant(31)));
      }
      if (Trimestre.equals((new IDVariant(2)), true))
      {
        // 
        // 31-Marzo-Esercizio passato
        // 
        return IDL.ToDate(Esercizio, (new IDVariant(6)), (new IDVariant(30)));
      }
      if (Trimestre.equals((new IDVariant(3)), true))
      {
        // 
        // 31-Marzo-Esercizio passato
        // 
        return IDL.ToDate(Esercizio, (new IDVariant(9)), (new IDVariant(30)));
      }
      if (Trimestre.equals((new IDVariant(4)), true))
      {
        // 
        // 31-Marzo-Esercizio passato
        // 
        return IDL.ToDate(Esercizio, (new IDVariant(12)), (new IDVariant(31)));
      }
      return (new IDVariant("2999/12/31# 00:00:00", IDVariant.DATETIME));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Getdatatrimestre", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Getente
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public IDVariant Getente ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_ENTE = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Getente Body
      // Procedure Body
      // 
      v_ENTE = (new IDVariant());
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.ENTE as ISTANZEENTE ");
      SQL.append("from ");
      SQL.append("  AD4_ISTANZE A ");
      SQL.append("where (A.ISTANZA = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOISTANZ, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_ENTE = QV.Get("ISTANZEENTE", IDVariant.STRING) ;
      }
      QV.Close();
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
        v_ENTE = (new IDVariant());
        return v_ENTE;
      }
      return v_ENTE;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Getente", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Getfattoreassociatoeconomica
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // Esercizio - Input
  // ES - Input
  // Cod IV Liv:  - Input
  // Cod V Liv:  - Input
  // **********************************************************************
  public IDVariant Getfattoreassociatoeconomica (IDVariant Esercizio, IDVariant ES, IDVariant CodIVLiv, IDVariant CodVLiv)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Getfattoreassociatoeconomica Body
      // Corpo Procedura
      // 
      if (IDL.NullValue(FILTRFATTPCF,(new IDVariant("NO"))).compareTo((new IDVariant("SI")), true)!=0)
      {
        return (new IDVariant());
      }
      IDVariant v_VGETFATASSPC = new IDVariant(0,IDVariant.STRING);
      v_VGETFATASSPC = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  GET_FATTORE_ASS_PCFPCE(" + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(CodIVLiv, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(CodVLiv, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") as GFAPEECILCVL ");
      SQL.append("from ");
      SQL.append("  DUAL A ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VGETFATASSPC = QV.Get("GFAPEECILCVL", IDVariant.STRING) ;
      }
      QV.Close();
      if (!(IDL.IsNull(v_VGETFATASSPC)))
      {
        if (ControlloFattoreScaduto(v_VGETFATASSPC))
        {
          return (new IDVariant());
        }
      }
      return v_VGETFATASSPC;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Getfattoreassociatoeconomica", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Getruolo
  // **********************************************************************
  public IDVariant Getruolo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RUOLO = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Getruolo Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.RUOLO as DIRIACCERUOL ");
      SQL.append("from ");
      SQL.append("  AD4_DIRITTI_ACCESSO A ");
      SQL.append("where (A.UTENTE = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.MODULO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ISTANZA = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOISTANZ, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_RUOLO = QV.Get("DIRIACCERUOL", IDVariant.STRING) ;
      }
      QV.Close();
      return v_RUOLO;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Getruolo", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Imp Eseimp
  // Explain which processing is carried out by this procedure
  // Anno Imp:  - Input
  // Numero Imp:  - Input
  // Capitolo:  - Input/Output
  // Articolo:  - Input/Output
  // **********************************************************************
  public boolean ImpEseimp (IDVariant AnnoImp, IDVariant NumeroImp, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_RET = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Imp Eseimp Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1, ");
      SQL.append("  A.CAPITOLO as ESEIMPCAPITO, ");
      SQL.append("  A.ARTICOLO as ESEIMPARTICO ");
      SQL.append("from ");
      SQL.append("  ESEIMP A ");
      SQL.append("where (A.ANNO_IMP = " + IDL.CSql(AnnoImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_IMP = " + IDL.CSql(NumeroImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("group by ");
      SQL.append("  A.CAPITOLO, ");
      SQL.append("  A.ARTICOLO ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
        Capitolo.set(QV.Get("ESEIMPCAPITO", IDVariant.DECIMAL));
        Articolo.set(QV.Get("ESEIMPARTICO", IDVariant.INTEGER));
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
        v_MESSAGGIO = (new IDVariant("Impegno di Spesa non previsto in Bilancio.", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_MESSAGGIO); 
        v_RET = (new IDVariant(0));
      }
      else
      {
        if (v_CONTATORE.compareTo((new IDVariant(0)), true)>0)
        {
          v_RET = (new IDVariant(-1));
        }
      }
      return v_RET.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ImpEseimp", _e);
      return false;
    }
  }

  // **********************************************************************
  // Imp Presente
  // Anno Imp:  - Input
  // Numero Imp:  - Input
  // **********************************************************************
  public IDVariant ImpPresente (IDVariant AnnoImp, IDVariant NumeroImp)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Imp Presente Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  IMP A ");
      SQL.append("where (A.ANNO_IMP = " + IDL.CSql(AnnoImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_IMP = " + IDL.CSql(NumeroImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
        v_MESSAGGIO = (new IDVariant("Impegno di Spesa non previsto in Bilancio", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_MESSAGGIO); 
        v_RETVAL = (new IDVariant(-1));
      }
      else
      {
        v_RETVAL = (new IDVariant(1));
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ImpPresente", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Imp Sub Finanziato
  // Anno Imp Sub:  - Input
  // Numero Imp Sub:  - Input
  // Imp Sub:  - Input
  // **********************************************************************
  public IDVariant ImpSubFinanziato (IDVariant AnnoImpSub, IDVariant NumeroImpSub, IDVariant ImpSub)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_IMPORTO = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_VARIMP = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_IMPFIN = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_IMPFINANZIAT = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_VARIMPFIN = new IDVariant(0,IDVariant.DECIMAL);

    try
    {
      TransCount = 0;
      // 
      // Imp Sub Finanziato Body
      // Procedure Body
      // 
      v_IMPORTO = (new IDVariant(0, IDVariant.DECIMAL));
      v_VARIMP = (new IDVariant(0, IDVariant.DECIMAL));
      v_IMPFIN = (new IDVariant(0, IDVariant.DECIMAL));
      v_IMPFINANZIAT = (new IDVariant(0, IDVariant.DECIMAL));
      v_VARIMPFIN = (new IDVariant(0, IDVariant.DECIMAL));
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      if (ImpSub.equals((new IDVariant("I")), true))
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.IMPORTO as IMPIMPORTO ");
        SQL.append("from ");
        SQL.append("  IMP A ");
        SQL.append("where (A.ANNO_IMP = " + IDL.CSql(AnnoImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_IMP = " + IDL.CSql(NumeroImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_IMPORTO = QV.Get("IMPIMPORTO", IDVariant.DECIMAL) ;
        }
        QV.Close();
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  SUM(A.IMPORTO) as SUMVARIMIMPO ");
        SQL.append("from ");
        SQL.append("  VARIMP A ");
        SQL.append("where (A.ANNO_IMP = " + IDL.CSql(AnnoImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_IMP = " + IDL.CSql(NumeroImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VARIMP = QV.Get("SUMVARIMIMPO", IDVariant.DECIMAL) ;
        }
        QV.Close();
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  SUM(A.IMPORTO) as SUMIMPFINIMP, ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  IMP_FIN A, ");
        SQL.append("  ESEIMP_FIN B ");
        SQL.append("where (A.FINANZIAMENTO = B.FINANZIAMENTO) ");
        SQL.append("and   (A.OPERA = B.OPERA) ");
        SQL.append("and   (A.ANNO_IMP = B.ANNO_IMP) ");
        SQL.append("and   (A.NUMERO_IMP = B.NUMERO_IMP) ");
        SQL.append("and   (B.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   ((B.SALDO_INI + B.VARIAZIONI + B.VARIAZIONI_RES) > 0) ");
        SQL.append("and   (A.ANNO_IMP = " + IDL.CSql(AnnoImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_IMP = " + IDL.CSql(NumeroImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_IMPFIN = QV.Get("SUMIMPFINIMP", IDVariant.DECIMAL) ;
          v_IMPFINANZIAT = QV.Get("COUNT1", IDVariant.DECIMAL) ;
        }
        QV.Close();
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  SUM(A.IMPORTO) as SUMVARIMIMPO ");
        SQL.append("from ");
        SQL.append("  VARIMP A ");
        SQL.append("where (A.ANNO_IMP = " + IDL.CSql(AnnoImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_IMP = " + IDL.CSql(NumeroImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (NOT ((A.FINANZIAMENTO IS NULL))) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VARIMPFIN = QV.Get("SUMVARIMIMPO", IDVariant.DECIMAL) ;
        }
        QV.Close();
      }
      else
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.IMPORTO as SUBIMPSUBIMP ");
        SQL.append("from ");
        SQL.append("  SUBIMP A ");
        SQL.append("where (A.ANNO_SUBIMP = " + IDL.CSql(AnnoImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_SUBIMP = " + IDL.CSql(NumeroImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_IMPORTO = QV.Get("SUBIMPSUBIMP", IDVariant.DECIMAL) ;
        }
        QV.Close();
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  SUM(A.IMPORTO) as SUMVARSUIMPO ");
        SQL.append("from ");
        SQL.append("  VARSUB A ");
        SQL.append("where (A.ANNO_SUBIMP = " + IDL.CSql(AnnoImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_SUBIMP = " + IDL.CSql(NumeroImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VARIMP = QV.Get("SUMVARSUIMPO", IDVariant.DECIMAL) ;
        }
        QV.Close();
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  SUM(A.IMPORTO) as SUMSUBFINIMP, ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  SUBIMP_FIN A, ");
        SQL.append("  ESESUB_FIN B ");
        SQL.append("where (A.FINANZIAMENTO = B.FINANZIAMENTO) ");
        SQL.append("and   (A.ANNO_SUBIMP = B.ANNO_SUBIMP) ");
        SQL.append("and   (A.NUMERO_SUBIMP = B.NUMERO_SUBIMP) ");
        SQL.append("and   (B.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   ((B.SALDO_INI + B.VARIAZIONI + B.VARIAZIONI_RES) > 0) ");
        SQL.append("and   (A.ANNO_SUBIMP = " + IDL.CSql(AnnoImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_SUBIMP = " + IDL.CSql(NumeroImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_IMPFIN = QV.Get("SUMSUBFINIMP", IDVariant.DECIMAL) ;
          v_IMPFINANZIAT = QV.Get("COUNT1", IDVariant.DECIMAL) ;
        }
        QV.Close();
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  SUM(A.IMPORTO) as SUMVARSUIMPO ");
        SQL.append("from ");
        SQL.append("  VARSUB A ");
        SQL.append("where (A.ANNO_SUBIMP = " + IDL.CSql(AnnoImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_SUBIMP = " + IDL.CSql(NumeroImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (NOT ((A.FINANZIAMENTO IS NULL))) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VARIMPFIN = QV.Get("SUMVARSUIMPO", IDVariant.DECIMAL) ;
        }
        QV.Close();
      }
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        return (new IDVariant(-1));
      }
      else
      {
        if (v_IMPFINANZIAT.equals((new IDVariant(0)), true))
        {
          return (new IDVariant(2));
        }
        if ((IDL.Add(IDL.NullValue(v_IMPORTO,(new IDVariant(0))), IDL.NullValue(v_VARIMP,(new IDVariant(0))))).equals((IDL.Add(IDL.NullValue(v_IMPFIN,(new IDVariant(0))), IDL.NullValue(v_VARIMPFIN,(new IDVariant(0))))), true))
        {
          return (new IDVariant(0));
        }
        else
        {
          if ((IDL.Add(IDL.NullValue(v_IMPORTO,(new IDVariant(0))), IDL.NullValue(v_VARIMP,(new IDVariant(0))))).compareTo(IDL.Add(IDL.NullValue(v_IMPFIN,(new IDVariant(0))), IDL.NullValue(v_VARIMPFIN,(new IDVariant(0)))), true)>0)
          {
            return (new IDVariant(1));
          }
          else
          {
            return (new IDVariant(-1));
          }
        }
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ImpSubFinanziato", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Importo Già Liquidato
  // Anno Prog:  - Input
  // Numero Prog:  - Input
  // **********************************************************************
  public IDVariant ImportoGiàLiquidato (IDVariant AnnoProg, IDVariant NumeroProg)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Importo Già Liquidato Body
      // Corpo Procedura
      // 
      IDVariant v_IMPORTO = new IDVariant(0,IDVariant.DECIMAL);
      v_IMPORTO = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  SUM(B.IMPORTO) as SUMLIQFABUIM ");
      SQL.append("from ");
      SQL.append("  FATTURE_BUONI A, ");
      SQL.append("  LIQ_FATTURE_BUONI B ");
      SQL.append("where (A.ANNO_PROG = " + IDL.CSql(AnnoProg, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_PROG = " + IDL.CSql(NumeroProg, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (B.PROGR_FABU(+) = A.PROGRESSIVO) ");
      SQL.append("and   (NOT ((B.ANNO_LIQ IS NULL))) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_IMPORTO = QV.Get("SUMLIQFABUIM", IDVariant.DECIMAL) ;
      }
      QV.Close();
      return IDL.NullValue(v_IMPORTO,(new IDVariant(0)));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ImportoGiàLiquidato", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Init Fix
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int InitFix ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Init Fix Body
      // Corpo Procedura
      // 
      // 
      // qui bisogna leggere da XML
      // 
      IDVariant v_FXMLFIELDS = new IDVariant(0,IDVariant.STRING);
      v_FXMLFIELDS = (new IDVariant("FIELDS_TO_BE_FIXED.xml"));
      XMLDoc v_XMLD = null;
      v_XMLD = (XMLDoc)new XMLDoc();
      v_XMLD.Load(IDL.Add(IDL.Add((new IDVariant(MainFrm.RealPath)), (new IDVariant("/"))), v_FXMLFIELDS).stringValue(), (new IDVariant(0)).intValue()); 
      XMLNode v_NODO = null;
      if (v_XMLD.HasNextNode())
      {
        v_NODO = v_XMLD.GetNextNode();
      }
      while (v_NODO.HasNextNode())
      {
        XMLNode N = null;
        N = v_NODO.GetNextNode();
        INITFIX_FITOBEFIINI1(N);
      }
      // 
      // qui bisogna leggere da XML
      // 
      IDVariant v_FXMLCHARS = new IDVariant(0,IDVariant.STRING);
      v_FXMLCHARS = (new IDVariant("CHARS_TO_BE_FIXED.xml"));
      XMLDoc v_XMLDOCCHARS = null;
      v_XMLDOCCHARS = (XMLDoc)new XMLDoc();
      v_XMLDOCCHARS.Load(IDL.Add(IDL.Add((new IDVariant(MainFrm.RealPath)), (new IDVariant("/"))), v_FXMLCHARS).stringValue(), (new IDVariant(0)).intValue()); 
      XMLNode v_NCHARS = null;
      if (v_XMLDOCCHARS.HasNextNode())
      {
        v_NCHARS = v_XMLDOCCHARS.GetNextNode();
      }
      while (v_NCHARS.HasNextNode())
      {
        XMLNode N = null;
        N = v_NCHARS.GetNextNode();
        INITFIX_CHTOBEFIINI4(N);
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "InitFix", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Fields To Be Fixed: Insert into
  // Perchè stai inserendo queste righe?
  // **********************************************************************
  private void INITFIX_FITOBEFIINI1(XMLNode N) throws SQLException
  {
    IMDB.TblAddNew(IMDBDef7.TBL_FIELTOBEFIXE, 0);
    IMDB.set_Value(IMDBDef7.TBL_FIELTOBEFIXE, IMDBDef7.FLD_FIELTOBEFIXE_CODFIETOBEFI, 0, new IDVariant(N.Value()));
  }

  // **********************************************************************
  // Chars To Be Fixed: Insert into
  // Perchè stai inserendo queste righe?
  // **********************************************************************
  private void INITFIX_CHTOBEFIINI4(XMLNode N) throws SQLException
  {
    IMDB.TblAddNew(IMDBDef7.TBL_CHARTOBEFIXE, 0);
    IMDB.set_Value(IMDBDef7.TBL_CHARTOBEFIXE, IMDBDef7.FLD_CHARTOBEFIXE_BADCHATOBEFI, 0, IDL.ToInteger((new IDVariant(N.GetAttribute((new IDVariant("BAD")).stringValue())))));
    IMDB.set_Value(IMDBDef7.TBL_CHARTOBEFIXE, IMDBDef7.FLD_CHARTOBEFIXE_GOOCHATOBEFI, 0, (new IDVariant(Glb.URLDecode(new IDVariant(N.Value()).stringValue()))));
  }

  // **********************************************************************
  // Invio File Siope Link
  // ID Elaborazione - Input
  // **********************************************************************
  public IDVariant InvioFileSiopeLink (IDVariant IDElaborazione)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDCachedRowSet C6;

    try
    {
      TransCount = 0;
      // 
      // Invio File Siope Link Body
      // Corpo Procedura
      // 
      IDVariant v_ERRORE = new IDVariant(0,IDVariant.INTEGER);
      if (!(IDL.IsNull(IDElaborazione)))
      {
        MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
        MainFrm.Cf4armDBObject.IMPORTAORDINATIVO(IDElaborazione);
        if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
        {
          SQL = new StringBuffer();
          SQL.append("update ELABORAZIONI_MANORD_INF set ");
          SQL.append("  ID_GDM = 0 ");
          SQL.append("where (ID_ELABORAZIONE = " + IDL.CSql(IDElaborazione, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          MainFrm.Cf4armDBObject.DBO().Execute(SQL);
          return (new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()));
        }
      }
      else
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Attenzione! Sono presenti flussi in Stato 'File Creato' che non è stato possibile inviare al documentale."));
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.ID_ELABORAZIONE as IDELABORAZIO ");
        SQL.append("from ");
        SQL.append("  ELABORAZIONI_MANORD_INF A ");
        SQL.append("where (A.ANNO_MANORD = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STATO = 'FILE CREATO') ");
        SQL.append("and   (LENGTH(A.FILE_XML) > 0) ");
        SQL.append("and   (A.ID_GDM = 0) ");
        C6 = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!C6.EOF()) C6.MoveNext();
        while (!C6.EOF())
        {
          MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
          MainFrm.Cf4armDBObject.IMPORTAORDINATIVO(C6.Get("IDELABORAZIO"));
          if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
          {
            v_ERRORE = (new IDVariant(-1));
          }
          C6.MoveNext();
        }
        C6.Close();
        if (v_ERRORE.booleanValue())
        {
          return v_AVVISO;
        }
      }
      return (new IDVariant());
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "InvioFileSiopeLink", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Invio Mail
  // Tipo Messaggio:  - Input
  // Nome Destinatario:  - Input
  // E Mail Destinatario:  - Input
  // Nome Per Conoscenza:  - Input
  // E Mail Per Conoscenza:  - Input
  // Numero Fax:  - Input
  // Oggetto:  - Input
  // Testo:  - Input
  // Nome Mittente - Input
  // Mail Mittente:  - Input
  // Nome Allegato:  - Input
  // Nome Pdf In Temp:  - Input
  // Fase:  - Input
  // **********************************************************************
  public IDVariant InvioMail (IDVariant TipoMessaggio, IDVariant NomeDestinatario, IDVariant EMailDestinatario, IDVariant NomePerConoscenza, IDVariant EMailPerConoscenza, IDVariant NumeroFax, IDVariant Oggetto, IDVariant Testo, IDVariant NomeMittente, IDVariant MailMittente, IDVariant NomeAllegato, IDVariant NomePdfInTemp, IDVariant Fase)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_IDMESSAGGIO = new IDVariant(0,IDVariant.INTEGER);
    IDCachedRowSet C6;

    try
    {
      TransCount = 0;
      // 
      // Invio Mail Body
      // Procedure Body
      // 
      IDVariant v_INVIATO = null;
      v_INVIATO = (new IDVariant("SI"));
      try
      {
        MainFrm.Cf4armDBObject.MESSAGGIINVIONUM(v_IDMESSAGGIO);
        SQL = new StringBuffer();
        SQL.append("insert into MESSAGGI_INVIO ");
        SQL.append("( ");
        SQL.append("  ID_MESSAGGIO, ");
        SQL.append("  TIPO_MESSAGGIO, ");
        SQL.append("  NOME_DESTINATARIO, ");
        SQL.append("  E_MAIL_DESTINATARIO, ");
        SQL.append("  NOME_PER_CONOSCENZA, ");
        SQL.append("  E_MAIL_PER_CONOSCENZA, ");
        SQL.append("  NUMERO_FAX, ");
        SQL.append("  OGGETTO, ");
        SQL.append("  TESTO, ");
        SQL.append("  NOME_MITTENTE, ");
        SQL.append("  MAIL_MITTENTE, ");
        SQL.append("  NOME_FILE_ALLEGATO, ");
        SQL.append("  JDBC, ");
        SQL.append("  UTENTE, ");
        SQL.append("  PROGETTO, ");
        SQL.append("  MODULO, ");
        SQL.append("  FASE ");
        SQL.append(") ");
        SQL.append("values ");
        SQL.append("( ");
        SQL.append("  " + IDL.CSql(v_IDMESSAGGIO, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", ");
        SQL.append("  " + IDL.CSql(TipoMessaggio, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
        SQL.append("  " + IDL.CSql(NomeDestinatario, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
        SQL.append("  " + IDL.CSql(EMailDestinatario, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
        SQL.append("  " + IDL.CSql(NomePerConoscenza, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
        SQL.append("  " + IDL.CSql(EMailPerConoscenza, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
        SQL.append("  " + IDL.CSql(NumeroFax, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
        SQL.append("  " + IDL.CSql(Oggetto, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
        SQL.append("  " + IDL.CSql(Testo, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
        SQL.append("  " + IDL.CSql(NomeMittente, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
        SQL.append("  " + IDL.CSql(MailMittente, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
        SQL.append("  " + IDL.CSql(NomeAllegato, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
        SQL.append("  " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PARDATURLMAI, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
        SQL.append("  " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
        SQL.append("  " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOPROGET, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
        SQL.append("  " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
        SQL.append("  " + IDL.CSql(Fase, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " ");
        SQL.append(") ");
        MainFrm.Cf4armDBObject.DBO().Execute(SQL);
      }
      catch (Exception e3)
      {
        MainFrm.set_AlertMessage(new IDVariant(e3.getMessage())); 
        v_INVIATO = (new IDVariant("NO"));
        return v_INVIATO;
      }
      if (!(IDL.IsNull(NomeAllegato)))
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.ID_MESSAGGIO as ID_MESSAGGIO, ");
        SQL.append("  A.ALLEGATO as ALLEGATO ");
        SQL.append("from ");
        SQL.append("  MESSAGGI_INVIO A ");
        SQL.append("where (A.ID_MESSAGGIO = " + IDL.CSql(v_IDMESSAGGIO, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        C6 = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!C6.EOF()) C6.MoveNext();
        while (!C6.EOF())
        {
          IDVariant v_FILENAME = new IDVariant(0,IDVariant.STRING);
          v_FILENAME = IDL.Add(IDL.Add((new IDVariant(MainFrm.RealPath)), (new IDVariant("/"))), NomePdfInTemp);
          C6.Set("ALLEGATO", Glb.LoadBlob(MainFrm,v_FILENAME));
          C6.updateRow();
          C6.MoveNext();
        }
        MainFrm.Cf4armDBObject.DBO().UpdateRS("MESSAGGI_INVIO", C6);
        C6.Close();
      }
      try
      {
        SQL = new StringBuffer();
        SQL.append("update MESSAGGI_INVIO set ");
        SQL.append("  DATA_INVIO = TRUNC( SYSDATE ) ");
        SQL.append("where (ID_MESSAGGIO = " + IDL.CSql(v_IDMESSAGGIO, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        MainFrm.Cf4armDBObject.DBO().Execute(SQL);
      }
      catch (Exception e8)
      {
        MainFrm.set_AlertMessage(new IDVariant(e8.getMessage())); 
        v_INVIATO = (new IDVariant("NO"));
        return v_INVIATO;
      }
      return v_INVIATO;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "InvioMail", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Lancia Error Report
  // Caption:  - Input
  // Messaggio:  - Input
  // **********************************************************************
  public int LanciaErrorReport (IDVariant Caption, IDVariant Messaggio)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_MESSANONESEG = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      v_MESSANONESEG = (new IDVariant("Caricamento non eseguito per presenza di anomalie", IDVariant.STRING));
      // 
      // Lancia Error Report Body
      // Procedure Body
      // 
      IDVariant v_MESSAGESEGUI = new IDVariant(0,IDVariant.STRING);
      v_MESSAGESEGUI = (new IDVariant("Caricamento eseguito con presenza di anomalie"));
      if (!(IDL.IsNull(Messaggio)))
      {
        MainFrm.set_AlertMessage(((Messaggio.equals((new IDVariant("SI"))))?v_MESSAGESEGUI:v_MESSANONESEG)); 
      }
      IMDB.set_Value(IMDBDef6.TBL_NEWTABLE35, IMDBDef6.FLD_NEWTABLE35_ROWNAMECAPTI, 0, new IDVariant(Caption));
      ((ReportErrori)MainFrm.GetForm(MyGlb.FRM_REPORTERRORI,0)).BUK_NEWBOOK.set_PrintDestination((new IDVariant(3)).intValue());
      ((ReportErrori)MainFrm.GetForm(MyGlb.FRM_REPORTERRORI,0)).BUK_NEWBOOK.RefreshQuery();
      ((ReportErrori)MainFrm.GetForm(MyGlb.FRM_REPORTERRORI,0)).BUK_NEWBOOK.PrintBook((new IDVariant(1)).intValue(), (new IDVariant(-1)).intValue()); 
      MainFrm.set_RedirectTo((new IDVariant(((ReportErrori)MainFrm.GetForm(MyGlb.FRM_REPORTERRORI,0)).BUK_NEWBOOK.GetWebFileName())));
      MainFrm.set_RedirectNewWindow((new IDVariant(-1)).booleanValue());
      MainFrm.set_RedirectFeatures((new IDVariant(""))); 
      MainFrm.UnloadForm(MyGlb.FRM_REPORTERRORI,(new IDVariant(0)).booleanValue()); 
      // SQL = new StringBuffer();
      // SQL.append("delete from WRK_ERRORI ");
      // SQL.append("where (SESSIONE = TO_CHAR ( " + IDL.CSql(PROGRESESSIO, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " )) ");
      // MainFrm.Cf4armDBObject.DBO().Execute(SQL);
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "LanciaErrorReport", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Salva E Lancia Stampa Bil
  // Id Stampa:  - Input
  // Nome Stampa:  - Input
  // Note Stampa:  - Input
  // Nome File:  - Input
  // Tipo File:  - Optional - Input
  // **********************************************************************
  public int SalvaELanciaStampaBil (IDVariant IdStampa, IDVariant NomeStampa, IDVariant NoteStampa, IDVariant NomeFile, IDVariant TipoFile)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDCachedRowSet C5;

    try
    {
      TransCount = 0;
      // 
      // Salva E Lancia Stampa Bil Body
      // Corpo Procedura
      // 
      if (!(IDL.IsNull(NoteStampa)) && IDL.NullValue(SALVFILESTAM,(new IDVariant("NO"))).equals((new IDVariant("SI")), true))
      {
        SalvaStampaJasper(NomeStampa, NomeFile, TipoFile);
        if (VBFiles.FileLen(NomeFile).compareTo((new IDVariant(0)), true)<=0)
        {
          IDVariant v_AVVISOERRORE = new IDVariant(0,IDVariant.STRING);
          v_AVVISOERRORE = (new IDVariant("Errore nella memorizzazione del Pdf in Tabella"));
          MainFrm.set_AlertMessage(v_AVVISOERRORE); 
          LanciaStampaJasper(NomeStampa, (new IDVariant("")), (new IDVariant("")), TipoFile);
        }
        else
        {
          SQL = new StringBuffer();
          SQL.append("select ");
          SQL.append("  A.ID_STAMPA as ID_STAMPA, ");
          SQL.append("  A.FILE_DATI as FILE_DATI, ");
          SQL.append("  A.TIPO_FILE as TIPO_FILE ");
          SQL.append("from ");
          SQL.append("  STAMPE_SALVATE A ");
          SQL.append("where (A.ID_STAMPA = " + IDL.CSql(IdStampa, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          C5 = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
          if (!C5.EOF()) C5.MoveNext();
          while (!C5.EOF())
          {
            C5.Set("TIPO_FILE", IDL.NullValue(TipoFile,(new IDVariant("pdf"))));
            C5.Set("FILE_DATI", Glb.LoadBlob(MainFrm,NomeFile));
            C5.updateRow();
            C5.MoveNext();
          }
          MainFrm.Cf4armDBObject.DBO().UpdateRS("STAMPE_SALVATE", C5);
          C5.Close();
          MainFrm.set_RedirectTo(NomeFile);
          MainFrm.set_RedirectNewWindow((new IDVariant(-1)).booleanValue());
          MainFrm.set_RedirectFeatures((new IDVariant(""))); 
        }
      }
      else
      {
        LanciaStampaJasper(NomeStampa, (new IDVariant("")), (new IDVariant("")), TipoFile);
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SalvaELanciaStampaBil", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Leggi Il File E Scrivi Su Export
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // Percorso File:  - Input
  // Fase Import:  - Input
  // Riga Inizio:  - Input
  // **********************************************************************
  public boolean LeggiIlFileEScriviSuExport (IDVariant PercorsoFile, IDVariant FaseImport, IDVariant RigaInizio)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Leggi Il File E Scrivi Su Export Body
      // Corpo Procedura
      // 
      // 
      // fd del file di input
      // 
      IDVariant v_FD = new IDVariant(0,IDVariant.INTEGER);
      try
      {
        v_FD = MainFrm.VBFile.FreeFile();
        MainFrm.VBFile.OpenForInput(PercorsoFile, v_FD); 
      }
      catch (Exception e3)
      {
        IDVariant S = new IDVariant(0,IDVariant.STRING);
        S = (new IDVariant("Errore nella lettura del file"));
        MainFrm.set_AlertMessage(S); 
        // 
        // log catalina.out
        // 
        Logmessage(IDL.Add(IDL.Add(S, (new IDVariant("\n"))), new IDVariant(e3.getMessage())));
        return (new IDVariant(0)).booleanValue();
      }
      IDVariant v_CURRLINE = new IDVariant(0,IDVariant.STRING);
      IDVariant v_CURRNUMBCHAR = new IDVariant(0,IDVariant.INTEGER);
      IDVariant v_PROGR = new IDVariant(0,IDVariant.DECIMAL);
      MainFrm.Cf4armDBObject.BeginTrans();
      try
      {
        // 
        // pulisco la tabella workesportteso prima di effettuare
        // l'inserimento
        // 
        SQL = new StringBuffer();
        SQL.append("delete from WORK_EXPORT_TESO ");
        SQL.append("where (FASE = " + IDL.CSql(FaseImport, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (SESSIONE = TO_CHAR ( " + IDL.CSql(PROGRESESSIO, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " )) ");
        MainFrm.Cf4armDBObject.DBO().Execute(SQL);
      }
      catch (Exception e6)
      {
        MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
        MainFrm.Cf4armDBObject.RollbackTrans();
        return (new IDVariant(0)).booleanValue();
      }
      IDVariant v_VMAX = new IDVariant(0,IDVariant.INTEGER);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  NVL(MAX(NVL(A.PROGRESSIVO, 0)), 0) as NUVMNVWETP00 ");
      SQL.append("from ");
      SQL.append("  WORK_EXPORT_TESO A ");
      SQL.append("where (A.FASE = " + IDL.CSql(FaseImport, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VMAX = QV.Get("NUVMNVWETP00", IDVariant.INTEGER) ;
      }
      QV.Close();
      v_PROGR = new IDVariant(IDL.Add(IDL.NullValue(v_VMAX,(new IDVariant(0))), (new IDVariant(1))),IDVariant.DECIMAL);
      IDVariant v_NRIGA = null;
      v_NRIGA = (new IDVariant(1));
      while (!(MainFrm.VBFile.EOF(v_FD)))
      {
        v_CURRLINE = MainFrm.VBFile.ReadLine(v_FD); 
        v_CURRNUMBCHAR = IDL.Length(v_CURRLINE);
        // 
        // parto dalla riga specificata nel parametro Riga Inizio
        // 
        if (v_NRIGA.compareTo(RigaInizio, true)>=0)
        {
          try
          {
            v_PROGR = IDL.Add(v_PROGR, (new IDVariant(1)));
            SQL = new StringBuffer();
            SQL.append("insert into WORK_EXPORT_TESO ");
            SQL.append("( ");
            SQL.append("  FASE, ");
            SQL.append("  PROGRESSIVO, ");
            SQL.append("  SESSIONE, ");
            SQL.append("  DATI, ");
            SQL.append("  DATI2 ");
            SQL.append(") ");
            SQL.append("values ");
            SQL.append("( ");
            SQL.append("  " + IDL.CSql(FaseImport, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
            SQL.append("  " + IDL.CSql(v_PROGR, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", ");
            SQL.append("  TO_CHAR ( " + IDL.CSql(PROGRESESSIO, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " ), ");
            SQL.append("  SUBSTR(" + IDL.CSql(v_CURRLINE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", 1, 4000), ");
            SQL.append("  SUBSTR(" + IDL.CSql(v_CURRLINE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", 4001, 4000) ");
            SQL.append(") ");
            MainFrm.Cf4armDBObject.DBO().Execute(SQL);
          }
          catch (Exception e11)
          {
            MainFrm.set_AlertMessage(new IDVariant(e11.getMessage())); 
            MainFrm.Cf4armDBObject.RollbackTrans();
            return (new IDVariant(0)).booleanValue();
          }
        }
        v_NRIGA = IDL.Add(v_NRIGA, (new IDVariant(1)));
      }
      MainFrm.Cf4armDBObject.CommitTrans();
      MainFrm.VBFile.Close(v_FD); 
      return (new IDVariant(-1)).booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "LeggiIlFileEScriviSuExport", _e);
      return false;
    }
  }

  // **********************************************************************
  // Licenza
  // Explain which processing is carried out by this procedure
  // Istanza:  - Input
  // Licenza:  - Input
  // **********************************************************************
  public boolean Licenza (IDVariant Istanza, IDVariant Licenza)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_INSTALLAZION = new IDVariant(0,IDVariant.STRING);
    IDVariant v_POSITION = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Licenza Body
      // Procedure Body
      // 
      v_POSITION = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.INSTALLAZIONE as ISTANZINSTAL ");
      SQL.append("from ");
      SQL.append("  AD4_ISTANZE A ");
      SQL.append("where (A.ISTANZA = " + IDL.CSql(Istanza, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_INSTALLAZION = QV.Get("ISTANZINSTAL", IDVariant.STRING) ;
      }
      QV.Close();
      v_POSITION = IDL.Find(v_INSTALLAZION, Licenza, (new IDVariant(0)));
      if (v_POSITION.compareTo((new IDVariant(0)), true)!=0)
      {
        v_RETVAL = (new IDVariant(-1));
      }
      else
      {
        v_RETVAL = (new IDVariant(0));
      }
      return v_RETVAL.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Licenza", _e);
      return false;
    }
  }

  // **********************************************************************
  // Licenza
  // Explain which processing is carried out by this procedure
  // Licenza:  - Input
  // **********************************************************************
  public boolean Licenza (IDVariant Licenza)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_INSTALLAZION = new IDVariant(0,IDVariant.STRING);
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Licenza Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.INSTALLAZIONE as ISTANZINSTAL ");
      SQL.append("from ");
      SQL.append("  AD4_ISTANZE A ");
      SQL.append("where (A.ISTANZA = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOISTANZ, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_INSTALLAZION = QV.Get("ISTANZINSTAL", IDVariant.STRING) ;
      }
      QV.Close();
      if (IDL.Find(v_INSTALLAZION, Licenza).compareTo((new IDVariant(0)), true)>0)
      {
        v_RETVAL = (new IDVariant(-1));
      }
      else
      {
        v_RETVAL = (new IDVariant(0));
      }
      return v_RETVAL.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Licenza", _e);
      return false;
    }
  }

  // **********************************************************************
  // Logmessage
  // Message:  - Input
  // **********************************************************************
  public int Logmessage (IDVariant Message)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Logmessage Body
      // Corpo Procedura
      // 
      IDVariant S = new IDVariant(0,IDVariant.STRING);
      S = (new IDVariant("## IN.DE - "));
      S = IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(S, (new IDVariant(" "))), IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0)), (new IDVariant(" "))), IDL.ToString(IDL.Now())), (new IDVariant(" - "))), Message);
      MainFrm.log(S.stringValue()); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Logmessage", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Mesedanumero
  // Mese:  - Input
  // **********************************************************************
  public IDVariant Mesedanumero (IDVariant Mese)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Mesedanumero Body
      // Procedure Body
      // 
      if (Mese.equals((new IDVariant(1)), true))
      {
        return (new IDVariant("Gennaio"));
      }
      if (Mese.equals((new IDVariant(2)), true))
      {
        return (new IDVariant("Febbraio"));
      }
      if (Mese.equals((new IDVariant(3)), true))
      {
        return (new IDVariant("Marzo"));
      }
      if (Mese.equals((new IDVariant(4)), true))
      {
        return (new IDVariant("Aprile"));
      }
      if (Mese.equals((new IDVariant(5)), true))
      {
        return (new IDVariant("Maggio"));
      }
      if (Mese.equals((new IDVariant(6)), true))
      {
        return (new IDVariant("Giugno"));
      }
      if (Mese.equals((new IDVariant(7)), true))
      {
        return (new IDVariant("Luglio"));
      }
      if (Mese.equals((new IDVariant(8)), true))
      {
        return (new IDVariant("Agosto"));
      }
      if (Mese.equals((new IDVariant(9)), true))
      {
        return (new IDVariant("Settembre"));
      }
      if (Mese.equals((new IDVariant(10)), true))
      {
        return (new IDVariant("Ottobre"));
      }
      if (Mese.equals((new IDVariant(11)), true))
      {
        return (new IDVariant("Novembre"));
      }
      if (Mese.equals((new IDVariant(12)), true))
      {
        return (new IDVariant("Dicembre"));
      }
      return (new IDVariant("Gennaio"));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Mesedanumero", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Min Quietanza
  // Explain which processing is carried out by this procedure
  // Codice Soggetto:  - Input
  // Data Scadenza:  - Input
  // **********************************************************************
  public IDVariant MinQuietanza (IDVariant CodiceSoggetto, IDVariant DataScadenza)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Min Quietanza Body
      // Procedure Body
      // 
      v_RETVAL = (new IDVariant());
      // SQL = new StringBuffer();
      // SQL.append("select ");
      // SQL.append("  MIN(A.NUM_QUIETANZA) as MINQTNNUMQUI, ");
      // SQL.append("  COUNT(*) as COUNT1 ");
      // SQL.append("from ");
      // SQL.append("  QTN A ");
      // SQL.append("where (A.CODICE = " + IDL.CSql(CodiceSoggetto, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      // SQL.append("and   ((A.SCADENZA IS NULL) OR A.SCADENZA > " + IDL.CSql(DataScadenza, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ") ");
      // QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      // if (!QV.EOF()) QV.MoveNext();
      // if (!QV.EOF())
      // {
      //   v_RETVAL = QV.Get("MINQTNNUMQUI", IDVariant.INTEGER) ;
      //   v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      // }
      // QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  MIN(A.NUM_QUIETANZA) as MINQTNNUMQUI ");
      SQL.append("from ");
      SQL.append("  QTN A ");
      SQL.append("where (A.CODICE = " + IDL.CSql(CodiceSoggetto, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((A.SCADENZA IS NULL) OR A.SCADENZA > " + IDL.CSql(DataScadenza, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.PREVALENTE = 'SI') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_RETVAL = QV.Get("MINQTNNUMQUI", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (IDL.IsNull(v_RETVAL))
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  MIN(A.NUM_QUIETANZA) as MINQTNNUMQUI, ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  QTN A ");
        SQL.append("where (A.CODICE = " + IDL.CSql(CodiceSoggetto, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   ((A.SCADENZA IS NULL) OR A.SCADENZA > " + IDL.CSql(DataScadenza, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_RETVAL = QV.Get("MINQTNNUMQUI", IDVariant.INTEGER) ;
          v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "MinQuietanza", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Movdi
  // Tipo Form:  - Input
  // Anno Acc:  - Input
  // Numero Acc:  - Input
  // Cap:  - Input
  // Art:  - Input
  // Esercizio Scadenza:  - Input
  // Anno Introd:  - Input
  // Voce Econ:  - Input
  // Cge:  - Input
  // Importo:  - Input
  // Importo Old:  - Input
  // Messaggio Non Bloccante:  - Input/Output
  // **********************************************************************
  public IDVariant Movdi (IDVariant TipoForm, IDVariant AnnoAcc, IDVariant NumeroAcc, IDVariant Cap, IDVariant Art, IDVariant EsercizioScadenza, IDVariant AnnoIntrod, IDVariant VoceEcon, IDVariant Cge, IDVariant Importo, IDVariant ImportoOld, IDVariant MessaggioNonBloccante)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_ERRORE = new IDVariant(0,IDVariant.STRING);
    IDVariant v_TIPO = new IDVariant(0,IDVariant.STRING);
    IDVariant v_MESSNONBLOCC = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Movdi Body
      // Procedure Body
      // 
      v_MESSNONBLOCC = (new IDVariant());
      if (TipoForm.equals((new IDVariant("ACC")), true))
      {
        v_TIPO = (new IDVariant("Accertamento"));
      }
      else
      {
        if (TipoForm.equals((new IDVariant("ACCPLURI")), true))
        {
          v_TIPO = (new IDVariant("Accertamento Pluriennale"));
        }
        else
        {
          v_TIPO = (new IDVariant("Variazione Accertamento"));
        }
      }
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      MainFrm.Cf4armDBObject.ACCDI(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), Cap, Art, AnnoAcc, NumeroAcc, ImportoOld, Importo, EsercizioScadenza, AnnoIntrod, (new IDVariant()), (new IDVariant()), (new IDVariant()), VoceEcon, Cge);
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        v_ERRORE = IDL.SubStr((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())), (new IDVariant(4)), (new IDVariant(6)));
        if (v_ERRORE.equals((new IDVariant("-20998")), true))
        {
          IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
          v_AVVISO = (new IDVariant(" superiore alla Disponibilità!", IDVariant.STRING));
          v_MESSNONBLOCC = IDL.Add(IDL.Add(v_MESSNONBLOCC, v_TIPO), v_AVVISO);
        }
        else
        {
          MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
          return (new IDVariant(-1));
        }
      }
      MessaggioNonBloccante.set(new IDVariant(v_MESSNONBLOCC));
      return (new IDVariant(0));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Movdi", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Nasconditoolbar
  // Panel - Input
  // **********************************************************************
  public int Nasconditoolbar (IDPanel Panel)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Nasconditoolbar Body
      // Corpo Procedura
      // 
      IDVariant v_ID = null;
      v_ID = new IDVariant(Panel.GetRD3Ident((new IDVariant("frame")).stringValue(),(new IDVariant(0)).intValue()));
      MainFrm.ExecuteOnClient(IDL.FormatMessage((new IDVariant("RD3_DesktopManager.ObjectMap[\"|1\"].SetOnlyContent(true);")), v_ID).stringValue()); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Nasconditoolbar", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Numero Finanziamenti
  // Explain which processing is carried out by this procedure
  // Anno Impegno:  - Input
  // Numero Impegno:  - Input
  // Anno Subimp - Optional - Input
  // Numero Subimp - Optional - Input
  // **********************************************************************
  public IDVariant NumeroFinanziamenti (IDVariant AnnoImpegno, IDVariant NumeroImpegno, IDVariant AnnoSubimp, IDVariant NumeroSubimp)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Numero Finanziamenti Body
      // Procedure Body
      // 
      if (AnnoSubimp.equals((new IDVariant(0)), true))
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  IMP_FIN A ");
        SQL.append("where (A.ANNO_IMP = " + IDL.CSql(AnnoImpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_IMP = " + IDL.CSql(NumeroImpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
      }
      else
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  SUBIMP_FIN A ");
        SQL.append("where (A.ANNO_SUBIMP = " + IDL.CSql(AnnoSubimp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_SUBIMP = " + IDL.CSql(NumeroSubimp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
      }
      return v_CONTATORE;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "NumeroFinanziamenti", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Obiettivo Ammesso
  // ID OBIETTIVO - Input
  // Lancia Errore - Optional - Input
  // **********************************************************************
  public boolean ObiettivoAmmesso (IDVariant IDOBIETTIVO, IDVariant LanciaErrore)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Obiettivo Ammesso Body
      // Corpo Procedura
      // 
      IDVariant v_VCOUNT = new IDVariant(0,IDVariant.INTEGER);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  DUP_OBIETTIVI_GESTIONE A ");
      SQL.append("where (A.ID_OBIETTIVO_GESTIONE = " + IDL.CSql(IDOBIETTIVO, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.IN_USO = 'Y') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_VCOUNT.equals((new IDVariant(0)), true))
      {
        if (LanciaErrore.equals((new IDVariant("SI")), true))
        {
          IDVariant S = new IDVariant(0,IDVariant.STRING);
          S = (new IDVariant("Obiettivo gestionale inesistente o non in uso"));
          MainFrm.set_AlertMessage(S); 
        }
        return (new IDVariant(0)).booleanValue();
      }
      else
      {
        return (new IDVariant(-1)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ObiettivoAmmesso", _e);
      return false;
    }
  }

  // **********************************************************************
  // Padre IV O V Livello Riclassificazione Con Impeco
  // Struttura Ricl Id - Input
  // Livello:  - Input
  // **********************************************************************
  public IDVariant PadreIVOVLivelloRiclassificazioneConImpeco (IDVariant StrutturaRiclId, IDVariant Livello)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Padre IV O V Livello Riclassificazione Con Impeco Body
      // Corpo Procedura
      // 
      IDVariant v_VIMPACC = new IDVariant(0,IDVariant.STRING);
      IDVariant v_VCODICEPADRE = null;
      v_VCODICEPADRE = (new IDVariant());
      IDVariant v_VES = new IDVariant(0,IDVariant.STRING);
      IDVariant v_VTIPORICLID = null;
      v_VTIPORICLID = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  NVL(A.IMP_ECO_IMPACC, 'NO') as NUVASTRIIEIN, ");
      SQL.append("  A.CODICE_PADRE as STRRICCODPAD, ");
      SQL.append("  A.E_S as STRUTRICLAES, ");
      SQL.append("  A.TIPO_RICL_ID as STRRICTIRIID ");
      SQL.append("from ");
      SQL.append("  STRUTTURA_RICLASSIFICAZIONE A ");
      SQL.append("where (A.STRUTTURA_RICL_ID = " + IDL.CSql(StrutturaRiclId, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VIMPACC = QV.Get("NUVASTRIIEIN", IDVariant.STRING) ;
        v_VCODICEPADRE = QV.Get("STRRICCODPAD", IDVariant.DECIMAL) ;
        v_VES = QV.Get("STRUTRICLAES", IDVariant.STRING) ;
        v_VTIPORICLID = QV.Get("STRRICTIRIID", IDVariant.DECIMAL) ;
      }
      QV.Close();
      if (v_VIMPACC.equals((new IDVariant("SI")), true))
      {
        return StrutturaRiclId;
      }
      IDVariant v_VSTRURICLIDP = null;
      v_VSTRURICLIDP = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.STRUTTURA_RICL_ID as STRRICSTRIID ");
      SQL.append("from ");
      SQL.append("  STRUTTURA_RICLASSIFICAZIONE A ");
      SQL.append("where (A.LIVELLO = " + IDL.CSql(Livello, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " - 1) ");
      SQL.append("and   (A.CODICE = " + IDL.CSql(v_VCODICEPADRE, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.TIPO_RICL_ID = " + IDL.CSql(v_VTIPORICLID, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(v_VES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VSTRURICLIDP = QV.Get("STRRICSTRIID", IDVariant.DECIMAL) ;
      }
      QV.Close();
      if (Livello.compareTo((new IDVariant(2)), true)<=0)
      {
        if (IDL.NullValue(v_VIMPACC,(new IDVariant("NO"))).equals((new IDVariant("SI")), true))
        {
          return StrutturaRiclId;
        }
        else
        {
          return (new IDVariant());
        }
      }
      else
      {
        return PadreIVOVLivelloRiclassificazioneConImpeco(new IDVariant(v_VSTRURICLIDP,IDVariant.INTEGER), IDL.Sub(Livello, (new IDVariant(1))));
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PadreIVOVLivelloRiclassificazioneConImpeco", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Percorso Immagini
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public IDVariant PercorsoImmagini ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CHIAVE = new IDVariant(0,IDVariant.STRING);
    IDVariant v_STRINGA = new IDVariant(0,IDVariant.STRING);
    IDVariant v_VALORE1 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_VALORE = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      v_CHIAVE = (new IDVariant("PRODUCTS/SO4", IDVariant.STRING));
      v_STRINGA = (new IDVariant("URL", IDVariant.STRING));
      v_VALORE = (new IDVariant("/images/", IDVariant.STRING));
      // 
      // Percorso Immagini Body
      // Procedure Body
      // 
      v_VALORE1 = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGA, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VALORE1 = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      v_VALORE1 = IDL.Add(v_VALORE1, v_VALORE);
      return v_VALORE1;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PercorsoImmagini", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Possibile Liq
  // Anno Imp:  - Input
  // Numero Imp:  - Input
  // Anno Sub Imp:  - Input
  // Numero Sub Imp:  - Input
  // **********************************************************************
  public IDVariant PossibileLiq (IDVariant AnnoImp, IDVariant NumeroImp, IDVariant AnnoSubImp, IDVariant NumeroSubImp)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_TIPOESEC = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Possibile Liq Body
      // Procedure Body
      // 
      IDVariant v_PRENOTAZIONE = new IDVariant(0,IDVariant.STRING);
      IDVariant v_AVVISOPRENOT = new IDVariant(0,IDVariant.STRING);
      v_AVVISOPRENOT = (new IDVariant("Prenotazione non ammessa"));
      if (IDL.NullValue(AnnoSubImp,(new IDVariant(0))).compareTo((new IDVariant(0)), true)!=0 && IDL.NullValue(NumeroSubImp,(new IDVariant(0))).compareTo((new IDVariant(0)), true)!=0)
      {
        IDVariant v_SUBIMPOBB = new IDVariant(0,IDVariant.STRING);
        IDVariant v_ANNODEL = new IDVariant(0,IDVariant.INTEGER);
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.SUBIMP_OBBLIG as SUBIMPOBBLIG, ");
        SQL.append("  A.ANNO_DEL as SUBIMANNODEL ");
        SQL.append("from ");
        SQL.append("  SUBIMP A, ");
        SQL.append("  IMP B ");
        SQL.append("where (A.ANNO_SUBIMP = " + IDL.CSql(AnnoSubImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_SUBIMP = " + IDL.CSql(NumeroSubImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (B.ANNO_IMP = A.ANNO_IMP) ");
        SQL.append("and   (B.NUMERO_IMP = A.NUMERO_IMP) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_SUBIMPOBB = QV.Get("SUBIMPOBBLIG", IDVariant.STRING) ;
          v_ANNODEL = QV.Get("SUBIMANNODEL", IDVariant.INTEGER) ;
        }
        QV.Close();
        if (IDL.IsNull(v_ANNODEL))
        {
          if (IDL.IsNull(v_SUBIMPOBB))
          {
            IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
            v_AVVISO = (new IDVariant("Sub-Impegno non esecutivo. Non è possibile liquidare!", IDVariant.STRING));
            MainFrm.set_AlertMessage(v_AVVISO); 
            return (new IDVariant(-1));
          }
        }
        else
        {
          v_TIPOESEC = (new IDVariant());
          SQL = new StringBuffer();
          SQL.append("select ");
          SQL.append("  A.P_D_E as T10PDE ");
          SQL.append("from ");
          SQL.append("  T10 A, ");
          SQL.append("  DEL B, ");
          SQL.append("  SUBIMP C ");
          SQL.append("where (C.ANNO_SUBIMP = " + IDL.CSql(AnnoSubImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append("and   (C.NUMERO_SUBIMP = " + IDL.CSql(NumeroSubImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append("and   (B.NUMERO_DEL = C.NUMERO_DEL) ");
          SQL.append("and   (B.ANNO_DEL = C.ANNO_DEL) ");
          SQL.append("and   (B.SEDE_DEL = C.SEDE_DEL) ");
          SQL.append("and   (B.TIPO_ESEC = A.CODICE) ");
          QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
          if (!QV.EOF()) QV.MoveNext();
          if (!QV.EOF())
          {
            v_TIPOESEC = QV.Get("T10PDE", IDVariant.STRING) ;
          }
          QV.Close();
          if (v_TIPOESEC.compareTo((new IDVariant("E")), true)!=0)
          {
            IDVariant v_AVVISODELIBE = new IDVariant(0,IDVariant.STRING);
            v_AVVISODELIBE = (new IDVariant("Delibera non esecutiva. Non è possibile liquidare!", IDVariant.STRING));
            MainFrm.set_AlertMessage(v_AVVISODELIBE); 
            return (new IDVariant(-1));
          }
        }
      }
      else
      {
        IDVariant v_IMPOBB = new IDVariant(0,IDVariant.STRING);
        IDVariant v_ANNODEL = new IDVariant(0,IDVariant.INTEGER);
        v_IMPOBB = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.IMPEGNO_OBBLIG as IMPIMPEGOBBL, ");
        SQL.append("  A.ANNO_DEL as SUBIMANNODEL, ");
        SQL.append("  A.PRENOTAZIONE as IMPPRENOTAZI ");
        SQL.append("from ");
        SQL.append("  IMP A ");
        SQL.append("where (A.ANNO_IMP = " + IDL.CSql(AnnoImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_IMP = " + IDL.CSql(NumeroImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_IMPOBB = QV.Get("IMPIMPEGOBBL", IDVariant.STRING) ;
          v_ANNODEL = QV.Get("SUBIMANNODEL", IDVariant.INTEGER) ;
          v_PRENOTAZIONE = QV.Get("IMPPRENOTAZI", IDVariant.STRING) ;
        }
        QV.Close();
        IDVariant v_VPARALIQPREN = new IDVariant(0,IDVariant.STRING);
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.PRENOTAZIONI as PARAMLIQPREN ");
        SQL.append("from ");
        SQL.append("  PARAMETRI_LIQ A ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VPARALIQPREN = QV.Get("PARAMLIQPREN", IDVariant.STRING) ;
        }
        QV.Close();
        if (v_PRENOTAZIONE.equals((new IDVariant("SI")), true) && IDL.NullValue(v_VPARALIQPREN,(new IDVariant("NO"))).compareTo((new IDVariant("SI")), true)!=0)
        {
          MainFrm.set_AlertMessage(v_AVVISOPRENOT); 
          return (new IDVariant(-1));
        }
        if (IDL.IsNull(v_ANNODEL))
        {
          if (IDL.IsNull(v_IMPOBB))
          {
            IDVariant v_AVVISOESECUT = new IDVariant(0,IDVariant.STRING);
            v_AVVISOESECUT = (new IDVariant("Impegno non esecutivo. Non è possibile liquidare!", IDVariant.STRING));
            MainFrm.set_AlertMessage(v_AVVISOESECUT); 
            return (new IDVariant(-1));
          }
        }
        else
        {
          v_TIPOESEC = (new IDVariant());
          SQL = new StringBuffer();
          SQL.append("select ");
          SQL.append("  A.P_D_E as T10PDE ");
          SQL.append("from ");
          SQL.append("  T10 A, ");
          SQL.append("  DEL B, ");
          SQL.append("  IMP C ");
          SQL.append("where (C.ANNO_IMP = " + IDL.CSql(AnnoImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append("and   (C.NUMERO_IMP = " + IDL.CSql(NumeroImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append("and   (B.NUMERO_DEL = C.NUMERO_DEL) ");
          SQL.append("and   (B.ANNO_DEL = C.ANNO_DEL) ");
          SQL.append("and   (B.SEDE_DEL = C.SEDE_DEL) ");
          SQL.append("and   (B.TIPO_ESEC = A.CODICE) ");
          QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
          if (!QV.EOF()) QV.MoveNext();
          if (!QV.EOF())
          {
            v_TIPOESEC = QV.Get("T10PDE", IDVariant.STRING) ;
          }
          QV.Close();
          if (v_TIPOESEC.compareTo((new IDVariant("E")), true)!=0)
          {
            IDVariant v_AVVISODELIBE = new IDVariant(0,IDVariant.STRING);
            v_AVVISODELIBE = (new IDVariant("Delibera non esecutiva. Non è possibile liquidare!", IDVariant.STRING));
            MainFrm.set_AlertMessage(v_AVVISODELIBE); 
            return (new IDVariant(-1));
          }
        }
      }
      return (new IDVariant(0));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PossibileLiq", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Progetti Lk
  // Explain which processing is carried out by this procedure
  // Progetto:  - Input
  // **********************************************************************
  public IDVariant ProgettiLk (IDVariant Progetto)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Progetti Lk Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  PROGETTI A ");
      SQL.append("where (A.PROGETTO_ID = " + IDL.CSql(Progetto, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        return (new IDVariant(-1));
      }
      else
      {
        return (new IDVariant(1));
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ProgettiLk", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Pulisci Messaggio Errore
  // Explain which processing is carried out by this procedure
  // Errore:  - Input
  // **********************************************************************
  public IDVariant PulisciMessaggioErrore (IDVariant Errore)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.STRING);
    IDVariant v_POSIZIONE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Pulisci Messaggio Errore Body
      // Procedure Body
      // 
      v_RETVAL = (new IDVariant());
      v_POSIZIONE = IDL.Find(Errore, (new IDVariant("ORA-")), (new IDVariant(0)));
      if (IDL.NullValue(AFC.GetRegistro((new IDVariant("FILTRA_ERRORI_ORACLE")), (new IDVariant("CFA"))),(new IDVariant("NO"))).compareTo((new IDVariant("SI")), true)!=0)
      {
        return Errore;
      }
      if (v_POSIZIONE.equals((new IDVariant(0)), true))
      {
        v_RETVAL = new IDVariant(Errore);
      }
      else
      {
        v_POSIZIONE = IDL.Find(Errore, (new IDVariant("ORA-")), (new IDVariant(5)));
        if (v_POSIZIONE.equals((new IDVariant(0)), true))
        {
          v_RETVAL = IDL.SubStr(Errore, (new IDVariant(11)), IDL.Sub(IDL.Length(Errore), (new IDVariant(11))));
        }
        else
        {
          v_RETVAL = IDL.SubStr(Errore, (new IDVariant(11)), IDL.Sub(v_POSIZIONE, (new IDVariant(11))));
        }
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PulisciMessaggioErrore", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Record BPR UO
  // Esercizio:  - Input
  // ES:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // **********************************************************************
  public IDVariant RecordBPRUO (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Record BPR UO Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  BPR_UO A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return IDL.NullValue(v_NUMREC,(new IDVariant(0)));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "RecordBPRUO", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Record Bil Fin
  // Esercizio:  - Input
  // E S:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // Opera:  - Input
  // Finanziamento:  - Input
  // **********************************************************************
  public IDVariant RecordBilFin (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo, IDVariant Articolo, IDVariant Opera, IDVariant Finanziamento)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Record Bil Fin Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  BIL_FIN A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = NVL(" + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", A.E_S)) ");
      SQL.append("and   (A.CAPITOLO = NVL(" + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", A.CAPITOLO)) ");
      SQL.append("and   (A.ARTICOLO = NVL(" + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", A.ARTICOLO)) ");
      SQL.append("and   (A.OPERA = NVL(" + IDL.CSql(Opera, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", A.OPERA)) ");
      SQL.append("and   (A.FINANZIAMENTO = NVL(" + IDL.CSql(Finanziamento, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", A.FINANZIAMENTO)) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        return (new IDVariant(-1));
      }
      else
      {
        return v_NUMREC;
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "RecordBilFin", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Record Bil UO
  // Esercizio:  - Input
  // ES:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // **********************************************************************
  public IDVariant RecordBilUO (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Record Bil UO Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  BIL_UO A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return IDL.NullValue(v_NUMREC,(new IDVariant(0)));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "RecordBilUO", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Record Cap UO
  // Esercizio:  - Input
  // ES:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // **********************************************************************
  public IDVariant RecordCapUO (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Record Cap UO Body
      // Procedure Body
      // 
      v_NUMREC = (new IDVariant(0));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  CAP_UO A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.TIPO_UNITA_ORGANIZZATIVA = 'G') ");
      SQL.append("and   ((A.SCADENZA IS NULL) OR A.SCADENZA > TRUNC( SYSDATE )) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return IDL.NullValue(v_NUMREC,(new IDVariant(0)));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "RecordCapUO", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Riclassificazionie Gest
  // E S:  - Input
  // Titolo:  - Input
  // Categoria:  - Input
  // Cod Intervento:  - Input
  // Cod Terzi:  - Input
  // Voce Econ:  - Input
  // Cod Gest:  - Input/Output
  // **********************************************************************
  public IDVariant RiclassificazionieGest (IDVariant ES, IDVariant Titolo, IDVariant Categoria, IDVariant CodIntervento, IDVariant CodTerzi, IDVariant VoceEcon, IDVariant CodGest)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Riclassificazionie Gest Body
      // Procedure Body
      // 
      if (IDL.IsNull(CodGest))
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1, ");
        SQL.append("  MAX(A.CODICE_GESTIONALE) as MAXRICGECOGE ");
        SQL.append("from ");
        SQL.append("  RICLASSIFICAZIONI_GEST A, ");
        SQL.append("  RICLASSIFICAZIONI B, ");
        SQL.append("  CODICI_GESTIONALI C ");
        SQL.append("where (C.CODICE = A.CODICE_GESTIONALE) ");
        SQL.append("and   (A.PROGR_RICLASSIFICAZIONI = B.PROGRESSIVO) ");
        SQL.append("and   (C.E_S = B.E_S) ");
        SQL.append("and   (B.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (B.TITOLO = " + IDL.CSql(Titolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (NVL(B.CATEGORIA, -1) = NVL(" + IDL.CSql(Categoria, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", -1)) ");
        SQL.append("and   (NVL(B.COD_INTERVENTO, -1) = NVL(" + IDL.CSql(CodIntervento, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", -1)) ");
        SQL.append("and   (NVL(B.COD_TERZI, -1) = NVL(" + IDL.CSql(CodTerzi, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", -1)) ");
        SQL.append("and   (B.VOCE_ECON = " + IDL.CSql(VoceEcon, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   ((C.SCADENZA IS NULL) OR C.SCADENZA >= " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
          CodGest.set(QV.Get("MAXRICGECOGE", IDVariant.INTEGER));
        }
        QV.Close();
        if (v_NUMREC.equals((new IDVariant(1)), true))
        {
          return (new IDVariant(1));
        }
        else
        {
          return (new IDVariant(-1));
        }
      }
      else
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  RICLASSIFICAZIONI_GEST A, ");
        SQL.append("  RICLASSIFICAZIONI B, ");
        SQL.append("  CODICI_GESTIONALI C ");
        SQL.append("where (C.CODICE = A.CODICE_GESTIONALE) ");
        SQL.append("and   (A.PROGR_RICLASSIFICAZIONI = B.PROGRESSIVO) ");
        SQL.append("and   (C.E_S = B.E_S) ");
        SQL.append("and   (B.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (B.TITOLO = " + IDL.CSql(Titolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (NVL(B.CATEGORIA, -1) = NVL(" + IDL.CSql(Categoria, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", -1)) ");
        SQL.append("and   (NVL(B.COD_INTERVENTO, -1) = NVL(" + IDL.CSql(CodIntervento, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", -1)) ");
        SQL.append("and   (NVL(B.COD_TERZI, -1) = NVL(" + IDL.CSql(CodTerzi, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", -1)) ");
        SQL.append("and   (B.VOCE_ECON = " + IDL.CSql(VoceEcon, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.CODICE_GESTIONALE = " + IDL.CSql(CodGest, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   ((C.SCADENZA IS NULL) OR C.SCADENZA >= " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
        if (v_NUMREC.compareTo((new IDVariant(1)), true)!=0)
        {
          return (new IDVariant(-1));
        }
        else
        {
          return (new IDVariant(1));
        }
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "RiclassificazionieGest", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Riempi CF4WEB STRUTTURA
  // UO Suddivisione:  - Input
  // **********************************************************************
  public int RiempiCF4WEBSTRUTTURA (IDVariant UOSuddivisione)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Riempi CF4WEB STRUTTURA Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  CF4WEB_STRUTTURA A ");
      SQL.append("where (A.PROGR_SESSIONE = " + IDL.CSql(PROGRESESSIO, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.TIPO_STRUTTURA = 'SICL') ");
      SQL.append("and   (A.PROGR_UNITA_PADRE = " + IDL.CSql(UOSuddivisione, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_NUMREC.equals((new IDVariant(0)), true))
      {
        MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
        MainFrm.Cf4armDBObject.CF4WEBGETDISCENDENTISTRUTT(PROGRESESSIO, UOSuddivisione);
        if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
        {
          MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "RiempiCF4WEBSTRUTTURA", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Riempi Codici Gest
  // E S:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // Proposta:  - Input
  // Voce Econ:  - Input
  // Cap:  - Input
  // Titolo:  - Input
  // Categoria:  - Input
  // Cod Intervento:  - Input
  // Cod Terzi:  - Input
  // **********************************************************************
  public IDVariant RiempiCodiciGest (IDVariant ES, IDVariant Capitolo, IDVariant Articolo, IDVariant Proposta, IDVariant VoceEcon, IDVariant Cap, IDVariant Titolo, IDVariant Categoria, IDVariant CodIntervento, IDVariant CodTerzi)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CODICEGEST = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Riempi Codici Gest Body
      // Procedure Body
      // 
      v_RETVAL = (new IDVariant());
      v_CODICEGEST = (new IDVariant());
      if (Proposta.booleanValue())
      {
        if (Cap.booleanValue())
        {
          SQL = new StringBuffer();
          SQL.append("select ");
          SQL.append("  A.CODICE_GESTIONALE as CAPCODICGEST ");
          SQL.append("from ");
          SQL.append("  CAP A ");
          SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
          if (!QV.EOF()) QV.MoveNext();
          if (!QV.EOF())
          {
            v_CODICEGEST = QV.Get("CAPCODICGEST", IDVariant.INTEGER) ;
          }
          QV.Close();
          v_RETVAL = new IDVariant(v_CODICEGEST);
        }
        else
        {
          if (RiclassificazionieGest(ES, Titolo, Categoria, CodIntervento, CodTerzi, VoceEcon, v_CODICEGEST).equals((new IDVariant(1)), true))
          {
            v_RETVAL = new IDVariant(v_CODICEGEST);
          }
          else
          {
            v_RETVAL = (new IDVariant());
          }
        }
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "RiempiCodiciGest", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Riempi Struttura
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public boolean RiempiStruttura ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Riempi Struttura Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  CF4WEB_STRUTTURA A ");
      SQL.append("where (A.PROGR_SESSIONE = " + IDL.CSql(PROGRESESSIO, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.TIPO_STRUTTURA = 'LG') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.compareTo((new IDVariant(0)), true)!=0)
      {
        return (new IDVariant(0)).booleanValue();
      }
      else
      {
        return (new IDVariant(-1)).booleanValue();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "RiempiStruttura", _e);
      return false;
    }
  }

  // **********************************************************************
  // STANDARD
  // **********************************************************************
  public int STANDARD ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // STANDARD Body
      // Procedure Body
      // 
      // 
      // Inizializzazioni Si4
      // 
      {
        AFC = Afc.CreateAfc(MainFrm,IMDB);
        AFC.Init();
        CaricaMenuRicorsivo();
        AFC.CaricaAbilitazioniInSolaInfo((new IDVariant("CFA")));
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "STANDARD", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Seleziona Importo Varacc
  // Anno Acc:  - Input
  // Numero Acc:  - Input
  // **********************************************************************
  public IDVariant SelezionaImportoVaracc (IDVariant AnnoAcc, IDVariant NumeroAcc)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_IMPORTOVARAC = new IDVariant(0,IDVariant.DECIMAL);

    try
    {
      TransCount = 0;
      // 
      // Seleziona Importo Varacc Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  SUM(NVL(A.IMPORTO, 0)) as SUMNUVAVAIM0 ");
      SQL.append("from ");
      SQL.append("  VARACC A ");
      SQL.append("where (A.NUMERO_ACC = " + IDL.CSql(NumeroAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_ACC = " + IDL.CSql(AnnoAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_VAR = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.PROGRESSIVO > 0) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_IMPORTOVARAC = QV.Get("SUMNUVAVAIM0", IDVariant.DECIMAL) ;
      }
      QV.Close();
      return IDL.NullValue(v_IMPORTOVARAC,(new IDVariant(0)));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SelezionaImportoVaracc", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Sessione
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public IDVariant Sessione ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_SESSIONE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      v_SESSIONE = (new IDVariant(2, IDVariant.INTEGER));
      // 
      // Sessione Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  CF4WEB_SESSIONE_SQ.nextval as CF4ARDBSESSI ");
      SQL.append("from ");
      SQL.append("  DUAL A ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_SESSIONE = QV.Get("CF4ARDBSESSI", IDVariant.INTEGER) ;
      }
      QV.Close();
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
        return (new IDVariant(-1));
      }
      return v_SESSIONE;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Sessione", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Setta Dati Ente
  // **********************************************************************
  public int SettaDatiEnte ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Setta Dati Ente Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.INDIRIZZO as TINDIRIZZO, ");
      SQL.append("  A.COMUNE as TCOMUNE, ");
      SQL.append("  A.PROVINCIA as TPROVINCIA, ");
      SQL.append("  A.CAP as TCAP, ");
      SQL.append("  A.COD_FISCALE as TCODFISCALE, ");
      SQL.append("  A.PARTITA_IVA as TPARTITAIVA, ");
      SQL.append("  A.DENOMINAZIONE as TDENOMINAZIO, ");
      SQL.append("  A.ATTIVITA as TATTIVITA, ");
      SQL.append("  A.TIPO_MO as T64TIPOMO, ");
      SQL.append("  A.CODICE_BDAP as T64CODICBDAP, ");
      SQL.append("  A.TIPO_PROVV as T64TIPOPROVV ");
      SQL.append("from ");
      SQL.append("  T64 A ");
      SQL.append("where (A.PROGRESSIVO = 1) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        IMDB.set_Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_INDIRIZZO, 0, QV.Get("TINDIRIZZO", IDVariant.STRING));
        IMDB.set_Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_COMUNE, 0, QV.Get("TCOMUNE", IDVariant.STRING));
        IMDB.set_Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0, QV.Get("TPROVINCIA", IDVariant.STRING));
        IMDB.set_Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_CAP, 0, QV.Get("TCAP", IDVariant.INTEGER));
        IMDB.set_Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_COD_FISCALE, 0, QV.Get("TCODFISCALE", IDVariant.STRING));
        IMDB.set_Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PARTITA_IVA, 0, QV.Get("TPARTITAIVA", IDVariant.DECIMAL));
        IMDB.set_Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_DENOMINAZIONE, 0, QV.Get("TDENOMINAZIO", IDVariant.STRING));
        IMDB.set_Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_DATIENTEATTI, 0, QV.Get("TATTIVITA", IDVariant.STRING));
        IMDB.set_Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_TIPO_MO, 0, QV.Get("T64TIPOMO", IDVariant.STRING));
        IMDB.set_Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_DATENTCODBDA, 0, QV.Get("T64CODICBDAP", IDVariant.STRING));
        IMDB.set_Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_DATENTTIPPRO, 0, QV.Get("T64TIPOPROVV", IDVariant.STRING));
      }
      QV.Close();
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaDatiEnte", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Setta Dati Jasper
  // **********************************************************************
  public int SettaDatiJasper ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_STRINGAURL = new IDVariant(0,IDVariant.STRING);
    IDVariant v_STRINGPROJEC = new IDVariant(0,IDVariant.STRING);
    IDVariant v_STRINGACONN = new IDVariant(0,IDVariant.STRING);
    IDVariant v_URL = new IDVariant(0,IDVariant.STRING);
    IDVariant v_CONN = new IDVariant(0,IDVariant.STRING);
    IDVariant v_PROJECT = new IDVariant(0,IDVariant.STRING);
    IDVariant v_CHIAVE = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      v_STRINGAURL = (new IDVariant("URL", IDVariant.STRING));
      v_STRINGPROJEC = (new IDVariant("Project ", IDVariant.STRING));
      v_STRINGACONN = (new IDVariant("Conn", IDVariant.STRING));
      v_CHIAVE = (new IDVariant("PRODUCTS/JASPER", IDVariant.STRING));
      // 
      // Setta Dati Jasper Body
      // Procedure Body
      // 
      IDVariant v_URLEXPORT = new IDVariant(0,IDVariant.STRING);
      IDVariant v_STRINGURLEXP = new IDVariant(0,IDVariant.STRING);
      v_STRINGURLEXP = (new IDVariant("URL Servlet Export"));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGAURL, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_URL = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGURLEXP, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_URLEXPORT = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGACONN, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONN = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGPROJEC, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_PROJECT = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      // 
      // 
      // 
      // 
      IMDB.set_Value(IMDBDef7.TBL_DATISTAMJASP, IMDBDef7.FLD_DATISTAMJASP_PARAMETROURL, 0, new IDVariant(v_URL));
      IMDB.set_Value(IMDBDef7.TBL_DATISTAMJASP, IMDBDef7.FLD_DATISTAMJASP_PARAMETRCONN, 0, new IDVariant(v_CONN));
      IMDB.set_Value(IMDBDef7.TBL_DATISTAMJASP, IMDBDef7.FLD_DATISTAMJASP_PARAMEPROJEC, 0, new IDVariant(v_PROJECT));
      IMDB.set_Value(IMDBDef7.TBL_DATISTAMJASP, IMDBDef7.FLD_DATISTAMJASP_PARAMURLEXPO, 0, new IDVariant(v_URLEXPORT));
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaDatiJasper", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Setta Dati Si4print
  // **********************************************************************
  public int SettaDatiSi4print ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CHIAVEINIZIO = new IDVariant(0,IDVariant.STRING);
    IDVariant v_CHIAVEFINE = new IDVariant(0,IDVariant.STRING);
    IDVariant v_PERCORSOSERV = new IDVariant(0,IDVariant.STRING);
    IDVariant v_PERCORSOCF4 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_DATABASE = new IDVariant(0,IDVariant.STRING);
    IDVariant v_PERCDELLSERV = new IDVariant(0,IDVariant.STRING);
    IDVariant v_NOMESERVDATA = new IDVariant(0,IDVariant.STRING);
    IDVariant v_PERCOAPPLCF4 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_CHIAVE = new IDVariant(0,IDVariant.STRING);
    IDVariant v_STRINDATAURL = new IDVariant(0,IDVariant.STRING);
    IDVariant v_CHIAVEMAIL = new IDVariant(0,IDVariant.STRING);
    IDVariant v_DATABASEURL = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      v_CHIAVEINIZIO = (new IDVariant("PRODUCTS/", IDVariant.STRING));
      v_CHIAVEFINE = (new IDVariant("/SI4PRINT", IDVariant.STRING));
      v_PERCORSOSERV = (new IDVariant("Percorso Servlet", IDVariant.STRING));
      v_PERCORSOCF4 = (new IDVariant("Percorso CF4", IDVariant.STRING));
      v_DATABASE = (new IDVariant("Database", IDVariant.STRING));
      v_STRINDATAURL = (new IDVariant("Database URL", IDVariant.STRING));
      v_CHIAVEMAIL = (new IDVariant("MAIL", IDVariant.STRING));
      // 
      // Setta Dati Si4print Body
      // Procedure Body
      // 
      v_CHIAVE = IDL.Add(IDL.Add(v_CHIAVEINIZIO, IDL.Upper(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0))), v_CHIAVEFINE);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_PERCORSOSERV, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_PERCDELLSERV = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_DATABASE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NOMESERVDATA = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_PERCORSOCF4, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_PERCOAPPLCF4 = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVEINIZIO, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEMAIL, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINDATAURL, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_DATABASEURL = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      // IMDB.set_Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PARPERDELSER, 0, (new IDVariant("http://ararat:8080/si4printservlet/si4printservlet.pdf")));
      IMDB.set_Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PARPERDELSER, 0, new IDVariant(v_PERCDELLSERV));
      IMDB.set_Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PARANOMEESEG, 0, (new IDVariant("si4print.exe")));
      IMDB.set_Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PARASERVNAME, 0, new IDVariant(v_NOMESERVDATA));
      IMDB.set_Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PARAPERCAPPL, 0, new IDVariant(v_PERCOAPPLCF4));
      IMDB.set_Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PARCODISTAD4, 0, IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOISTANZ, 0));
      IMDB.set_Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PARDATURLMAI, 0, new IDVariant(v_DATABASEURL));
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaDatiSi4print", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Setta Main Caption
  // **********************************************************************
  public int SettaMainCaption ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Setta Main Caption Body
      // Corpo Procedura
      // 
      MainFrm.set_Caption(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), (new IDVariant("ID"))), ESERCIZIO), (new IDVariant(" ("))), DescrizioneFaseBilancio(FASEBILANCIO)), (new IDVariant(")"))), (new IDVariant(" - "))), IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_DENOMINAZIONE, 0)));
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaMainCaption", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Setta POL Parametri
  // **********************************************************************
  public int SettaPOLParametri ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Setta POL Parametri Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.SUDDIVISIONE_UNITA_SUP as POLPARSUUNSU ");
      SQL.append("from ");
      SQL.append("  POL_PARAMETRI A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        POLSUDUNISUP = QV.Get("POLPARSUUNSU", IDVariant.INTEGER) ;
      }
      QV.Close();
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaPOLParametri", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Setta Parametri Art18
  // **********************************************************************
  public int SettaParametriArt18 ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Setta Parametri Art18 Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.GESTIONE_IMP as PARARTGESIMP, ");
      SQL.append("  A.GESTIONE_LIQ as PARARTGESLIQ, ");
      SQL.append("  A.GESTIONE_ORD as PARARTGESORD, ");
      SQL.append("  A.GESTIONE_DISTINTE as PARARTGESDIS, ");
      SQL.append("  A.SOLO_IMP_ESECUTIVI as PARARTSOIMES, ");
      SQL.append("  A.BLOCCO_ELIMINAZIONE as PARARTBLOELI ");
      SQL.append("from ");
      SQL.append("  PARAMETRI_ART18 A ");
      SQL.append("where (A.PROGRESSIVO = 1) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        GESTIONEIMP = QV.Get("PARARTGESIMP", IDVariant.STRING) ;
        GESTIONELIQ = QV.Get("PARARTGESLIQ", IDVariant.STRING) ;
        GESTIONEORD = QV.Get("PARARTGESORD", IDVariant.STRING) ;
        GESTIODISTIN = QV.Get("PARARTGESDIS", IDVariant.STRING) ;
        SOLOIMPESECU = QV.Get("PARARTSOIMES", IDVariant.STRING) ;
        BLOCCOELIMIN = QV.Get("PARARTBLOELI", IDVariant.STRING) ;
      }
      QV.Close();
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaParametriArt18", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Setta Parametri DOC FE
  // caricamento dei parametri globali per la Fatturazione
  // Elettronica
  // **********************************************************************
  public int SettaParametriDOCFE ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Setta Parametri DOC FE Body
      // Corpo Procedura
      // 
      // 
      // Parametro che serve per abilitare o meno le notifiche
      // per il decentrato in Fatture Elettroniche
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.STRINGA = 'Consenti_accettazione_decentrato') ");
      SQL.append("and   (A.CHIAVE = 'PRODUCTS/FATTURA_ELETTRONICA/SMISTAMENTO') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        FEACCETTADOD = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      FEACCETTADOD = IDL.NullValue(FEACCETTADOD,(new IDVariant("N")));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.STRINGA = 'FEPA_DOCUMENTALE') ");
      SQL.append("and   (A.CHIAVE = 'PRODUCTS/FATTURA_ELETTRONICA') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        GDMCONNTYPE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      if (GDMCONNTYPE.equals((new IDVariant("NO")), true))
      {
        MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_INTERSCAMSDI+BaseCmdLinIdx, (new IDVariant(0)).booleanValue());
      }
      else
      {
        MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_INTERSCAMSDI+BaseCmdLinIdx, (new IDVariant(-1)).booleanValue());
        if (GDMCONNTYPE.equals((new IDVariant("SSO")), true))
        {
          SQL = new StringBuffer();
          SQL.append("select ");
          SQL.append("  A.VALORE as REGISTVALORE ");
          SQL.append("from ");
          SQL.append("  REGISTRO A ");
          SQL.append("where (A.STRINGA = 'FEPA_SSO') ");
          SQL.append("and   (A.CHIAVE = 'PRODUCTS/FATTURA_ELETTRONICA') ");
          QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
          if (!QV.EOF()) QV.MoveNext();
          if (!QV.EOF())
          {
            GDMSSO = QV.Get("REGISTVALORE", IDVariant.STRING) ;
          }
          QV.Close();
        }
        if (GDMCONNTYPE.equals((new IDVariant("DIRETTO")), true))
        {
          SQL = new StringBuffer();
          SQL.append("select ");
          SQL.append("  A.VALORE as REGISTVALORE ");
          SQL.append("from ");
          SQL.append("  REGISTRO A ");
          SQL.append("where (A.STRINGA = 'FEPA_GDM') ");
          SQL.append("and   (A.CHIAVE = 'PRODUCTS/FATTURA_ELETTRONICA') ");
          QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
          if (!QV.EOF()) QV.MoveNext();
          if (!QV.EOF())
          {
            GDMURL = QV.Get("REGISTVALORE", IDVariant.STRING) ;
          }
          QV.Close();
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaParametriDOCFE", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Setta Parametri Iride
  // **********************************************************************
  public int SettaParametriIride ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Setta Parametri Iride Body
      // Corpo Procedura
      // 
      IDVariant v_CHIAVE = new IDVariant(0,IDVariant.STRING);
      v_CHIAVE = (new IDVariant("PRODUCTS/IRIDE"));
      IDVariant v_CHIAVEWS = new IDVariant(0,IDVariant.STRING);
      v_CHIAVEWS = (new IDVariant("/WS"));
      IDVariant v_CHIAVEASP = new IDVariant(0,IDVariant.STRING);
      v_CHIAVEASP = (new IDVariant("/ASP"));
      IDVariant v_CHIAVEFAT = new IDVariant(0,IDVariant.STRING);
      v_CHIAVEFAT = (new IDVariant("/FAT"));
      IDVariant v_CHIAVELIQ = new IDVariant(0,IDVariant.STRING);
      v_CHIAVELIQ = (new IDVariant("/LIQ"));
      IDVariant v_CHIAVEP121 = new IDVariant(0,IDVariant.STRING);
      v_CHIAVEP121 = (new IDVariant("/P121"));
      IDVariant v_CHIAVEP135 = new IDVariant(0,IDVariant.STRING);
      v_CHIAVEP135 = (new IDVariant("/P135"));
      IDVariant v_CHIAVEP140 = new IDVariant(0,IDVariant.STRING);
      v_CHIAVEP140 = (new IDVariant("/P140"));
      IDVariant v_STRINGAURL = new IDVariant(0,IDVariant.STRING);
      v_STRINGAURL = (new IDVariant("URL"));
      IDVariant v_STRINGUTENTE = new IDVariant(0,IDVariant.STRING);
      v_STRINGUTENTE = (new IDVariant("utente"));
      IDVariant v_STRINGPUBBLI = new IDVariant(0,IDVariant.STRING);
      v_STRINGPUBBLI = (new IDVariant("pubblicare"));
      IDVariant v_STRINGAPSW = new IDVariant(0,IDVariant.STRING);
      v_STRINGAPSW = (new IDVariant("pwd"));
      IDVariant v_STRINGARUOLO = new IDVariant(0,IDVariant.STRING);
      v_STRINGARUOLO = (new IDVariant("ruolo"));
      IDVariant v_STRINGAGGIOR = new IDVariant(0,IDVariant.STRING);
      v_STRINGAGGIOR = (new IDVariant("aggiorna"));
      IDVariant v_STRIENTENOME = new IDVariant(0,IDVariant.STRING);
      v_STRIENTENOME = (new IDVariant("ente_nome"));
      IDVariant v_STRINCODIAMM = new IDVariant(0,IDVariant.STRING);
      v_STRINCODIAMM = (new IDVariant("codice amministrazione"));
      IDVariant v_STRINGTRATTA = new IDVariant(0,IDVariant.STRING);
      v_STRINGTRATTA = (new IDVariant("trattamento"));
      IDVariant v_STRINGCLASSI = new IDVariant(0,IDVariant.STRING);
      v_STRINGCLASSI = (new IDVariant("classifica"));
      IDVariant v_VALORE = new IDVariant(0,IDVariant.STRING);
      IDVariant v_DOCUMENTALE = new IDVariant(0,IDVariant.STRING);
      v_DOCUMENTALE = (new IDVariant("documentale"));
      IDVariant v_DOCUIRIDATTI = new IDVariant(0,IDVariant.STRING);
      v_DOCUIRIDATTI = (new IDVariant("documentale_iride_attiva"));
      if (AFC.GetComando(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), v_DOCUMENTALE).equals(v_DOCUIRIDATTI, true))
      {
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_DOCUMENIRIDE, 0, (new IDVariant("SI")));
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEWS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINCODIAMM, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDCODAMMWS, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEWS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVELIQ, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGTRATTA, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDETRATTWS, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEWS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEFAT, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGCLASSI, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDCLAWSFAT, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEWS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVELIQ, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGCLASSI, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDCLAWSLIQ, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEWS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEFAT, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGUTENTE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDUTEWSFAT, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEWS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEFAT, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGARUOLO, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDRUOWSFAT, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEWS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVELIQ, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGUTENTE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDUTEWSLIQ, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEWS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVELIQ, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGPUBBLI, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDPUBWSLIQ, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEASP, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGAURL, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDEURLASP, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEASP, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRIENTENOME, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDEENTEASP, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEASP, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEP121, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGUTENTE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDUTENP121, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEASP, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEP135, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGUTENTE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDUTENP135, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEASP, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEP140, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGUTENTE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDUTENP140, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEASP, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEP121, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGAPSW, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDEPWDP121, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEASP, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEP135, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGAPSW, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDEPWDP135, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEASP, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEP140, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGAPSW, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDEPWDP140, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEASP, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEP121, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGARUOLO, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDRUOLP121, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEASP, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEP135, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGARUOLO, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDRUOLP135, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEASP, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEP140, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGARUOLO, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDRUOLP140, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEASP, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEP121, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGAGGIOR, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDAGGIP121, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEASP, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEP135, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGAGGIOR, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDAGGIP135, 0, new IDVariant(v_VALORE));
        v_VALORE = (new IDVariant());
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.VALORE as REGISTVALORE ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEASP, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEP140, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGAGGIOR, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VALORE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_IRIDAGGIP140, 0, new IDVariant(v_VALORE));
      }
      else
      {
        IMDB.set_Value(IMDBDef7.TBL_PARAMETIRIDE, IMDBDef7.FLD_PARAMETIRIDE_DOCUMENIRIDE, 0, (new IDVariant()));
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaParametriIride", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Setta Parametri LIQ
  // **********************************************************************
  public int SettaParametriLIQ ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Setta Parametri LIQ Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.INTEGRAZIONE_GDM as PARLIQINTGDM, ");
      SQL.append("  A.SCADENZA_DIST as PARLIQSCADIS ");
      SQL.append("from ");
      SQL.append("  PARAMETRI_LIQ A ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        INTEGRGDMLIQ = QV.Get("PARLIQINTGDM", IDVariant.STRING) ;
        SCADENZADIST = QV.Get("PARLIQSCADIS", IDVariant.STRING) ;
      }
      QV.Close();
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaParametriLIQ", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Setta Parametri MANORD INF XML
  // **********************************************************************
  public int SettaParametriMANORDINFXML ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Setta Parametri MANORD INF XML Body
      // Corpo Procedura
      // 
      IDVariant v_MODCRE = new IDVariant(0,IDVariant.STRING);
      v_MODCRE = (new IDVariant("MODCRE"));
      IDVariant v_SERVLETURL = new IDVariant(0,IDVariant.STRING);
      v_SERVLETURL = (new IDVariant("SERVLET_URL"));
      IDVariant v_DIMMAXFILE = new IDVariant(0,IDVariant.STRING);
      v_DIMMAXFILE = (new IDVariant("DIM_MAX_FILE"));
      IDVariant v_MAXDETTFILE = new IDVariant(0,IDVariant.STRING);
      v_MAXDETTFILE = (new IDVariant("MAX_DETT_FILE"));
      IDVariant v_VALIDAZIFILE = new IDVariant(0,IDVariant.STRING);
      v_VALIDAZIFILE = (new IDVariant("VALIDAZIONE_FILE"));
      IDVariant v_SIOPELINK = new IDVariant(0,IDVariant.STRING);
      v_SIOPELINK = (new IDVariant("SIOPELINK"));
      IDVariant v_LIIVTIDESIIV = new IDVariant(0,IDVariant.STRING);
      v_LIIVTIDESIIV = (new IDVariant("LIVELLO_IV_TIPO_DEBITO_SIOPE_IVA"));
      IDVariant v_CODIDOCNOCOM = new IDVariant(0,IDVariant.STRING);
      v_CODIDOCNOCOM = (new IDVariant("CODICI_DOC_NO_COMM"));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.DESCRIZIONE as PARMANINXMDE ");
      SQL.append("from ");
      SQL.append("  PARAMETRI_MANORD_INF_XML A ");
      SQL.append("where (A.PARAMETRO = " + IDL.CSql(v_MODCRE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        MODALCREAXML = QV.Get("PARMANINXMDE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.DESCRIZIONE as PARMANINXMDE ");
      SQL.append("from ");
      SQL.append("  PARAMETRI_MANORD_INF_XML A ");
      SQL.append("where (A.PARAMETRO = " + IDL.CSql(v_SERVLETURL, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        SERVLETURL = QV.Get("PARMANINXMDE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  DECODE(A.DESCRIZIONE, NULL, to_number(NULL), TRUNC(TO_NUMBER(A.DESCRIZIONE))) as IEPMIXDNTIPM ");
      SQL.append("from ");
      SQL.append("  PARAMETRI_MANORD_INF_XML A ");
      SQL.append("where (A.PARAMETRO = " + IDL.CSql(v_DIMMAXFILE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        DIMMAXFILE = QV.Get("IEPMIXDNTIPM", IDVariant.INTEGER) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  DECODE(A.DESCRIZIONE, NULL, to_number(NULL), TRUNC(TO_NUMBER(A.DESCRIZIONE))) as IEPMIXDNTIPM ");
      SQL.append("from ");
      SQL.append("  PARAMETRI_MANORD_INF_XML A ");
      SQL.append("where (A.PARAMETRO = " + IDL.CSql(v_MAXDETTFILE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        MAXDETTFILE = QV.Get("IEPMIXDNTIPM", IDVariant.INTEGER) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.DESCRIZIONE as PARMANINXMDE ");
      SQL.append("from ");
      SQL.append("  PARAMETRI_MANORD_INF_XML A ");
      SQL.append("where (A.PARAMETRO = " + IDL.CSql(v_VALIDAZIFILE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        VALIDAZIFILE = QV.Get("PARMANINXMDE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  NVL(A.DESCRIZIONE, 'NO') as NUVAPAMAIXDN ");
      SQL.append("from ");
      SQL.append("  PARAMETRI_MANORD_INF_XML A ");
      SQL.append("where (A.PARAMETRO = " + IDL.CSql(v_SIOPELINK, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        SIOPELINK = QV.Get("NUVAPAMAIXDN", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.DESCRIZIONE as PARMANINXMDE ");
      SQL.append("from ");
      SQL.append("  PARAMETRI_MANORD_INF_XML A ");
      SQL.append("where (A.PARAMETRO = " + IDL.CSql(v_LIIVTIDESIIV, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        LIIVTIDESIIV = QV.Get("PARMANINXMDE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.DESCRIZIONE as PARMANINXMDE ");
      SQL.append("from ");
      SQL.append("  PARAMETRI_MANORD_INF_XML A ");
      SQL.append("where (A.PARAMETRO = " + IDL.CSql(v_CODIDOCNOCOM, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        CODIDOCNOCOM = QV.Get("PARMANINXMDE", IDVariant.STRING) ;
      }
      QV.Close();
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaParametriMANORDINFXML", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Setta Parametri MINF
  // **********************************************************************
  public int SettaParametriMINF ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Setta Parametri MINF Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.DATA_INIZIO_MAND_INF as PAMIDAINMAIN, ");
      SQL.append("  A.DATA_INIZIO_ORD_INF as PAMIDAINORIN, ");
      SQL.append("  A.TIPO_MINF as PARATIPOMINF, ");
      SQL.append("  A.CODICE_TESORERIA as PARMINCODTES, ");
      SQL.append("  A.CODICE_ENTE as PARMINCODENT, ");
      SQL.append("  A.CODICE_FILIALE as PARMINCODFIL, ");
      SQL.append("  A.PRIMO_PROG_TESO as PARMINPRPRTE, ");
      SQL.append("  A.TIPO_SUB_MAN as PARMINTISUMA, ");
      SQL.append("  A.MOD_PAGAM_DIVERSE as PARMINMOPADI, ");
      SQL.append("  A.GESTIONE_SPESE as PARMINGESSPE, ");
      SQL.append("  A.GESIONE_COMMISSIONI as PARMINGESCOM, ");
      SQL.append("  A.GESTIONE_ALLEGATI as PARMINGESALL, ");
      SQL.append("  A.GESTIONE_INFO_TESORIERE as PARMINGEINTE, ");
      SQL.append("  A.GESTIONE_ORD_ASSOCIATI as PARMINGEORAS, ");
      SQL.append("  A.GESTIONE_ANNULLI as PARMINGESANN, ");
      SQL.append("  A.GESTIONE_SOSTITUZIONI as PARMINGESSOS, ");
      SQL.append("  A.GESTIONE_VARIAZIONI as PARMINGESVAR, ");
      SQL.append("  A.TIPO_SUB_ORD as PARMINTISUOR, ");
      SQL.append("  A.TIPO_INC_PAG as PARMINTIINPA, ");
      SQL.append("  A.GENERA_XML as PARMINGENXML, ");
      SQL.append("  A.SPESE_DA_SOGGETTO as PARMINSPDASO, ");
      SQL.append("  A.MANDATI_COPERTURA as PARMINMANCOP ");
      SQL.append("from ");
      SQL.append("  PARAMETRI_MINF A ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        DATA_INIZIO_MAND_INF = QV.Get("PAMIDAINMAIN", IDVariant.DATETIME) ;
        DATA_INIZIO_ORD_INF = QV.Get("PAMIDAINORIN", IDVariant.DATETIME) ;
        TIPO_MINF = QV.Get("PARATIPOMINF", IDVariant.STRING) ;
        CODICE_TESORERIA = QV.Get("PARMINCODTES", IDVariant.STRING) ;
        CODICE_ENTE = QV.Get("PARMINCODENT", IDVariant.STRING) ;
        CODICE_FILIALE = QV.Get("PARMINCODFIL", IDVariant.STRING) ;
        PRIMO_PROG_TESO = QV.Get("PARMINPRPRTE", IDVariant.INTEGER) ;
        TIPO_SUB_MAN = QV.Get("PARMINTISUMA", IDVariant.STRING) ;
        MOD_PAGAM_DIVERSE = QV.Get("PARMINMOPADI", IDVariant.STRING) ;
        GESTIONSPESE = QV.Get("PARMINGESSPE", IDVariant.STRING) ;
        GESTIOCOMMIS = QV.Get("PARMINGESCOM", IDVariant.STRING) ;
        GESTIOALLEGA = QV.Get("PARMINGESALL", IDVariant.STRING) ;
        GESTINFOTESO = QV.Get("PARMINGEINTE", IDVariant.STRING) ;
        GESTIONE_ORD_ASSOCIATI = QV.Get("PARMINGEORAS", IDVariant.STRING) ;
        GESTIONE_ANNULLI = QV.Get("PARMINGESANN", IDVariant.STRING) ;
        GESTIONE_SOSTITUZIONI = QV.Get("PARMINGESSOS", IDVariant.STRING) ;
        GESTIONE_VARIAZIONI = QV.Get("PARMINGESVAR", IDVariant.STRING) ;
        TIPO_SUB_ORD = QV.Get("PARMINTISUOR", IDVariant.STRING) ;
        TIPO_INC_PAG = QV.Get("PARMINTIINPA", IDVariant.STRING) ;
        GENERA_XML = QV.Get("PARMINGENXML", IDVariant.STRING) ;
        SPESE_DA_SOGGETTO = QV.Get("PARMINSPDASO", IDVariant.STRING) ;
        MANDATCOPERT = QV.Get("PARMINMANCOP", IDVariant.STRING) ;
      }
      QV.Close();
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaParametriMINF", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Setta Parametri OD
  // **********************************************************************
  public int SettaParametriOD ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Setta Parametri OD Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.GESTIONE_BOLLE as PARAODGESBOL, ");
      SQL.append("  A.TOLLERANZA_CONTROLLO as PARAODTOLCON, ");
      SQL.append("  A.CONTROLLO_ORDINI_RES as PARODCONORRE, ");
      SQL.append("  A.AGG_DATA_EMISS_O as PARODAGDAEMO, ");
      SQL.append("  A.AGG_VOCE_ECON_O as PARODAGVOECO, ");
      SQL.append("  A.AGG_CGU_O as PARODAGGCGUO, ");
      SQL.append("  A.AGG_FATTORE_O as PARODAGGFATO, ");
      SQL.append("  A.AGG_PREZZO_O as PARODAGGPREO, ");
      SQL.append("  A.ID_SUDDIVISIONE_UNITA_SUP_D as PAODIDSUUNSD, ");
      SQL.append("  A.AGG_QUIETANZA_DISP as PARODAGGQUDI, ");
      SQL.append("  A.ST_COD_FORNITORE_D as PARODSTCOFOD, ");
      SQL.append("  A.ST_CGU_D as PARAODSTCGUD, ");
      SQL.append("  A.ST_FATTORE_D as PARAODSTFATD, ");
      SQL.append("  A.ST_CENTRO_D as PARAODSTCEND, ");
      SQL.append("  A.ST_SCADENZA_D as PARAODSTSCAD, ");
      SQL.append("  A.ST_UTENTE_D as PARAODSTUTED, ");
      SQL.append("  A.SCADENZA_DISTINTA_O as PARODSCADISO, ");
      SQL.append("  A.LIQUIDABILE_CONTR_FATT as PARODLIQCOFA, ");
      SQL.append("  A.INTEGRAZIONE_GDM as PARAODINTGDM, ");
      SQL.append("  A.PUBBLICA_AUTOM_ART18 as PARODPUBAUAR, ");
      SQL.append("  A.GESTIONE_VARBUONI as PARAODGESVAR, ");
      SQL.append("  A.CONTR_DATA_BUONO_FAT as PAODCODABUFA ");
      SQL.append("from ");
      SQL.append("  PARAMETRI_OD A ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        GESTIONBOLLE = QV.Get("PARAODGESBOL", IDVariant.STRING) ;
        TOLLERANZA_CONTROLLO = QV.Get("PARAODTOLCON", IDVariant.DECIMAL) ;
        CONTROLLO_ORDINI_RES = QV.Get("PARODCONORRE", IDVariant.INTEGER) ;
        AGG_DATA_EMISS_O = QV.Get("PARODAGDAEMO", IDVariant.INTEGER) ;
        AGG_VOCE_ECON_O = QV.Get("PARODAGVOECO", IDVariant.STRING) ;
        AGG_CGU_O = QV.Get("PARODAGGCGUO", IDVariant.STRING) ;
        AGG_FATTORE_O = QV.Get("PARODAGGFATO", IDVariant.STRING) ;
        AGG_PREZZO_O = QV.Get("PARODAGGPREO", IDVariant.STRING) ;
        IDSUDUNISUPD = QV.Get("PAODIDSUUNSD", IDVariant.INTEGER) ;
        AGGQUIETDISP = QV.Get("PARODAGGQUDI", IDVariant.STRING) ;
        ST_COD_FORNITORE_D = QV.Get("PARODSTCOFOD", IDVariant.STRING) ;
        ST_CGU_D = QV.Get("PARAODSTCGUD", IDVariant.STRING) ;
        ST_FATTORE_D = QV.Get("PARAODSTFATD", IDVariant.STRING) ;
        ST_CENTRO_D = QV.Get("PARAODSTCEND", IDVariant.STRING) ;
        ST_SCADENZA_D = QV.Get("PARAODSTSCAD", IDVariant.STRING) ;
        ST_UTENTE_D = QV.Get("PARAODSTUTED", IDVariant.STRING) ;
        SCADENZA_DISTINTA_O = QV.Get("PARODSCADISO", IDVariant.STRING) ;
        LIQUCONTFATT = QV.Get("PARODLIQCOFA", IDVariant.STRING) ;
        INTEGRAZIONE_GDM = QV.Get("PARAODINTGDM", IDVariant.STRING) ;
        PUBBAUTOART1 = QV.Get("PARODPUBAUAR", IDVariant.STRING) ;
        GESTIOVARBUO = QV.Get("PARAODGESVAR", IDVariant.STRING) ;
        CONDATBUOFAT = QV.Get("PAODCODABUFA", IDVariant.STRING) ;
      }
      QV.Close();
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaParametriOD", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Setta Parametri Registro
  // **********************************************************************
  public int SettaParametriRegistro ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Setta Parametri Registro Body
      // Corpo Procedura
      // 
      IDVariant v_PRODUCTS = new IDVariant(0,IDVariant.STRING);
      v_PRODUCTS = (new IDVariant("PRODUCTS/"));
      IDVariant v_CHIAVE2 = new IDVariant(0,IDVariant.STRING);
      v_CHIAVE2 = (new IDVariant("/DOCUMENTI/DUPLICA"));
      IDVariant v_CHIAVE3 = new IDVariant(0,IDVariant.STRING);
      v_CHIAVE3 = (new IDVariant("/PIANO_DEI_CONTI"));
      IDVariant v_CHIAVE4 = new IDVariant(0,IDVariant.STRING);
      v_CHIAVE4 = (new IDVariant("/DISTINTE"));
      IDVariant v_CHIAVE5 = new IDVariant(0,IDVariant.STRING);
      v_CHIAVE5 = (new IDVariant("/CRONOPROGRAMMI"));
      IDVariant v_STRIBDAPREND = new IDVariant(0,IDVariant.STRING);
      v_STRIBDAPREND = (new IDVariant("/BDAP_RENDICONTO"));
      IDVariant v_STRIBDAPPREV = new IDVariant(0,IDVariant.STRING);
      v_STRIBDAPPREV = (new IDVariant("/BDAP_PREVENTIVO"));
      IDVariant v_SEGDATMAAR18 = new IDVariant(0,IDVariant.STRING);
      v_SEGDATMAAR18 = (new IDVariant("Segnala dati mancanti art 18"));
      IDVariant v_DIRCENTRALE = new IDVariant(0,IDVariant.STRING);
      v_DIRCENTRALE = (new IDVariant("Dir. Centrale"));
      IDVariant v_BLOCCOPROPOS = new IDVariant(0,IDVariant.STRING);
      v_BLOCCOPROPOS = (new IDVariant("Blocco Proposta"));
      IDVariant v_PERCSALVSTAM = new IDVariant(0,IDVariant.STRING);
      v_PERCSALVSTAM = (new IDVariant("Percorso Salvataggio Stampe"));
      IDVariant v_ESEPIADECOMO = new IDVariant(0,IDVariant.STRING);
      v_ESEPIADECOMO = (new IDVariant("Esercizio Piano dei Conti modificato"));
      IDVariant v_DATAEMISSION = new IDVariant(0,IDVariant.STRING);
      v_DATAEMISSION = (new IDVariant("Data emissione"));
      IDVariant v_CODICEUTENZA = new IDVariant(0,IDVariant.STRING);
      v_CODICEUTENZA = (new IDVariant("Codice utenza"));
      IDVariant v_DATAARRIVO = new IDVariant(0,IDVariant.STRING);
      v_DATAARRIVO = (new IDVariant("Data arrivo"));
      IDVariant v_NUMEPROTGENE = new IDVariant(0,IDVariant.STRING);
      v_NUMEPROTGENE = (new IDVariant("Numero protocollo generale"));
      IDVariant v_DATAPROTINTE = new IDVariant(0,IDVariant.STRING);
      v_DATAPROTINTE = (new IDVariant("Data protocollo interno"));
      IDVariant v_GUIDUNITGEST = new IDVariant(0,IDVariant.STRING);
      v_GUIDUNITGEST = (new IDVariant("Guida Unita Gestione"));
      IDVariant v_GUIDUNITUTIL = new IDVariant(0,IDVariant.STRING);
      v_GUIDUNITUTIL = (new IDVariant("Guida Unita Utilizzo"));
      IDVariant v_MODDISELILIQ = new IDVariant(0,IDVariant.STRING);
      v_MODDISELILIQ = (new IDVariant("Modifica distinta in eliminazione liquidazione"));
      IDVariant v_PRIMESERARMO = new IDVariant(0,IDVariant.STRING);
      v_PRIMESERARMO = (new IDVariant("Primo Esercizio Armonizzazione"));
      IDVariant v_DISTINPARZIA = new IDVariant(0,IDVariant.STRING);
      v_DISTINPARZIA = (new IDVariant("Distinte Parziali"));
      IDVariant v_GENVARIMPSUB = new IDVariant(0,IDVariant.STRING);
      v_GENVARIMPSUB = (new IDVariant("Generazione Variazioni Imp./Sub."));
      IDVariant v_GESTTRATMIST = new IDVariant(0,IDVariant.STRING);
      v_GESTTRATMIST = (new IDVariant("GESTISCI_TRATTAMENTI_MISTI"));
      IDVariant v_CHIAVINTEPBM = new IDVariant(0,IDVariant.STRING);
      v_CHIAVINTEPBM = (new IDVariant("PRODUCTS/INTEGRAZIONE_PBM"));
      IDVariant v_STRINGAPBM = new IDVariant(0,IDVariant.STRING);
      v_STRINGAPBM = (new IDVariant("Integrazione PBM"));
      IDVariant v_ATTIVASTATIS = new IDVariant(0,IDVariant.STRING);
      v_ATTIVASTATIS = (new IDVariant("Attivazione Statistiche"));
      IDVariant v_PRIESECONECO = new IDVariant(0,IDVariant.STRING);
      v_PRIESECONECO = (new IDVariant("Primo Esercizio Contabilita Economica"));
      IDVariant v_STRINGFE = new IDVariant(0,IDVariant.STRING);
      v_STRINGFE = (new IDVariant("BLOCCO_MODIFICHE_FE"));
      IDVariant v_DETTIMPENETT = new IDVariant(0,IDVariant.STRING);
      v_DETTIMPENETT = (new IDVariant("Dettaglio Impegno Netto"));
      IDVariant v_SERURLSIOPLU = new IDVariant(0,IDVariant.STRING);
      v_SERURLSIOPLU = (new IDVariant("Server URL Siope Link"));
      IDVariant v_GESTCONTECON = new IDVariant(0,IDVariant.STRING);
      v_GESTCONTECON = (new IDVariant("Gestione Contabilita Economica"));
      IDVariant v_CHIAVEFE = new IDVariant(0,IDVariant.STRING);
      v_CHIAVEFE = (new IDVariant("PRODUCTS/FATTURA_ELETTRONICA"));
      IDVariant v_NUMESEPLUFCD = new IDVariant(0,IDVariant.STRING);
      v_NUMESEPLUFCD = (new IDVariant("Numero Esercizi Pluriennali FCDDE"));
      IDVariant v_NUMESEPLUFPV = new IDVariant(0,IDVariant.STRING);
      v_NUMESEPLUFPV = (new IDVariant("Numero Esercizi Pluriennali FPV"));
      IDVariant v_SOSPFATTURE = new IDVariant(0,IDVariant.STRING);
      v_SOSPFATTURE = (new IDVariant("SOSP_FATTURE"));
      IDVariant v_COMPFUNZSMIS = new IDVariant(0,IDVariant.STRING);
      v_COMPFUNZSMIS = (new IDVariant("COMPETENZA_FUNZIONI_SMISTAMENTO"));
      IDVariant v_SALVFILESTAM = new IDVariant(0,IDVariant.STRING);
      v_SALVFILESTAM = (new IDVariant("Salvataggio File Stampa"));
      IDVariant v_CHIAVEFCE = null;
      v_CHIAVEFCE = (new IDVariant("PRODUCTS/FCE"));
      IDVariant v_ATTIVAFCE = null;
      v_ATTIVAFCE = (new IDVariant("Attiva Collegamento Fascicolo Contabile"));
      IDVariant v_URLFCE = null;
      v_URLFCE = (new IDVariant("Url FCE"));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_SEGDATMAAR18, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        SEGDATMANART = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_DIRCENTRALE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        DIRCENTRALE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_BLOCCOPROPOS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        BLOCCOPROPOS = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_PERCSALVSTAM, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        PERCSTAMPERS = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_ESEPIADECOMO, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        ESEPIACONMOD = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVE2, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_DATAEMISSION, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        DATAEMISSION = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVE2, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_CODICEUTENZA, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        CODICEUTENZA = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVE2, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_DATAARRIVO, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        UTENDATAARRI = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVE2, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_NUMEPROTGENE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        NUMEPROTGENE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVE2, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_DATAPROTINTE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        DATAPROTINTE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVE3, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_GUIDUNITGEST, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        GUIDAUOGESTI = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVE3, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_GUIDUNITUTIL, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        GUIDAUOUTILI = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || 'CFAOD' || " + IDL.CSql(v_CHIAVE4, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_MODDISELILIQ, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        MODDISELILIQ = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      PRIMOESERARM = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_PRIMESERARMO, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        PRIMOESERARM = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || 'CFAOD' || " + IDL.CSql(v_CHIAVE4, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_DISTINPARZIA, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        DISTINPARZIA = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVE5, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_GENVARIMPSUB, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        GENVARIMPSUB = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = 'LIQ_CAMPO_LIBERO_1') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        LABECAMPLIB1 = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = 'LIQ_CAMPO_LIBERO_2') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        LABECAMPLIB2 = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = 'VISUALIZZA_CHECK_DISTINTA') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        VISUCHECDIST = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || 'FATTURA_ELETTRONICA') ");
      SQL.append("and   (A.STRINGA = 'LABEL_ACCETTA') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        LABELACCETTA = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || 'FATTURA_ELETTRONICA') ");
      SQL.append("and   (A.STRINGA = 'CONSENTI_RIFIUTO') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        CONSENRIFIUT = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  NVL(A.VALORE, 'NO') as NULVALREVANO ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || 'FATTURA_ELETTRONICA') ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_GESTTRATMIST, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        GESTTRATMIST = QV.Get("NULVALREVANO", IDVariant.STRING) ;
      }
      QV.Close();
      INTEGRAZIPBM = (new IDVariant("NO"));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  NVL(A.VALORE, 'NO') as NULVALREVANO ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVINTEPBM, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRINGAPBM, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        INTEGRAZIPBM = QV.Get("NULVALREVANO", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_ATTIVASTATIS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        ATTIVASTATIS = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_STRIBDAPREND, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_GESTCONTECON, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        GESTCONTECON = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_STRIBDAPREND, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_PRIESECONECO, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        PRIESECONECO = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || 'CFACE') ");
      SQL.append("and   (A.STRINGA = 'SIBEC') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        SIBEC = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_DETTIMPENETT, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        DETTIMPENETT = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.STRINGA = 'URL Campi Aggiuntivi') ");
      SQL.append("and   (A.CHIAVE = 'PRODUCTS/GDM') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        URLCAMPIAGGI = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.STRINGA = " + IDL.CSql(v_SERURLSIOPLU, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CHIAVE = 'PRODUCTS/GDM') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        URLWSGDMSIOP = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.STRINGA = 'INTEGRAZIONE_PCC') ");
      SQL.append("and   (A.CHIAVE = 'PRODUCTS/PCC') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        INTEGRAZIPCC = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.STRINGA = 'PCC_MAX_NUM') ");
      SQL.append("and   (A.CHIAVE = 'PRODUCTS/PCC') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        PCCMAXNUM = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      if (IDL.NullValue(PCCMAXNUM,(new IDVariant(""))).equals((new IDVariant("")), true))
      {
        PCCMAXNUM = (new IDVariant("0"));
      }
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.STRINGA = 'DATA_INIZIO_DOC') ");
      SQL.append("and   (A.CHIAVE = 'PRODUCTS/PCC') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        DATAINIZIDOC = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.STRINGA = 'MOD_DOCUMENTO') ");
      SQL.append("and   (A.CHIAVE = 'PRODUCTS/PCC') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        MODDOCUMENTO = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.STRINGA = 'ESITO_DOC_002') ");
      SQL.append("and   (A.CHIAVE = 'PRODUCTS/PCC') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        ESITODOC002 = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  NVL(INDE_FE_PASSIVA.TROVA_REGISTRO(" + IDL.CSql(v_CHIAVEFE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(v_STRINGFE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + "), 'N') as NVIFPTRCFSFN ");
      SQL.append("from ");
      SQL.append("  DUAL A ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        BLOCCMODIFFE = QV.Get("NVIFPTRCFSFN", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = 'PRODUCTS/CFA') ");
      SQL.append("and   (A.STRINGA = 'Modifica Reiscr Stn Imp') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        MODREISTNIMP = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  NVL(A.VALORE, 'N') as NULVALREGVAN ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.STRINGA = 'FORZA_SCADENZA') ");
      SQL.append("and   (A.CHIAVE = " + IDL.CSql(v_CHIAVEFE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        FORZASCADENZ = QV.Get("NULVALREGVAN", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  TRUNC(TO_NUMBER(NVL(A.VALORE, '1'))) as TOINNUVAREV1 ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_STRIBDAPPREV, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_NUMESEPLUFCD, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        NUMESEPLUFCD = QV.Get("TOINNUVAREV1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (IDL.IsNull(NUMESEPLUFCD))
      {
        NUMESEPLUFCD = (new IDVariant(1));
      }
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  TRUNC(TO_NUMBER(NVL(A.VALORE, '1'))) as TOINNUVAREV1 ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_STRIBDAPPREV, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_NUMESEPLUFPV, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        NUMESEPLUFPV = QV.Get("TOINNUVAREV1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (IDL.IsNull(NUMESEPLUFPV))
      {
        NUMESEPLUFPV = (new IDVariant(1));
      }
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_SOSPFATTURE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        SOSPFATTURE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = 'PRODUCTS/FATTURA_ELETTRONICA/SMISTAMENTO') ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_COMPFUNZSMIS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        COMPFUNZSMIS = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      IDVariant v_CHIACOMUFATT = null;
      v_CHIACOMUFATT = (new IDVariant("PRODUCTS/CFA/COMUNICAZIONE_FATTURE"));
      IDVariant v_STRIPERIINVI = null;
      v_STRIPERIINVI = (new IDVariant("PERIODO_INVIO"));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIACOMUFATT, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_STRIPERIINVI, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        PERINVCOMFAT = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      if (IDL.IsNull(PERINVCOMFAT))
      {
        PERINVCOMFAT = (new IDVariant("TRIMESTRALE"));
      }
      IDVariant v_SPERIINVIEST = null;
      v_SPERIINVIEST = (new IDVariant("PERIODO_INVIO_ESTEROMETRO"));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIACOMUFATT, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_SPERIINVIEST, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        PERINVCOFAES = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      if (IDL.IsNull(PERINVCOFAES))
      {
        PERINVCOFAES = (new IDVariant("MENSILE"));
      }
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || '/STAMPE') ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_SALVFILESTAM, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        SALVFILESTAM = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = 'PRODUCTS/CFA/RIACCERTAMENTI') ");
      SQL.append("and   (A.STRINGA = 'IMPORTO_UFFS_ZERO') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        IMPOUFFSZERO = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      // 
      // Fascicolo contabile (FCE)
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVEFCE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_ATTIVAFCE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        FCEATTCOFACO = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_CHIAVEFCE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_URLFCE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        FCEURL = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = 'PRODUCTS/CFA/RIACCERTAMENTI') ");
      SQL.append("and   (A.STRINGA = 'TIPO_VAR_OBBLIGATORIO') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        TIPOVAROBBLI = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaParametriRegistro", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Setta Parametri T99
  // **********************************************************************
  public int SettaParametriT99 ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_GESTDEL = new IDVariant(0,IDVariant.STRING);
    IDVariant v_CASSAECON = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Setta Parametri T99 Body
      // Procedure Body
      // 
      IDVariant v_VGESTIOFINAN = new IDVariant(0,IDVariant.STRING);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.PROC_DEL as T99PROCDEL, ");
      SQL.append("  NVL(A.GESTIONE_ECONOMICA, -1) as NULVAT9GEEC1, ");
      SQL.append("  NVL(A.TIPO_ORD, -2) as NULVAT9TIOR2, ");
      SQL.append("  A.PROCEDURA_BUONI as T99PROCEBUON, ");
      SQL.append("  A.ACC_CF4OF as T99ACCCF4OF, ");
      SQL.append("  A.ORDIN_PROGETTI as T99ORDINPROG, ");
      SQL.append("  NVL(A.FIN_SUB, 'SI') as NUVAT9FISUSI, ");
      SQL.append("  NVL(A.FILTRO_OBIETTIVO, 'NO') as NUVAT9FIOBNO, ");
      SQL.append("  A.OBIETTIVO_OBBLIG as T99OBIETOBBL, ");
      SQL.append("  NVL(A.CONTROLLO_FIN_IMPEGNO, 'NO') as NUVAT9COFIIN, ");
      SQL.append("  A.MODALITA_IMPUTAZIONE as T99MODALIMPU, ");
      SQL.append("  A.MODALITA_IMPUTAZIONE_E as T99MODAIMPUE, ");
      SQL.append("  NVL(A.RESPONSABILE_RES, 'NO') as NUVAT9RERENO, ");
      SQL.append("  NVL(A.GESTIONE_IMPEGNABILE, 'NO') as NUVAT9GEIMNO, ");
      SQL.append("  A.CASSA_ECONOMALE as T99CASSAECON, ");
      SQL.append("  A.RETTE as T99RETTE, ");
      SQL.append("  A.CONTROLLO_COMPETENZA_FIN as T99CONCOFIFI, ");
      SQL.append("  A.CORR_MOD as T99CORRMOD, ");
      SQL.append("  A.FLAG_RITORNO_CC_PROVV as T99FLARICCPR, ");
      SQL.append("  A.LIQ_MO as T99LIQMO, ");
      SQL.append("  A.DATA_INIZIO_SIOPE as T99DATINISIO, ");
      SQL.append("  A.PROC_PERS as T99PROCPERS, ");
      SQL.append("  A.ORD_ELENCO_DOC as T99ORDELEDO1, ");
      SQL.append("  A.ORDINE_STAMPA_MANDATI as T99ORDSTAMAN, ");
      SQL.append("  A.CONTROLLO_SERCOS as T99CONTRSERC, ");
      SQL.append("  A.SE_IMP_NEG_LIQ_PERS as T9SEIMNELIPE, ");
      SQL.append("  A.BLOCCO_STN_TESTATA as T99BLOSTNTES, ");
      SQL.append("  A.BLOCCO_TIPO_VAR as T99BLOTIPVAR, ");
      SQL.append("  A.TIPO_ENTE as T99TIPOENTE, ");
      SQL.append("  A.TIPO_SFMA as T99TIPOSFMA, ");
      SQL.append("  A.GESTIONE_FATTURAZIONE as T99GESTIFATT, ");
      SQL.append("  A.TIPO_TOT_LIQ_MULTIPLA as T99TIPTOLIMU, ");
      SQL.append("  A_GET_SE_OBIETTIVI_POL(" + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") as CFDBAGSOP1SE, ");
      SQL.append("  A.TRACCIATO_PERS as T99TRACCPERS, ");
      SQL.append("  A.ABILITA_IMP_DOC as T99ABIIMPDOC, ");
      SQL.append("  A.GESTIONE_BARCODE as T99GESTIBARC, ");
      SQL.append("  A.VAR_NQ as T99VARNQ, ");
      SQL.append("  A.PROGETTO_OBBLIG_IST as T99PROOBBIST, ");
      SQL.append("  A.CODICE_PERS as T99CODICPERS, ");
      SQL.append("  A.ESERCIZIO_INIZIO_WEB as T99ESEINIWEB, ");
      SQL.append("  A.CAUSALE_LIQ_AUTO as T99CAULIQAUT, ");
      SQL.append("  A.FILTRO_EC as T99FILTROEC, ");
      SQL.append("  A.FLAG_EC_MO as T99FLAGECMO, ");
      SQL.append("  A.G_I as T99GI, ");
      SQL.append("  A.TIPO_EMISS_ACC_PROVV as T99TIPEMACPR, ");
      SQL.append("  A.CONTROLLO_PC as T99CONTROLPC, ");
      SQL.append("  A.IMPORTO_CONTROLLO_EQUITALIA as T99IMPCONEQU, ");
      SQL.append("  A.DATA_RIF_RITENUTE as T99DATRIFRIT, ");
      SQL.append("  A.ORD_ELENCO_DOC as T99ORDELEDOC, ");
      SQL.append("  A.CONTROLLO_IVA_LIQ as T99CONIVALIQ, ");
      SQL.append("  A.BLOCCO_FATTURA_DOPPIA as T99BLOFATDOP, ");
      SQL.append("  A.FLAG_IVA_NON_SOG as T99FLAIVNOSO, ");
      SQL.append("  A.PVB_PS4 as T99PVBPS4, ");
      SQL.append("  A.DATA_INIZIO_GEST_CRONO_UO as T9DAINGECRUO, ");
      SQL.append("  A.DATA_FINE_GEST_CRONO_UO as T9DAFIGECRUO, ");
      SQL.append("  A.CONTROLLO_CASSA_VPRO_LIQ as T99CONCAVPLI, ");
      SQL.append("  A.CONTROLLO_CASSA_VPRO_IN_EMISS as T9COCAVPINEM, ");
      SQL.append("  A.NUM_OPE_AUTO as T99NUMOPEAUT, ");
      SQL.append("  A.CONTROLLO_IMP_PROV as T99CONIMPPRO, ");
      SQL.append("  A.FILTRO_FATTORI_PCF as T99FILFATPCF, ");
      SQL.append("  A.VOCE_TECNICA_OPERA as T99VOCTECOPE, ");
      SQL.append("  A.PERIODICITA_VERS_IVA as T99PERVERIVA, ");
      SQL.append("  A.RAGGRUPPAMENTO_VERS_IVA as T99RAGVERIVA, ");
      SQL.append("  A.CONTROLLO_RIL_IVA as T99CONRILIVA, ");
      SQL.append("  A.GESTIONE_FINANZIAMENTI as T99GESTIFINA, ");
      SQL.append("  A.NUM_FIN_AUTO as T99NUMFINAUT, ");
      SQL.append("  A.FATTORI_ARCONET as T99FATTOARCO, ");
      SQL.append("  A.CONTROLLO_REGISTRI_LIQ_FAT as T99CONRELIFA, ");
      SQL.append("  DECODE(GET_SIOPE_ATTIVO_ARM(" + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "), 'SI', -1, 0) as IFEGSAASESTF, ");
      SQL.append("  NVL(A.ECO_STAND_ALONE, 'NO') as NUVAT9ECSTAN, ");
      SQL.append("  A.GESTIONE_CESPITI as T99GESTICESP, ");
      SQL.append("  A.PASSAGGIO_CI4 as T99PASSAGCI4, ");
      SQL.append("  A.EMISS_PARZ_PROVV_S as T99EMIPARPRS, ");
      SQL.append("  A.COLLEGAMENTO_DUP as T99COLLEGDUP, ");
      SQL.append("  A.MOVI_LIQ_CI4_SU_IMMOB as T9MOLICISUIM, ");
      SQL.append("  A.DATA_ESIG_IVA as T99DATESIIVA ");
      SQL.append("from ");
      SQL.append("  T99 A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_GESTDEL = QV.Get("T99PROCDEL", IDVariant.STRING) ;
        GESTIOECONOM = QV.Get("NULVAT9GEEC1", IDVariant.INTEGER) ;
        TIPOORDINATI = QV.Get("NULVAT9TIOR2", IDVariant.INTEGER) ;
        PROCEDUBUONI = QV.Get("T99PROCEBUON", IDVariant.STRING) ;
        GESTIACCCF4O = QV.Get("T99ACCCF4OF", IDVariant.STRING) ;
        ORDINAPROGET = QV.Get("T99ORDINPROG", IDVariant.STRING) ;
        FINSUB = QV.Get("NUVAT9FISUSI", IDVariant.STRING) ;
        FILTROOBIETT = QV.Get("NUVAT9FIOBNO", IDVariant.STRING) ;
        OBIETTOBBLIG = QV.Get("T99OBIETOBBL", IDVariant.STRING) ;
        CONTRFINIMPE = QV.Get("NUVAT9COFIIN", IDVariant.STRING) ;
        MODAIMPUSPES = QV.Get("T99MODALIMPU", IDVariant.STRING) ;
        MODAIMPUENTR = QV.Get("T99MODAIMPUE", IDVariant.STRING) ;
        RESPONSABRES = QV.Get("NUVAT9RERENO", IDVariant.STRING) ;
        GESTIOIMPEGN = QV.Get("NUVAT9GEIMNO", IDVariant.STRING) ;
        v_CASSAECON = QV.Get("T99CASSAECON", IDVariant.INTEGER) ;
        RETTE = QV.Get("T99RETTE", IDVariant.STRING) ;
        CONTRCOMPFIN = QV.Get("T99CONCOFIFI", IDVariant.STRING) ;
        CORRISMODIFI = QV.Get("T99CORRMOD", IDVariant.STRING) ;
        RITORCCPROVV = QV.Get("T99FLARICCPR", IDVariant.STRING) ;
        LIQMO = QV.Get("T99LIQMO", IDVariant.STRING) ;
        DATAINIZSIOP = QV.Get("T99DATINISIO", IDVariant.DATETIME) ;
        PROCEDPERSON = QV.Get("T99PROCPERS", IDVariant.INTEGER) ;
        ORDIELENDOCU = QV.Get("T99ORDELEDO1", IDVariant.INTEGER) ;
        ORDISTAMMAND = QV.Get("T99ORDSTAMAN", IDVariant.INTEGER) ;
        CONTROSERCOS = QV.Get("T99CONTRSERC", IDVariant.STRING) ;
        SEIMPNEGLIPE = QV.Get("T9SEIMNELIPE", IDVariant.STRING) ;
        BLOCCSTNTEST = QV.Get("T99BLOSTNTES", IDVariant.STRING) ;
        BLOCCTIPOVAR = QV.Get("T99BLOTIPVAR", IDVariant.STRING) ;
        TIPOENTE = QV.Get("T99TIPOENTE", IDVariant.STRING) ;
        TIPOSFMA = QV.Get("T99TIPOSFMA", IDVariant.STRING) ;
        GESTIOFATTUR = QV.Get("T99GESTIFATT", IDVariant.STRING) ;
        TIPTOTLIQMUL = QV.Get("T99TIPTOLIMU", IDVariant.INTEGER) ;
        GESTOBIEATTI = QV.Get("CFDBAGSOP1SE", IDVariant.INTEGER) ;
        TRACCIATPERS = QV.Get("T99TRACCPERS", IDVariant.STRING) ;
        ABILITIMPDOC = QV.Get("T99ABIIMPDOC", IDVariant.STRING) ;
        GESTIOBARCOD = QV.Get("T99GESTIBARC", IDVariant.STRING) ;
        TIPOVARNQ = QV.Get("T99VARNQ", IDVariant.STRING) ;
        PROGETOBBLIG = QV.Get("T99PROOBBIST", IDVariant.STRING) ;
        CODICEPERS = QV.Get("T99CODICPERS", IDVariant.STRING) ;
        ESERCIZIO_INIZIO_WEB = QV.Get("T99ESEINIWEB", IDVariant.INTEGER) ;
        CAUSALE_LIQ_AUTO = QV.Get("T99CAULIQAUT", IDVariant.STRING) ;
        FILTRO_EC = QV.Get("T99FILTROEC", IDVariant.INTEGER) ;
        FLAG_EC_MO = QV.Get("T99FLAGECMO", IDVariant.INTEGER) ;
        G_I = QV.Get("T99GI", IDVariant.STRING) ;
        TIPO_EMISS_ACC_PROVV = QV.Get("T99TIPEMACPR", IDVariant.INTEGER) ;
        CONTROLLO_PC = QV.Get("T99CONTROLPC", IDVariant.STRING) ;
        IMPOCONTEQUI = QV.Get("T99IMPCONEQU", IDVariant.DECIMAL) ;
        DATARIFRITEN = QV.Get("T99DATRIFRIT", IDVariant.STRING) ;
        ORDIELENDOCU = QV.Get("T99ORDELEDOC", IDVariant.INTEGER) ;
        CONTROIVALIQ = QV.Get("T99CONIVALIQ", IDVariant.STRING) ;
        BLOCFATTDOPP = QV.Get("T99BLOFATDOP", IDVariant.STRING) ;
        FLAIVANONSOG = QV.Get("T99FLAIVNOSO", IDVariant.STRING) ;
        PVBPS4 = QV.Get("T99PVBPS4", IDVariant.INTEGER) ;
        INIZGESTCRON = QV.Get("T9DAINGECRUO", IDVariant.DATETIME) ;
        FINEGESTCRON = QV.Get("T9DAFIGECRUO", IDVariant.DATETIME) ;
        CONTRCASSLIQ = QV.Get("T99CONCAVPLI", IDVariant.INTEGER) ;
        CONCASLIQEMI = QV.Get("T9COCAVPINEM", IDVariant.INTEGER) ;
        NUMOPEAUTO = QV.Get("T99NUMOPEAUT", IDVariant.STRING) ;
        CONTRIMPPROV = QV.Get("T99CONIMPPRO", IDVariant.STRING) ;
        FILTRFATTPCF = QV.Get("T99FILFATPCF", IDVariant.STRING) ;
        VOCETECNOPER = QV.Get("T99VOCTECOPE", IDVariant.STRING) ;
        PERIOVERSIVA = QV.Get("T99PERVERIVA", IDVariant.STRING) ;
        RAGGRVERSIVA = QV.Get("T99RAGVERIVA", IDVariant.STRING) ;
        CONTRORILIVA = QV.Get("T99CONRILIVA", IDVariant.STRING) ;
        v_VGESTIOFINAN = QV.Get("T99GESTIFINA", IDVariant.STRING) ;
        NUMFINAUTO = QV.Get("T99NUMFINAUT", IDVariant.STRING) ;
        FATTORARCONE = QV.Get("T99FATTOARCO", IDVariant.STRING) ;
        CONREGLIQFAT = QV.Get("T99CONRELIFA", IDVariant.STRING) ;
        SIOPEATTIARM = QV.Get("IFEGSAASESTF", IDVariant.INTEGER) ;
        ECOSTANDALON = QV.Get("NUVAT9ECSTAN", IDVariant.STRING) ;
        GESTIOCESPIT = QV.Get("T99GESTICESP", IDVariant.INTEGER) ;
        PASSAGGIOCI4 = QV.Get("T99PASSAGCI4", IDVariant.STRING) ;
        EMISPARZPROS = QV.Get("T99EMIPARPRS", IDVariant.STRING) ;
        COLLEGAMEDUP = QV.Get("T99COLLEGDUP", IDVariant.STRING) ;
        MOVLIQCISUIM = QV.Get("T9MOLICISUIM", IDVariant.STRING) ;
        DATAESIGIVA = QV.Get("T99DATESIIVA", IDVariant.STRING) ;
      }
      QV.Close();
      if (v_GESTDEL.equals((new IDVariant("SI")), true))
      {
        GESTIODELIBE = (new IDVariant(-1));
      }
      else
      {
        GESTIODELIBE = (new IDVariant(0));
      }
      if (v_CASSAECON.equals((new IDVariant(4)), true))
      {
        INTEGRAZIGC4 = (new IDVariant(-1));
      }
      else
      {
        INTEGRAZIGC4 = (new IDVariant(0));
      }
      if (IDL.NullValue(v_VGESTIOFINAN,(new IDVariant("NO"))).equals((new IDVariant("SI")), true))
      {
        FINANZIAMENT = (new IDVariant(-1));
      }
      else
      {
        FINANZIAMENT = (new IDVariant(0));
      }
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        RETVALT99 = (new IDVariant(-1));
        CONTRFINIMPE = (new IDVariant("NO"));
      }
      else
      {
        RETVALT99 = (new IDVariant(0));
      }
      FASEBILANCIO = ControllaEsefin(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0));
      IMDB.set_Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSCFPEATTI, 0, CfpegAttivo());
      DisabilitaComandiDaCodice();
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaParametriT99", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Setta Parametri Trasco
  // **********************************************************************
  public int SettaParametriTrasco ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Setta Parametri Trasco Body
      // Procedure Body
      // 
      TIPOTRASCO = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.TIPO_TRASCO as PARATIPOTRAS ");
      SQL.append("from ");
      SQL.append("  PARAMETRI_TRASCO A ");
      SQL.append("where (A.PROGRESSIVO = 1) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        TIPOTRASCO = QV.Get("PARATIPOTRAS", IDVariant.STRING) ;
      }
      QV.Close();
      if (IDL.IsNull(TIPOTRASCO))
      {
        PROVENIENCF4 = (new IDVariant("S"));
      }
      else
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.PROVENIENZA_CF4 as TIPTRAPROCF4 ");
        SQL.append("from ");
        SQL.append("  TIPI_TRASCO A ");
        SQL.append("where (A.TIPO_TRASCO = " + IDL.CSql(TIPOTRASCO, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          PROVENIENCF4 = QV.Get("TIPTRAPROCF4", IDVariant.STRING) ;
        }
        QV.Close();
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaParametriTrasco", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Setta Parametri WEB
  // **********************************************************************
  public int SettaParametriWEB ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Setta Parametri WEB Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.SUDDIVISIONE_UNITA_SUP as PARWEBSUUNSU, ");
      SQL.append("  A.SUDDIVISIONE_UNITA_SUP_2 as PARWESUUNSU2, ");
      SQL.append("  A.OTTICA as PARAMWEBOTTI, ");
      SQL.append("  A.ATTI_LIQ as PARWEBATTLIQ, ");
      SQL.append("  A.SUDDIVISIONE_UFFICIO as PARWEBSUDUFF, ");
      SQL.append("  A.COMPETENZA_FINANZIAMENTI as PARWEBCOMFIN, ");
      SQL.append("  A.PLUGIN_SFERA as PARWEBPLUSFE, ");
      SQL.append("  A.PLUGIN_DISTLIQ as PARWEBPLUDI1, ");
      SQL.append("  A.PLUGIN_DISTORD as PARWEBPLUDI2, ");
      SQL.append("  A.PLUGIN_DISTECON as PARWEBPLUDIS, ");
      SQL.append("  A.ANAGRAFE_CONDIVISA as PARWEBANACON ");
      SQL.append("from ");
      SQL.append("  PARAMETRI_WEB A ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        SUDDIVISIONE_UNITA_SUP = QV.Get("PARWEBSUUNSU", IDVariant.INTEGER) ;
        SUDDUNITSUP2 = QV.Get("PARWESUUNSU2", IDVariant.INTEGER) ;
        OTTICA = QV.Get("PARAMWEBOTTI", IDVariant.STRING) ;
        ATTILIQ = QV.Get("PARWEBATTLIQ", IDVariant.STRING) ;
        SUDDIVUFFICI = QV.Get("PARWEBSUDUFF", IDVariant.INTEGER) ;
        COMPETFINANZ = QV.Get("PARWEBCOMFIN", IDVariant.STRING) ;
        PLUGINSFERA = QV.Get("PARWEBPLUSFE", IDVariant.STRING) ;
        PLUGINDISTLI = QV.Get("PARWEBPLUDI1", IDVariant.STRING) ;
        PLUGINDISTOR = QV.Get("PARWEBPLUDI2", IDVariant.STRING) ;
        PLUGINDISTEC = QV.Get("PARWEBPLUDIS", IDVariant.STRING) ;
        ANAGRACONDIV = QV.Get("PARWEBANACON", IDVariant.STRING) ;
      }
      QV.Close();
      COMPETENZA = (new IDVariant("TU"));
      IDVariant v_VDUP = new IDVariant(0,IDVariant.STRING);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as DUPIMPOSVALO ");
      SQL.append("from ");
      SQL.append("  DUP_IMPOSTAZIONI A ");
      SQL.append("where (A.CODICE = 'GESTIONE_MGP') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VDUP = QV.Get("DUPIMPOSVALO", IDVariant.STRING) ;
      }
      QV.Close();
      if (IDL.NullValue(v_VDUP,(new IDVariant("N"))).equals((new IDVariant("Y")), true))
      {
        INTEMPOBIGES = (new IDVariant("SI"));
      }
      else
      {
        INTEMPOBIGES = (new IDVariant("NO"));
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaParametriWEB", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Setta Quietanza Beneficiario
  // Beneficiario:  - Input
  // Data:  - Input
  // **********************************************************************
  public IDVariant SettaQuietanzaBeneficiario (IDVariant Beneficiario, IDVariant Data)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_QUIETANZA = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Setta Quietanza Beneficiario Body
      // Procedure Body
      // 
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      // SQL = new StringBuffer();
      // SQL.append("select ");
      // SQL.append("  MIN(A.NUM_QUIETANZA) as MINQTNNUMQUI ");
      // SQL.append("from ");
      // SQL.append("  QTN A ");
      // SQL.append("where (A.CODICE = " + IDL.CSql(Beneficiario, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      // SQL.append("and   ((A.SCADENZA IS NULL) OR A.SCADENZA >= " + IDL.CSql(Data, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ") ");
      // QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      // if (!QV.EOF()) QV.MoveNext();
      // if (!QV.EOF())
      // {
      //   v_QUIETANZA = QV.Get("MINQTNNUMQUI", IDVariant.INTEGER) ;
      // }
      // QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  MIN(A.NUM_QUIETANZA) as MINQTNNUMQUI ");
      SQL.append("from ");
      SQL.append("  QTN A ");
      SQL.append("where (A.CODICE = " + IDL.CSql(Beneficiario, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((A.SCADENZA IS NULL) OR A.SCADENZA >= " + IDL.CSql(Data, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.PREVALENTE = 'SI') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_QUIETANZA = QV.Get("MINQTNNUMQUI", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (IDL.IsNull(v_QUIETANZA))
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  MIN(A.NUM_QUIETANZA) as MINQTNNUMQUI ");
        SQL.append("from ");
        SQL.append("  QTN A ");
        SQL.append("where (A.CODICE = " + IDL.CSql(Beneficiario, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   ((A.SCADENZA IS NULL) OR A.SCADENZA >= " + IDL.CSql(Data, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_QUIETANZA = QV.Get("MINQTNNUMQUI", IDVariant.INTEGER) ;
        }
        QV.Close();
      }
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
        return (new IDVariant());
      }
      else
      {
        return v_QUIETANZA;
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaQuietanzaBeneficiario", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Sottostringapb
  // Restituisce la parte sinistra della stringa fino ad
  // arrivare al carattere selezionato+
  // Stringa: Stringa parametro - Input/Output
  // sottostringa: Sottostringa da ricercare - Input
  // **********************************************************************
  public IDVariant Sottostringapb (IDVariant Stringa, IDVariant sottostringa)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_LUNGHESTRING = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_LUNGHESOTTOS = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_DARESTITUIRE = new IDVariant(0,IDVariant.STRING);
    IDVariant v_TEMP = new IDVariant(0,IDVariant.STRING);
    IDVariant v_LUNGHEZZA = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Sottostringapb Body
      // Procedure Body
      // 
      v_TEMP = new IDVariant(Stringa);
      v_LUNGHEZZA = IDL.Length(Stringa);
      while (v_LUNGHESTRING.compareTo(v_LUNGHESOTTOS, true)>=0)
      {
        v_LUNGHESTRING = IDL.Length(v_TEMP);
        v_LUNGHESOTTOS = IDL.Length(sottostringa);
        if (IDL.Left(v_TEMP, v_LUNGHESOTTOS).equals(sottostringa, true))
        {
          break;
        }
        else
        {
          v_DARESTITUIRE = IDL.Add(v_DARESTITUIRE, IDL.Left(v_TEMP, v_LUNGHESOTTOS));
          v_TEMP = IDL.Right(v_TEMP, IDL.Sub(v_LUNGHESTRING, v_LUNGHESOTTOS));
        }
      }
      Stringa.set(IDL.Right(Stringa, IDL.Sub(IDL.Sub(v_LUNGHEZZA, IDL.Length(v_DARESTITUIRE)), (new IDVariant(1)))));
      return v_DARESTITUIRE;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Sottostringapb", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Stanziamento Voce Peg
  // Esercizio:  - Input
  // ES:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // **********************************************************************
  public IDVariant StanziamentoVocePeg (IDVariant Esercizio, IDVariant ES, IDVariant Capitolo, IDVariant Articolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_STANZIAMENTO = new IDVariant(0,IDVariant.DECIMAL);

    try
    {
      TransCount = 0;
      // 
      // Stanziamento Voce Peg Body
      // Procedure Body
      // 
      v_STANZIAMENTO = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  NVL(A.STN_INI_CO, 0) + NVL(A.VARIAZIONI_CO, 0) as NVBSICZNVBVC ");
      SQL.append("from ");
      SQL.append("  BIL A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.E_S = " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_STANZIAMENTO = QV.Get("NVBSICZNVBVC", IDVariant.DECIMAL) ;
      }
      QV.Close();
      return v_STANZIAMENTO;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "StanziamentoVocePeg", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Sub Esesub
  // Explain which processing is carried out by this procedure
  // AnnoSub:  - Input
  // NumeroSub:  - Input
  // Capitolo:  - Input/Output
  // Articolo:  - Input/Output
  // AnnoImp:  - Input/Output
  // NumeroImp:  - Input/Output
  // **********************************************************************
  public boolean SubEsesub (IDVariant AnnoSub, IDVariant NumeroSub, IDVariant Capitolo, IDVariant Articolo, IDVariant AnnoImp, IDVariant NumeroImp)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_RET = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Sub Esesub Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1, ");
      SQL.append("  A.CAPITOLO as ESESUBCAPITO, ");
      SQL.append("  A.ARTICOLO as ESESUBARTICO, ");
      SQL.append("  A.ANNO_IMP as ESESUANNOIMP, ");
      SQL.append("  A.NUMERO_IMP as ESESUNUMEIMP ");
      SQL.append("from ");
      SQL.append("  ESESUB A ");
      SQL.append("where (A.ANNO_SUBIMP = " + IDL.CSql(AnnoSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_SUBIMP = " + IDL.CSql(NumeroSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("group by ");
      SQL.append("  A.CAPITOLO, ");
      SQL.append("  A.ARTICOLO, ");
      SQL.append("  A.ANNO_IMP, ");
      SQL.append("  A.NUMERO_IMP ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
        Capitolo.set(QV.Get("ESESUBCAPITO", IDVariant.DECIMAL));
        Articolo.set(QV.Get("ESESUBARTICO", IDVariant.INTEGER));
        AnnoImp.set(QV.Get("ESESUANNOIMP", IDVariant.INTEGER));
        NumeroImp.set(QV.Get("ESESUNUMEIMP", IDVariant.INTEGER));
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
        v_MESSAGGIO = (new IDVariant("Sub-impegno di Spesa non previsto in Bilancio.", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_MESSAGGIO); 
        v_RET = (new IDVariant(0));
      }
      else
      {
        if (v_CONTATORE.compareTo((new IDVariant(0)), true)>0)
        {
          v_RET = (new IDVariant(-1));
        }
      }
      return v_RET.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SubEsesub", _e);
      return false;
    }
  }

  // **********************************************************************
  // Sub Imp Presente
  // Anno Sub Imp:  - Input
  // Numero Sub Imp:  - Input
  // **********************************************************************
  public IDVariant SubImpPresente (IDVariant AnnoSubImp, IDVariant NumeroSubImp)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Sub Imp Presente Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  SUBIMP A ");
      SQL.append("where (A.ANNO_SUBIMP = " + IDL.CSql(AnnoSubImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_SUBIMP = " + IDL.CSql(NumeroSubImp, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.equals((new IDVariant(0)), true))
      {
        IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
        v_MESSAGGIO = (new IDVariant("Sub-Impegno di Spesa non previsto in Bilancio", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_MESSAGGIO); 
        v_RETVAL = (new IDVariant(-1));
      }
      else
      {
        v_RETVAL = (new IDVariant(1));
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SubImpPresente", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Tipo Fattore
  // Fattore:  - Input
  // Tipo:  - Input/Output
  // **********************************************************************
  public IDVariant TipoFattore (IDVariant Fattore, IDVariant Tipo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Tipo Fattore Body
      // Procedure Body
      // 
      Tipo.set((new IDVariant()));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.TIPO as FATTORITIPO ");
      SQL.append("from ");
      SQL.append("  FATTORI A ");
      SQL.append("where (A.FATTORE = " + IDL.CSql(Fattore, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        Tipo.set(QV.Get("FATTORITIPO", IDVariant.STRING));
      }
      QV.Close();
      if (Tipo.equals((new IDVariant()), true))
      {
        v_RETVAL = (new IDVariant(-1));
        return v_RETVAL;
      }
      v_RETVAL = (new IDVariant(0));
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "TipoFattore", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Tot Finanziato Var Acc
  // Anno Acc:  - Input
  // Numero Acc:  - Input
  // **********************************************************************
  public IDVariant TotFinanziatoVarAcc (IDVariant AnnoAcc, IDVariant NumeroAcc)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_IMPORTOVARAC = new IDVariant(0,IDVariant.DECIMAL);

    try
    {
      TransCount = 0;
      // 
      // Tot Finanziato Var Acc Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  SUM(DECODE(A.OPERA, to_number(NULL), 0, NVL(A.IMPORTO, 0))) as SIEVON0NVVI0 ");
      SQL.append("from ");
      SQL.append("  VARACC A ");
      SQL.append("where (A.NUMERO_ACC = " + IDL.CSql(NumeroAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_ACC = " + IDL.CSql(AnnoAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_VAR = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.PROGRESSIVO > 0) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_IMPORTOVARAC = QV.Get("SIEVON0NVVI0", IDVariant.DECIMAL) ;
      }
      QV.Close();
      return IDL.NullValue(v_IMPORTOVARAC,(new IDVariant(0)));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "TotFinanziatoVarAcc", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Totale Record Finanziamenti
  // E S:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // Opera:  - Input
  // **********************************************************************
  public IDVariant TotaleRecordFinanziamenti (IDVariant ES, IDVariant Capitolo, IDVariant Articolo, IDVariant Opera)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Totale Record Finanziamenti Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  FINANZIAMENTI A, ");
      SQL.append("  BEN B, ");
      SQL.append("  CATEGORIE_FIN C, ");
      SQL.append("  BIL_FIN D ");
      SQL.append("where (A.ENTE = B.CODICE(+)) ");
      SQL.append("and   (A.CATEGORIA = C.CODICE(+)) ");
      SQL.append("and   (D.FINANZIAMENTO(+) = A.CODICE) ");
      SQL.append("and   ((A.SCADENZA IS NULL) OR A.SCADENZA >= " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (NVL(D.ESERCIZIO, -1) = DECODE(" + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", -1, NVL(D.ESERCIZIO, -1), " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ")) ");
      SQL.append("and   (NVL(D.E_S, '-1') = DECODE(" + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", '-1', NVL(D.E_S, '-1'), " + IDL.CSql(ES, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ")) ");
      SQL.append("and   (NVL(D.CAPITOLO, -1) = DECODE(" + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", -1, NVL(D.CAPITOLO, -1), " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ")) ");
      SQL.append("and   (NVL(D.ARTICOLO, -1) = DECODE(" + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", -1, NVL(D.ARTICOLO, -1), " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ")) ");
      SQL.append("and   (NVL(D.OPERA, -1) = DECODE(" + IDL.CSql(Opera, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", -1, NVL(D.OPERA, -1), " + IDL.CSql(Opera, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ")) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return v_NUMREC;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "TotaleRecordFinanziamenti", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Totale Record Opere
  // Anno Acc:  - Input
  // Numero Acc:  - Input
  // **********************************************************************
  public IDVariant TotaleRecordOpere (IDVariant AnnoAcc, IDVariant NumeroAcc)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Totale Record Opere Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  ACC_OPE A ");
      SQL.append("where (A.ANNO_ACC = " + IDL.CSql(AnnoAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_ACC = " + IDL.CSql(NumeroAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return v_NUMREC;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "TotaleRecordOpere", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Totale Record Pluriennali
  // Anno Acc:  - Input
  // Numero Acc:  - Input
  // **********************************************************************
  public IDVariant TotaleRecordPluriennali (IDVariant AnnoAcc, IDVariant NumeroAcc)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Totale Record Pluriennali Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  ACC A ");
      SQL.append("where ((A.ANNO_PLUR = " + IDL.CSql(AnnoAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " AND A.NUMERO_PLUR = " + IDL.CSql(NumeroAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") OR (A.ANNO_ACC > " + IDL.CSql(AnnoAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " AND EXISTS(");
      SQL.append("( ");
      SQL.append("select ");
      SQL.append("  1 ");
      SQL.append("from ");
      SQL.append("  ACC B ");
      SQL.append("where (B.ANNO_PLUR = A.ANNO_PLUR) ");
      SQL.append("and   (B.NUMERO_PLUR = A.NUMERO_PLUR) ");
      SQL.append("and   (B.ANNO_ACC = " + IDL.CSql(AnnoAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (B.NUMERO_ACC = " + IDL.CSql(NumeroAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_ACC > B.ANNO_ACC) ");
      SQL.append(")))) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return v_NUMREC;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "TotaleRecordPluriennali", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Totale Record Variazioni
  // Anno Acc:  - Input
  // Numero Acc:  - Input
  // **********************************************************************
  public IDVariant TotaleRecordVariazioni (IDVariant AnnoAcc, IDVariant NumeroAcc)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Totale Record Variazioni Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  VARACC A ");
      SQL.append("where (A.ANNO_ACC = " + IDL.CSql(AnnoAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_ACC = " + IDL.CSql(NumeroAcc, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_VAR = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.PROGRESSIVO > 0) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      return v_NUMREC;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "TotaleRecordVariazioni", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Trova Sigla Provincia
  // Explain which processing is carried out by this procedure
  // Provincia - Input
  // **********************************************************************
  public IDVariant TrovaSiglaProvincia (IDVariant Provincia)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_SIGLA = new IDVariant(0,IDVariant.STRING);
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Trova Sigla Provincia Body
      // Procedure Body
      // 
      v_SIGLA = (new IDVariant());
      if (!(IDL.IsNull(Provincia)))
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.SIGLA as PROVINCSIGLA ");
        SQL.append("from ");
        SQL.append("  AD4_PROVINCIE A ");
        SQL.append("where (A.PROVINCIA = " + IDL.CSql(Provincia, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_SIGLA = QV.Get("PROVINCSIGLA", IDVariant.STRING) ;
        }
        QV.Close();
        if (IDL.IsNull(v_SIGLA))
        {
          v_RETVAL = (new IDVariant("EST"));
        }
        else
        {
          v_RETVAL = new IDVariant(v_SIGLA);
        }
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "TrovaSiglaProvincia", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Uf Imp Ge4 Lk
  // Explain which processing is carried out by this procedure
  // Anno Impegno:  - Input
  // Numero Impegno:  - Input
  // **********************************************************************
  public IDVariant UfImpGe4Lk (IDVariant AnnoImpegno, IDVariant NumeroImpegno)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CHK1 = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CHK2 = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Uf Imp Ge4 Lk Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  1 as C1 ");
      SQL.append("from ");
      SQL.append("  IMPEGNI_GE4 A ");
      SQL.append("where (A.ANNO_IMPEGNO = " + IDL.CSql(AnnoImpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_IMPEGNO = " + IDL.CSql(NumeroImpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_SUBIMPEGNO = 0) ");
      SQL.append("and   (A.NUMERO_SUBIMPEGNO = 0) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CHK1 = QV.Get("C1", IDVariant.INTEGER) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  1 as C1 ");
      SQL.append("from ");
      SQL.append("  IMPEGNI_GC4 A ");
      SQL.append("where (A.ANNO_IMPEGNO = " + IDL.CSql(AnnoImpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_IMPEGNO = " + IDL.CSql(NumeroImpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_SUBIMPEGNO = 0) ");
      SQL.append("and   (A.NUMERO_SUBIMPEGNO = 0) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CHK2 = QV.Get("C1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CHK1.equals((new IDVariant(1)), true) || v_CHK2.equals((new IDVariant(1)), true))
      {
        v_RETVAL = (new IDVariant(1));
      }
      else
      {
        v_RETVAL = (new IDVariant(0));
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "UfImpGe4Lk", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Uf Sub Imp Ge4 Lk
  // Explain which processing is carried out by this procedure
  // AnnoSubImpegno:  - Input
  // NumeroSubImpegno:  - Input
  // **********************************************************************
  public IDVariant UfSubImpGe4Lk (IDVariant AnnoSubImpegno, IDVariant NumeroSubImpegno)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CHK1 = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CHK2 = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Uf Sub Imp Ge4 Lk Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  1 as C1 ");
      SQL.append("from ");
      SQL.append("  IMPEGNI_GE4 A ");
      SQL.append("where (A.ANNO_SUBIMPEGNO = " + IDL.CSql(AnnoSubImpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_SUBIMPEGNO = " + IDL.CSql(NumeroSubImpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CHK1 = QV.Get("C1", IDVariant.INTEGER) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  1 as C1 ");
      SQL.append("from ");
      SQL.append("  IMPEGNI_GC4 A ");
      SQL.append("where (A.ANNO_SUBIMPEGNO = " + IDL.CSql(AnnoSubImpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_SUBIMPEGNO = " + IDL.CSql(NumeroSubImpegno, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CHK2 = QV.Get("C1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CHK1.equals((new IDVariant(1)), true) || v_CHK2.equals((new IDVariant(1)), true))
      {
        v_RETVAL = (new IDVariant(1));
      }
      else
      {
        v_RETVAL = (new IDVariant(0));
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "UfSubImpGe4Lk", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Variazioni Imp Sub Senza Delibera
  // Anno Imp Sub:  - Input
  // Numero Imp Sub:  - Input
  // Imp Sub:  - Input
  // **********************************************************************
  public IDVariant VariazioniImpSubSenzaDelibera (IDVariant AnnoImpSub, IDVariant NumeroImpSub, IDVariant ImpSub)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTA = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Variazioni Imp Sub Senza Delibera Body
      // Procedure Body
      // 
      v_CONTA = (new IDVariant(0));
      if (ImpSub.equals((new IDVariant("I")), true))
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  VARIMP A ");
        SQL.append("where (A.ANNO_IMP = " + IDL.CSql(AnnoImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_IMP = " + IDL.CSql(NumeroImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.IMPORTO > 0) ");
        SQL.append("and   ((A.ANNO_DEL IS NULL)) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_CONTA = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
      }
      else
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  VARSUB A ");
        SQL.append("where (A.ANNO_SUBIMP = " + IDL.CSql(AnnoImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.NUMERO_SUBIMP = " + IDL.CSql(NumeroImpSub, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.IMPORTO > 0) ");
        SQL.append("and   ((A.ANNO_DEL IS NULL)) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_CONTA = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
      }
      return v_CONTA;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "VariazioniImpSubSenzaDelibera", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Vincolo Scadenza
  // Tipo Vincolo:  - Input
  // Data:  - Input
  // **********************************************************************
  public IDVariant VincoloScadenza (IDVariant TipoVincolo, IDVariant Data)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Vincolo Scadenza Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  VINCOLI A ");
      SQL.append("where (A.CODICE = " + IDL.CSql(TipoVincolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   ((A.SCADENZA IS NULL) OR (A.SCADENZA > " + IDL.CSql(Data, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ")) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_NUMREC.equals((new IDVariant(0)), true))
      {
        return (new IDVariant(-1));
      }
      else
      {
        return (new IDVariant(1));
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "VincoloScadenza", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Visualizza Risorsa Intevento
  // Esercizio:  - Input
  // **********************************************************************
  public boolean VisualizzaRisorsaIntevento (IDVariant Esercizio)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_SECF4 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_TIPOVOCEPEG = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Visualizza Risorsa Intevento Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.SE_CF4 as POLPARASECF4, ");
      SQL.append("  A.TIPO_VOCE_PEG as POLPARTIVOPE ");
      SQL.append("from ");
      SQL.append("  POL_PARAMETRI A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_SECF4 = QV.Get("POLPARASECF4", IDVariant.STRING) ;
        v_TIPOVOCEPEG = QV.Get("POLPARTIVOPE", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_SECF4.equals((new IDVariant("SI")), true))
      {
        return (new IDVariant(-1)).booleanValue();
      }
      else
      {
        if (v_TIPOVOCEPEG.equals((new IDVariant()), true) || v_TIPOVOCEPEG.equals((new IDVariant(1)), true))
        {
          return (new IDVariant(0)).booleanValue();
        }
        else
        {
          return (new IDVariant(-1)).booleanValue();
        }
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "VisualizzaRisorsaIntevento", _e);
      return false;
    }
  }

  // **********************************************************************
  // Check Smart Beneficiario
  // chekSmartBeneficiario
  // Stringa Da Cercare PAR:  - Input
  // Data Filtro - Optional - Input
  // Fase:  - Optional - Input
  // NO INSERT - Optional - Input
  // Non Considerare Scadenza:  - Optional - Input
  // **********************************************************************
  public int CheckSmartBeneficiario (IDVariant StringaDaCercarePAR, IDVariant DataFiltro, IDVariant Fase, IDVariant NOINSERT, IDVariant NonConsiderareScadenza)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Check Smart Beneficiario Body
      // Corpo Procedura
      // 
      IDVariant v_VCOUNT = new IDVariant(0,IDVariant.INTEGER);
      IDVariant v_STRINDACERCA = null;
      v_STRINDACERCA = IDL.Add(IDL.Add((new IDVariant("%")), IDL.Lower(StringaDaCercarePAR)), (new IDVariant("%")));
      if (IDL.NullValue(NonConsiderareScadenza,(new IDVariant("NO"))).equals((new IDVariant("NO")), true))
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  BEN A ");
        SQL.append("where ((LOWER(TO_CHAR ( A.CODICE )) || '-' || A.RAGIONE_SOCIALE_ESTESA LIKE " + IDL.CSql(v_STRINDACERCA, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") OR (LOWER(TO_CHAR ( A.CODICE_FISCALE )) LIKE " + IDL.CSql(v_STRINDACERCA, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") OR LOWER(TO_CHAR ( A.PARTITA_IVA )) LIKE " + IDL.CSql(v_STRINDACERCA, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   ((NVL(" + IDL.CSql(DataFiltro, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ", TRUNC( SYSDATE )) BETWEEN NVL(A.DAL, TO_DATE('1900-01-01','YYYY-MM-DD')) AND NVL(A.AL, TO_DATE('2999-12-31','YYYY-MM-DD')))) ");
        SQL.append("and   (DECODE(A.D_SCADENZA, to_date(NULL), TO_DATE('2999-12-31','YYYY-MM-DD'), A.D_SCADENZA) >= NVL(" + IDL.CSql(DataFiltro, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + ", TRUNC( SYSDATE ))) ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
      }
      else
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  BEN A ");
        SQL.append("where ((LOWER(TO_CHAR ( A.CODICE )) || '-' || A.RAGIONE_SOCIALE_ESTESA LIKE " + IDL.CSql(v_STRINDACERCA, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") OR (LOWER(TO_CHAR ( A.CODICE_FISCALE )) LIKE " + IDL.CSql(v_STRINDACERCA, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") OR LOWER(TO_CHAR ( A.PARTITA_IVA )) LIKE " + IDL.CSql(v_STRINDACERCA, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
      }
      if (v_VCOUNT.equals((new IDVariant(0)), true))
      {
        IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
        v_MESSAGGIO = (new IDVariant("Soggetto non trovato!", IDVariant.STRING));
        IDVariant v_INSSOGG = new IDVariant(0,IDVariant.STRING);
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  CF4WEB_ABILITA_INS_BEN(" + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(Fase, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ",NULL) as CDCAIBSMFSUN ");
        SQL.append("from ");
        SQL.append("  DUAL A ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_INSSOGG = QV.Get("CDCAIBSMFSUN", IDVariant.STRING) ;
        }
        QV.Close();
        if (v_INSSOGG.equals((new IDVariant("SI")), true) && !(NOINSERT.booleanValue()))
        {
          IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
          v_SMS = (new IDVariant("Il Soggetto indicato non è stato trovato, si desidera inserire una nuova registrazione?", IDVariant.STRING));
          if (MainFrm.MessageConfirm(v_SMS))
          {
            IMDB.set_Value(IMDBDef2.TBL_IMDB4, IMDBDef2.FLD_IMDB4_ROWNAMECODI1, 0, (new IDVariant()));
            IMDB.set_Value(IMDBDef2.TBL_IMDB4, IMDBDef2.FLD_IMDB4_ROWNAMRAGSOC, 0, new IDVariant(StringaDaCercarePAR));
            IMDB.set_Value(IMDBDef2.TBL_IMDB4, IMDBDef2.FLD_IMDB4_ROWNAMDATDAL, 0, ((ANAGRACONDIV.equals((new IDVariant("SI"))))?DataFiltro:(new IDVariant())));
            MainFrm.Show(MyGlb.FRM_SOGGETTO, (new IDVariant(-1)).intValue(), this); 
          }
        }
        else
        {
          MainFrm.set_AlertMessage(v_MESSAGGIO); 
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CheckSmartBeneficiario", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Aggiornamentosoggetto
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // Iddocumento - Input
  // Errore - Input/Output
  // **********************************************************************
  public int Aggiornamentosoggetto (IDVariant Iddocumento, IDVariant Errore)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Aggiornamentosoggetto Body
      // Corpo Procedura
      // 
      Errore.set((new IDVariant("")));
      // 
      // la procedura di AggiornamentoSogegtto viene utilizzata
      // solo in caso di integrazione con anagrafe Unica
      // 
      // 
      // Richiamo la procedura di DB  INDE_FE_PASSIVA.AGGIORNA
      // SOGGETTO_CMV che gestisce l'aggiornamento del soggetto
      // secondo le specifiche della Città Metropolitana di
      // Venezia
      // 
      MainFrm.Cf4armDBObject.INDEFEPASSIVAAGGIORNAMENTOSOGGETTOCMV(Iddocumento);
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        Errore.set((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())));
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Aggiornamentosoggetto", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Proponidatareginesercizio
  // ProponiDataRegInEsercizio
  // **********************************************************************
  public IDVariant Proponidatareginesercizio ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Proponidatareginesercizio Body
      // Corpo Procedura
      // 
      IDVariant v_RDATE = new IDVariant(0,IDVariant.DATETIME);
      if (IDL.Year(IDL.Today()).compareTo(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), true)>0)
      {
        v_RDATE = IDL.ToDate(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), (new IDVariant(12)), (new IDVariant(31)));
      }
      else
      {
        v_RDATE = IDL.Today();
      }
      return v_RDATE;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Proponidatareginesercizio", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Setta NLS CHAR
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int SettaNLSCHAR ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Setta NLS CHAR Body
      // Corpo Procedura
      // 
      IDVariant v_DBLINK = new IDVariant(0,IDVariant.STRING);
      IDVariant v_SSTRI = new IDVariant(0,IDVariant.STRING);
      v_SSTRI = (new IDVariant("Settaggio NLS_NUMERIC_CHARACTERS per DBLINK"));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  INDE_FE_PASSIVA.TROVA_REGISTRO('PRODUCTS/CFA'," + IDL.CSql(v_SSTRI, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") as INFEPATRRPCS ");
      SQL.append("from ");
      SQL.append("  DUAL A ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_DBLINK = QV.Get("INFEPATRRPCS", IDVariant.STRING) ;
      }
      QV.Close();
      if (IDL.NullValue(v_DBLINK,(new IDVariant("NO"))).equals((new IDVariant("SI")), true))
      {
        MainFrm.Cf4armDBObject.SETTANLSNUMERICCHARACTERS();
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaNLSCHAR", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Get Divisione Gruppi
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // p ES - Input
  // **********************************************************************
  public IDVariant GetDivisioneGruppi (IDVariant pES)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Get Divisione Gruppi Body
      // Corpo Procedura
      // 
      IDVariant v_VRET = null;
      v_VRET = (new IDVariant("N"));
      IDVariant v_VCONTATORE = new IDVariant(0,IDVariant.INTEGER);
      IDVariant v_VTIPO = null;
      v_VTIPO = ((pES.equals((new IDVariant("E"))))?(new IDVariant("EP")):(new IDVariant("ES")));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  T72 A ");
      SQL.append("where (A.TIPO = " + IDL.CSql(v_VTIPO, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (NOT ((A.SEZIONE IS NULL))) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_VCONTATORE.compareTo((new IDVariant(0)), true)>0)
      {
        v_VRET = (new IDVariant("Y"));
      }
      return v_VRET;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GetDivisioneGruppi", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Disabilitazione Modifica Fattura
  // **********************************************************************
  public IDVariant DisabilitazioneModificaFattura ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_WINDOW = new IDVariant(0,IDVariant.STRING);
    IDVariant v_NUMREC = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      v_WINDOW = (new IDVariant("Modifica_Fattura", IDVariant.STRING));
      // 
      // Disabilitazione Modifica Fattura Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  AD4_DISABILITAZIONI A ");
      SQL.append("where (A.RUOLO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIONRUOLO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.MODULO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (UPPER(A.WINDOW) = UPPER(" + IDL.CSql(v_WINDOW, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ")) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_NUMREC = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (IDL.NullValue(v_NUMREC,(new IDVariant(0))).compareTo((new IDVariant(0)), true)>0)
      {
        return (new IDVariant("SI"));
      }
      else
      {
        return (new IDVariant("NO"));
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "DisabilitazioneModificaFattura", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Chk Acc Prec
  // Controllo accertamento anno precedente
  // p Anno Acc Prec:  - Input
  // p Numero Acc Prec:  - Input
  // p Capitolo:  - Input
  // p Articolo:  - Input
  // **********************************************************************
  public boolean ChkAccPrec (IDVariant pAnnoAccPrec, IDVariant pNumeroAccPrec, IDVariant pCapitolo, IDVariant pArticolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Chk Acc Prec Body
      // Procedure Body
      // 
      if (IDL.IsNull(pCapitolo) || IDL.IsNull(pArticolo) || IDL.IsNull(pAnnoAccPrec) || IDL.IsNull(pNumeroAccPrec))
      {
        return (new IDVariant(0)).booleanValue();
      }
      IDVariant v_VRET = null;
      v_VRET = (new IDVariant(-1));
      IDVariant v_VFOUND = new IDVariant(0,IDVariant.INTEGER);
      IDVariant v_VNUMEROACC = null;
      v_VNUMEROACC = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.NUMERO_ACC as NUMEROACC ");
      SQL.append("from ");
      SQL.append("  ACC A ");
      SQL.append("where (A.ANNO_ACC = " + IDL.CSql(pAnnoAccPrec, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_ACC = " + IDL.CSql(pNumeroAccPrec, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(pCapitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(pArticolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_ACC = (" + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " - 1)) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      v_VFOUND = (QV.RecordCount()!=0 ? IDVariant.TRUE : IDVariant.FALSE);
      if (!QV.EOF())
      {
        v_VNUMEROACC = QV.Get("NUMEROACC", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (!(v_VFOUND.booleanValue()))
      {
        IDVariant v_VMSGERR = new IDVariant(0,IDVariant.STRING);
        v_VMSGERR = (new IDVariant("Accertamento non presente o non ammesso.</br>Sono selezionabili solo accertamenti dell'esercizio "));
        IDVariant v_VMSGERR2 = new IDVariant(0,IDVariant.STRING);
        v_VMSGERR2 = (new IDVariant(" sul capitolo "));
        v_VMSGERR = IDL.Add(v_VMSGERR, IDL.ToString(IDL.Sub(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), (new IDVariant(1)))));
        v_VMSGERR2 = IDL.Add(IDL.Add(IDL.Add(v_VMSGERR2, IDL.ToString(pCapitolo)), (new IDVariant("/"))), IDL.ToString(pArticolo));
        MainFrm.set_AlertMessage(IDL.Add(v_VMSGERR, v_VMSGERR2)); 
        v_VRET = (new IDVariant(0));
      }
      return v_VRET.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ChkAccPrec", _e);
      return false;
    }
  }

  // **********************************************************************
  // Chk Imp Prec
  // Controllo impegno anno precedente
  // p Anno Imp Prec:  - Input
  // p Numero Imp Prec:  - Input
  // p Capitolo:  - Input
  // p Articolo:  - Input
  // **********************************************************************
  public boolean ChkImpPrec (IDVariant pAnnoImpPrec, IDVariant pNumeroImpPrec, IDVariant pCapitolo, IDVariant pArticolo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Chk Imp Prec Body
      // Procedure Body
      // 
      if (IDL.IsNull(pCapitolo) || IDL.IsNull(pArticolo) || IDL.IsNull(pAnnoImpPrec) || IDL.IsNull(pNumeroImpPrec))
      {
        return (new IDVariant(0)).booleanValue();
      }
      IDVariant v_VRET = null;
      v_VRET = (new IDVariant(-1));
      IDVariant v_VFOUND = new IDVariant(0,IDVariant.INTEGER);
      IDVariant v_VNUMEROIMP = null;
      v_VNUMEROIMP = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.NUMERO_IMP as NUMEROIMP ");
      SQL.append("from ");
      SQL.append("  IMP A ");
      SQL.append("where (A.ANNO_IMP = " + IDL.CSql(pAnnoImpPrec, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_IMP = " + IDL.CSql(pNumeroImpPrec, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CAPITOLO = " + IDL.CSql(pCapitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ARTICOLO = " + IDL.CSql(pArticolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_IMP = (" + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " - 1)) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      v_VFOUND = (QV.RecordCount()!=0 ? IDVariant.TRUE : IDVariant.FALSE);
      if (!QV.EOF())
      {
        v_VNUMEROIMP = QV.Get("NUMEROIMP", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (!(v_VFOUND.booleanValue()))
      {
        IDVariant v_VMSGERR = new IDVariant(0,IDVariant.STRING);
        v_VMSGERR = (new IDVariant("Impegno non presente o non ammesso.</br>Sono selezionabili solo impegni dell'esercizio "));
        IDVariant v_VMSGERR2 = new IDVariant(0,IDVariant.STRING);
        v_VMSGERR2 = (new IDVariant(" sul capitolo "));
        v_VMSGERR = IDL.Add(v_VMSGERR, IDL.ToString(IDL.Sub(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), (new IDVariant(1)))));
        v_VMSGERR2 = IDL.Add(IDL.Add(IDL.Add(v_VMSGERR2, IDL.ToString(pCapitolo)), (new IDVariant("/"))), IDL.ToString(pArticolo));
        MainFrm.set_AlertMessage(IDL.Add(v_VMSGERR, v_VMSGERR2)); 
        v_VRET = (new IDVariant(0));
      }
      return v_VRET.booleanValue();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ChkImpPrec", _e);
      return false;
    }
  }

  // **********************************************************************
  // Chiama WS
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // Url WS - Input
  // Soap Request - Input
  // Service Name Space - Input
  // Service Time Out - Input
  // Utente - Optional - Input
  // Password - Optional - Input
  // SOAP Action - Optional - Input
  // **********************************************************************
  public IDVariant ChiamaWS (IDVariant UrlWS, IDVariant SoapRequest, IDVariant ServiceNameSpace, IDVariant ServiceTimeOut, IDVariant Utente, IDVariant Password, IDVariant SOAPAction)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Chiama WS Body
      // Corpo Procedura
      // 
      IDVariant v_RESULT = new IDVariant(0,IDVariant.STRING);
      IDVariant v_RISPOSTAWS = new IDVariant(0,IDVariant.STRING);
      IDVariant v_SOAPREQUCOMP = null;
      v_SOAPREQUCOMP = IDL.Add((new IDVariant("<?xml version = \"1.0\" encoding = \"UTF-8\"?>")), (new IDVariant("\n")));
      v_SOAPREQUCOMP = IDL.Add(IDL.Add(v_SOAPREQUCOMP, (new IDVariant("<soapenv:Envelope xmlns:soapenv=\"http://schemas.xmlsoap.org/soap/envelope/\""))), (new IDVariant("\n")));
      v_SOAPREQUCOMP = IDL.Add(IDL.Add(IDL.Add(IDL.Add(v_SOAPREQUCOMP, (new IDVariant("              "))), ServiceNameSpace), (new IDVariant(">"))), (new IDVariant("\n")));
      v_SOAPREQUCOMP = IDL.Add(IDL.Add(IDL.Add(v_SOAPREQUCOMP, (new IDVariant("        "))), (new IDVariant("<soapenv:Body>"))), (new IDVariant("\n")));
      v_SOAPREQUCOMP = IDL.Add(IDL.Add(v_SOAPREQUCOMP, SoapRequest), (new IDVariant("\n")));
      v_SOAPREQUCOMP = IDL.Add(IDL.Add(IDL.Add(v_SOAPREQUCOMP, (new IDVariant("        "))), (new IDVariant("</soapenv:Body>"))), (new IDVariant("\n")));
      v_SOAPREQUCOMP = IDL.Add(IDL.Add(v_SOAPREQUCOMP, (new IDVariant("</soapenv:Envelope>"))), (new IDVariant("\n")));
      IDVariant v_REQUESLENGTH = null;
      v_REQUESLENGTH = IDL.Length(v_SOAPREQUCOMP);
      IDMap v_MAP = null;
      v_MAP = (IDMap)new IDMap();
      v_MAP.set_Value((new IDVariant("ID_TYPE")),(new IDVariant("POST"))); 
      v_MAP.set_Value((new IDVariant("ID_RESPONSETYPE")),(new IDVariant("TEXT"))); 
      v_MAP.set_Value((new IDVariant("ID_TIMEOUT")),ServiceTimeOut); 
      v_MAP.set_Value((new IDVariant("ID_NOERROR")),(new IDVariant(-1))); 
      IDVariant v_SSOAPACTION = null;
      v_SSOAPACTION = (new IDVariant(""));
      if (IDL.NullValue(SOAPAction,(new IDVariant(""))).compareTo((new IDVariant("")), true)!=0)
      {
        v_SSOAPACTION = IDL.Add((new IDVariant("\n")), SOAPAction);
      }
      v_MAP.set_Value((new IDVariant("ID_HEADERS")),IDL.Add(IDL.Add((new IDVariant("Content-Length: ")), IDL.ToString(v_REQUESLENGTH)), v_SSOAPACTION)); 
      v_MAP.set_Value((new IDVariant("ID_BODY")),v_SOAPREQUCOMP); 
      v_MAP.set_Value((new IDVariant("ID_BODYTYPE")),(new IDVariant("text/xml;charset=UTF-8"))); 
      v_RESULT = IDL.HttpRequest(MainFrm, UrlWS, v_MAP, Utente, Password);
      return v_RESULT;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ChiamaWS", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Setta Parametri Registro PAGO PA
  // **********************************************************************
  public int SettaParametriRegistroPAGOPA ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Setta Parametri Registro PAGO PA Body
      // Corpo Procedura
      // 
      IDVariant v_PRODUCTS = null;
      v_PRODUCTS = (new IDVariant("PRODUCTS/PAGO_PA/"));
      IDVariant v_CHIAVEEFIL = null;
      v_CHIAVEEFIL = (new IDVariant("/E-FIL"));
      IDVariant v_CHIAVEEFILSA = null;
      v_CHIAVEEFILSA = (new IDVariant("/E-FIL/SOAP_ACTION"));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = 'Tipo Integrazione') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        PAGOPATIPINT = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEEFIL, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = 'EndPoint') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        EFILENDPOINT = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEEFIL, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = 'NameSpace') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        EFILNAMESPAC = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEEFIL, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = 'CodiceEnte') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        EFILCODIENTE = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEEFIL, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = 'IDApplicazione') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        EFILIDAPPLIC = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEEFILSA, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = 'EstraiDettaglioPosizionePerIUV') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        EFILSADETTAG = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = " + IDL.CSql(v_PRODUCTS, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || " + IDL.CSql(v_CHIAVEEFILSA, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.STRINGA = 'EstraiIUVPerFlussoRiversamento') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        EFILSAIUVPER = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaParametriRegistroPAGOPA", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Initialize Event
  // **********************************************************************
  public void InitApp ()
  {
    DispatchToComp("InitApp", new Object[] {});
    //
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Initialize Event Body
      // Procedure Body
      // 
      // 
      // Uncomment this statement in a VB application if you
      // don't make any query during login
      // 
      // MainFrm.Cf4armDBObject.OpenConnection((new IDVariant("")).stringValue(), (new IDVariant("")).stringValue(), (new IDVariant("")).stringValue()); 
      MainFrm.set_UserName(new IDVariant((String)MainFrm.Request.getSession().getAttribute("Utente")));
      MainFrm.set_UserRole((new IDVariant(1)));
      MainFrm.RD3CompressFiles = (new IDVariant(0)).booleanValue();
      MainFrm.Cf4armDBObject.DBO().set_CommandTimeout((new IDVariant(0)));
      // MainFrm.UTF8Encode = (new IDVariant(0)).booleanValue();
      InitFix();
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "InitializeEvent", _e);
    }
  }

  // **********************************************************************
  // On Login Event
  // Evento notificato dall'applicazione quando l'utente
  // effettua il login
  // Data Valid - Input/Output
  // Username - Input/Output
  // Password - Input/Output
  // **********************************************************************
  public void Login (IDVariant Username, IDVariant Password, IDVariant DataValid)
  {
    DispatchToComp("Login", new Object[] {Username, Password, DataValid});
    //
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // On Login Event Body
      // Procedure Body
      // 
      // MainFrm.set_UserName((new IDVariant("AAA")));
      // MainFrm.set_UserRole((new IDVariant(1)));
      // DataValid.set((new IDVariant(-1)));
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "OnLoginEvent", _e);
    }
  }

  // **********************************************************************
  // After Login Event
  // Evento notificato dall'applicazione dopo che è stato
  // effettuato l'accesso al sistema
  // **********************************************************************
  public void AfterLogin()
  {
    DispatchToComp("AfterLogin", new Object[] {});
    //
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // After Login Event Body
      // Procedure Body
      // 
      IMDB.set_Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIONOMINA, 0, new IDVariant(MainFrm.Request.getRemoteUser()));
      PROGRESESSIO = new IDVariant(Sessione(),IDVariant.DECIMAL);
      if (PROGRESESSIO.equals((new IDVariant(-1)), true))
      {
        IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
        v_SMS = (new IDVariant("Errore nell'apertura della sessione", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_SMS); 
      }
      IMDB.set_Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSVERSPROD, 0, (new IDVariant("V1.24 del 14/10/2020")));
      MainFrm.DTTObj.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add((new IDVariant("Connessione")), (new IDVariant(" "))), (new IDVariant("username:"))), (new IDVariant(MainFrm.Cf4armDBObject.DefaultUserId()))), (new IDVariant(" DB "))), (new IDVariant(":"))), (new IDVariant(MainFrm.Cf4armDBObject.DBName))), (new IDVariant(" "))), (new IDVariant(MainFrm.Cf4armDBObject.DefaultConnStr()))).stringValue(), (new IDVariant(999)).intValue(), (new IDVariant(3)).intValue()); 
      // 
      // NON C'E' PIU' BISOGNO DI TOCCARE I PARAMETRI DI SOTTO
      //  SE NON Username e Istanza e/o MODULO in casi di test
      // particolari in DB differenti o dal cliente
      // --------------------------CONN--------------------
      // ---------------------------------------
      // DEPLOYMENT IN PRODUZIONE
      // /// NON TOCCAREEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEEE
      // 
      if ((new IDVariant(MainFrm.Cf4armDBObject.DefaultConnStr())).equals((new IDVariant("datasource=cfarm")), true))
      {
        // 
        // Parametri per Compilazione in Produzione
        // 
        {
          IMDB.set_Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0, new IDVariant((String)MainFrm.Request.getSession().getAttribute("Utente")));
          IMDB.set_Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOISTANZ, 0, new IDVariant((String)MainFrm.Request.getSession().getAttribute("Istanza")));
          IMDB.set_Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0, new IDVariant((String)MainFrm.Request.getSession().getAttribute("Modulo")));
        }
      }
      else
      {
        IDVariant v_DEFAULUTENTE = new IDVariant(0,IDVariant.STRING);
        IDVariant v_DEFAULISTANZ = new IDVariant(0,IDVariant.STRING);
        if (IDL.Find((new IDVariant(MainFrm.Cf4armDBObject.DefaultConnStr())), (new IDVariant("GAM"))).compareTo((new IDVariant(0)), true)>0)
        {
          // 
          // SVI-GAM
          // 
          v_DEFAULUTENTE = (new IDVariant("FDTEST"));
          v_DEFAULISTANZ = (new IDVariant("CF4ARM"));
        }
        else
        {
          // 
          // TEST
          // 
          v_DEFAULUTENTE = (new IDVariant("CFA"));
          v_DEFAULISTANZ = (new IDVariant("CFA"));
        }
        // 
        // No web xml In locale
        // 
        {
          IMDB.set_Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0, IDL.NullValue(new IDVariant((String)MainFrm.Request.getSession().getAttribute("Utente")),v_DEFAULUTENTE));
          IMDB.set_Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOISTANZ, 0, IDL.NullValue(new IDVariant((String)MainFrm.Request.getSession().getAttribute("Istanza")),v_DEFAULISTANZ));
          IMDB.set_Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0, IDL.NullValue(new IDVariant((String)MainFrm.Request.getSession().getAttribute("Modulo")),(new IDVariant("CFA"))));
          TEST = (new IDVariant("SI"));
        }
      }
      // 
      // NON TOCCARE IL PEZZO DI SOPRAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
      // --------------------------------------------------
      // --------------------------------------------
      // 
      // 
      // 
      // 
      // 
      // 
      if (IDL.NullValue(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0),(new IDVariant("GUEST"))).equals((new IDVariant("GUEST")), true))
      {
        MainFrm.ExitApp((new IDVariant("error.htm")).stringValue()); 
      }
      if (EsistonoTriggerDisabilitati())
      {
        IDVariant S = new IDVariant(0,IDVariant.STRING);
        S = (new IDVariant("Sul database sono presenti trigger disabilitati"));
        MainFrm.set_AlertMessage(S); 
        DisabilitaTuttiIComandi();
        return;
      }
      IMDB.set_Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIONEENTE, 0, IDL.NullValue(Getente(),(new IDVariant("ADDP"))));
      IMDB.set_Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOPROGET, 0, IDL.NullValue(GetProgettoDaIstanza(),(new IDVariant("CFA"))));
      IMDB.set_Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0, IDL.Year(IDL.Today()));
      IMDB.set_Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIONRUOLO, 0, Getruolo());
      // 
      // Font aggiunti per i sistemi operativi Unix
      // 
      {
        com.progamma.idre.pdf.PdfFont.scanFontDirectory(IDL.Add((new IDVariant(MainFrm.RealPath)), IDL.Add((new IDVariant("/")), (new IDVariant("WEB-INF/fonts")))).stringValue()); 
      }
      AFC = Afc.CreateAfc(MainFrm,IMDB);
      AFC.Init();
      SettaDatiSi4print();
      SettaDatiJasper();
      ESERCIZIO = IDL.Add((new IDVariant(" - ")), IDL.Add((new IDVariant("Esercizio")), IDL.Add((new IDVariant(" ")), IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))));
      IMDB.set_Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSPERCIMMA, 0, PercorsoImmagini());
      MainFrm.set_AutoCollapseMenu((new IDVariant(3)).intValue());
      CaricaMenuRicorsivo();
      SettaParametriT99();
      SettaParametriOD();
      SettaParametriMANORDINFXML();
      SettaParametriMINF();
      SettaParametriWEB();
      SettaParametriLIQ();
      SettaParametriRegistro();
      SettaParametriRegistroPAGOPA();
      SettaPOLParametri();
      SettaParametriIride();
      SettaDatiEnte();
      SettaParametriArt18();
      SettaMainCaption();
      SettaParametriTrasco();
      SettaParametriDOCFE();
      DisabilitaVociMenuCustomizzate();
      AbilitaEstrazioniImpacc();
      IDVariant v_VCOUNT = new IDVariant(0,IDVariant.INTEGER);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  NOTIFICHE A ");
      SQL.append("where (A.MODULO_A = 'CF') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      IDVariant v_VNOTIFICACFA = new IDVariant(0,IDVariant.STRING);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = 'PRODUCTS/FATTURA_ELETTRONICA/SMISTAMENTO') ");
      SQL.append("and   (A.STRINGA = 'NOTIFICA_CFA') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VNOTIFICACFA = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      if (v_VCOUNT.compareTo((new IDVariant(0)), true)>0 && IDL.NullValue(v_VNOTIFICACFA,(new IDVariant("S"))).compareTo((new IDVariant("N")), true)!=0 && MainFrm.CmdObj.CmdSetVisible(MyGlb.CMDS_CANOTIFI+BaseCmdSetIdx) && MainFrm.CmdObj.CmdVisible(MyGlb.CMD_NOTIFICHE+BaseCmdLinIdx))
      {
        MainFrm.Show(MyGlb.FRM_NOTIFICHE, (new IDVariant(2)).intValue(), this); 
      }
      IMDB.set_Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIRPPATTI, 0, FunctionRppAttiva());
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      MainFrm.Cf4armDBObject.GENERACRONOPIANOCOMPTUTTI(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), PROGRESESSIO, IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0));
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Errore nella generazione del dettaglio composizione Cronoprogramma."));
        MainFrm.set_AlertMessage(IDL.Add(IDL.Add(v_AVVISO, (new IDVariant("<BR/>"))), (new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())))); 
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "AfterLoginEvent", _e);
    }
  }

  // **********************************************************************
  // Global Activate
  // Evento notificato alla videata quando essa viene attivata
  // cioè quando viene portata in primo piano
  // Form - Input
  // **********************************************************************
  public void Form_Activate(WebForm Form)
  {
    DispatchToOwner("Form_Activate", new Object[] {Form});
    //
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Global Activate Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_SCHEDINFOBIL, 0, false)!=null) && (new IDVariant(Form.FormIdx)).compareTo((new IDVariant(MyGlb.FRM_SCHEDINFOBIL)), true)!=0)
      {
        MainFrm.GetForm(MyGlb.FRM_SCHEDINFOBIL,0).set_WindowState((new IDVariant(2)).intValue());
      }
      if ((MainFrm.GetForm(MyGlb.FRM_SCHEDINFOMOV, 0, false)!=null) && (new IDVariant(Form.FormIdx)).compareTo((new IDVariant(MyGlb.FRM_SCHEDINFOMOV)), true)!=0)
      {
        MainFrm.GetForm(MyGlb.FRM_SCHEDINFOMOV,0).set_WindowState((new IDVariant(2)).intValue());
      }
      if ((MainFrm.GetForm(MyGlb.FRM_SCHEDINFOLIQ, 0, false)!=null) && (new IDVariant(Form.FormIdx)).compareTo((new IDVariant(MyGlb.FRM_SCHEDINFOLIQ)), true)!=0)
      {
        MainFrm.GetForm(MyGlb.FRM_SCHEDINFOLIQ,0).set_WindowState((new IDVariant(2)).intValue());
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GlobalActivate", _e);
    }
  }

  // **********************************************************************
  // Global Panel Database Error
  // Evento notificato dal pannello al verificarsi di un
  // errore di database durante un'operazione di salvataggio
  // dei dati.
  // Panel - Input
  // Cancel - Input/Output
  // Skip - Input/Output
  // Error Number - Input
  // Error Message - Input
  // Native Error Number - Input
  // Panel Operation - Input
  // Document - Input
  // **********************************************************************
  public void OnDBError(IDPanel Panel, IDVariant Cancel, IDVariant Skip, IDVariant ErrorNumber, IDVariant ErrorMessage, IDVariant NativeErrorNumber, IDVariant PanelOperation, com.progamma.doc.IDDocument Document)
  {
    DispatchToOwner("OnDBError", new Object[] {Panel, Cancel, Skip, ErrorNumber, ErrorMessage, NativeErrorNumber, PanelOperation, Document});
    //
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Global Panel Database Error Body
      // Corpo Procedura
      // 
      Cancel.set((new IDVariant(-1)));
      Skip.set((new IDVariant(-1)));
      MainFrm.set_AlertMessage(PulisciMessaggioErrore(ErrorMessage)); 
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GlobalPanelDatabaseError", _e);
    }
  }

  // **********************************************************************
  // Global Panel Validate Row
  // Evento notificato dal pannello quando un utente modifica
  // i dati presenti nel pannello
  // Panel - Input
  // Cancel - Input/Output
  // **********************************************************************
  public void IntValidateRow (IDPanel Panel, IDVariant Cancel)
  {
    DispatchToOwner("IntValidateRow", new Object[] {Panel, Cancel});
    //
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Global Panel Validate Row Body
      // Corpo Procedura
      // 
      if (Panel.FinalUpdate)
      {
        GLOPANVALROW_FIELTOBEFIX1();
        while (!IMDB.Eof(IMDBDef7.QRY_FIELTOBEFIX1, 0))
        {
          if (new IDVariant(Panel.FindField(IMDB.Value(IMDBDef7.QRY_FIELTOBEFIX1, IMDBDef7.QSL_FIELTOBEFIX1_CODFIETOBEFI, 0).stringValue())).compareTo((new IDVariant(0)), true)>0 && !(IDL.IsNull(Panel.Value(IMDB.Value(IMDBDef7.QRY_FIELTOBEFIX1, IMDBDef7.QSL_FIELTOBEFIX1_CODFIETOBEFI, 0).stringValue()))))
          {
            Panel.set_Value(IMDB.Value(IMDBDef7.QRY_FIELTOBEFIX1, IMDBDef7.QSL_FIELTOBEFIX1_CODFIETOBEFI, 0).stringValue(), FixCharset(Panel.Value(IMDB.Value(IMDBDef7.QRY_FIELTOBEFIX1, IMDBDef7.QSL_FIELTOBEFIX1_CODFIETOBEFI, 0).stringValue()))); 
          }
          IMDB.TblMoveNext(IMDBDef7.QRY_FIELTOBEFIX1, 0);
        }
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GlobalPanelValidateRow", _e);
    }
  }

  // **********************************************************************
  // Fields To Be Fixed
  // Quali dati devi selezionare con questa query?
  // **********************************************************************
  private void GLOPANVALROW_FIELTOBEFIX1() throws SQLException
  {
    IDVariant[] AggrBuff;
    int[] AggrRowCount;
    int AggrCount=0;
    boolean AggrNewGroup = false;

    IMDB.TblTruncate(IMDBDef7.QRY_FIELTOBEFIX1);
    IMDB.TblMoveFirst(IMDBDef7.TBL_FIELTOBEFIXE, 0);
    Loop1: while (!IMDB.Eof(IMDBDef7.TBL_FIELTOBEFIXE, 0))
    {
      IMDB.TblAddNew(IMDBDef7.QRY_FIELTOBEFIX1, 0);
      IMDB.TblLinkRow(IMDBDef7.QRY_FIELTOBEFIX1, 0, IMDBDef7.TBL_FIELTOBEFIXE, 0);
      IMDB.TblLinkField(IMDBDef7.QRY_FIELTOBEFIX1, 0, 0, IMDBDef7.TBL_FIELTOBEFIXE, IMDBDef7.FLD_FIELTOBEFIXE_CODFIETOBEFI, 0);
      IMDB.TblMoveNext(IMDBDef7.TBL_FIELTOBEFIXE, 0);
      if (IMDB.Eof(IMDBDef7.TBL_FIELTOBEFIXE, 0))
      {
        IMDB.TblMoveFirst(IMDBDef7.TBL_FIELTOBEFIXE, 0);
      }
      else
      {
        continue Loop1;
      }
      break;
    }
    IMDB.TblMoveFirst(IMDBDef7.QRY_FIELTOBEFIX1, 0);
  }

  // **********************************************************************
  // On Command
  // Evento notificato dall'applicazione quando viene passato
  // un comando via URL
  // Command - Input
  // **********************************************************************
  public void OnCommand(IDVariant Command)
  {
    DispatchToComp("OnCommand", new Object[] {Command});
    //
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // On Command Body
      // Corpo Procedura
      // 
      if (Command.equals((new IDVariant("APRIFORM")), true))
      {
        IDVariant v_FORM = new IDVariant(0,IDVariant.STRING);
        IDVariant v_FORMCCD = new IDVariant(0,IDVariant.STRING);
        v_FORMCCD = (new IDVariant("CALQFNCD"));
        IDVariant v_FORMLIQGE4 = new IDVariant(0,IDVariant.STRING);
        v_FORMLIQGE4 = (new IDVariant("CALQFNDE"));
        IDVariant v_FORMCONTIMPE = null;
        v_FORMCONTIMPE = (new IDVariant("CAOPRCNI"));
        IDVariant v_FORMCONTIMPS = null;
        v_FORMCONTIMPS = (new IDVariant("CALQLPCC"));
        v_FORM = MainFrm.GetUrlParam((new IDVariant("FORM")));
        if ((MainFrm.GetForm(MyGlb.FRM_NOTIFICHE, 0, false)!=null))
        {
          MainFrm.UnloadForm(MyGlb.FRM_NOTIFICHE,(new IDVariant(0)).booleanValue()); 
        }
        if (v_FORM.equals(v_FORMCCD, true))
        {
          MainFrm.UnloadForm(MyGlb.FRM_CONTCONTDIST,(new IDVariant(0)).booleanValue()); 
          IMDB.set_Value(IMDBDef5.TBL_PARAMETRI93, IMDBDef5.FLD_PARAMETRI93_NUMERO_DISTINTA, 0, IDL.ToInteger(MainFrm.GetUrlParam((new IDVariant("PAR1")))));
          IMDB.set_Value(IMDBDef5.TBL_PARAMETRI93, IMDBDef5.FLD_PARAMETRI93_ANNO_DISTINTA, 0, IDL.ToInteger(MainFrm.GetUrlParam((new IDVariant("PAR2")))));
          CmdObj.ExecCmdCode(v_FORM.stringValue()); 
        }
        else if (v_FORM.equals(v_FORMLIQGE4, true))
        {
          IDVariant v_ANNOPROPOSTA = null;
          v_ANNOPROPOSTA = IDL.ToInteger(MainFrm.GetUrlParam((new IDVariant("PAR1"))));
          IDVariant v_NUMEROPROPOS = null;
          v_NUMEROPROPOS = IDL.ToInteger(MainFrm.GetUrlParam((new IDVariant("PAR2"))));
          IDVariant v_UNITAPROP = null;
          v_UNITAPROP = MainFrm.GetUrlParam((new IDVariant("PAR3")));
          IDVariant v_VNUMDIST = null;
          v_VNUMDIST = (new IDVariant());
          IDVariant v_VANNODIST = null;
          v_VANNODIST = (new IDVariant());
          SQL = new StringBuffer();
          SQL.append("select ");
          SQL.append("  A.ANNO_DISTINTA as DISEXTDAANDI, ");
          SQL.append("  A.NUMERO_DISTINTA as DISEXTDANUDI ");
          SQL.append("from ");
          SQL.append("  DISTINTE_EXTRA_DATIAGG A ");
          SQL.append("where (A.ANNO_PROPOSTA = " + IDL.CSql(v_ANNOPROPOSTA, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append("and   (A.NUMERO_PROPOSTA = " + IDL.CSql(v_NUMEROPROPOS, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append("and   (A.UNITA_PROPONENTE = " + IDL.CSql(v_UNITAPROP, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append("and   (A.TIPO_DISTINTA = 'E') ");
          SQL.append("and   (ROWNUM = 1) ");
          SQL.append("order by ");
          SQL.append("  A.ANNO_DISTINTA ");
          QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
          if (!QV.EOF()) QV.MoveNext();
          if (!QV.EOF())
          {
            v_VANNODIST = QV.Get("DISEXTDAANDI", IDVariant.INTEGER) ;
            v_VNUMDIST = QV.Get("DISEXTDANUDI", IDVariant.DECIMAL) ;
          }
          QV.Close();
          if (IDL.NullValue(v_VANNODIST,(new IDVariant(0))).compareTo((new IDVariant(0)), true)<=0)
          {
            IMDB.set_Value(IMDBDef5.TBL_PARAMETRI299, IMDBDef5.FLD_PARAMETRI299_PARAANNODIST, 0, (new IDVariant()));
            IMDB.set_Value(IMDBDef5.TBL_PARAMETRI299, IMDBDef5.FLD_PARAMETRI299_PARANUMEDIST, 0, (new IDVariant()));
          }
          else
          {
            IMDB.set_Value(IMDBDef5.TBL_PARAMETRI299, IMDBDef5.FLD_PARAMETRI299_PARAANNODIST, 0, new IDVariant(v_VANNODIST));
            IMDB.set_Value(IMDBDef5.TBL_PARAMETRI299, IMDBDef5.FLD_PARAMETRI299_PARANUMEDIST, 0, new IDVariant(new IDVariant(v_VNUMDIST),IDVariant.INTEGER));
          }
          IMDB.set_Value(IMDBDef5.TBL_PARAMETRI299, IMDBDef5.FLD_PARAMETRI299_PARSOLIMDALI, 0, (new IDVariant("SI")));
          MainFrm.Show(MyGlb.FRM_LIQUDADISECO, (new IDVariant(0)).intValue(), this); 
        }
        else if (v_FORM.equals(v_FORMCONTIMPE, true))
        {
          IDVariant v_VPAR1 = null;
          v_VPAR1 = MainFrm.GetUrlParam((new IDVariant("PAR1")));
          IDVariant v_VDATAE = null;
          v_VDATAE = (new IDVariant());
          // 
          // Se nel parametro non si indica una data o la data ha
          // un formato diverso da dd/mm/null si imposta la data
          // a null
          // 
          try
          {
            SQL = new StringBuffer();
            SQL.append("select ");
            SQL.append("  TO_DATE(" + IDL.CSql(v_VPAR1, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ",'dd/mm/yyyy') as TODAFOVPDDMY ");
            SQL.append("from ");
            SQL.append("  DUAL A ");
            QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
            if (!QV.EOF()) QV.MoveNext();
            if (!QV.EOF())
            {
              v_VDATAE = QV.Get("TODAFOVPDDMY", IDVariant.DATETIME) ;
            }
            QV.Close();
          }
          catch (Exception e10)
          {
            v_VDATAE = (new IDVariant());
          }
          ApriControlloImputazioniEntrata(v_VDATAE);
        }
        else if (v_FORM.equals(v_FORMCONTIMPS, true))
        {
          IDVariant v_VPAR1 = null;
          v_VPAR1 = MainFrm.GetUrlParam((new IDVariant("PAR1")));
          IDVariant v_VDATAS = null;
          v_VDATAS = (new IDVariant());
          // 
          // Se nel parametro non si indica una data o la data ha
          // un formato diverso da dd/mm/null si imposta la data
          // a null
          // 
          try
          {
            SQL = new StringBuffer();
            SQL.append("select ");
            SQL.append("  TO_DATE(" + IDL.CSql(v_VPAR1, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ",'dd/mm/yyyy') as TODAFOVPDDMY ");
            SQL.append("from ");
            SQL.append("  DUAL A ");
            QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
            if (!QV.EOF()) QV.MoveNext();
            if (!QV.EOF())
            {
              v_VDATAS = QV.Get("TODAFOVPDDMY", IDVariant.DATETIME) ;
            }
            QV.Close();
          }
          catch (Exception e13)
          {
            v_VDATAS = (new IDVariant());
          }
          ApriControlloImputazioniSpesa(v_VDATAS);
        }
        else
        {
          CmdObj.ExecCmdCode(v_FORM.stringValue()); 
        }
      }
      else if (Command.equals((new IDVariant("APRIRPT")), true))
      {
        ApriReportDaLinkEsterno();
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "OnCommand", _e);
    }
  }

  // **********************************************************************
  // Global Load
  // Evento notificato alla videata al momento del caricamento
  // in memoria.
  // Form - Input
  // **********************************************************************
  public void IntFormLoad (WebForm Form)
  {
    DispatchToOwner("IntFormLoad", new Object[] {Form});
    //
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Global Load Body
      // Corpo Procedura
      // 
      if (ATTIVASTATIS.equals((new IDVariant("SI")), true))
      {
        IDVariant v_CLASSNAME = null;
        v_CLASSNAME = new IDVariant(Form.getClass().getName());
        MainFrm.Cf4armDBObject.STATISTICHEUTILIZZOUPDCONTATOREFORM(v_CLASSNAME, IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), (new IDVariant("FORM")), IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIONRUOLO, 0), IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0));
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GlobalLoad", _e);
    }
  }

  // **********************************************************************
  // Global Panel Dynamic Properties
  // Consente l'aggiustamento delle proprietà visuali delle
  // singole celle del pannello.
  // Panel - Input
  // **********************************************************************
  public void DynamicProperties (IDPanel Panel)
  {
    DispatchToOwner("DynamicProperties", new Object[] {Panel});
    //
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Global Panel Dynamic Properties Body
      // Corpo Procedura
      // 
      if (Panel != null)
      {
        IDVariant v_CIGFIELDIDX = null;
        v_CIGFIELDIDX = new IDVariant(Panel.FindField((new IDVariant("CIG")).stringValue()));
        if (IDL.NullValue(v_CIGFIELDIDX,(new IDVariant(-1))).compareTo((new IDVariant(-1)), true)!=0)
        {
          Panel.set_VisualStyle(Glb.OBJ_FIELD,v_CIGFIELDIDX.intValue(),new IDVariant(MyGlb.VIS_CAMPOCIG).intValue()); 
        }
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GlobalPanelDynamicProperties", _e);
    }
  }

  // **********************************************************************
  // Setta Variabili
  // **********************************************************************
  public int SettaVariabili ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Setta Variabili Body
      // Procedure Body
      // 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SettaVariabili", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Selezione Centro
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public int SelezioneCentro ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Selezione Centro Body
      // Procedure Body
      // 
      IMDB.set_Value(IMDBDef1.TBL_PARAMETRI14, IMDBDef1.FLD_PARAMETRI14_ROWNAMDATREG, 0, IMDB.Value(IMDBDef13.PQRY_IMP5, IMDBDef13.PQSL_IMP5_D_DATA_REG, 0));
      MainFrm.Show(MyGlb.FRM_SCELTACENTRI, (new IDVariant(-1)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SelezioneCentro", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Rendiconto Fatture
  // **********************************************************************
  public int ApriRendicontoFatture ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_PERSONALIZZA = new IDVariant(0,IDVariant.STRING);
    IDVariant v_NOMDATWIPERI = new IDVariant(0,IDVariant.STRING);
    IDVariant v_NOMEDATAWIND = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      v_NOMDATWIPERI = (new IDVariant("w_rendiconto_fatture_stampa_riv", IDVariant.STRING));
      v_NOMEDATAWIND = (new IDVariant("w_rendiconto_fatture_stampa", IDVariant.STRING));
      // 
      // Apri Rendiconto Fatture Body
      // Procedure Body
      // 
      // 
      // gestione personalizzazione
      // 
      {
        v_PERSONALIZZA = AFC.GetComando(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), v_NOMEDATAWIND);
        if (v_PERSONALIZZA.equals(v_NOMDATWIPERI, true))
        {
          MainFrm.Show(MyGlb.FRM_RENFATPERRIV, (new IDVariant(0)).intValue(), this); 
        }
        else
        {
          MainFrm.Show(MyGlb.FRM_RENDICFATTUR, (new IDVariant(0)).intValue(), this); 
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriRendicontoFatture", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Rendiconto Mandati
  // **********************************************************************
  public int ApriRendicontoMandati ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_PERSONALIZZA = new IDVariant(0,IDVariant.STRING);
    IDVariant v_NOMDATWINPER = new IDVariant(0,IDVariant.STRING);
    IDVariant v_NOMEDATAWIND = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      v_NOMDATWINPER = (new IDVariant("w_rendiconto_mandati_stampa_riv", IDVariant.STRING));
      v_NOMEDATAWIND = (new IDVariant("w_rendiconto_mandati_stampa", IDVariant.STRING));
      // 
      // Apri Rendiconto Mandati Body
      // Procedure Body
      // 
      // 
      // gestione personalizzazione
      // 
      {
        v_PERSONALIZZA = AFC.GetComando(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), v_NOMEDATAWIND);
        if (v_PERSONALIZZA.equals(v_NOMDATWINPER, true))
        {
          MainFrm.Show(MyGlb.FRM_RENDMANDRIVO, (new IDVariant(0)).intValue(), this); 
        }
        else
        {
          MainFrm.Show(MyGlb.FRM_RENDICMANDAT, (new IDVariant(0)).intValue(), this); 
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriRendicontoMandati", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Generazione Imputazioni Economica
  // **********************************************************************
  public int ApriGenerazioneImputazioniEconomica ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Generazione Imputazioni Economica Body
      // Procedure Body
      // 
      MainFrm.Show(MyGlb.FRM_GENEIMPUECO2, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriGenerazioneImputazioniEconomica", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Inserisci Nel Documentale
  // Explain which processing is carried out by this procedure
  // Anno Prog:  - Input
  // NumeroProg:  - Input
  // Percorsofile:  - Input
  // NuovoDoc:  - Input
  // IDDoc:  - Input
  // **********************************************************************
  public int InserisciNelDocumentale (IDVariant AnnoProg, IDVariant NumeroProg, IDVariant Percorsofile, IDVariant NuovoDoc, IDVariant IDDoc)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    it.finmatica.dmServer.management.Profilo P = null;
    it.finmatica.kofax.AllineaDbKfx12 v_AL = null;
    IDVariant v_CODICE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_ANNORIF = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_NUMERORIF = new IDVariant(0,IDVariant.STRING);
    IDVariant v_ANNODOC = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_NUMERODOC = new IDVariant(0,IDVariant.STRING);
    IDVariant v_DATADOC = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_ANNOPROT = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_NUMEROPROT = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_DATAPROT = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CODICEDOC = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_STORNO = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_TIPOPAGAMENT = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_UFFICIOINVIO = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_DESCRIZIONE = new IDVariant(0,IDVariant.STRING);
    IDVariant v_IMPORTO = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_DIFFERENZAIV = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_NUMQUIETANZA = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CATEGORIA = new IDVariant(0,IDVariant.STRING);
    IDVariant v_ACQUISTOCEE = new IDVariant(0,IDVariant.STRING);
    IDVariant v_MONETA = new IDVariant(0,IDVariant.STRING);
    IDVariant v_ESLUSIONEELE = new IDVariant(0,IDVariant.STRING);
    IDVariant v_SCADENZA = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_RIVENDITA = new IDVariant(0,IDVariant.STRING);
    IDVariant v_VARIAZIONI = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_IMPUTATO = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_DDATADOC = new IDVariant(0,IDVariant.DATETIME);
    IDVariant v_DDATAPROT = new IDVariant(0,IDVariant.DATETIME);
    IDVariant v_DSCADENZA = new IDVariant(0,IDVariant.DATETIME);
    IDVariant v_BUONI = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_LIREEURO = new IDVariant(0,IDVariant.STRING);
    IDVariant v_IMPORTOEURO = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_TIPOUTENZA = new IDVariant(0,IDVariant.STRING);
    IDVariant v_CODICEUTENZA = new IDVariant(0,IDVariant.STRING);
    IDVariant v_BLOCCOPAGAME = new IDVariant(0,IDVariant.STRING);
    IDVariant v_CODIMPECO = new IDVariant(0,IDVariant.STRING);
    IDVariant v_ANNOORDINE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_NUMEROORDINE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_FLAGIVAECO = new IDVariant(0,IDVariant.STRING);
    IDVariant v_FLAGDAFS4 = new IDVariant(0,IDVariant.STRING);
    IDVariant v_DATARIENTRO = new IDVariant(0,IDVariant.DATETIME);
    IDVariant v_NUMUTENTE = new IDVariant(0,IDVariant.STRING);
    IDVariant v_IDDOCUMENTAL = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_NOTE = new IDVariant(0,IDVariant.STRING);
    IDVariant v_PROGRUNITA = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_UTINS = new IDVariant(0,IDVariant.STRING);
    IDVariant v_DATAINS = new IDVariant(0,IDVariant.DATETIME);
    IDVariant v_UTAGG = new IDVariant(0,IDVariant.STRING);
    IDVariant v_DATAAGG = new IDVariant(0,IDVariant.DATETIME);
    IDVariant v_PROGRUNITAIN = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_DATAINIZOUT = new IDVariant(0,IDVariant.DATETIME);
    IDVariant v_DATAFINEUT = new IDVariant(0,IDVariant.DATETIME);
    IDVariant v_CONSUMIUT = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_ANNODISTINTA = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_NUMERODISTIN = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_DATADISTINTA = new IDVariant(0,IDVariant.DATETIME);
    IDVariant v_STATO = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_NOTESOSPENSI = new IDVariant(0,IDVariant.STRING);
    IDVariant v_PROGRCOMPETE = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_BARCODE = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_TIPODOCUMENT = new IDVariant(0,IDVariant.STRING);
    IDVariant v_RAGIONESOCIA = new IDVariant(0,IDVariant.STRING);
    IDVariant v_AREA = new IDVariant(0,IDVariant.STRING);
    IDVariant v_MODELLO = new IDVariant(0,IDVariant.STRING);
    IDVariant v_PATHFILEPROP = new IDVariant(0,IDVariant.STRING);
    IDVariant v_PATH = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      v_PATH = (new IDVariant("Path File Properties", IDVariant.STRING));
      // 
      // Inserisci Nel Documentale Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.CODICE as FATCODICE, ");
      SQL.append("  A.ANNO_RIF as FATANNORIF, ");
      SQL.append("  A.NUMERO_RIF as FATNUMERORIF, ");
      SQL.append("  A.ANNO_DOC as FATANNODOC, ");
      SQL.append("  A.NUMERO_DOC as FATNUMERODOC, ");
      SQL.append("  A.DATA_DOC as FATDATADOC, ");
      SQL.append("  A.ANNO_PROT as FATANNOPROT, ");
      SQL.append("  A.NUMERO_PROT as FATNUMERPROT, ");
      SQL.append("  A.DATA_PROT as FATDATAPROT, ");
      SQL.append("  A.CODICE_DOC as FATCODICEDOC, ");
      SQL.append("  A.STORNO as FATSTORNO, ");
      SQL.append("  A.TIPO_PAGAMENTO as FATTIPOPAGAM, ");
      SQL.append("  A.UFFICIO_INVIO as FATUFFICINVI, ");
      SQL.append("  A.DESCRIZIONE as FATDESCRIZIO, ");
      SQL.append("  A.IMPORTO as FATIMPORTO, ");
      SQL.append("  A.DIFFERENZA_IVA as FATDIFFERIVA, ");
      SQL.append("  A.NUM_QUIETANZA as FATNUMQUIETA, ");
      SQL.append("  A.CATEGORIA as FATCATEGORIA, ");
      SQL.append("  A.ACQUISTO_CEE as FATACQUISCEE, ");
      SQL.append("  A.MONETA as FATMONETA, ");
      SQL.append("  A.ESCLUSIONE_ELE as FATESCLUSELE, ");
      SQL.append("  A.SCADENZA as FATSCADENZA, ");
      SQL.append("  A.RIVENDITA as FATRIVENDITA, ");
      SQL.append("  A.VARIAZIONI as FATVARIAZION, ");
      SQL.append("  A.IMPUTATO as FATIMPUTATO, ");
      SQL.append("  A.D_DATA_DOC as FATDDATADOC, ");
      SQL.append("  A.D_DATA_PROT as FATDDATAPROT, ");
      SQL.append("  A.D_SCADENZA as FATDSCADENZA, ");
      SQL.append("  A.BUONI as FATBUONI, ");
      SQL.append("  A.LIRE_EURO as FATLIREEURO, ");
      SQL.append("  A.IMPORTO_EURO as FATIMPOREURO, ");
      SQL.append("  A.TIPO_UTENZA as FATTIPOUTENZ, ");
      SQL.append("  A.CODICE_UTENZA as FATCODICUTEN, ");
      SQL.append("  A.BLOCCO_PAGAMENTO as FATBLOCCPAGA, ");
      SQL.append("  A.COD_IMP_ECO as FATCODIMPECO, ");
      SQL.append("  A.ANNO_ORDINE as FATANNOORDIN, ");
      SQL.append("  A.NUMERO_ORDINE as FATNUMERORDI, ");
      SQL.append("  A.FLAG_IVA_ECO as FATFLAIVAECO, ");
      SQL.append("  A.FLAG_DA_FS4 as FATFLAGDAFS4, ");
      SQL.append("  A.DATA_RIENTRO as FATDATARIENT, ");
      SQL.append("  A.NUM_UTENTE as FATNUMUTENTE, ");
      SQL.append("  A.ID_DOCUMENTALE as FATIDDOCUMEN, ");
      SQL.append("  A.NOTE as FATNOTE, ");
      SQL.append("  A.PROGR_UNITA_ORGANIZZATIVA as FATPROUNIORG, ");
      SQL.append("  A.UTENTE_INSERIMENTO as FATUTENTINSE, ");
      SQL.append("  A.DATA_INSERIMENTO as FATDATAINSER, ");
      SQL.append("  A.UTENTE_ULTIMO_AGG as FATUTEULTAGG, ");
      SQL.append("  A.DATA_ULTIMO_AGG as FATDATULTAGG, ");
      SQL.append("  A.PROGR_UNITA_ORGANIZZATIVA_INS as FATPROUNORIN, ");
      SQL.append("  A.DATA_INIZIO_UT as FATDATAINIUT, ");
      SQL.append("  A.DATA_FINE_UT as FATDATAFINUT, ");
      SQL.append("  A.CONSUMI_UT as FATCONSUMIUT, ");
      SQL.append("  A.ANNO_DISTINTA_UT as FATANNODISUT, ");
      SQL.append("  A.NUMERO_DISTINTA_UT as FATNUMEDISUT, ");
      SQL.append("  A.DATA_DISTINTA_UT as FATDATADISUT, ");
      SQL.append("  A.STATO as FATSTATO, ");
      SQL.append("  A.NOTE_SOSPENSIONE as FATNOTESOSPE, ");
      SQL.append("  A.PROGR_UO_COMPETENZA as FATPROGUOCOM, ");
      SQL.append("  A.BARCODE as FATBARCODE ");
      SQL.append("from ");
      SQL.append("  FAT A ");
      SQL.append("where (A.ANNO_PROG = " + IDL.CSql(AnnoProg, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.NUMERO_PROG = " + IDL.CSql(NumeroProg, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CODICE = QV.Get("FATCODICE", IDVariant.INTEGER) ;
        v_ANNORIF = QV.Get("FATANNORIF", IDVariant.INTEGER) ;
        v_NUMERORIF = QV.Get("FATNUMERORIF", IDVariant.STRING) ;
        v_ANNODOC = QV.Get("FATANNODOC", IDVariant.INTEGER) ;
        v_NUMERODOC = QV.Get("FATNUMERODOC", IDVariant.STRING) ;
        v_DATADOC = QV.Get("FATDATADOC", IDVariant.INTEGER) ;
        v_ANNOPROT = QV.Get("FATANNOPROT", IDVariant.INTEGER) ;
        v_NUMEROPROT = QV.Get("FATNUMERPROT", IDVariant.INTEGER) ;
        v_DATAPROT = QV.Get("FATDATAPROT", IDVariant.INTEGER) ;
        v_CODICEDOC = QV.Get("FATCODICEDOC", IDVariant.INTEGER) ;
        v_STORNO = QV.Get("FATSTORNO", IDVariant.INTEGER) ;
        v_TIPOPAGAMENT = QV.Get("FATTIPOPAGAM", IDVariant.INTEGER) ;
        v_UFFICIOINVIO = QV.Get("FATUFFICINVI", IDVariant.INTEGER) ;
        v_DESCRIZIONE = QV.Get("FATDESCRIZIO", IDVariant.STRING) ;
        v_IMPORTO = QV.Get("FATIMPORTO", IDVariant.DECIMAL) ;
        v_DIFFERENZAIV = QV.Get("FATDIFFERIVA", IDVariant.DECIMAL) ;
        v_NUMQUIETANZA = QV.Get("FATNUMQUIETA", IDVariant.INTEGER) ;
        v_CATEGORIA = QV.Get("FATCATEGORIA", IDVariant.STRING) ;
        v_ACQUISTOCEE = QV.Get("FATACQUISCEE", IDVariant.STRING) ;
        v_MONETA = QV.Get("FATMONETA", IDVariant.STRING) ;
        v_ESLUSIONEELE = QV.Get("FATESCLUSELE", IDVariant.STRING) ;
        v_SCADENZA = QV.Get("FATSCADENZA", IDVariant.INTEGER) ;
        v_RIVENDITA = QV.Get("FATRIVENDITA", IDVariant.STRING) ;
        v_VARIAZIONI = QV.Get("FATVARIAZION", IDVariant.DECIMAL) ;
        v_IMPUTATO = QV.Get("FATIMPUTATO", IDVariant.DECIMAL) ;
        v_DDATADOC = QV.Get("FATDDATADOC", IDVariant.DATETIME) ;
        v_DDATAPROT = QV.Get("FATDDATAPROT", IDVariant.DATETIME) ;
        v_DSCADENZA = QV.Get("FATDSCADENZA", IDVariant.DATETIME) ;
        v_BUONI = QV.Get("FATBUONI", IDVariant.DECIMAL) ;
        v_LIREEURO = QV.Get("FATLIREEURO", IDVariant.STRING) ;
        v_IMPORTOEURO = QV.Get("FATIMPOREURO", IDVariant.DECIMAL) ;
        v_TIPOUTENZA = QV.Get("FATTIPOUTENZ", IDVariant.STRING) ;
        v_CODICEUTENZA = QV.Get("FATCODICUTEN", IDVariant.STRING) ;
        v_BLOCCOPAGAME = QV.Get("FATBLOCCPAGA", IDVariant.STRING) ;
        v_CODIMPECO = QV.Get("FATCODIMPECO", IDVariant.STRING) ;
        v_ANNOORDINE = QV.Get("FATANNOORDIN", IDVariant.INTEGER) ;
        v_NUMEROORDINE = QV.Get("FATNUMERORDI", IDVariant.INTEGER) ;
        v_FLAGIVAECO = QV.Get("FATFLAIVAECO", IDVariant.STRING) ;
        v_FLAGDAFS4 = QV.Get("FATFLAGDAFS4", IDVariant.STRING) ;
        v_DATARIENTRO = QV.Get("FATDATARIENT", IDVariant.DATETIME) ;
        v_NUMUTENTE = QV.Get("FATNUMUTENTE", IDVariant.STRING) ;
        v_IDDOCUMENTAL = QV.Get("FATIDDOCUMEN", IDVariant.INTEGER) ;
        v_NOTE = QV.Get("FATNOTE", IDVariant.STRING) ;
        v_PROGRUNITA = QV.Get("FATPROUNIORG", IDVariant.INTEGER) ;
        v_UTINS = QV.Get("FATUTENTINSE", IDVariant.STRING) ;
        v_DATAINS = QV.Get("FATDATAINSER", IDVariant.DATETIME) ;
        v_UTAGG = QV.Get("FATUTEULTAGG", IDVariant.STRING) ;
        v_DATAAGG = QV.Get("FATDATULTAGG", IDVariant.DATETIME) ;
        v_PROGRUNITAIN = QV.Get("FATPROUNORIN", IDVariant.INTEGER) ;
        v_DATAINIZOUT = QV.Get("FATDATAINIUT", IDVariant.DATETIME) ;
        v_DATAFINEUT = QV.Get("FATDATAFINUT", IDVariant.DATETIME) ;
        v_CONSUMIUT = QV.Get("FATCONSUMIUT", IDVariant.DECIMAL) ;
        v_ANNODISTINTA = QV.Get("FATANNODISUT", IDVariant.INTEGER) ;
        v_NUMERODISTIN = QV.Get("FATNUMEDISUT", IDVariant.INTEGER) ;
        v_DATADISTINTA = QV.Get("FATDATADISUT", IDVariant.DATETIME) ;
        v_STATO = QV.Get("FATSTATO", IDVariant.INTEGER) ;
        v_NOTESOSPENSI = QV.Get("FATNOTESOSPE", IDVariant.STRING) ;
        v_PROGRCOMPETE = QV.Get("FATPROGUOCOM", IDVariant.INTEGER) ;
        v_BARCODE = QV.Get("FATBARCODE", IDVariant.DECIMAL) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.DESCRIZIONE as T03DESCRIZIO ");
      SQL.append("from ");
      SQL.append("  T03 A ");
      SQL.append("where (A.STORNO = " + IDL.CSql(v_STORNO, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.CODICE = " + IDL.CSql(v_CODICEDOC, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_TIPODOCUMENT = QV.Get("T03DESCRIZIO", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.RAGIONE_SOCIALE as BENRAGIOSOCI ");
      SQL.append("from ");
      SQL.append("  BEN A ");
      SQL.append("where (A.CODICE = " + IDL.CSql(v_CODICE, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_RAGIONESOCIA = QV.Get("BENRAGIOSOCI", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = 'PRODUCTS/GDM') ");
      SQL.append("and   (A.STRINGA = 'Area') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_AREA = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = 'PRODUCTS/GDM/FATTURE') ");
      SQL.append("and   (A.STRINGA = 'Modello') ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_MODELLO = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = 'PRODUCTS/GDM') ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_PATH, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_PATHFILEPROP = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      if (NuovoDoc.equals((new IDVariant(1)), true))
      {
        P = new it.finmatica.dmServer.management.Profilo(v_MODELLO.toString(),v_AREA.toString());
         
      }
      else
      {
        P = new it.finmatica.dmServer.management.Profilo(IDL.ToString(IDDoc).toString());
         
      }
      // P.initVarEnv((new IDVariant("GDM")).toString(),(new IDVariant("GDM")).toString(),IDL.Add(IDL.Add((new IDVariant(MainFrm.RealPath)), (new IDVariant("\\"))), (new IDVariant("gd4dm.properties"))).toString()); 
      // MainFrm.set_AlertMessage(new IDVariant((String)P.getArea())); 
      P.initVarEnv((new IDVariant("GDM")).toString(),(new IDVariant("GDM")).toString(),v_PATHFILEPROP.toString()); 
      P.addCompetenza(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0).toString(),(new IDVariant("U")).toString()); 
      P.addCompetenza(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0).toString(),(new IDVariant("L")).toString()); 
      if (NuovoDoc.booleanValue() || IDL.IsNull(IMDB.Value(IMDBDef9.PQRY_FAT11, IMDBDef9.PQSL_FAT11_IMG_DOCUMENTALE, 0)))
      {
        if (IDL.IsNull(IMDB.Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMEBARCO, 0)))
        {
          try
          {
            P.setFileName(Percorsofile.toString()); 
          }
          catch (Exception e7)
          {
            MainFrm.set_AlertMessage(new IDVariant((String)P.getError())); 
            return 0;
          }
        }
      }
      // P.settaValore((new IDVariant("CODICE")).toString(),v_CODICE.toString()); 
      // P.settaValore((new IDVariant("ANNO_RIF")).toString(),v_ANNORIF.toString()); 
      // P.settaValore((new IDVariant("NUMERO_RIF")).toString(),v_NUMERORIF.toString()); 
      // P.settaValore((new IDVariant("ANNO_PROG")).toString(),v_ANNODOC.toString()); 
      // P.settaValore((new IDVariant("NUMERO_PROG")).toString(),v_NUMERODOC.toString()); 
      P.settaValore((new IDVariant("DESCRIZIONE")).toString(),v_DESCRIZIONE.toString()); 
      // P.settaValore((new IDVariant("IMPORTO")).toString(),v_IMPORTO.toString()); 
      P.settaValore((new IDVariant("NUMERO_PROT")).toString(),v_NUMEROPROT.toString()); 
      // P.settaValore((new IDVariant("ANNO_PROT")).toString(),v_ANNOPROT.toString()); 
      P.settaValore((new IDVariant("DATA_PROT")).toString(),v_DDATAPROT.toString()); 
      P.settaValore((new IDVariant("NUMERO_DOC")).toString(),v_NUMERODOC.toString()); 
      // P.settaValore((new IDVariant("ANNO_DOC")).toString(),v_ANNODOC.toString()); 
      P.settaValore((new IDVariant("DATA_DOC")).toString(),v_DDATADOC.toString()); 
      P.settaValore((new IDVariant("IMPORTO")).toString(),v_IMPORTO.toString()); 
      P.settaValore((new IDVariant("RAGIONE_SOCIALE")).toString(),v_RAGIONESOCIA.toString()); 
      P.settaValore((new IDVariant("TIPO_DOC")).toString(),v_TIPODOCUMENT.toString()); 
      P.settaValore((new IDVariant("BARCODE_KEY")).toString(),IMDB.Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMEBARCO, 0).toString()); 
      P.settaACL(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0).toString(),(new IDVariant("Global.NO_ACCESS")).toString()); 
      if (!(P.salva().booleanValue()))
      {
        MainFrm.set_AlertMessage(new IDVariant((String)P.getError())); 
        return 0;
      }
      else
      {
        IDVariant v_NUMDOC = new IDVariant(0,IDVariant.STRING);
        IDVariant v_SMS2 = new IDVariant(0,IDVariant.STRING);
        v_SMS2 = (new IDVariant("La Fattura è stata inserita nel Documentale", IDVariant.STRING));
        if (NuovoDoc.equals((new IDVariant(1)), true))
        {
          v_NUMDOC = new IDVariant((String)P.getDocNumber());
          MainFrm.set_AlertMessage(v_SMS2); 
          try
          {
            IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);
            SQL = new StringBuffer();
            SQL.append("update FAT set ");
            SQL.append("  ID_DOCUMENTALE = TRUNC(TO_NUMBER(" + IDL.CSql(v_NUMDOC, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ")), ");
            SQL.append("  BARCODE = " + IDL.CSql(IMDB.Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMEBARCO, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", ");
            SQL.append("  IMG_DOCUMENTALE = 'SI' ");
            SQL.append("where (ANNO_PROG = " + IDL.CSql(AnnoProg, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
            SQL.append("and   (NUMERO_PROG = " + IDL.CSql(NumeroProg, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
            MainFrm.Cf4armDBObject.DBO().Execute(SQL);
            SQL = new StringBuffer();
            SQL.append("select ");
            SQL.append("  COUNT(*) as COUNT1 ");
            SQL.append("from ");
            SQL.append("  DOCUMENTALE A ");
            SQL.append("where (A.ID_DOCUMENTALE = TRUNC(TO_NUMBER(" + IDL.CSql(v_NUMDOC, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + "))) ");
            QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
            if (!QV.EOF()) QV.MoveNext();
            if (!QV.EOF())
            {
              v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
            }
            QV.Close();
            if (v_CONTATORE.equals((new IDVariant(0)), true))
            {
              SQL = new StringBuffer();
              SQL.append("insert into DOCUMENTALE ");
              SQL.append("( ");
              SQL.append("  ID_DOCUMENTALE, ");
              SQL.append("  BARCODE, ");
              SQL.append("  TIPO_MOVI, ");
              SQL.append("  ANNO_MOVI, ");
              SQL.append("  NUMERO_MOVI ");
              SQL.append(") ");
              SQL.append("values ");
              SQL.append("( ");
              SQL.append("  TRUNC(TO_NUMBER(" + IDL.CSql(v_NUMDOC, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ")), ");
              SQL.append("  " + IDL.CSql(IMDB.Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMEBARCO, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", ");
              SQL.append("  'FAT', ");
              SQL.append("  " + IDL.CSql(AnnoProg, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", ");
              SQL.append("  " + IDL.CSql(NumeroProg, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " ");
              SQL.append(") ");
              MainFrm.Cf4armDBObject.DBO().Execute(SQL);
            }
            else
            {
              SQL = new StringBuffer();
              SQL.append("update DOCUMENTALE set ");
              SQL.append("  BARCODE = " + IDL.CSql(IMDB.Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMEBARCO, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " ");
              SQL.append("where (ID_DOCUMENTALE = TRUNC(TO_NUMBER(" + IDL.CSql(v_NUMDOC, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + "))) ");
              MainFrm.Cf4armDBObject.DBO().Execute(SQL);
            }
            VBFiles.Kill(Percorsofile); 
            VBFiles.Kill(IDL.Add(IDL.Add(IDL.Add(IDL.Add((new IDVariant(MainFrm.RealPath)), (new IDVariant("/"))), (new IDVariant("temp"))), (new IDVariant("/"))), IMDB.Value(IMDBDef2.TBL_EVENTOBLOB, IMDBDef2.FLD_EVENTOBLOB_ROWNAMFILPAT, 0))); 
            if (IMDB.Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMVARIBA, 0).equals((new IDVariant(2)), true))
            {
              IDVariant v_RIT = new IDVariant(0,IDVariant.INTEGER);
              v_AL = new it.finmatica.kofax.AllineaDbKfx12((new IDVariant("GDM")).toString(),(new IDVariant("GDM")).toString(),v_PATHFILEPROP.toString(),"S");
               
              v_RIT = (new IDVariant());
              v_RIT = new IDVariant(v_AL.allineaOneDoc (IDL.ToString(IMDB.Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMEBARCO, 0)).toString()));
              if (v_RIT.equals((new IDVariant(0)), true))
              {
                IDVariant v_SMS1 = new IDVariant(0,IDVariant.STRING);
                v_SMS1 = (new IDVariant("Errore interno durante l'allineamento tra CF4 e Documentale", IDVariant.STRING));
                MainFrm.set_AlertMessage(v_SMS1); 
                return 0;
              }
            }
          }
          catch (Exception e) {}
          MainFrm.UnloadForm(MyGlb.FRM_ACQUIMMAFATT,(new IDVariant(-1)).booleanValue()); 
          ((Fattura)MainFrm.GetForm(MyGlb.FRM_FATTURA,0)).PAN_FATTURA.PanelCommand(Glb.PCM_REQUERY);
        }
        else
        {
          if ((MainFrm.GetForm(MyGlb.FRM_ACQUIMMAFATT, 0, false)!=null))
          {
            IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
            v_SMS = (new IDVariant("Immagine inserita nel Documentale", IDVariant.STRING));
            VBFiles.Kill(Percorsofile); 
            VBFiles.Kill(IDL.Add(IDL.Add(IDL.Add(IDL.Add((new IDVariant(MainFrm.RealPath)), (new IDVariant("/"))), (new IDVariant("temp"))), (new IDVariant("/"))), IMDB.Value(IMDBDef2.TBL_EVENTOBLOB, IMDBDef2.FLD_EVENTOBLOB_ROWNAMFILPAT, 0))); 
            SQL = new StringBuffer();
            SQL.append("update FAT set ");
            SQL.append("  IMG_DOCUMENTALE = 'SI' ");
            SQL.append("where (ANNO_PROG = " + IDL.CSql(AnnoProg, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
            SQL.append("and   (NUMERO_PROG = " + IDL.CSql(NumeroProg, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
            MainFrm.Cf4armDBObject.DBO().Execute(SQL);
            MainFrm.UnloadForm(MyGlb.FRM_ACQUIMMAFATT,(new IDVariant(-1)).booleanValue()); 
            ((Fattura)MainFrm.GetForm(MyGlb.FRM_FATTURA,0)).PAN_FATTURA.PanelCommand(Glb.PCM_REQUERY);
            MainFrm.set_AlertMessage(v_SMS); 
          }
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "InserisciNelDocumentale", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Integrazione Doc
  // Explain which processing is carried out by this procedure
  // Barcode:  - Input
  // **********************************************************************
  public int IntegrazioneDoc (IDVariant Barcode)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    it.finmatica.kofax.AllineaDbKfx12 v_AL = null;
    IDVariant v_VALOREDIRITO = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_PATHFILEPROP = new IDVariant(0,IDVariant.STRING);
    IDVariant v_PATH = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      v_PATH = (new IDVariant("Path File Properties", IDVariant.STRING));
      // 
      // Integrazione Doc Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.VALORE as REGISTVALORE ");
      SQL.append("from ");
      SQL.append("  REGISTRO A ");
      SQL.append("where (A.CHIAVE = 'PRODUCTS/GDM') ");
      SQL.append("and   (A.STRINGA = " + IDL.CSql(v_PATH, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_PATHFILEPROP = QV.Get("REGISTVALORE", IDVariant.STRING) ;
      }
      QV.Close();
      v_AL = new it.finmatica.kofax.AllineaDbKfx12((new IDVariant("GDM")).toString(),(new IDVariant("GDM")).toString(),v_PATHFILEPROP.toString(),"S");
       
      if (IDL.NullValue(Barcode,(new IDVariant(1))).compareTo((new IDVariant(1)), true)!=0)
      {
        v_VALOREDIRITO = new IDVariant(v_AL.checkBC(IDL.ToString(Barcode).toString()));
        if (v_VALOREDIRITO.equals((new IDVariant(1)), true))
        {
          IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
          v_SMS = (new IDVariant("Barcode non presente sul repository di kofax", IDVariant.STRING));
          MainFrm.set_AlertMessage(v_SMS); 
          return 0;
        }
        if (v_VALOREDIRITO.equals((new IDVariant(3)), true))
        {
          IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
          v_SMS = (new IDVariant("Barcode già presente nel Documentale", IDVariant.STRING));
          MainFrm.set_AlertMessage(v_SMS); 
          return 0;
        }
        if (v_VALOREDIRITO.equals((new IDVariant(0)), true))
        {
          IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
          v_SMS = (new IDVariant("Barcode non valido. Inserirne uno corretto.", IDVariant.STRING));
          MainFrm.set_AlertMessage(v_SMS); 
          return 0;
        }
        else
        {
          IMDB.set_Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMVARIBA, 0, new IDVariant(v_VALOREDIRITO));
          IMDB.set_Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMANNPRO, 0, IMDB.Value(IMDBDef9.PQRY_FAT11, IMDBDef9.PQSL_FAT11_ANNO_PROG, 0));
          IMDB.set_Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMNUMPRO, 0, IMDB.Value(IMDBDef9.PQRY_FAT11, IMDBDef9.PQSL_FAT11_NUMERO_PROG, 0));
          IMDB.set_Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMNUMDOC, 0, IMDB.Value(IMDBDef9.PQRY_FAT11, IMDBDef9.PQSL_FAT11_NUMERO_DOC, 0));
          IMDB.set_Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMANNDOC, 0, IMDB.Value(IMDBDef9.PQRY_FAT11, IMDBDef9.PQSL_FAT11_ANNO_DOC, 0));
          if (IDL.IsNull(IMDB.Value(IMDBDef9.PQRY_FAT11, IMDBDef9.PQSL_FAT11_ID_DOCUMENTALE, 0)))
          {
            IMDB.set_Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMNUODOC, 0, (new IDVariant(1)));
          }
          else
          {
            IMDB.set_Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMNUODOC, 0, (new IDVariant(0)));
          }
          IMDB.set_Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMEIDDOC, 0, new IDVariant(IMDB.Value(IMDBDef9.PQRY_FAT11, IMDBDef9.PQSL_FAT11_ID_DOCUMENTALE, 0),IDVariant.INTEGER));
          MainFrm.Show(MyGlb.FRM_ACQUIMMAFATT, (new IDVariant(0)).intValue(), this); 
        }
      }
      else
      {
        IMDB.set_Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMVARIBA, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMANNPRO, 0, IMDB.Value(IMDBDef9.PQRY_FAT11, IMDBDef9.PQSL_FAT11_ANNO_PROG, 0));
        IMDB.set_Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMNUMPRO, 0, IMDB.Value(IMDBDef9.PQRY_FAT11, IMDBDef9.PQSL_FAT11_NUMERO_PROG, 0));
        IMDB.set_Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMNUMDOC, 0, IMDB.Value(IMDBDef9.PQRY_FAT11, IMDBDef9.PQSL_FAT11_NUMERO_DOC, 0));
        IMDB.set_Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMANNDOC, 0, IMDB.Value(IMDBDef9.PQRY_FAT11, IMDBDef9.PQSL_FAT11_ANNO_DOC, 0));
        if (IDL.IsNull(IMDB.Value(IMDBDef9.PQRY_FAT11, IMDBDef9.PQSL_FAT11_ID_DOCUMENTALE, 0)))
        {
          IMDB.set_Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMNUODOC, 0, (new IDVariant(1)));
        }
        else
        {
          IMDB.set_Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMNUODOC, 0, (new IDVariant(0)));
        }
        IMDB.set_Value(IMDBDef2.TBL_PARAM1, IMDBDef2.FLD_PARAM1_ROWNAMEIDDOC, 0, new IDVariant(IMDB.Value(IMDBDef9.PQRY_FAT11, IMDBDef9.PQSL_FAT11_ID_DOCUMENTALE, 0),IDVariant.INTEGER));
        MainFrm.Show(MyGlb.FRM_ACQUIMMAFATT, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "IntegrazioneDoc", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Scarica ZIP
  // Nome File - Input
  // **********************************************************************
  public int ScaricaZIP (IDVariant NomeFile)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDCachedRowSet C4;

    try
    {
      TransCount = 0;
      // 
      // Scarica ZIP Body
      // Corpo Procedura
      // 
      IDVariant v_FILE = new IDVariant(0,IDVariant.STRING);
      if (IDL.IsNull(NomeFile))
      {
        return 0;
      }
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.FILE_ZIP as BLOBZIP ");
      SQL.append("from ");
      SQL.append("  CFAT_FILE_ZIP A ");
      SQL.append("where (A.NOME_FILE_ZIP = " + IDL.CSql(NomeFile, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      C4 = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!C4.EOF()) C4.MoveNext();
      while (!C4.EOF())
      {
        v_FILE = Glb.SaveBlob(MainFrm,C4.Get("BLOBZIP"),IDL.Add((new IDVariant(MainFrm.RealPath)), (new IDVariant("/temp"))),NomeFile);
        C4.MoveNext();
      }
      C4.Close();
      if (v_FILE.compareTo((new IDVariant("")), true)!=0)
      {
        MainFrm.AddTempFile(v_FILE.stringValue()); 
        MainFrm.set_RedirectTo(v_FILE);
        MainFrm.set_RedirectNewWindow((new IDVariant(-1)).booleanValue());
        MainFrm.set_RedirectFeatures((new IDVariant("save"))); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ScaricaZIP", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Interscambio SDI
  // **********************************************************************
  public int InterscambioSDI ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Interscambio SDI Body
      // Corpo Procedura
      // 
      if (GDMCONNTYPE.equals((new IDVariant("SSO")), true))
      {
        IDVariant v_VGETURLESCAP = new IDVariant(0,IDVariant.STRING);
        IDVariant v_TOKEN = new IDVariant(0,IDVariant.STRING);
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  INDE_FE_PASSIVA.SSO_KEY(" + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") as KEYSESUSENAM ");
        SQL.append("from ");
        SQL.append("  DUAL A ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_TOKEN = QV.Get("KEYSESUSENAM", IDVariant.STRING) ;
        }
        QV.Close();
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  INDE_FE_PASSIVA.GET_URL_ESCAPE(" + IDL.CSql(v_TOKEN, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ",1) as GETURLESCTO1 ");
        SQL.append("from ");
        SQL.append("  DUAL A ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VGETURLESCAP = QV.Get("GETURLESCTO1", IDVariant.STRING) ;
        }
        QV.Close();
        IDVariant v_URL = null;
        v_URL = IDL.Add(IDL.Add(IDL.Add(GDMSSO, (new IDVariant("?token="))), v_VGETURLESCAP), (new IDVariant("&webapp=GDM")));
        MainFrm.set_RedirectTo(v_URL);
        MainFrm.set_RedirectNewWindow((new IDVariant(-1)).booleanValue());
        MainFrm.set_RedirectFeatures((new IDVariant(""))); 
      }
      if (GDMCONNTYPE.equals((new IDVariant("DIRETTO")), true))
      {
        MainFrm.set_RedirectTo(GDMURL);
        MainFrm.set_RedirectNewWindow((new IDVariant(-1)).booleanValue());
        MainFrm.set_RedirectFeatures((new IDVariant(""))); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "InterscambioSDI", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri File XML Comun Liq Iva
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // Esercizio - Input
  // Periodo - Input
  // **********************************************************************
  public int ApriFileXMLComunLiqIva (IDVariant Esercizio, IDVariant Periodo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    int CurPos=0;
    IDCachedRowSet C3;

    try
    {
      TransCount = 0;
      // 
      // Apri File XML Comun Liq Iva Body
      // Corpo Procedura
      // 
      IDVariant v_FD = null;
      v_FD = MainFrm.VBFile.FreeFile();
      IDVariant v_VCF = new IDVariant(0,IDVariant.STRING);
      IDVariant v_VPROGRC = new IDVariant(0,IDVariant.STRING);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.CODICE_FISCALE as COMLIQIVCOFI, ");
      SQL.append("  LPAD(TO_CHAR ( A.PROGR_COMUNICAZIONE ), 2, SUBSTR('0', 1, 1)) as FILTSCLIPC20 ");
      SQL.append("from ");
      SQL.append("  COMUNICAZIONE_LIQ_IVA A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.TRIMESTRE = " + IDL.CSql(Periodo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCF = QV.Get("COMLIQIVCOFI", IDVariant.STRING) ;
        v_VPROGRC = QV.Get("FILTSCLIPC20", IDVariant.STRING) ;
      }
      QV.Close();
      if (IDL.Length(v_VCF).equals((new IDVariant(0)), true))
      {
        v_VCF = IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_COD_FISCALE, 0);
      }
      IDVariant v_NOMEFILE = new IDVariant(0,IDVariant.STRING);
      v_NOMEFILE = IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add((new IDVariant("IT")), v_VCF), (new IDVariant("_"))), (new IDVariant("LI"))), (new IDVariant("_"))), IDL.Right(IDL.ToString(Esercizio), (new IDVariant(2)))), IDL.ToString(Periodo)), v_VPROGRC), (new IDVariant(".xml")));
      // IDVariant v_FILE = null;
      // v_FILE = Glb.SaveBlob(MainFrm,C3.Get("FILE_XML"),IDL.Add(IDL.Add((new IDVariant(MainFrm.RealPath)), (new IDVariant("/"))), (new IDVariant("temp"))),v_NOMEFILE);
      MainFrm.VBFile.OpenForOutput(IDL.Add(IDL.Add(IDL.Add(IDL.Add((new IDVariant(MainFrm.RealPath)), (new IDVariant("/"))), (new IDVariant("temp"))), (new IDVariant("/"))), v_NOMEFILE), v_FD, false); 
      IDVariant v_VCOMLIIVFIXM = new IDVariant(0,IDVariant.STRING);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.FILE_XML as COMLIQIVFIXM ");
      SQL.append("from ");
      SQL.append("  COMUNICAZIONE_LIQ_IVA A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.TRIMESTRE = " + IDL.CSql(Periodo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCOMLIIVFIXM = QV.Get("COMLIQIVFIXM", IDVariant.STRING) ;
      }
      QV.Close();
      // C3 = PAN_DATCOMLIQIVA.MasterRS();
      // if (C3.size()>0) CurPos = C3.getRow(); else CurPos = 0;
      // if (!C3.Bof()) PAN_DATCOMLIQIVA.GotoFirst();
      // while (!PAN_DATCOMLIQIVA.RSEOF())
      // {
      //   PAN_DATCOMLIQIVA.GotoNext();
      // }
      // if (CurPos>0) C3.absolute(CurPos);
      MainFrm.VBFile.WriteLine(v_FD, v_VCOMLIIVFIXM); 
      MainFrm.VBFile.Close(v_FD); 
      MainFrm.AddTempFile(IDL.Add(IDL.Add((new IDVariant(MainFrm.RealPath)), (new IDVariant("temp/"))), v_NOMEFILE).stringValue()); 
      MainFrm.set_RedirectTo(IDL.Add((new IDVariant("temp/")), v_NOMEFILE));
      MainFrm.set_RedirectNewWindow((new IDVariant(-1)).booleanValue());
      MainFrm.set_RedirectFeatures((new IDVariant("save"))); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriFileXMLComunLiqIva", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Stanziamenti Effettivo
  // **********************************************************************
  public int ApriStanziamentiEffettivo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Stanziamenti Effettivo Body
      // Procedure Body
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_STANBILAEFF1, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_STANBILAEFF1,(new IDVariant(0)).booleanValue()); 
      }
      // 
      // controllo se la fase di bilancio è valida, se valida apro la form
      // 
      {
        if (FASEBILANCIO.compareTo((new IDVariant(2)), true)>0)
        {
          IMDB.set_Value(IMDBDef3.TBL_FILTRI16, IMDBDef3.FLD_FILTRI16_ROWNAMELOCKE, 0, (new IDVariant("SI")));
        }
        else
        {
          IMDB.set_Value(IMDBDef3.TBL_FILTRI16, IMDBDef3.FLD_FILTRI16_ROWNAMELOCKE, 0, (new IDVariant()));
        }
        IMDB.set_Value(IMDBDef3.TBL_FILTRI16, IMDBDef3.FLD_FILTRI16_ROWNAMENTSPE, 0, (new IDVariant("S")));
        MainFrm.Show(MyGlb.FRM_STANBILAEFF1, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriStanziamentiEffettivo", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Stanziamenti Simulato
  // **********************************************************************
  public int ApriStanziamentiSimulato ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Stanziamenti Simulato Body
      // Procedure Body
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_STANBILASIM1, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_STANBILASIM1,(new IDVariant(0)).booleanValue()); 
      }
      // 
      // controllo se la fase di bilancio è valida, se valida apro la form
      // 
      {
        if (FASEBILANCIO.compareTo((new IDVariant(2)), true)>0)
        {
          IMDB.set_Value(IMDBDef3.TBL_FILTRI17, IMDBDef3.FLD_FILTRI17_ROWNAMELOCKE, 0, (new IDVariant("SI")));
        }
        else
        {
          IMDB.set_Value(IMDBDef3.TBL_FILTRI17, IMDBDef3.FLD_FILTRI17_ROWNAMELOCKE, 0, (new IDVariant()));
        }
        MainFrm.Show(MyGlb.FRM_STANBILASIM1, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriStanziamentiSimulato", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Stanziamenti Di Effettivo Vg
  // **********************************************************************
  public int ApriStanziamentiDiEffettivoVg ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Stanziamenti Di Effettivo Vg Body
      // Procedure Body
      // 
      // 
      // controllo se la fase di bilancio è valida, se valida apro la form
      // 
      {
        MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
        if (FASEBILANCIO.compareTo((new IDVariant(0)), true)!=0 && FASEBILANCIO.compareTo((new IDVariant(1)), true)!=0)
        {
          IDVariant v_MSG = new IDVariant(0,IDVariant.STRING);
          v_MSG = (new IDVariant("Modifica stanziamenti non abilitata per la fase di bilancio  corrente", IDVariant.STRING));
          MainFrm.set_AlertMessage(v_MSG); 
        }
        else
        {
          IMDB.set_Value(IMDBDef3.TBL_FILTREFFETVG, IMDBDef3.FLD_FILTREFFETVG_ROWNAMEENTRA, 0, (new IDVariant("S")));
          MainFrm.Show(MyGlb.FRM_STANBILEFFVG, (new IDVariant(0)).intValue(), this); 
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriStanziamentiDiEffettivoVg", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Stanziamenti Bilancio Simulato Vg
  // **********************************************************************
  public int ApriStanziamentiBilancioSimulatoVg ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Stanziamenti Bilancio Simulato Vg Body
      // Procedure Body
      // 
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      IMDB.set_Value(IMDBDef3.TBL_FILTRSIMULVG, IMDBDef3.FLD_FILTRSIMULVG_ROWNAMEENTRA, 0, (new IDVariant("S")));
      // 
      // controllo se la fase di bilancio è valida, se valida apro la form
      // 
      {
        if (FASEBILANCIO.compareTo((new IDVariant(0)), true)!=0 && FASEBILANCIO.compareTo((new IDVariant(1)), true)!=0)
        {
          IDVariant v_MSG = new IDVariant(0,IDVariant.STRING);
          v_MSG = (new IDVariant("Modifica stanziamenti non abilitata per la fase di bilancio  corrente", IDVariant.STRING));
          MainFrm.set_AlertMessage(v_MSG); 
        }
        else
        {
          IMDB.set_Value(IMDBDef3.TBL_FILTRSIMULVG, IMDBDef3.FLD_FILTRSIMULVG_ROWNAMEENTRA, 0, (new IDVariant("S")));
          MainFrm.Show(MyGlb.FRM_STANBILSIMVG, (new IDVariant(0)).intValue(), this); 
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriStanziamentiBilancioSimulatoVg", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Lancia Stampa Amministrazione Trasparente
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int LanciaStampaAmministrazioneTrasparente ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Lancia Stampa Amministrazione Trasparente Body
      // Corpo Procedura
      // 
      if (IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0).compareTo((new IDVariant(2016)), true)<0)
      {
        MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
        MainFrm.Cf4armDBObject.WORKBILAMMTRASP(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), PROGRESESSIO);
        if (IDL.NullValue((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())),(new IDVariant(""))).compareTo((new IDVariant("")), true)!=0)
        {
          MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
          return 0;
        }
        SetParametroStampaJasper((new IDVariant("ESERCIZIO")), IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)));
        SetParametroStampaJasper((new IDVariant("SESSIONE")), IDL.ToString(PROGRESESSIO));
        IDVariant v_NOMESTAMPA = new IDVariant(0,IDVariant.STRING);
        v_NOMESTAMPA = (new IDVariant("Prospetto_altri_enti"));
        LanciaStampaJasper(v_NOMESTAMPA, (new IDVariant("")), (new IDVariant("")), (new IDVariant("")));
      }
      else
      {
        if ((MainFrm.GetForm(MyGlb.FRM_AMMINITRASPA, 0, false)!=null))
        {
          MainFrm.UnloadForm(MyGlb.FRM_AMMINITRASPA,(new IDVariant(0)).booleanValue()); 
        }
        IMDB.set_Value(IMDBDef3.TBL_PARS25, IMDBDef3.FLD_PARS25_NOMOGGCONPRE, 0, (new IDVariant("A")));
        MainFrm.Show(MyGlb.FRM_AMMINITRASPA, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "LanciaStampaAmministrazioneTrasparente", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Lancia Stampa Amministrazione Trasp Cons
  // **********************************************************************
  public int LanciaStampaAmministrazioneTraspCons ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Lancia Stampa Amministrazione Trasp Cons Body
      // Corpo Procedura
      // 
      if (IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0).compareTo((new IDVariant(2016)), true)<0)
      {
        MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
        MainFrm.Cf4armDBObject.WORK_BIL_AMM_TRASP_CONS(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), PROGRESESSIO);
        if (IDL.NullValue((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())),(new IDVariant(""))).compareTo((new IDVariant("")), true)!=0)
        {
          MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
          return 0;
        }
        SetParametroStampaJasper((new IDVariant("ESERCIZIO")), IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)));
        SetParametroStampaJasper((new IDVariant("SESSIONE")), IDL.ToString(PROGRESESSIO));
        IDVariant v_NOMESTAMPA = new IDVariant(0,IDVariant.STRING);
        v_NOMESTAMPA = (new IDVariant("Prospetto_altri_enti"));
        LanciaStampaJasper(v_NOMESTAMPA, (new IDVariant("")), (new IDVariant("")), (new IDVariant("")));
      }
      else
      {
        if ((MainFrm.GetForm(MyGlb.FRM_AMMINITRASPA, 0, false)!=null))
        {
          MainFrm.UnloadForm(MyGlb.FRM_AMMINITRASPA,(new IDVariant(0)).booleanValue()); 
        }
        IMDB.set_Value(IMDBDef3.TBL_PARS25, IMDBDef3.FLD_PARS25_NOMOGGCONPRE, 0, (new IDVariant("A")));
        IMDB.set_Value(IMDBDef3.TBL_PARS25, IMDBDef3.FLD_PARS25_NOMOGGCODA20, 0, (new IDVariant("SI")));
        MainFrm.Show(MyGlb.FRM_AMMINITRASPA, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "LanciaStampaAmministrazioneTraspCons", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Lancia Stampa Amministrazione DL77 Prev
  // **********************************************************************
  public int LanciaStampaAmministrazioneDL77Prev ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Lancia Stampa Amministrazione DL77 Prev Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_AMMINITRASPA, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_AMMINITRASPA,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef3.TBL_PARS25, IMDBDef3.FLD_PARS25_NOMOGGCONPRE, 0, (new IDVariant("P")));
      MainFrm.Show(MyGlb.FRM_AMMINITRASPA, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "LanciaStampaAmministrazioneDL77Prev", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Lancia Stampa Amministrazione DL77 Cons
  // **********************************************************************
  public int LanciaStampaAmministrazioneDL77Cons ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Lancia Stampa Amministrazione DL77 Cons Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_AMMINITRASPA, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_AMMINITRASPA,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef3.TBL_PARS25, IMDBDef3.FLD_PARS25_NOMOGGCONPRE, 0, (new IDVariant("C")));
      MainFrm.Show(MyGlb.FRM_AMMINITRASPA, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "LanciaStampaAmministrazioneDL77Cons", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Situazione Generale Per Unita Organizzativa
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public int ApriSituazioneGeneralePerUnitaOrganizzativa ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Situazione Generale Per Unita Organizzativa Body
      // Procedure Body
      // 
      if (IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0).compareTo(IDL.NullValue(ESERCIZIO_INIZIO_WEB,(new IDVariant(2999))), true)<0)
      {
        IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
        v_SMS = (new IDVariant("Unità Organizzative non gestite per l'esercizio ", IDVariant.STRING));
        MainFrm.set_AlertMessage(IDL.Add(v_SMS, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
        return 0;
      }
      MainFrm.Show(MyGlb.FRM_SITGENPEUNOR, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriSituazioneGeneralePerUnitaOrganizzativa", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Gen Imp Da Esig
  // **********************************************************************
  public int ApriGenImpDaEsig ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Gen Imp Da Esig Body
      // Corpo Procedura
      // 
      IDVariant v_VT99TIIMDAES = new IDVariant(0,IDVariant.STRING);
      v_VT99TIIMDAES = (new IDVariant());
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.TIPO_IMP_DA_ESIG as T99TIPIMDAES ");
      SQL.append("from ");
      SQL.append("  T99 A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VT99TIIMDAES = QV.Get("T99TIPIMDAES", IDVariant.STRING) ;
      }
      QV.Close();
      if (IDL.IsNull(v_VT99TIIMDAES))
      {
        IDVariant S = new IDVariant(0,IDVariant.STRING);
        S = (new IDVariant("Tipo Generazione Impegni da Esigibilità non indicato nel dizionario Preferenze"));
        MainFrm.set_AlertMessage(S); 
        return 0;
      }
      IMDB.set_Value(IMDBDef4.TBL_PARS33, IMDBDef4.FLD_PARS33_NOMEOGGEVBVI, 0, new IDVariant(v_VT99TIIMDAES));
      MainFrm.Show(MyGlb.FRM_GENEIMPDAESI, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriGenImpDaEsig", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Chk Controllo 12
  // Explain which processing is carried out by this procedure
  // Esercizio:  - Input
  // Capitolo:  - Input
  // Articolo:  - Input
  // Anno Imp Provenienza:  - Input
  // Imp Da Reiscr Stn:  - Input
  // Cod Livello 5:  - Input
  // Esclusione 12:  - Input
  // Mese:  - Input
  // old Importo:  - Input
  // new Importo:  - Input
  // data Reg - Input
  // Messaggio Non Bloccante:  - Input/Output
  // **********************************************************************
  public IDVariant ChkControllo12 (IDVariant Esercizio, IDVariant Capitolo, IDVariant Articolo, IDVariant AnnoImpProvenienza, IDVariant ImpDaReiscrStn, IDVariant CodLivello5, IDVariant Esclusione12, IDVariant Mese, IDVariant oldImporto, IDVariant newImporto, IDVariant dataReg, IDVariant MessaggioNonBloccante)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_RETVAL = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_IMP = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_STANZ = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_DODICESIMI = new IDVariant(0,IDVariant.DECIMAL);
    IDVariant v_ROUND = new IDVariant(0,IDVariant.DECIMAL);

    try
    {
      TransCount = 0;
      // 
      // Chk Controllo 12 Body
      // Procedure Body
      // 
      try
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A_GET_IMPEGNATO_12(" + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(oldImporto, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(newImporto, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(AnnoImpProvenienza, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(ImpDaReiscrStn, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(dataReg, IDL.FMT_DAT3, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(CodLivello5, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(Esclusione12, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") as AGI1ECAOINIA, ");
        SQL.append("  A_GET_STANZIAMENTO_12(" + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") as AGEST12ESCAA ");
        SQL.append("from ");
        SQL.append("  DUAL A ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_IMP = QV.Get("AGI1ECAOINIA", IDVariant.DECIMAL) ;
          v_STANZ = QV.Get("AGEST12ESCAA", IDVariant.DECIMAL) ;
        }
        QV.Close();
      }
      catch (Exception e3)
      {
        MainFrm.set_AlertMessage(new IDVariant(e3.getMessage())); 
        return (new IDVariant(-1));
      }
      v_DODICESIMI = IDL.Div(Mese, IDL.ToCurrency((new IDVariant(12))));
      v_ROUND = IDL.Round(IDL.Mul(v_STANZ, v_DODICESIMI), (new IDVariant(0)));
      if (v_ROUND.compareTo(v_IMP, true)<0)
      {
        IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
        v_SMS = (new IDVariant("Il Totale Impegnato (", IDVariant.STRING));
        IDVariant v_SMS1 = new IDVariant(0,IDVariant.STRING);
        v_SMS1 = (new IDVariant(") di Missione-Programma ", IDVariant.STRING));
        IDVariant v_SMS2 = new IDVariant(0,IDVariant.STRING);
        v_SMS2 = (new IDVariant(" Titolo ", IDVariant.STRING));
        IDVariant v_SMS3 = new IDVariant(0,IDVariant.STRING);
        v_SMS3 = (new IDVariant(" è superiore ai "));
        IDVariant v_SMS4 = new IDVariant(0,IDVariant.STRING);
        v_SMS4 = (new IDVariant("/12 dello Stanziamento ("));
        IDVariant v_VCAPCODISTRU = new IDVariant(0,IDVariant.STRING);
        IDVariant v_VTITOLO = new IDVariant(0,IDVariant.STRING);
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  A.CODICE_STRUTTURA as CAPCODICSTRU, ");
        SQL.append("  A_GET_COD_RICL_CAP(" + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ",'S'," + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "," + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ",1,'SI','MACRO') as AGCRCESCA1SM ");
        SQL.append("from ");
        SQL.append("  CAP A ");
        SQL.append("where (A.ESERCIZIO = " + IDL.CSql(Esercizio, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.E_S = 'S') ");
        SQL.append("and   (A.CAPITOLO = " + IDL.CSql(Capitolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.ARTICOLO = " + IDL.CSql(Articolo, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VCAPCODISTRU = QV.Get("CAPCODICSTRU", IDVariant.STRING) ;
          v_VTITOLO = QV.Get("AGCRCESCA1SM", IDVariant.STRING) ;
        }
        QV.Close();
        MessaggioNonBloccante.set(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(v_SMS, IDL.Format(v_IMP, (new IDVariant("###,###,###,##0.00")), MainFrm)), v_SMS1), v_VCAPCODISTRU), v_SMS2), v_VTITOLO), v_SMS3), IDL.ToString(Mese)), v_SMS4), IDL.ToString(IDL.Format(v_ROUND, (new IDVariant("###,###,###,##0.00")), MainFrm))), (new IDVariant(")"))));
        v_RETVAL = (new IDVariant(-1));
      }
      else
      {
        v_RETVAL = (new IDVariant(0));
      }
      return v_RETVAL;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ChkControllo12", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Apri Gen Acc Da Esig
  // **********************************************************************
  public int ApriGenAccDaEsig ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Gen Acc Da Esig Body
      // Corpo Procedura
      // 
      MainFrm.Show(MyGlb.FRM_GENEACCDAESI, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriGenAccDaEsig", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Controllo Imputazioni Entrata
  // Explain which processing is carried out by this procedure
  // p Data - Input
  // **********************************************************************
  public int ApriControlloImputazioniEntrata (IDVariant pData)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Controllo Imputazioni Entrata Body
      // Procedure Body
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_CONTROIMPUTA, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_CONTROIMPUTA,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef5.TBL_PARAM63, IMDBDef5.FLD_PARAM63_ROWNAMEES, 0, (new IDVariant("E")));
      IMDB.set_Value(IMDBDef5.TBL_PARAM63, IMDBDef5.FLD_PARAM63_ROWNAMDIVGRU, 0, GetDivisioneGruppi((new IDVariant("E"))));
      IMDB.set_Value(IMDBDef5.TBL_PARAM63, IMDBDef5.FLD_PARAM63_ROWNAMEDATA, 0, new IDVariant(pData));
      IMDB.set_Value(IMDBDef5.TBL_PARAM63, IMDBDef5.FLD_PARAM63_ROWNAMSOSEIM, 0, (new IDVariant("N")));
      SettaNLSCHAR();
      MainFrm.Show(MyGlb.FRM_CONTROIMPUTA, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriControlloImputazioniEntrata", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Controllo Imputazioni Spesa
  // Explain which processing is carried out by this procedure
  // p Data - Input
  // **********************************************************************
  public int ApriControlloImputazioniSpesa (IDVariant pData)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Controllo Imputazioni Spesa Body
      // Procedure Body
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_CONTROIMPUTA, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_CONTROIMPUTA,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef5.TBL_PARAM63, IMDBDef5.FLD_PARAM63_ROWNAMEES, 0, (new IDVariant("S")));
      IMDB.set_Value(IMDBDef5.TBL_PARAM63, IMDBDef5.FLD_PARAM63_ROWNAMDIVGRU, 0, GetDivisioneGruppi((new IDVariant("S"))));
      IMDB.set_Value(IMDBDef5.TBL_PARAM63, IMDBDef5.FLD_PARAM63_ROWNAMEDATA, 0, new IDVariant(pData));
      IMDB.set_Value(IMDBDef5.TBL_PARAM63, IMDBDef5.FLD_PARAM63_ROWNAMSOSEIM, 0, (new IDVariant("N")));
      SettaNLSCHAR();
      MainFrm.Show(MyGlb.FRM_CONTROIMPUTA, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriControlloImputazioniSpesa", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Stampa Controllo Disponibilita Puro
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // p ES - Input
  // p Data - Input
  // **********************************************************************
  public int StampaControlloDisponibilitaPuro (IDVariant pES, IDVariant pData)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Stampa Controllo Disponibilita Puro Body
      // Corpo Procedura
      // 
      IDVariant v_NOMESTAMPA = null;
      v_NOMESTAMPA = (new IDVariant("Gps_Controllo_Dispo_Puro"));
      SetParametroStampaJasper((new IDVariant("P_TITOLO")), IDL.Add((new IDVariant("Disponibilità Puro su Imputazioni Contabili di ")), ((pES.equals((new IDVariant("S")), true))?(new IDVariant("Spesa")):(new IDVariant("Entrata")))));
      // 
      // Carico dati mancanti
      // 
      SetParametroStampaJasper((new IDVariant("P_CODICE_PERS")), IDL.ToString(CODICEPERS));
      SetParametroStampaJasper((new IDVariant("P_DIVISIONE_GRUPPI")), IDL.ToString(IDL.NullValue(GetDivisioneGruppi(pES),(new IDVariant("N")))));
      SetParametroStampaJasper((new IDVariant("P_ES")), IDL.ToString(pES));
      SetParametroStampaJasper((new IDVariant("P_DATA")), IDL.ToString(pData));
      // 
      // Nella stampa vedo sempre anche i valori con impegno
      // 
      // 
      SetParametroStampaJasper((new IDVariant("P_SOLO_SENZA_IMPEGNO")), IDL.ToString((new IDVariant("NO"))));
      LanciaStampaJasper(v_NOMESTAMPA, (new IDVariant("")), (new IDVariant("")), (new IDVariant("")));
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "StampaControlloDisponibilitaPuro", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Controllo Contabile Distinta
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public int ApriControlloContabileDistinta ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Controllo Contabile Distinta Body
      // Procedure Body
      // 
      MainFrm.Show(MyGlb.FRM_CONTCONTDIST, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriControlloContabileDistinta", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Cmd Emissione Manuale Distinta
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public int CmdEmissioneManualeDistinta ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Cmd Emissione Manuale Distinta Body
      // Procedure Body
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
        v_SMS = (new IDVariant("Gestione Movimenti non Ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_SMS); 
        return 0;
      }
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI342, IMDBDef5.FLD_PARAMETRI342_ROWNAMDAMADA, 0, IDL.ToDate(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), (new IDVariant(1)), (new IDVariant(1))));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI342, IMDBDef5.FLD_PARAMETRI342_ROWNAMDAMAAL, 0, IDL.ToDate(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), (new IDVariant(12)), (new IDVariant(31))));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI342, IMDBDef5.FLD_PARAMETRI342_ROWNAMNUMADA, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI342, IMDBDef5.FLD_PARAMETRI342_ROWNAMNUMAAL, 0, (new IDVariant()));
      MainFrm.Show(MyGlb.FRM_EMISMANUDIST, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CmdEmissioneManualeDistinta", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Cmd Liq Da Emettere
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public int CmdLiqDaEmettere ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Cmd Liq Da Emettere Body
      // Procedure Body
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
        v_SMS = (new IDVariant("Gestione Movimenti non Ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_SMS); 
        return 0;
      }
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI290, IMDBDef5.FLD_PARAMETRI290_ROWNAMDALIDA, 0, IDL.ToDate(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), (new IDVariant(1)), (new IDVariant(1))));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI290, IMDBDef5.FLD_PARAMETRI290_ROWNAMDALIAL, 0, IDL.ToDate(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), (new IDVariant(12)), (new IDVariant(31))));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI290, IMDBDef5.FLD_PARAMETRI290_ROWNAMNULIDA, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI290, IMDBDef5.FLD_PARAMETRI290_ROWNAMNULIAL, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI290, IMDBDef5.FLD_PARAMETRI290_ROWNAMSCADAL, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI290, IMDBDef5.FLD_PARAMETRI290_ROWNAMESCAAL, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI290, IMDBDef5.FLD_PARAMETRI290_RONASOLINODF, 0, (new IDVariant("NO")));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI290, IMDBDef5.FLD_PARAMETRI290_RONASOGIINEM, 0, (new IDVariant("NO")));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI290, IMDBDef5.FLD_PARAMETRI290_ROWNAMEORDIN, 0, (new IDVariant("3")));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI290, IMDBDef5.FLD_PARAMETRI290_ROWNAMEUFFIC, 0, (new IDVariant(-1)));
      MainFrm.Show(MyGlb.FRM_LIQDAEMEINMA, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CmdLiqDaEmettere", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Cmd Emissione Manuale Mandato
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public int CmdEmissioneManualeMandato ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Cmd Emissione Manuale Mandato Body
      // Procedure Body
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
        v_SMS = (new IDVariant("Gestione Movimenti non Ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_SMS); 
        return 0;
      }
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI301, IMDBDef5.FLD_PARAMETRI301_ROWNAMDALIDA, 0, IDL.ToDate(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), (new IDVariant(1)), (new IDVariant(1))));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI301, IMDBDef5.FLD_PARAMETRI301_ROWNAMDALIAL, 0, IDL.ToDate(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), (new IDVariant(12)), (new IDVariant(31))));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI301, IMDBDef5.FLD_PARAMETRI301_ROWNAMNULIDA, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI301, IMDBDef5.FLD_PARAMETRI301_ROWNAMNULIAL, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI301, IMDBDef5.FLD_PARAMETRI301_ROWNAMSCADAL, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI301, IMDBDef5.FLD_PARAMETRI301_ROWNAMESCAAL, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI301, IMDBDef5.FLD_PARAMETRI301_RONASOLINODF, 0, (new IDVariant("NO")));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI301, IMDBDef5.FLD_PARAMETRI301_ROWNAMEORDIN, 0, (new IDVariant("1")));
      MainFrm.Show(MyGlb.FRM_EMISMANUMAND, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CmdEmissioneManualeMandato", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Incarichi 1
  // **********************************************************************
  public int ApriIncarichi1 ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Incarichi 1 Body
      // Corpo Procedura
      // 
      if (G_I.equals((new IDVariant("SI")), true))
      {
        if ((MainFrm.GetForm(MyGlb.FRM_INCARICHI, 0, false)!=null))
        {
          MainFrm.UnloadForm(MyGlb.FRM_INCARICHI,(new IDVariant(0)).booleanValue()); 
        }
        MainFrm.Show(MyGlb.FRM_INCARICHI, (new IDVariant(0)).intValue(), this); 
      }
      else
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Incarichi non presente", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriIncarichi1", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Incasso Completo
  // **********************************************************************
  public int ApriIncassoCompleto ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Incasso Completo Body
      // Procedure Body
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_ERR = new IDVariant(0,IDVariant.STRING);
        v_ERR = (new IDVariant("Gestione Movimenti non ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_ERR); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_INCASSCOMPLE, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriIncassoCompleto", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Emissione Ordinativi Da Provvisori
  // **********************************************************************
  public int ApriEmissioneOrdinativiDaProvvisori ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Apri Emissione Ordinativi Da Provvisori Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  ORD_PROV_DETTAGLI A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_ACC > " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CONTATORE.compareTo((new IDVariant(0)), true)>0)
      {
        IDVariant v_ERR = new IDVariant(0,IDVariant.STRING);
        v_ERR = (new IDVariant("Sul gruppo sono presenti Accertamenti di esercizi successivi: non è possibile emettere Ordinativi", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_ERR); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_EMISORDDAPRO, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEmissioneOrdinativiDaProvvisori", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Controllo Codici Gestionali
  // **********************************************************************
  public int ApriControlloCodiciGestionali ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_DATAINIZIOSI = new IDVariant(0,IDVariant.DATETIME);

    try
    {
      TransCount = 0;
      // 
      // Apri Controllo Codici Gestionali Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.DATA_INIZIO_SIOPE as T99DATINISIO ");
      SQL.append("from ");
      SQL.append("  T99 A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_DATAINIZIOSI = QV.Get("T99DATINISIO", IDVariant.DATETIME) ;
      }
      QV.Close();
      if (v_DATAINIZIOSI.equals((new IDVariant()), true))
      {
        IDVariant v_ERR = new IDVariant(0,IDVariant.STRING);
        v_ERR = (new IDVariant("Non esiste l'indicazione della data inizio siope per l'esercizio del contesto", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_ERR); 
      }
      else
      {
        IMDB.set_Value(IMDBDef5.TBL_NEWTABLE2, IMDBDef5.FLD_NEWTABLE2_ROWNAMDAINSI, 0, new IDVariant(v_DATAINIZIOSI));
        MainFrm.Show(MyGlb.FRM_CONTCODIGES1, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriControlloCodiciGestionali", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Trasmissione Ordinativi A Tesoreria
  // **********************************************************************
  public int ApriTrasmissioneOrdinativiATesoreria ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_LICENZAMIF = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Apri Trasmissione Ordinativi A Tesoreria Body
      // Procedure Body
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_ERR = new IDVariant(0,IDVariant.STRING);
        v_ERR = (new IDVariant("Gestione Movimenti non ammessi", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_ERR); 
      }
      else
      {
        v_LICENZAMIF = (new IDVariant(Licenza(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOISTANZ, 0), (new IDVariant("MIF")))));
        if (v_LICENZAMIF.equals((new IDVariant(-1)), true))
        {
          if (DATA_INIZIO_ORD_INF.compareTo((new IDVariant()), true)!=0 && DATA_INIZIO_ORD_INF.compareTo(IDL.Today(), true)<0)
          {
            IDVariant v_ERRMESS = new IDVariant(0,IDVariant.STRING);
            v_ERRMESS = (new IDVariant("Utilizzare la fase di invio dell'Ordinativo Informatico", IDVariant.STRING));
            MainFrm.set_AlertMessage(v_ERRMESS); 
          }
          else
          {
            MainFrm.Show(MyGlb.FRM_TRASORDIATES, (new IDVariant(0)).intValue(), this); 
          }
        }
        else
        {
          MainFrm.Show(MyGlb.FRM_TRASORDIATES, (new IDVariant(0)).intValue(), this); 
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriTrasmissioneOrdinativiATesoreria", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Ricezioni Incassi Da Tesoreria
  // **********************************************************************
  public int ApriRicezioniIncassiDaTesoreria ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Ricezioni Incassi Da Tesoreria Body
      // Procedure Body
      // 
      MainFrm.UnloadForm(MyGlb.FRM_RICPAGINDATE,(new IDVariant(0)).booleanValue()); 
      IMDB.set_Value(IMDBDef6.TBL_PARAMETRI66, IMDBDef6.FLD_PARAMETRI66_ROWNAMEFASE, 0, (new IDVariant("INCASSI")));
      IMDB.set_Value(IMDBDef6.TBL_PARAMETRI66, IMDBDef6.FLD_PARAMETRI66_ROWNAMETIPO, 0, (new IDVariant(2)));
      MainFrm.Show(MyGlb.FRM_RICPAGINDATE, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriRicezioniIncassiDaTesoreria", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Ordinativi Da Imputazioni
  // **********************************************************************
  public int ApriOrdinativiDaImputazioni ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Ordinativi Da Imputazioni Body
      // Procedure Body
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_ERR = new IDVariant(0,IDVariant.STRING);
        v_ERR = (new IDVariant("Gestione Movimenti non ammessi", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_ERR); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_ORDINDAIMPUT, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriOrdinativiDaImputazioni", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Ordinativi Da Distinta Cassa Economale
  // **********************************************************************
  public int ApriOrdinativiDaDistintaCassaEconomale ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CASSAECO = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Apri Ordinativi Da Distinta Cassa Economale Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.CASSA_ECONOMALE as T99CASSAECON ");
      SQL.append("from ");
      SQL.append("  T99 A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CASSAECO = QV.Get("T99CASSAECON", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_CASSAECO.compareTo((new IDVariant(4)), true)!=0)
      {
        IDVariant v_ERR = new IDVariant(0,IDVariant.STRING);
        v_ERR = (new IDVariant("Funzionalità non ammessa. Manca integrazione con Cassa Economale.", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_ERR); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_ORDDADISCAEC, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriOrdinativiDaDistintaCassaEconomale", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Riempi IMDB
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public int RiempiIMDB ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_ATIPO = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Riempi IMDB Body
      // Procedure Body
      // 
      RIEMPIIMDB_IMDVISDELRO1();
      // 
      // gestione imdb
      // 
      {
        if (IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0).equals((new IDVariant(1)), true) || IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0).equals((new IDVariant(2)), true) || IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0).equals((new IDVariant(7)), true) || IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0).equals((new IDVariant(8)), true))
        {
          v_ATIPO = (new IDVariant());
        }
        if (IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0).equals((new IDVariant(3)), true) || IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0).equals((new IDVariant(4)), true))
        {
          v_ATIPO = (new IDVariant("A"));
        }
        if (IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0).equals((new IDVariant(5)), true) || IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0).equals((new IDVariant(6)), true))
        {
          v_ATIPO = (new IDVariant("V"));
        }
      }
      RIEMPIIMDB_IMDVISDELROW();
      // 
      // gestione mandati
      // 
      {
        // 
        // riempio IMDB se stiamo trattando l'Invio dei Mandati
        // 
        {
          if (IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0).equals((new IDVariant(1)), true))
          {
            RIEMPIIMDB_IMDVISINSRO3();
          }
        }
        // 
        // riempio IMDB se stiamo trattando gli Annullo dei Mandati
        // 
        {
          if (IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0).equals((new IDVariant(3)), true) || IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0).equals((new IDVariant(5)), true))
          {
            RIEMPIIMDB_IMDVISINSRO4(v_ATIPO);
          }
        }
        // 
        // riempio IMDB se stiamo trattando la Sostituzione dei Mandati
        // 
        {
          if (IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0).equals((new IDVariant(7)), true))
          {
            RIEMPIIMDB_IMDVISINSRO5();
          }
        }
      }
      // 
      // gestione ordinativi
      // 
      {
        if (IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0).equals((new IDVariant(2)), true))
        {
          RIEMPIIMDB_IMDVISINSR12();
        }
        if (IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0).equals((new IDVariant(4)), true) || IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0).equals((new IDVariant(6)), true))
        {
          RIEMPIIMDB_IMDVISINSR13(v_ATIPO);
        }
        if (IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0).equals((new IDVariant(8)), true))
        {
          RIEMPIIMDB_IMDVISINSR14();
        }
      }
      ((Eliminazione)MainFrm.GetForm(MyGlb.FRM_ELIMINAZIONE,0)).PAN_ELIMINAZIONE.PanelCommand(Glb.PCM_REQUERY);
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "RiempiIMDB", _e);
      return -1;
    }
  }

  // **********************************************************************
  // IMDB Visualizzato: Delete rows
  // Why are you deleting these data?
  // **********************************************************************
  private void RIEMPIIMDB_IMDVISDELRO1() throws SQLException
  {
    IMDB.TblTruncate(IMDBDef6.TBL_IMDBVISUALIZ);
  }

  // **********************************************************************
  // IMDB Visualizzato: Delete rows
  // Why are you deleting these data?
  // **********************************************************************
  private void RIEMPIIMDB_IMDVISDELROW() throws SQLException
  {
    IMDB.TblTruncate(IMDBDef6.TBL_IMDBVISUALIZ);
  }

  // **********************************************************************
  // IMDB Visualizzato: Insert rows
  // Why are you inserting these data?
  // **********************************************************************
  private void RIEMPIIMDB_IMDVISINSRO3() throws SQLException
  {
    StringBuffer SQL = new StringBuffer();
    IDCachedRowSet RS = new IDCachedRowSet();

    SQL = new StringBuffer();
    SQL.append("select ");
    SQL.append("  B.NUMERO_MAND as MANINFTENUMA, ");
    SQL.append("  B.DATA_MAND as MANINFTEDAMA, ");
    SQL.append("  MAX(B.IMPORTO) as MAXMANINTEIM, ");
    SQL.append("  MAX(B.NUMERO_ELENCO) as MAMAINTENUEL, ");
    SQL.append("  MAX(B.DATA_ELENCO) as MAMAINTEDAEL, ");
    SQL.append("  MAX(B.CAPITOLO) as MAXMANINTECA, ");
    SQL.append("  MAX(B.ARTICOLO) as MAXMANINTEAR, ");
    SQL.append("  MAX(B.ANNO_IMP) as MAMAINTEANIM, ");
    SQL.append("  MAX(B.NUMERO_IMP) as MAMAINTENUIM, ");
    SQL.append("  SUM(NVL(D.PAGATO, 0)) as SUNUVAMAPAZE ");
    SQL.append("from ");
    SQL.append("  MAN_INF_STATO A, ");
    SQL.append("  MAN_INF_TESTATA B, ");
    SQL.append("  MAN_INF_SUB C, ");
    SQL.append("  MAN D ");
    SQL.append("where (D.ANNO_MAND = A.ANNO_MAND AND D.NUMERO_MAND = A.NUMERO_MAND AND C.IDENTIFICATIVO_TESTATA = B.IDENTIFICATIVO_RECORD AND C.PROGRESSIVO_TESO = A.PROGRESSIVO_TESO AND A.ANNO_MAND = B.ANNO_MAND AND A.NUMERO_MAND = B.NUMERO_MAND AND A.VERSIONE = B.VERSIONE AND A.ANNO_MAND = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " AND ((" + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEDAL, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " IS NULL) OR (NOT ((" + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEDAL, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " IS NULL)) AND (A.NUMERO_MAND BETWEEN " + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEDAL, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " AND " + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEAL, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "))) AND NVL(B.NUMERO_ELENCO, -1) = DECODE(" + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMDISNUM, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", to_number(NULL), NVL(B.NUMERO_ELENCO, -1), " + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMDISNUM, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ")) ");
    SQL.append("and   (NOT (EXISTS(");
    SQL.append("( ");
    SQL.append("select ");
    SQL.append("  1 ");
    SQL.append("from ");
    SQL.append("  MAN_INF_STATO E ");
    SQL.append("where (E.TIPO <> 'I') ");
    SQL.append("and   (E.ANNO_MAND = A.ANNO_MAND) ");
    SQL.append("and   (E.NUMERO_MAND = A.NUMERO_MAND) ");
    SQL.append(")))) ");
    SQL.append("group by ");
    SQL.append("  B.NUMERO_MAND, ");
    SQL.append("  B.DATA_MAND ");
    RS = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
    if (!RS.EOF()) RS.MoveNext();
    while (!RS.EOF())
    {
      IMDB.TblAddNew(IMDBDef6.TBL_IMDBVISUALIZ, 0);
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_MAND,0,RS.Get(1));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_DATA_MAND,0,RS.Get(2));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_IMPORTO,0,RS.Get(3));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_ELENCO,0,RS.Get(4));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_DATA_ELENCO,0,RS.Get(5));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_CAPITOLO,0,new IDVariant(RS.Get(6),IDVariant.DECIMAL));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_ARTICOLO,0,RS.Get(7));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_ANNO_IMP,0,RS.Get(8));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_IMP,0,RS.Get(9));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_PAGATO,0,RS.Get(10));
      RS.MoveNext();
    }
  }

  // **********************************************************************
  // IMDB Visualizzato: Insert rows
  // Why are you inserting these data?
  // **********************************************************************
  private void RIEMPIIMDB_IMDVISINSRO4(IDVariant v_ATIPO) throws SQLException
  {
    StringBuffer SQL = new StringBuffer();
    IDCachedRowSet RS = new IDCachedRowSet();

    SQL = new StringBuffer();
    SQL.append("select ");
    SQL.append("  B.NUMERO_MAND as MANINFTENUMA, ");
    SQL.append("  B.DATA_MAND as MANINFTEDAMA, ");
    SQL.append("  MAX(B.IMPORTO) as MAXMANINTEIM, ");
    SQL.append("  MAX(B.NUMERO_ELENCO) as MAMAINTENUEL, ");
    SQL.append("  MAX(B.DATA_ELENCO) as MAMAINTEDAEL, ");
    SQL.append("  MAX(B.CAPITOLO) as MAXMANINTECA, ");
    SQL.append("  MAX(B.ARTICOLO) as MAXMANINTEAR, ");
    SQL.append("  MAX(B.ANNO_IMP) as MAMAINTEANIM, ");
    SQL.append("  MAX(B.NUMERO_IMP) as MAMAINTENUIM, ");
    SQL.append("  SUM(NVL(D.PAGATO, 0)) as SUNUVAMAPAZE ");
    SQL.append("from ");
    SQL.append("  MAN_INF_STATO A, ");
    SQL.append("  MAN_INF_TESTATA B, ");
    SQL.append("  MAN_INF_SUB C, ");
    SQL.append("  MAN D ");
    SQL.append("where (D.ANNO_MAND(+) = A.ANNO_MAND AND D.NUMERO_MAND(+) = A.NUMERO_MAND AND C.IDENTIFICATIVO_TESTATA = B.IDENTIFICATIVO_RECORD AND C.PROGRESSIVO_TESO = A.PROGRESSIVO_TESO AND A.ANNO_MAND = B.ANNO_MAND AND A.NUMERO_MAND = B.NUMERO_MAND AND A.VERSIONE = B.VERSIONE AND A.ANNO_MAND = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
    SQL.append("and   ((A.NUMERO_MAND BETWEEN " + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEDAL, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " AND " + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEAL, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ")) ");
    SQL.append("and   (A.TIPO = " + IDL.CSql(v_ATIPO, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
    SQL.append("and   (NOT ((A.DATA_INVIO IS NULL))) ");
    SQL.append("and   (NOT (EXISTS(");
    SQL.append("( ");
    SQL.append("select ");
    SQL.append("  1 ");
    SQL.append("from ");
    SQL.append("  MAN_INF_STATO E ");
    SQL.append("where (E.TIPO = DECODE(" + IDL.CSql(v_ATIPO, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", 'A', 'V', 'A')) ");
    SQL.append("and   (E.ANNO_MAND = A.ANNO_MAND AND E.NUMERO_MAND = A.NUMERO_MAND) ");
    SQL.append("and   (E.VERSIONE = A.VERSIONE) ");
    SQL.append(")))) ");
    SQL.append("and   (A.VERSIONE = ");
    SQL.append("( ");
    SQL.append("select ");
    SQL.append("  MAX(F.VERSIONE) ");
    SQL.append("from ");
    SQL.append("  MAN_INF_STATO F ");
    SQL.append("where (F.ANNO_MAND = A.ANNO_MAND) ");
    SQL.append("and   (F.NUMERO_MAND = A.NUMERO_MAND) ");
    SQL.append(")) ");
    SQL.append("group by ");
    SQL.append("  B.NUMERO_MAND, ");
    SQL.append("  B.DATA_MAND ");
    RS = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
    if (!RS.EOF()) RS.MoveNext();
    while (!RS.EOF())
    {
      IMDB.TblAddNew(IMDBDef6.TBL_IMDBVISUALIZ, 0);
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_MAND,0,RS.Get(1));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_DATA_MAND,0,RS.Get(2));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_IMPORTO,0,RS.Get(3));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_ELENCO,0,RS.Get(4));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_DATA_ELENCO,0,RS.Get(5));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_CAPITOLO,0,new IDVariant(RS.Get(6),IDVariant.DECIMAL));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_ARTICOLO,0,RS.Get(7));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_ANNO_IMP,0,RS.Get(8));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_IMP,0,RS.Get(9));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_PAGATO,0,RS.Get(10));
      RS.MoveNext();
    }
  }

  // **********************************************************************
  // IMDB Visualizzato: Insert rows
  // Why are you inserting these data?
  // **********************************************************************
  private void RIEMPIIMDB_IMDVISINSRO5() throws SQLException
  {
    StringBuffer SQL = new StringBuffer();
    IDCachedRowSet RS = new IDCachedRowSet();

    SQL = new StringBuffer();
    SQL.append("select ");
    SQL.append("  B.NUMERO_MAND as MANINFTENUMA, ");
    SQL.append("  B.DATA_MAND as MANINFTEDAMA, ");
    SQL.append("  MAX(B.IMPORTO) as MAXMANINTEIM, ");
    SQL.append("  MAX(B.NUMERO_ELENCO) as MAMAINTENUEL, ");
    SQL.append("  MAX(B.DATA_ELENCO) as MAMAINTEDAEL, ");
    SQL.append("  MAX(B.CAPITOLO) as MAXMANINTECA, ");
    SQL.append("  MAX(B.ARTICOLO) as MAXMANINTEAR, ");
    SQL.append("  MAX(B.ANNO_IMP) as MAMAINTEANIM, ");
    SQL.append("  MAX(B.NUMERO_IMP) as MAMAINTENUIM, ");
    SQL.append("  SUM(NVL(D.PAGATO, 0)) as SUNUVAMAPAZE ");
    SQL.append("from ");
    SQL.append("  MAN_INF_STATO A, ");
    SQL.append("  MAN_INF_TESTATA B, ");
    SQL.append("  MAN_INF_SUB C, ");
    SQL.append("  MAN D ");
    SQL.append("where (D.ANNO_MAND = A.ANNO_MAND AND D.NUMERO_MAND = A.NUMERO_MAND AND C.IDENTIFICATIVO_TESTATA = B.IDENTIFICATIVO_RECORD AND C.PROGRESSIVO_TESO = A.PROGRESSIVO_TESO AND A.ANNO_MAND = B.ANNO_MAND AND A.NUMERO_MAND = B.NUMERO_MAND AND A.VERSIONE = B.VERSIONE AND A.ANNO_MAND = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " AND (A.NUMERO_MAND BETWEEN " + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEDAL, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " AND " + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEAL, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ")) ");
    SQL.append("and   (NOT (EXISTS(");
    SQL.append("( ");
    SQL.append("select ");
    SQL.append("  1 ");
    SQL.append("from ");
    SQL.append("  MAN_INF_STATO E ");
    SQL.append("where (E.TIPO <> 'S') ");
    SQL.append("and   (E.ANNO_MAND = A.ANNO_MAND) ");
    SQL.append("and   (E.NUMERO_MAND = A.NUMERO_MAND) ");
    SQL.append(")))) ");
    SQL.append("group by ");
    SQL.append("  B.NUMERO_MAND, ");
    SQL.append("  B.DATA_MAND ");
    RS = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
    if (!RS.EOF()) RS.MoveNext();
    while (!RS.EOF())
    {
      IMDB.TblAddNew(IMDBDef6.TBL_IMDBVISUALIZ, 0);
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_MAND,0,RS.Get(1));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_DATA_MAND,0,RS.Get(2));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_IMPORTO,0,RS.Get(3));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_ELENCO,0,RS.Get(4));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_DATA_ELENCO,0,RS.Get(5));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_CAPITOLO,0,new IDVariant(RS.Get(6),IDVariant.DECIMAL));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_ARTICOLO,0,RS.Get(7));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_ANNO_IMP,0,RS.Get(8));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_IMP,0,RS.Get(9));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_PAGATO,0,RS.Get(10));
      RS.MoveNext();
    }
  }

  // **********************************************************************
  // IMDB Visualizzato: Insert rows
  // Why are you inserting these data?
  // **********************************************************************
  private void RIEMPIIMDB_IMDVISINSR12() throws SQLException
  {
    StringBuffer SQL = new StringBuffer();
    IDCachedRowSet RS = new IDCachedRowSet();

    SQL = new StringBuffer();
    SQL.append("select ");
    SQL.append("  C.NUMERO_ORD as ORDINFTENUOR, ");
    SQL.append("  C.DATA_ORD as ORDINFTEDAOR, ");
    SQL.append("  MAX(C.IMPORTO) as MAXORDINTEIM, ");
    SQL.append("  MAX(C.NUMERO_ELENCO) as MAORINTENUEL, ");
    SQL.append("  MAX(C.DATA_ELENCO) as MAORINTEDAEL, ");
    SQL.append("  MAX(C.CAPITOLO) as MAXORDINTECA, ");
    SQL.append("  MAX(C.ARTICOLO) as MAXORDINTEAR, ");
    SQL.append("  MAX(C.ANNO_ACC) as MAORINTEANAC, ");
    SQL.append("  MAX(C.NUMERO_ACC) as MAORINTENUAC, ");
    SQL.append("  SUM(NVL(D.INCASSATO, 0)) as SUNUVAORINZE ");
    SQL.append("from ");
    SQL.append("  ORD_INF_STATO A, ");
    SQL.append("  ORD_INF_TESTATA C, ");
    SQL.append("  ORD D, ");
    SQL.append("  ORD_INF_SUB E ");
    SQL.append("where (D.ANNO_ORD = A.ANNO_ORD AND D.NUMERO_ORD = A.NUMERO_ORD AND E.IDENTIFICATIVO_TESTATA = C.IDENTIFICATIVO_RECORD AND E.PROGRESSIVO_TESO = A.PROGRESSIVO_TESO AND A.ANNO_ORD = C.ANNO_ORD AND A.NUMERO_ORD = C.NUMERO_ORD AND A.VERSIONE = C.VERSIONE AND A.ANNO_ORD = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " AND ((" + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEDAL, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " IS NULL) OR (NOT ((" + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEDAL, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " IS NULL)) AND (A.NUMERO_ORD BETWEEN " + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEDAL, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " AND " + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEAL, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + "))) AND NVL(C.NUMERO_ELENCO, -1) = DECODE(" + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMDISNUM, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", to_number(NULL), NVL(C.NUMERO_ELENCO, -1), " + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMDISNUM, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ")) ");
    SQL.append("and   (NOT (EXISTS(");
    SQL.append("( ");
    SQL.append("select ");
    SQL.append("  1 ");
    SQL.append("from ");
    SQL.append("  ORD_INF_STATO B ");
    SQL.append("where (B.TIPO <> 'I') ");
    SQL.append("and   (B.ANNO_ORD = A.ANNO_ORD) ");
    SQL.append("and   (B.NUMERO_ORD = A.NUMERO_ORD) ");
    SQL.append(")))) ");
    SQL.append("group by ");
    SQL.append("  C.NUMERO_ORD, ");
    SQL.append("  C.DATA_ORD ");
    RS = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
    if (!RS.EOF()) RS.MoveNext();
    while (!RS.EOF())
    {
      IMDB.TblAddNew(IMDBDef6.TBL_IMDBVISUALIZ, 0);
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_MAND,0,RS.Get(1));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_DATA_MAND,0,RS.Get(2));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_IMPORTO,0,RS.Get(3));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_ELENCO,0,RS.Get(4));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_DATA_ELENCO,0,RS.Get(5));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_CAPITOLO,0,new IDVariant(RS.Get(6),IDVariant.DECIMAL));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_ARTICOLO,0,RS.Get(7));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_ANNO_IMP,0,RS.Get(8));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_IMP,0,RS.Get(9));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_PAGATO,0,RS.Get(10));
      RS.MoveNext();
    }
  }

  // **********************************************************************
  // IMDB Visualizzato: Insert rows
  // Why are you inserting these data?
  // **********************************************************************
  private void RIEMPIIMDB_IMDVISINSR13(IDVariant v_ATIPO) throws SQLException
  {
    StringBuffer SQL = new StringBuffer();
    IDCachedRowSet RS = new IDCachedRowSet();

    SQL = new StringBuffer();
    SQL.append("select ");
    SQL.append("  D.NUMERO_ORD as ORDINFTENUOR, ");
    SQL.append("  D.DATA_ORD as ORDINFTEDAOR, ");
    SQL.append("  MAX(D.IMPORTO) as MAXORDINTEIM, ");
    SQL.append("  MAX(D.NUMERO_ELENCO) as MAORINTENUEL, ");
    SQL.append("  MAX(D.DATA_ELENCO) as MAORINTEDAEL, ");
    SQL.append("  MAX(D.CAPITOLO) as MAXORDINTECA, ");
    SQL.append("  MAX(D.ARTICOLO) as MAXORDINTEAR, ");
    SQL.append("  MAX(D.ANNO_ACC) as MAORINTEANAC, ");
    SQL.append("  MAX(D.NUMERO_ACC) as MAORINTENUAC, ");
    SQL.append("  SUM(NVL(F.INCASSATO, 0)) as SUNUVAORINZE ");
    SQL.append("from ");
    SQL.append("  ORD_INF_STATO C, ");
    SQL.append("  ORD_INF_TESTATA D, ");
    SQL.append("  ORD_INF_SUB E, ");
    SQL.append("  ORD F ");
    SQL.append("where (F.ANNO_ORD(+) = C.ANNO_ORD_SOST AND F.NUMERO_ORD(+) = C.NUMERO_ORD AND E.IDENTIFICATIVO_TESTATA = D.IDENTIFICATIVO_RECORD AND E.PROGRESSIVO_TESO = C.PROGRESSIVO_TESO AND C.ANNO_ORD = D.ANNO_ORD AND C.NUMERO_ORD = D.NUMERO_ORD AND C.VERSIONE = D.VERSIONE AND C.ANNO_ORD = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
    SQL.append("and   ((C.NUMERO_ORD BETWEEN " + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEDAL, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " AND " + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEAL, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ")) ");
    SQL.append("and   (C.TIPO = " + IDL.CSql(v_ATIPO, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
    SQL.append("and   (NOT ((C.DATA_INVIO IS NULL))) ");
    SQL.append("and   (NOT (EXISTS(");
    SQL.append("( ");
    SQL.append("select ");
    SQL.append("  1 ");
    SQL.append("from ");
    SQL.append("  ORD_INF_STATO A ");
    SQL.append("where (A.TIPO = DECODE(" + IDL.CSql(v_ATIPO, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", 'A', 'V', 'A')) ");
    SQL.append("and   (A.ANNO_ORD = C.ANNO_ORD AND A.NUMERO_ORD = C.NUMERO_ORD) ");
    SQL.append("and   (A.VERSIONE = C.VERSIONE) ");
    SQL.append(")))) ");
    SQL.append("and   (C.VERSIONE = ");
    SQL.append("( ");
    SQL.append("select ");
    SQL.append("  MAX(B.VERSIONE) ");
    SQL.append("from ");
    SQL.append("  ORD_INF_STATO B ");
    SQL.append("where (B.ANNO_ORD = C.ANNO_ORD) ");
    SQL.append("and   (B.NUMERO_ORD = C.NUMERO_ORD) ");
    SQL.append(")) ");
    SQL.append("group by ");
    SQL.append("  D.NUMERO_ORD, ");
    SQL.append("  D.DATA_ORD ");
    RS = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
    if (!RS.EOF()) RS.MoveNext();
    while (!RS.EOF())
    {
      IMDB.TblAddNew(IMDBDef6.TBL_IMDBVISUALIZ, 0);
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_MAND,0,RS.Get(1));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_DATA_MAND,0,RS.Get(2));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_IMPORTO,0,RS.Get(3));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_ELENCO,0,RS.Get(4));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_DATA_ELENCO,0,RS.Get(5));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_CAPITOLO,0,new IDVariant(RS.Get(6),IDVariant.DECIMAL));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_ARTICOLO,0,RS.Get(7));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_ANNO_IMP,0,RS.Get(8));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_IMP,0,RS.Get(9));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_PAGATO,0,RS.Get(10));
      RS.MoveNext();
    }
  }

  // **********************************************************************
  // IMDB Visualizzato: Insert rows
  // Why are you inserting these data?
  // **********************************************************************
  private void RIEMPIIMDB_IMDVISINSR14() throws SQLException
  {
    StringBuffer SQL = new StringBuffer();
    IDCachedRowSet RS = new IDCachedRowSet();

    SQL = new StringBuffer();
    SQL.append("select ");
    SQL.append("  C.NUMERO_ORD as ORDINFTENUOR, ");
    SQL.append("  C.DATA_ORD as ORDINFTEDAOR, ");
    SQL.append("  MAX(C.IMPORTO) as MAXORDINTEIM, ");
    SQL.append("  MAX(C.NUMERO_ELENCO) as MAORINTENUEL, ");
    SQL.append("  MAX(C.DATA_ELENCO) as MAORINTEDAEL, ");
    SQL.append("  MAX(C.CAPITOLO) as MAXORDINTECA, ");
    SQL.append("  MAX(C.ARTICOLO) as MAXORDINTEAR, ");
    SQL.append("  MAX(C.ANNO_ACC) as MAORINTEANAC, ");
    SQL.append("  MAX(C.NUMERO_ACC) as MAORINTENUAC, ");
    SQL.append("  SUM(NVL(E.INCASSATO, 0)) as SUNUVAORINZE ");
    SQL.append("from ");
    SQL.append("  ORD_INF_STATO B, ");
    SQL.append("  ORD_INF_TESTATA C, ");
    SQL.append("  ORD_INF_SUB D, ");
    SQL.append("  ORD E ");
    SQL.append("where (E.ANNO_ORD = B.ANNO_ORD AND E.NUMERO_ORD = B.NUMERO_ORD AND D.IDENTIFICATIVO_TESTATA = C.IDENTIFICATIVO_RECORD AND D.PROGRESSIVO_TESO = B.PROGRESSIVO_TESO AND B.ANNO_ORD = C.ANNO_ORD AND B.NUMERO_ORD = C.NUMERO_ORD AND B.VERSIONE = C.VERSIONE AND B.ANNO_ORD = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " AND (B.NUMERO_ORD BETWEEN " + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEDAL, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " AND " + IDL.CSql(IMDB.Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEAL, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ")) ");
    SQL.append("and   (NOT (EXISTS(");
    SQL.append("( ");
    SQL.append("select ");
    SQL.append("  1 ");
    SQL.append("from ");
    SQL.append("  ORD_INF_STATO A ");
    SQL.append("where (A.TIPO <> 'S') ");
    SQL.append("and   (A.ANNO_ORD = B.ANNO_ORD) ");
    SQL.append("and   (A.NUMERO_ORD = B.NUMERO_ORD) ");
    SQL.append(")))) ");
    SQL.append("group by ");
    SQL.append("  C.NUMERO_ORD, ");
    SQL.append("  C.DATA_ORD ");
    RS = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
    if (!RS.EOF()) RS.MoveNext();
    while (!RS.EOF())
    {
      IMDB.TblAddNew(IMDBDef6.TBL_IMDBVISUALIZ, 0);
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_MAND,0,RS.Get(1));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_DATA_MAND,0,RS.Get(2));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_IMPORTO,0,RS.Get(3));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_ELENCO,0,RS.Get(4));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_DATA_ELENCO,0,RS.Get(5));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_CAPITOLO,0,new IDVariant(RS.Get(6),IDVariant.DECIMAL));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_ARTICOLO,0,RS.Get(7));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_ANNO_IMP,0,RS.Get(8));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_NUMERO_IMP,0,RS.Get(9));
      IMDB.set_Value(IMDBDef6.TBL_IMDBVISUALIZ,IMDBDef6.FLD_IMDBVISUALIZ_PAGATO,0,RS.Get(10));
      RS.MoveNext();
    }
  }

  // **********************************************************************
  // Apri Variazioni Di Entrata
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int ApriVariazioniDiEntrata ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Variazioni Di Entrata Body
      // Corpo Procedura
      // 
      IMDB.set_Value(IMDBDef6.TBL_PARAMETRI530, IMDBDef6.FLD_PARAMETRI530_ROWNAMEPARTE, 0, (new IDVariant("E")));
      MainFrm.Show(MyGlb.FRM_VARIAZENTRAT, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriVariazioniDiEntrata", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Variazioni Di Spesa
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int ApriVariazioniDiSpesa ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Variazioni Di Spesa Body
      // Corpo Procedura
      // 
      IMDB.set_Value(IMDBDef6.TBL_PARAMETRI532, IMDBDef6.FLD_PARAMETRI532_ROWNAMEPARTE, 0, (new IDVariant("S")));
      MainFrm.Show(MyGlb.FRM_VARIAZISPESA, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriVariazioniDiSpesa", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Get Abilitazioni
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // Azione - Input
  // **********************************************************************
  public IDVariant GetAbilitazioni (IDVariant Azione)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Get Abilitazioni Body
      // Corpo Procedura
      // 
      IDVariant v_VCOMPCF4COMP = new IDVariant(0,IDVariant.STRING);
      IDVariant B = new IDVariant(0,IDVariant.INTEGER);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.COMPETENZA as COMPECF4COMP ");
      SQL.append("from ");
      SQL.append("  COMPETENZE_CF4 A ");
      SQL.append("where (A.COMPETENZA = " + IDL.CSql(Azione, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.OGGETTO = 14) ");
      SQL.append("and   (A.UTENTE = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIONRUOLO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCOMPCF4COMP = QV.Get("COMPECF4COMP", IDVariant.STRING) ;
      }
      QV.Close();
      if (IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0).equals((new IDVariant("CFA")), true))
      {
        if (v_VCOMPCF4COMP.equals(Azione, true))
        {
          B = (new IDVariant(-1));
        }
        else
        {
          B = (new IDVariant(0));
        }
      }
      else
      {
        B = (new IDVariant(0));
      }
      return B;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GetAbilitazioni", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Importafile
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int Importafile ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDCachedRowSet C2;

    try
    {
      TransCount = 0;
      // 
      // Importafile Body
      // Corpo Procedura
      // 
      IDVariant v_FD = new IDVariant(0,IDVariant.INTEGER);
      IDVariant v_CONTROLLOFIL = new IDVariant(0,IDVariant.INTEGER);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.CODICE as CFESTRSELCOD, ");
      SQL.append("  A.ID as CFESTRSELEID ");
      SQL.append("from ");
      SQL.append("  CF_ESTRAI_SELECT A ");
      SQL.append("where (NVL(LENGTH(A.SELECT_SQL), 0) = 0 OR (A.SELECT_SQL IS NULL)) ");
      C2 = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!C2.EOF()) C2.MoveNext();
      while (!C2.EOF())
      {
        IDVariant v_FILE = null;
        v_FILE = IDL.Add((new IDVariant(MainFrm.RealPath)), (new IDVariant("/Import/CF_ESTRAI/")));
        v_CONTROLLOFIL = (new IDVariant(-1));
        v_FD = MainFrm.VBFile.FreeFile();
        // v_FILE = IDL.Add(IDL.Add((new IDVariant("C:\\Import\\")), C2.Get("CFESTRSELCOD")), (new IDVariant(".txt")));
        v_FILE = IDL.Add(IDL.Add(v_FILE, C2.Get("CFESTRSELCOD")), (new IDVariant(".txt")));
        if (VBFiles.FileExists(v_FILE))
        {
          MainFrm.VBFile.OpenForInput(v_FILE, v_FD); 
          while (!(MainFrm.VBFile.EOF(v_FD)))
          {
            IDVariant v_CURRLINE = new IDVariant(0,IDVariant.STRING);
            IDVariant v_CURRNUMBERCH = new IDVariant(0,IDVariant.INTEGER);
            v_CURRLINE = MainFrm.VBFile.ReadLine(v_FD); 
            v_CURRNUMBERCH = IDL.Length(v_CURRLINE);
            // 
            // controllo se il file è vuoto ed eventualmente lo gestisco
            // 
            {
              if (v_CONTROLLOFIL.booleanValue())
              {
                v_CONTROLLOFIL = (new IDVariant(0));
                if (v_CURRNUMBERCH.equals((new IDVariant(0)), true))
                {
                  IDVariant v_MSG = new IDVariant(0,IDVariant.STRING);
                  v_MSG = (new IDVariant("Il file è vuoto!", IDVariant.STRING));
                  MainFrm.set_AlertMessage(v_MSG); 
                }
              }
            }
            if (v_CURRNUMBERCH.compareTo((new IDVariant(0)), true)>0)
            {
              try
              {
                SQL = new StringBuffer();
                SQL.append("update CF_ESTRAI_SELECT set ");
                SQL.append("  SELECT_SQL = CF_ESTRAI_SELECT.SELECT_SQL || " + IDL.CSql(v_CURRLINE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " || CHR(10) ");
                SQL.append("where (CODICE = " + IDL.CSql(C2.Get("CFESTRSELCOD"), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
                MainFrm.Cf4armDBObject.DBO().Execute(SQL);
              }
              catch (Exception e10)
              {
                MainFrm.set_AlertMessage(new IDVariant(e10.getMessage())); 
                return 0;
              }
              v_CONTROLLOFIL = (new IDVariant(0));
            }
          }
        }
        C2.MoveNext();
      }
      C2.Close();
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Importafile", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Fattori
  // **********************************************************************
  public int ApriFattori ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Fattori Body
      // Procedure Body
      // 
      if (GESTIOECONOM.compareTo((new IDVariant(-1)), true)!=0)
      {
        MainFrm.Show(MyGlb.FRM_FATTORI, (new IDVariant(0)).intValue(), this); 
      }
      else
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Economica Light - Consultare i Fattori nel modulo di Contabilità Economica", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriFattori", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Centri
  // **********************************************************************
  public int ApriCentri ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Centri Body
      // Procedure Body
      // 
      if (GESTIOECONOM.equals((new IDVariant(2)), true))
      {
        MainFrm.Show(MyGlb.FRM_CENTRI, (new IDVariant(0)).intValue(), this); 
      }
      else
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Centri non ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriCentri", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Classi Contabili
  // **********************************************************************
  public int ApriClassiContabili ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Classi Contabili Body
      // Procedure Body
      // 
      if (GESTIOECONOM.compareTo((new IDVariant(-1)), true)!=0)
      {
        MainFrm.Show(MyGlb.FRM_CLASSICONTAB, (new IDVariant(0)).intValue(), this); 
      }
      else
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Classi Contabili non ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriClassiContabili", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Lancia Assessorati
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public int LanciaAssessorati ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_PERSONALIZZA = new IDVariant(0,IDVariant.STRING);
    IDVariant v_DW = new IDVariant(0,IDVariant.STRING);
    IDVariant v_DW1 = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      v_DW = (new IDVariant("strutt_peg", IDVariant.STRING));
      v_DW1 = (new IDVariant("strutt_peg_mo", IDVariant.STRING));
      // 
      // Lancia Assessorati Body
      // Procedure Body
      // 
      v_PERSONALIZZA = AFC.GetComando(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), v_DW);
      if (v_PERSONALIZZA.compareTo(v_DW1, true)!=0)
      {
        IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
        v_SMS = (new IDVariant("Gestione Assessorati non ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_SMS); 
        return 0;
      }
      MainFrm.Show(MyGlb.FRM_ASSESSORATI, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "LanciaAssessorati", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Programma Progetto
  // **********************************************************************
  public int ApriProgrammaProgetto ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTATORE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Apri Programma Progetto Body
      // Procedure Body
      // 
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  OGGETTI_COMPETENZE A ");
      SQL.append("where (A.OGGETTO = 1) ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_CONTATORE = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      // if (v_CONTATORE.compareTo((new IDVariant(0)), true)>0)
      // {
        // MainFrm.set_AlertMessage(v_SMS); 
        // return 0;
      // }
      MainFrm.Show(MyGlb.FRM_PROGRAPROGET, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriProgrammaProgetto", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Parametri
  // **********************************************************************
  public int ApriParametri ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_NUMESERCIZIO = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_NUMESERCIZI1 = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Apri Parametri Body
      // Procedure Body
      // 
      try
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  T99 A ");
        SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_NUMESERCIZIO = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
        if (v_NUMESERCIZIO.equals((new IDVariant(0)), true))
        {
          SQL = new StringBuffer();
          SQL.append("select ");
          SQL.append("  COUNT(*) as COUNT1 ");
          SQL.append("from ");
          SQL.append("  T99 A ");
          SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " - 1) ");
          QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
          if (!QV.EOF()) QV.MoveNext();
          if (!QV.EOF())
          {
            v_NUMESERCIZI1 = QV.Get("COUNT1", IDVariant.INTEGER) ;
          }
          QV.Close();
          if (v_NUMESERCIZI1.equals((new IDVariant(0)), true))
          {
            SQL = new StringBuffer();
            SQL.append("insert into T99 ");
            SQL.append("( ");
            SQL.append("  ESERCIZIO, ");
            SQL.append("  TIPO_TOTALE_FC, ");
            SQL.append("  UTENTE_INSERIMENTO, ");
            SQL.append("  DATA_INSERIMENTO, ");
            SQL.append("  DIFFERENZA_MAG ");
            SQL.append(") ");
            SQL.append("values ");
            SQL.append("( ");
            SQL.append("  " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", ");
            SQL.append("  0, ");
            SQL.append("  " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
            SQL.append("  TRUNC( SYSDATE ), ");
            SQL.append("  1 ");
            SQL.append(") ");
            MainFrm.Cf4armDBObject.DBO().Execute(SQL);
          }
          else
          {
            SQL = new StringBuffer();
            SQL.append("insert into T99 ");
            SQL.append("( ");
            SQL.append("  ESERCIZIO, ");
            SQL.append("  VARCOM_OBBLIG, ");
            SQL.append("  PROTOCOLLO_AUTO, ");
            SQL.append("  REG_IVA_AUTO, ");
            SQL.append("  CC_OBBLIG, ");
            SQL.append("  LIQ_AUTO, ");
            SQL.append("  DIFFERENZA_MAG, ");
            SQL.append("  CONTROLLO_CF, ");
            SQL.append("  CONTROLLO_IMPUTAZIONE, ");
            SQL.append("  TIPO_BIL_BUDGET, ");
            SQL.append("  TIPO_ORD, ");
            SQL.append("  CODICE_PERS, ");
            SQL.append("  PROC_DEL, ");
            SQL.append("  CONTROLLO_COMPETENZA, ");
            SQL.append("  CORR_MOD, ");
            SQL.append("  CONTROLLO_BEN, ");
            SQL.append("  TIPO_TOTALE_FC, ");
            SQL.append("  ESERCIZIO_RIF_PL, ");
            SQL.append("  TIPO_ENTE, ");
            SQL.append("  CONTROLLO_PC, ");
            SQL.append("  INTESTAZIONE_ENTE_IVA, ");
            SQL.append("  INTESTAZIONE_BOLLATO_IVA, ");
            SQL.append("  INTERESSI_LT, ");
            SQL.append("  PROCEDURA_BUONI, ");
            SQL.append("  DATA_RIF_RITENUTE, ");
            SQL.append("  ORDINE_EMISSIONE_MANDATI, ");
            SQL.append("  TIPO_EMISSIONE_MANDATI, ");
            SQL.append("  INTESTAZIONE_ENTE_CERT, ");
            SQL.append("  DATA_RIF_PRO_CASSA, ");
            SQL.append("  PROC_PERS, ");
            SQL.append("  CAUSALE_LIQ_AUTO, ");
            SQL.append("  CAUSALE_PRE_AUTO, ");
            SQL.append("  GESTIONE_IMPEGNABILE, ");
            SQL.append("  DATA_ESIG_IVA, ");
            SQL.append("  GESTIONE_ECONOMICA, ");
            SQL.append("  MODALITA_IMPUTAZIONE, ");
            SQL.append("  G_U, ");
            SQL.append("  G_I, ");
            SQL.append("  COLONNA_AVANZO, ");
            SQL.append("  VAR_NQ, ");
            SQL.append("  FLAG_BUONI, ");
            SQL.append("  FLAG_INT_CERTIF, ");
            SQL.append("  GESTIONE_CESPITI, ");
            SQL.append("  INTESTAZIONE_REGISTRO_IVA, ");
            SQL.append("  FLAG_IVA_NON_SOG, ");
            SQL.append("  CLASSE_ORD, ");
            SQL.append("  CASSA_ECONOMALE, ");
            SQL.append("  GESTIONE_FATTURAZIONE, ");
            SQL.append("  DESCRIZIONE_DOC_REG_IVA, ");
            SQL.append("  CONTROLLO_BUONI_RES, ");
            SQL.append("  PREVENTIVO_EURO, ");
            SQL.append("  PREVENTIVO_UNITA_EURO, ");
            SQL.append("  PASSAGGIO_CI4, ");
            SQL.append("  TIPO_CAST_MANDATI, ");
            SQL.append("  BLOCCO_AUMENTO_RESIDUI, ");
            SQL.append("  CONTROLLO_RIL_IVA, ");
            SQL.append("  MODALITA_IMPUTAZIONE_E, ");
            SQL.append("  RESP_SETTORE, ");
            SQL.append("  CONTROLLO_BIL_FIN, ");
            SQL.append("  CONTROLLO_COMPETENZA_FIN, ");
            SQL.append("  NUM_FIN_AUTO, ");
            SQL.append("  NUM_OPE_AUTO, ");
            SQL.append("  CONTROLLO_FIN_IMPEGNO, ");
            SQL.append("  FC_RPP_OBBLIG, ");
            SQL.append("  TIPO_VIS_ESPL_E_CF4OF, ");
            SQL.append("  BLOCCO_STN_TESTATA, ");
            SQL.append("  LIQ_MO, ");
            SQL.append("  NO_AGG_PROG_RES, ");
            SQL.append("  CARICA_IMP_NEG_PERS, ");
            SQL.append("  SE_IMP_NEG_LIQ_PERS, ");
            SQL.append("  TIPO_SFMA, ");
            SQL.append("  RPP_ZERO, ");
            SQL.append("  RETTE, ");
            SQL.append("  ACQUISIZIONE_CESPITE, ");
            SQL.append("  TITOLO_3_RPP, ");
            SQL.append("  TIPO_AGG_DATA_BUONO, ");
            SQL.append("  TIPO_SFOR, ");
            SQL.append("  OBIETTIVO_OBBLIG, ");
            SQL.append("  NUMERAZIONE_RPP, ");
            SQL.append("  MOD_RESP_SERV, ");
            SQL.append("  ACC_CF4OF, ");
            SQL.append("  FIN_QD_PR, ");
            SQL.append("  TRACCIATO_PERS, ");
            SQL.append("  FIN_SUB, ");
            SQL.append("  PROGETTO_OBBLIG_IST, ");
            SQL.append("  SALDI_CON_DECIMALI, ");
            SQL.append("  INS_AUTOMATICO_GD, ");
            SQL.append("  DATA_INIZIO_SIOPE, ");
            SQL.append("  ORDINE_STAMPA_MANDATI, ");
            SQL.append("  ORDINE_BEN_MANDATI, ");
            SQL.append("  DES_IMP_MAN, ");
            SQL.append("  MOD_PREV_FIN, ");
            SQL.append("  VOCE_ECON_BUONI, ");
            SQL.append("  BLOCCO_TIPO_VAR, ");
            SQL.append("  NOTE_FAT, ");
            SQL.append("  CONTROLLO_COMPETENZA_RPP, ");
            SQL.append("  CONTROLLO_IMPACC_FIN, ");
            SQL.append("  CONTROLLO_IMPACC_OPE, ");
            SQL.append("  FILTRO_EC, ");
            SQL.append("  RESPONSABILE_RES, ");
            SQL.append("  ORDIN_PROGETTI, ");
            SQL.append("  CAP_E_UNIVOCI, ");
            SQL.append("  CAP_S_UNIVOCI, ");
            SQL.append("  ABILITA_IMP_DOC, ");
            SQL.append("  ANNULLO_PRENOTAZIONE_DEL, ");
            SQL.append("  CONTROLLO_COD_UTENZA, ");
            SQL.append("  FLAG_EC_MO, ");
            SQL.append("  FILTRO_OBIETTIVO, ");
            SQL.append("  PVB_PS4, ");
            SQL.append("  TIPO_CAP_ISTITUZIONE, ");
            SQL.append("  ST_DES_INTERVENTO, ");
            SQL.append("  CONTROLLO_PROG_DOPPI, ");
            SQL.append("  ORD_ELENCO_DOC, ");
            SQL.append("  GP4_IMP_DISP, ");
            SQL.append("  SALP_FI, ");
            SQL.append("  ESERCIZIO_INIZIO_WEB, ");
            SQL.append("  CONTROLLO_SEQUENZA_MAN, ");
            SQL.append("  CONTROLLO_SEQUENZA_ORD, ");
            SQL.append("  TIPO_EMISS_ACC_PROVV, ");
            SQL.append("  CONTROLLO_PROPOSTA_IMP, ");
            SQL.append("  TIPO_TOT_LIQ_MULTIPLA, ");
            SQL.append("  CONTROLLO_IVA_LIQ, ");
            SQL.append("  UTENTE_INSERIMENTO, ");
            SQL.append("  DATA_INSERIMENTO, ");
            SQL.append("  BLOCCO_FATTURA_DOPPIA, ");
            SQL.append("  TIPO_CAR_SOGG, ");
            SQL.append("  IVA_DEF_GC4, ");
            SQL.append("  DATA_INIZIO_GEST_CRONO_UO, ");
            SQL.append("  DATA_FINE_GEST_CRONO_UO, ");
            SQL.append("  CONTROLLO_CASSA_VPRO_LIQ, ");
            SQL.append("  CONTROLLO_CASSA_VPRO_IN_EMISS, ");
            SQL.append("  CONTROLLO_IMP_PROV, ");
            SQL.append("  VOCE_TECNICA_OPERA, ");
            SQL.append("  FILTRO_FATTORI_PCF, ");
            SQL.append("  RATEI_COSTI_RIC_PROVENTI_EME, ");
            SQL.append("  PERIODICITA_VERS_IVA, ");
            SQL.append("  RAGGRUPPAMENTO_VERS_IVA, ");
            SQL.append("  FATTORI_ARCONET, ");
            SQL.append("  CONTROLLO_REGISTRI_LIQ_FAT, ");
            SQL.append("  MACROAGGREGATO_CI4, ");
            SQL.append("  GPS_GESTIONE_TIPI_COSTO, ");
            SQL.append("  BLOCCO_CASSA_COMP_TITOLO_5, ");
            SQL.append("  BLOCCO_CASSA_COMP_TITOLO_7, ");
            SQL.append("  COLLEGAMENTO_DUP, ");
            SQL.append("  BLOCCO_DISP_PURA_STANZ_OBIET ");
            SQL.append(") ");
            SQL.append("select ");
            SQL.append("  " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", ");
            SQL.append("  A.VARCOM_OBBLIG, ");
            SQL.append("  A.PROTOCOLLO_AUTO, ");
            SQL.append("  A.REG_IVA_AUTO, ");
            SQL.append("  A.CC_OBBLIG, ");
            SQL.append("  A.LIQ_AUTO, ");
            SQL.append("  1, ");
            SQL.append("  A.CONTROLLO_CF, ");
            SQL.append("  A.CONTROLLO_IMPUTAZIONE, ");
            SQL.append("  A.TIPO_BIL_BUDGET, ");
            SQL.append("  A.TIPO_ORD, ");
            SQL.append("  A.CODICE_PERS, ");
            SQL.append("  A.PROC_DEL, ");
            SQL.append("  A.CONTROLLO_COMPETENZA, ");
            SQL.append("  A.CORR_MOD, ");
            SQL.append("  A.CONTROLLO_BEN, ");
            SQL.append("  A.TIPO_TOTALE_FC, ");
            SQL.append("  A.ESERCIZIO_RIF_PL, ");
            SQL.append("  A.TIPO_ENTE, ");
            SQL.append("  A.CONTROLLO_PC, ");
            SQL.append("  A.INTESTAZIONE_ENTE_IVA, ");
            SQL.append("  A.INTESTAZIONE_BOLLATO_IVA, ");
            SQL.append("  A.INTERESSI_LT, ");
            SQL.append("  A.PROCEDURA_BUONI, ");
            SQL.append("  A.DATA_RIF_RITENUTE, ");
            SQL.append("  A.ORDINE_EMISSIONE_MANDATI, ");
            SQL.append("  A.TIPO_EMISSIONE_MANDATI, ");
            SQL.append("  A.INTESTAZIONE_ENTE_CERT, ");
            SQL.append("  A.DATA_RIF_PRO_CASSA, ");
            SQL.append("  A.PROC_PERS, ");
            SQL.append("  A.CAUSALE_LIQ_AUTO, ");
            SQL.append("  A.CAUSALE_PRE_AUTO, ");
            SQL.append("  A.GESTIONE_IMPEGNABILE, ");
            SQL.append("  A.DATA_ESIG_IVA, ");
            SQL.append("  A.GESTIONE_ECONOMICA, ");
            SQL.append("  A.MODALITA_IMPUTAZIONE, ");
            SQL.append("  A.G_U, ");
            SQL.append("  A.G_I, ");
            SQL.append("  A.COLONNA_AVANZO, ");
            SQL.append("  A.VAR_NQ, ");
            SQL.append("  A.FLAG_BUONI, ");
            SQL.append("  A.FLAG_INT_CERTIF, ");
            SQL.append("  A.GESTIONE_CESPITI, ");
            SQL.append("  A.INTESTAZIONE_REGISTRO_IVA, ");
            SQL.append("  A.FLAG_IVA_NON_SOG, ");
            SQL.append("  A.CLASSE_ORD, ");
            SQL.append("  A.CASSA_ECONOMALE, ");
            SQL.append("  A.GESTIONE_FATTURAZIONE, ");
            SQL.append("  A.DESCRIZIONE_DOC_REG_IVA, ");
            SQL.append("  A.CONTROLLO_BUONI_RES, ");
            SQL.append("  A.PREVENTIVO_EURO, ");
            SQL.append("  A.PREVENTIVO_UNITA_EURO, ");
            SQL.append("  A.PASSAGGIO_CI4, ");
            SQL.append("  A.TIPO_CAST_MANDATI, ");
            SQL.append("  A.BLOCCO_AUMENTO_RESIDUI, ");
            SQL.append("  A.CONTROLLO_RIL_IVA, ");
            SQL.append("  A.MODALITA_IMPUTAZIONE_E, ");
            SQL.append("  A.RESP_SETTORE, ");
            SQL.append("  A.CONTROLLO_BIL_FIN, ");
            SQL.append("  A.CONTROLLO_COMPETENZA_FIN, ");
            SQL.append("  A.NUM_FIN_AUTO, ");
            SQL.append("  A.NUM_OPE_AUTO, ");
            SQL.append("  A.CONTROLLO_FIN_IMPEGNO, ");
            SQL.append("  A.FC_RPP_OBBLIG, ");
            SQL.append("  A.TIPO_VIS_ESPL_E_CF4OF, ");
            SQL.append("  A.BLOCCO_STN_TESTATA, ");
            SQL.append("  A.LIQ_MO, ");
            SQL.append("  A.NO_AGG_PROG_RES, ");
            SQL.append("  A.CARICA_IMP_NEG_PERS, ");
            SQL.append("  A.SE_IMP_NEG_LIQ_PERS, ");
            SQL.append("  A.TIPO_SFMA, ");
            SQL.append("  A.RPP_ZERO, ");
            SQL.append("  A.RETTE, ");
            SQL.append("  A.ACQUISIZIONE_CESPITE, ");
            SQL.append("  A.TITOLO_3_RPP, ");
            SQL.append("  A.TIPO_AGG_DATA_BUONO, ");
            SQL.append("  A.TIPO_SFOR, ");
            SQL.append("  A.OBIETTIVO_OBBLIG, ");
            SQL.append("  A.NUMERAZIONE_RPP, ");
            SQL.append("  A.MOD_RESP_SERV, ");
            SQL.append("  A.ACC_CF4OF, ");
            SQL.append("  A.FIN_QD_PR, ");
            SQL.append("  A.TRACCIATO_PERS, ");
            SQL.append("  A.FIN_SUB, ");
            SQL.append("  A.PROGETTO_OBBLIG_IST, ");
            SQL.append("  A.SALDI_CON_DECIMALI, ");
            SQL.append("  A.INS_AUTOMATICO_GD, ");
            SQL.append("  A.DATA_INIZIO_SIOPE, ");
            SQL.append("  A.ORDINE_STAMPA_MANDATI, ");
            SQL.append("  A.ORDINE_BEN_MANDATI, ");
            SQL.append("  A.DES_IMP_MAN, ");
            SQL.append("  A.MOD_PREV_FIN, ");
            SQL.append("  A.VOCE_ECON_BUONI, ");
            SQL.append("  A.BLOCCO_TIPO_VAR, ");
            SQL.append("  A.NOTE_FAT, ");
            SQL.append("  A.CONTROLLO_COMPETENZA_RPP, ");
            SQL.append("  A.CONTROLLO_IMPACC_FIN, ");
            SQL.append("  A.CONTROLLO_IMPACC_OPE, ");
            SQL.append("  A.FILTRO_EC, ");
            SQL.append("  A.RESPONSABILE_RES, ");
            SQL.append("  A.ORDIN_PROGETTI, ");
            SQL.append("  A.CAP_E_UNIVOCI, ");
            SQL.append("  A.CAP_S_UNIVOCI, ");
            SQL.append("  A.ABILITA_IMP_DOC, ");
            SQL.append("  A.ANNULLO_PRENOTAZIONE_DEL, ");
            SQL.append("  A.CONTROLLO_COD_UTENZA, ");
            SQL.append("  A.FLAG_EC_MO, ");
            SQL.append("  A.FILTRO_OBIETTIVO, ");
            SQL.append("  A.PVB_PS4, ");
            SQL.append("  A.TIPO_CAP_ISTITUZIONE, ");
            SQL.append("  A.ST_DES_INTERVENTO, ");
            SQL.append("  A.CONTROLLO_PROG_DOPPI, ");
            SQL.append("  A.ORD_ELENCO_DOC, ");
            SQL.append("  A.GP4_IMP_DISP, ");
            SQL.append("  A.SALP_FI, ");
            SQL.append("  A.ESERCIZIO_INIZIO_WEB, ");
            SQL.append("  A.CONTROLLO_SEQUENZA_MAN, ");
            SQL.append("  A.CONTROLLO_SEQUENZA_ORD, ");
            SQL.append("  A.TIPO_EMISS_ACC_PROVV, ");
            SQL.append("  A.CONTROLLO_PROPOSTA_IMP, ");
            SQL.append("  A.TIPO_TOT_LIQ_MULTIPLA, ");
            SQL.append("  A.CONTROLLO_IVA_LIQ, ");
            SQL.append("  " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
            SQL.append("  TRUNC( SYSDATE ), ");
            SQL.append("  A.BLOCCO_FATTURA_DOPPIA, ");
            SQL.append("  A.TIPO_CAR_SOGG, ");
            SQL.append("  A.IVA_DEF_GC4, ");
            SQL.append("  A.DATA_INIZIO_GEST_CRONO_UO, ");
            SQL.append("  A.DATA_FINE_GEST_CRONO_UO, ");
            SQL.append("  A.CONTROLLO_CASSA_VPRO_LIQ, ");
            SQL.append("  NVL(A.CONTROLLO_CASSA_VPRO_IN_EMISS, 1), ");
            SQL.append("  A.CONTROLLO_IMP_PROV, ");
            SQL.append("  A.VOCE_TECNICA_OPERA, ");
            SQL.append("  A.FILTRO_FATTORI_PCF, ");
            SQL.append("  A.RATEI_COSTI_RIC_PROVENTI_EME, ");
            SQL.append("  A.PERIODICITA_VERS_IVA, ");
            SQL.append("  A.RAGGRUPPAMENTO_VERS_IVA, ");
            SQL.append("  A.FATTORI_ARCONET, ");
            SQL.append("  A.CONTROLLO_REGISTRI_LIQ_FAT, ");
            SQL.append("  A.MACROAGGREGATO_CI4, ");
            SQL.append("  A.GPS_GESTIONE_TIPI_COSTO, ");
            SQL.append("  A.BLOCCO_CASSA_COMP_TITOLO_5, ");
            SQL.append("  A.BLOCCO_CASSA_COMP_TITOLO_7, ");
            SQL.append("  A.COLLEGAMENTO_DUP, ");
            SQL.append("  A.BLOCCO_DISP_PURA_STANZ_OBIET ");
            SQL.append("from ");
            SQL.append("  T99 A ");
            SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " - 1) ");
            MainFrm.Cf4armDBObject.DBO().Execute(SQL);
          }
        }
      }
      catch (Exception e6)
      {
        MainFrm.set_AlertMessage(new IDVariant(e6.getMessage())); 
        return 0;
      }
      IMDB.set_Value(IMDBDef1.TBL_PARAMETRI456, IMDBDef1.FLD_PARAMETRI456_ROWNAMEINFOR, 0, (new IDVariant("NO")));
      MainFrm.UnloadForm(MyGlb.FRM_PREFERENZE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_PREFERENZE, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriParametri", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Procedure Informazioni
  // **********************************************************************
  public int ApriProcedureInformazioni ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Procedure Informazioni Body
      // Procedure Body
      // 
      IMDB.set_Value(IMDBDef1.TBL_PARAMETRI456, IMDBDef1.FLD_PARAMETRI456_ROWNAMEINFOR, 0, (new IDVariant("SI")));
      MainFrm.UnloadForm(MyGlb.FRM_PREFERENZE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_PREFERENZE, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriProcedureInformazioni", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esecutività Proposte
  // **********************************************************************
  public int ApriEsecutivitàProposte ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esecutività Proposte Body
      // Procedure Body
      // 
      if (GESTIODELIBE.booleanValue())
      {
        IDVariant v_ERR = new IDVariant(0,IDVariant.STRING);
        v_ERR = (new IDVariant("Integrazione con GS4 attiva per l'esercizio del contesto.", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_ERR); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_ESECUTPROPOS, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsecutivitàProposte", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esecutività Proposte Gs4
  // **********************************************************************
  public int ApriEsecutivitàProposteGs4 ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esecutività Proposte Gs4 Body
      // Procedure Body
      // 
      if (!(GESTIODELIBE.booleanValue()))
      {
        IDVariant v_ERR = new IDVariant(0,IDVariant.STRING);
        v_ERR = (new IDVariant("Funzionalità non ammessa in assenza di integrazione delibere", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_ERR); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_ESECPRODAGS4, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsecutivitàProposteGs4", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Stampa Proposte
  // **********************************************************************
  public int ApriStampaProposte ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Stampa Proposte Body
      // Procedure Body
      // 
      if (!(GESTIODELIBE.booleanValue()))
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Funzionalità non ammessa in assenza di integrazione delibere!", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
        return 0;
      }
      else
      {
        IMDB.set_Value(IMDBDef2.TBL_PARAMETRI248, IMDBDef2.FLD_PARAMETRI248_PARAUNITPROP, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef2.TBL_PARAMETRI248, IMDBDef2.FLD_PARAMETRI248_PARAMANNO, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef2.TBL_PARAMETRI248, IMDBDef2.FLD_PARAMETRI248_PARAMDATA, 0, IDL.Today());
        MainFrm.Show(MyGlb.FRM_STAMPAPROPOS, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriStampaProposte", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Info Soggetto
  // **********************************************************************
  public int ApriInfoSoggetto ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Info Soggetto Body
      // Procedure Body
      // 
      IMDB.set_Value(IMDBDef2.TBL_PARAMETRI307, IMDBDef2.FLD_PARAMETRI307_PARAMINFO, 0, (new IDVariant(1)));
      MainFrm.Show(MyGlb.FRM_SOGGETTI, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriInfoSoggetto", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Controllo Soggetti
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int ControlloSoggetti ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Controllo Soggetti Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_CONTROSOGGET, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_CONTROSOGGET,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef2.TBL_PAR111, IMDBDef2.FLD_PAR111_NOMOGGCONINS, 0, (new IDVariant(0)));
      MainFrm.Show(MyGlb.FRM_CONTROSOGGET, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloSoggetti", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Caricamento Soggetti
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int CaricamentoSoggetti ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Caricamento Soggetti Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_CONTROSOGGET, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_CONTROSOGGET,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef2.TBL_PAR111, IMDBDef2.FLD_PAR111_NOMOGGCONINS, 0, (new IDVariant(1)));
      MainFrm.Show(MyGlb.FRM_CONTROSOGGET, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CaricamentoSoggetti", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Variazioni Per Finanziamento
  // **********************************************************************
  public int ApriVariazioniPerFinanziamento ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Variazioni Per Finanziamento Body
      // Procedure Body
      // 
      if (FINANZIAMENT.booleanValue())
      {
        MainFrm.Show(MyGlb.FRM_VARIAPERFINA, (new IDVariant(0)).intValue(), this); 
      }
      else
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Funzionalità non ammessa. Manca Gestione Finanziamenti", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriVariazioniPerFinanziamento", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Variazioni Per Progetto
  // **********************************************************************
  public int ApriVariazioniPerProgetto ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Variazioni Per Progetto Body
      // Procedure Body
      // 
      if (FunctionRppAttiva().equals((new IDVariant(1)), true))
      {
        MainFrm.Show(MyGlb.FRM_VARIAPERPROG, (new IDVariant(0)).intValue(), this); 
      }
      else
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Funzionalità non ammessa. Rpp non Gestita", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriVariazioniPerProgetto", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Cmd Estremi Variazioni Definitive
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public int CmdEstremiVariazioniDefinitive ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Cmd Estremi Variazioni Definitive Body
      // Procedure Body
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
        v_SMS = (new IDVariant("Gestione Variazioni non Ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_SMS); 
        return 0;
      }
      if ((MainFrm.GetForm(MyGlb.FRM_ESTREMVARIAZ, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_ESTREMVARIAZ,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef3.TBL_PARAM10, IMDBDef3.FLD_PARAM10_ESTRDEFIOPRO, 0, (new IDVariant("D")));
      MainFrm.Show(MyGlb.FRM_ESTREMVARIAZ, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CmdEstremiVariazioniDefinitive", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Cmd Estremi Variazioni Provvisorie
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public int CmdEstremiVariazioniProvvisorie ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Cmd Estremi Variazioni Provvisorie Body
      // Procedure Body
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
        v_SMS = (new IDVariant("Gestione Variazioni non Ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_SMS); 
        return 0;
      }
      if ((MainFrm.GetForm(MyGlb.FRM_ESTREMVARIAZ, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_ESTREMVARIAZ,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef3.TBL_PARAM10, IMDBDef3.FLD_PARAM10_ESTRDEFIOPRO, 0, (new IDVariant("P")));
      MainFrm.Show(MyGlb.FRM_ESTREMVARIAZ, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CmdEstremiVariazioniProvvisorie", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Variazioni Impegnabile
  // **********************************************************************
  public int ApriVariazioniImpegnabile ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Variazioni Impegnabile Body
      // Procedure Body
      // 
      if (GESTIOIMPEGN.equals((new IDVariant("SI")), true))
      {
        if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
        {
          IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
          v_AVVISO = (new IDVariant("Gestione Variazioni non Ammessa", IDVariant.STRING));
          MainFrm.set_AlertMessage(v_AVVISO); 
        }
        else
        {
          APRIVARIIMPE_PARVARIMPDEL();
          MainFrm.Show(MyGlb.FRM_FASE1ESTRPRO, (new IDVariant(0)).intValue(), this); 
        }
      }
      else
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Impegnabile non Prevista", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriVariazioniImpegnabile", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Parametri Variazioni Impegnabile: Delete
  // Why are you deleting these data?
  // **********************************************************************
  private void APRIVARIIMPE_PARVARIMPDEL() throws SQLException
  {
    IMDB.set_Value(IMDBDef3.TBL_PARAVARIIMPE, IMDBDef3.FLD_PARAVARIIMPE_SEDE_DEL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef3.TBL_PARAVARIIMPE, IMDBDef3.FLD_PARAVARIIMPE_NUMERO_DEL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef3.TBL_PARAVARIIMPE, IMDBDef3.FLD_PARAVARIIMPE_ANNO_DEL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef3.TBL_PARAVARIIMPE, IMDBDef3.FLD_PARAVARIIMPE_UNITA_PROPONENTE, 0, new IDVariant());
    IMDB.set_Value(IMDBDef3.TBL_PARAVARIIMPE, IMDBDef3.FLD_PARAVARIIMPE_NUMERO_PROPOSTA, 0, new IDVariant());
    IMDB.set_Value(IMDBDef3.TBL_PARAVARIIMPE, IMDBDef3.FLD_PARAVARIIMPE_ANNO_PROPOSTA, 0, new IDVariant());
    IMDB.set_Value(IMDBDef3.TBL_PARAVARIIMPE, IMDBDef3.FLD_PARAVARIIMPE_PARAINFODELI, 0, new IDVariant());
  }

  // **********************************************************************
  // Apri Esecutività Variazioni
  // **********************************************************************
  public int ApriEsecutivitàVariazioni ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esecutività Variazioni Body
      // Procedure Body
      // 
      if (GESTIODELIBE.booleanValue())
      {
        IDVariant v_ERR = new IDVariant(0,IDVariant.STRING);
        v_ERR = (new IDVariant("Integrazione con GS4 attiva per l'esercizio del contesto.", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_ERR); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_ESECUTVARIAZ, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsecutivitàVariazioni", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esecutività Variazioni Gs4
  // **********************************************************************
  public int ApriEsecutivitàVariazioniGs4 ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esecutività Variazioni Gs4 Body
      // Procedure Body
      // 
      if (!(GESTIODELIBE.booleanValue()))
      {
        IDVariant v_ERR = new IDVariant(0,IDVariant.STRING);
        v_ERR = (new IDVariant("Integrazione con GS4 non attiva per l'esercizio del contesto.", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_ERR); 
        MainFrm.UnloadForm(MyGlb.FRM_ESECVARDAGS4,(new IDVariant(0)).booleanValue()); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_ESECVARDAGS4, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsecutivitàVariazioniGs4", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Assestamenti
  // **********************************************************************
  public int ApriAssestamenti ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Assestamenti Body
      // Corpo Procedura
      // 
      if (!((FASEBILANCIO.compareTo((new IDVariant(3)), true)>=0 && FASEBILANCIO.compareTo((new IDVariant(7)), true)<=0)))
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Variazioni non Ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_ASSESTAMENTI, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriAssestamenti", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Proposte
  // **********************************************************************
  public int ApriProposte ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Proposte Body
      // Corpo Procedura
      // 
      if (!((FASEBILANCIO.compareTo((new IDVariant(3)), true)>=0 && FASEBILANCIO.compareTo((new IDVariant(7)), true)<=0)))
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Variazioni non Ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_PROPODAUFFIC, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriProposte", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Variazioni da Cronoprogramma
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int VariazionidaCronoprogramma ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Variazioni da Cronoprogramma Body
      // Corpo Procedura
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
        v_SMS = (new IDVariant("Gestione Variazioni non Ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_SMS); 
        return 0;
      }
      MainFrm.Show(MyGlb.FRM_GENEVARDACRO, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "VariazionidaCronoprogramma", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Variazioni Esig Consuntivo
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int VariazioniEsigConsuntivo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Variazioni Esig Consuntivo Body
      // Corpo Procedura
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
        v_SMS = (new IDVariant("Gestione Variazioni non Ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_SMS); 
        return 0;
      }
      if ((MainFrm.GetForm(MyGlb.FRM_VARESICOCOAN, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_VARESICOCOAN,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef4.TBL_PAR114, IMDBDef4.FLD_PAR114_NOOGCOANCOAN, 0, (new IDVariant("C")));
      MainFrm.Show(MyGlb.FRM_VARESICOCOAN, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "VariazioniEsigConsuntivo", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Variazioni Esig Anno Corrente
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int VariazioniEsigAnnoCorrente ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Variazioni Esig Anno Corrente Body
      // Corpo Procedura
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
        v_SMS = (new IDVariant("Gestione Variazioni non Ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_SMS); 
        return 0;
      }
      if ((MainFrm.GetForm(MyGlb.FRM_VARESICOCOAN, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_VARESICOCOAN,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef4.TBL_PAR114, IMDBDef4.FLD_PAR114_NOOGCOANCOAN, 0, (new IDVariant("A")));
      MainFrm.Show(MyGlb.FRM_VARESICOCOAN, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "VariazioniEsigAnnoCorrente", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Variazioni Esig Anticipata
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int VariazioniEsigAnticipata ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Variazioni Esig Anticipata Body
      // Corpo Procedura
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
        v_SMS = (new IDVariant("Gestione Variazioni non Ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_SMS); 
        return 0;
      }
      if ((MainFrm.GetForm(MyGlb.FRM_VARESICOCOAN, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_VARESICOCOAN,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef4.TBL_PAR114, IMDBDef4.FLD_PAR114_NOOGCOANCOAN, 0, (new IDVariant("T")));
      MainFrm.Show(MyGlb.FRM_VARESICOCOAN, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "VariazioniEsigAnticipata", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Variazioni Esig Ritardata Entrata
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int VariazioniEsigRitardataEntrata ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Variazioni Esig Ritardata Entrata Body
      // Corpo Procedura
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
        v_SMS = (new IDVariant("Gestione Variazioni non Ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_SMS); 
        return 0;
      }
      if ((MainFrm.GetForm(MyGlb.FRM_VARIESIDIENT, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_VARIESIDIENT,(new IDVariant(0)).booleanValue()); 
      }
      // 
      // R = Ritardata
      // 
      IMDB.set_Value(IMDBDef4.TBL_PAR121, IMDBDef4.FLD_PAR121_NOMOGGRITANT, 0, (new IDVariant("R")));
      MainFrm.Show(MyGlb.FRM_VARIESIDIENT, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "VariazioniEsigRitardataEntrata", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Variazioni Esig Anticipata Entrata
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int VariazioniEsigAnticipataEntrata ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Variazioni Esig Anticipata Entrata Body
      // Corpo Procedura
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_SMS = new IDVariant(0,IDVariant.STRING);
        v_SMS = (new IDVariant("Gestione Variazioni non Ammessa", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_SMS); 
        return 0;
      }
      if ((MainFrm.GetForm(MyGlb.FRM_VARIESIDIENT, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_VARIESIDIENT,(new IDVariant(0)).booleanValue()); 
      }
      // 
      // A = Anticipata
      // 
      IMDB.set_Value(IMDBDef4.TBL_PAR121, IMDBDef4.FLD_PAR121_NOMOGGRITANT, 0, (new IDVariant("A")));
      MainFrm.Show(MyGlb.FRM_VARIESIDIENT, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "VariazioniEsigAnticipataEntrata", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Bilancio A Tesoreria
  // **********************************************************************
  public int ApriBilancioATesoreria ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_OUTFILE = new IDVariant(0,IDVariant.STRING);
    IDVariant v_FASE = new IDVariant(0,IDVariant.STRING);
    IDCachedRowSet C6;

    try
    {
      TransCount = 0;
      v_OUTFILE = (new IDVariant("BILANCIO.txt", IDVariant.STRING));
      v_FASE = (new IDVariant("BIL_MPS", IDVariant.STRING));
      // 
      // Apri Bilancio A Tesoreria Body
      // Procedure Body
      // 
      MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      MainFrm.Cf4armDBObject.GENERATESOBILMPS(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), PROGRESESSIO);
      if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
      {
        MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
        return 0;
      }
      if ((new IDVariant(-1)).equals((new IDVariant(-1)), true))
      {
        IDVariant v_FD = new IDVariant(0,IDVariant.INTEGER);
        // 
        // scrivo il file
        // 
        {
          v_FD = MainFrm.VBFile.FreeFile();
          MainFrm.VBFile.OpenForOutput(IDL.Add(IDL.Add((new IDVariant(MainFrm.RealPath)), (new IDVariant("/"))), v_OUTFILE), v_FD, false); 
          SQL = new StringBuffer();
          SQL.append("select ");
          SQL.append("  A.DATI as WOREXPTESDA1, ");
          SQL.append("  A.ORDINAMENTO as WOREXPTESORD ");
          SQL.append("from ");
          SQL.append("  WORK_EXPORT_TESO A ");
          SQL.append("where (A.FASE = " + IDL.CSql(v_FASE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append("and   (A.SESSIONE = TO_CHAR ( " + IDL.CSql(PROGRESESSIO, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " )) ");
          SQL.append("order by ");
          SQL.append("  A.ORDINAMENTO ");
          C6 = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
          if (!C6.EOF()) C6.MoveNext();
          while (!C6.EOF())
          {
            MainFrm.VBFile.WriteLine(v_FD, C6.Get("WOREXPTESDA1")); 
            C6.MoveNext();
          }
          C6.Close();
          MainFrm.VBFile.Close(v_FD); 
          MainFrm.set_RedirectTo(v_OUTFILE);
          MainFrm.set_RedirectNewWindow((new IDVariant(-1)).booleanValue());
          MainFrm.set_RedirectFeatures((new IDVariant(""))); 
        }
      }
      SQL = new StringBuffer();
      SQL.append("delete from WORK_EXPORT_TESO ");
      SQL.append("where (FASE = " + IDL.CSql(v_FASE, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (SESSIONE = TO_CHAR ( " + IDL.CSql(PROGRESESSIO, IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " )) ");
      MainFrm.Cf4armDBObject.DBO().Execute(SQL);
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriBilancioATesoreria", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Previsioni Per Programma
  // **********************************************************************
  public int ApriPrevisioniPerProgramma ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Previsioni Per Programma Body
      // Procedure Body
      // 
      // if (FunctionRppAttiva().equals((new IDVariant(1)), true))
      // {
        // MainFrm.set_AlertMessage(v_ERR); 
      // }
      // else
      // {
      // }
      MainFrm.Show(MyGlb.FRM_PREVIPERPROG, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriPrevisioniPerProgramma", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Previsioni Per Settore Operativo
  // **********************************************************************
  public int ApriPrevisioniPerSettoreOperativo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Previsioni Per Settore Operativo Body
      // Procedure Body
      // 
      if (IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0).compareTo(IDL.NullValue(ESERCIZIO_INIZIO_WEB,(new IDVariant(2999))), true)>=0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Settore Operativo non gestito per Esercizio ", IDVariant.STRING));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_PREPERSETOPE, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriPrevisioniPerSettoreOperativo", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Previsioni Per Centro Di Costo
  // **********************************************************************
  public int ApriPrevisioniPerCentroDiCosto ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Previsioni Per Centro Di Costo Body
      // Procedure Body
      // 
      if (IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0).compareTo(IDL.NullValue(ESERCIZIO_INIZIO_WEB,(new IDVariant(2999))), true)>=0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Centro di Costo non gestito per Esercizio ", IDVariant.STRING));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_PREPERCEDICO, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriPrevisioniPerCentroDiCosto", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Previsioni Per Unita Di Gestione
  // **********************************************************************
  public int ApriPrevisioniPerUnitaDiGestione ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Previsioni Per Unita Di Gestione Body
      // Procedure Body
      // 
      if (IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0).compareTo(IDL.NullValue(ESERCIZIO_INIZIO_WEB,(new IDVariant(2999))), true)<0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Unità Organizzative non gestite per l'esercizio ", IDVariant.STRING));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_PREPERUNDIGE, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriPrevisioniPerUnitaDiGestione", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Previsioni Per Unita Di Utilizzo
  // **********************************************************************
  public int ApriPrevisioniPerUnitaDiUtilizzo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Previsioni Per Unita Di Utilizzo Body
      // Procedure Body
      // 
      if (IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0).compareTo(IDL.NullValue(ESERCIZIO_INIZIO_WEB,(new IDVariant(2999))), true)<0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Unità Organizzative non gestite per l'esercizio ", IDVariant.STRING));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_PREPERUNDIUT, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriPrevisioniPerUnitaDiUtilizzo", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Estrazioni Dati RPP
  // **********************************************************************
  public int ApriEstrazioniDatiRPP ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Estrazioni Dati RPP Body
      // Procedure Body
      // 
      if (IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0).compareTo((new IDVariant("BO")), true)!=0 && IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0).compareTo((new IDVariant("MO")), true)!=0 && IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0).compareTo((new IDVariant("FE")), true)!=0 && IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0).compareTo((new IDVariant("FC")), true)!=0 && IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0).compareTo((new IDVariant("RN")), true)!=0 && IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0).compareTo((new IDVariant("RE")), true)!=0 && IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0).compareTo((new IDVariant("PR")), true)!=0 && IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0).compareTo((new IDVariant("PC")), true)!=0 && FunctionRppAttiva().equals((new IDVariant(1)), true))
      {
        IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
        v_MESSAGGIO = (new IDVariant("Estrazione abilitata per gli enti dell'Emilia Romagna che non gestiscono cf4rp", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_MESSAGGIO); 
        return 0;
      }
      MainFrm.Show(MyGlb.FRM_ESTRADATIRPP, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEstrazioniDatiRPP", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Estrazioni Dati Certificato Consuntivo
  // **********************************************************************
  public int ApriEstrazioniDatiCertificatoConsuntivo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Estrazioni Dati Certificato Consuntivo Body
      // Procedure Body
      // 
      if (IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0).compareTo((new IDVariant("BO")), true)!=0 && IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0).compareTo((new IDVariant("MO")), true)!=0 && IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0).compareTo((new IDVariant("FE")), true)!=0 && IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0).compareTo((new IDVariant("FC")), true)!=0 && IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0).compareTo((new IDVariant("RN")), true)!=0 && IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0).compareTo((new IDVariant("RE")), true)!=0 && IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0).compareTo((new IDVariant("PR")), true)!=0 && IMDB.Value(IMDBDef7.TBL_T64, IMDBDef7.FLD_T64_PROVINCIA, 0).compareTo((new IDVariant("PC")), true)!=0)
      {
        IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
        v_MESSAGGIO = (new IDVariant("Estrazione abilitata per gli enti dell'Emilia Romagna", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_MESSAGGIO); 
        return 0;
      }
      MainFrm.Show(MyGlb.FRM_ESTDATCERCON, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEstrazioniDatiCertificatoConsuntivo", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Riepilogo Generale Spese
  // **********************************************************************
  public int RiepilogoGeneraleSpese ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_DATAWINDOWS = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      v_DATAWINDOWS = (new IDVariant("d_bil_cc_spesegen", IDVariant.STRING));
      // 
      // Riepilogo Generale Spese Body
      // Procedure Body
      // 
      SetParametroStampa(IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)));
      LanciaStampa(IMDB.Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PARAPERCAPPL, 0), v_DATAWINDOWS);
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "RiepilogoGeneraleSpese", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Funzioni Delegate Bilancio Consuntivo
  // **********************************************************************
  public int FunzioniDelegateBilancioConsuntivo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_DATAWINDOW = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      v_DATAWINDOW = (new IDVariant("d_cc_bil_s_funzdele", IDVariant.STRING));
      // 
      // Funzioni Delegate Bilancio Consuntivo Body
      // Procedure Body
      // 
      SetParametroStampa(IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)));
      SetParametroStampa((new IDVariant("S")));
      LanciaStampa(IMDB.Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PARAPERCAPPL, 0), v_DATAWINDOW);
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "FunzioniDelegateBilancioConsuntivo", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Stampa Contributi Comunitari Internazionali
  // **********************************************************************
  public int StampaContributiComunitariInternazionali ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_DW = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      v_DW = (new IDVariant("d_cc_bil_s_contribcomu", IDVariant.STRING));
      // 
      // Stampa Contributi Comunitari Internazionali Body
      // Procedure Body
      // 
      SetParametroStampa(IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)));
      SetParametroStampa((new IDVariant("S")));
      LanciaStampa(IMDB.Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PARAPERCAPPL, 0), v_DW);
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "StampaContributiComunitariInternazionali", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Prev Peg Entrata
  // **********************************************************************
  public int PrevPegEntrata ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Prev Peg Entrata Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_STAPREPERCAP, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_STAPREPERCAP,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef7.TBL_PARAM, IMDBDef7.FLD_PARAM_NOMEOGGETITO, 0, (new IDVariant("Previsione per capitolo - Entrata")));
      IMDB.set_Value(IMDBDef7.TBL_PARAM, IMDBDef7.FLD_PARAM_NOMEOGGESTAM, 0, (new IDVariant("Peg_Entrate")));
      MainFrm.Show(MyGlb.FRM_STAPREPERCAP, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PrevPegEntrata", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Prev Peg Entrata CC
  // **********************************************************************
  public int PrevPegEntrataCC ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Prev Peg Entrata CC Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_STAPREPERCAP, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_STAPREPERCAP,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef7.TBL_PARAM, IMDBDef7.FLD_PARAM_NOMEOGGETITO, 0, (new IDVariant("Previsione per capitolo - Entrata per centro di costo")));
      IMDB.set_Value(IMDBDef7.TBL_PARAM, IMDBDef7.FLD_PARAM_NOMEOGGESTAM, 0, (new IDVariant("Peg_Entrate_CC")));
      MainFrm.Show(MyGlb.FRM_STAPREPERCAP, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PrevPegEntrataCC", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Prev Peg Entrata UO
  // **********************************************************************
  public int PrevPegEntrataUO ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Prev Peg Entrata UO Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_STAPREPERCAP, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_STAPREPERCAP,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef7.TBL_PARAM, IMDBDef7.FLD_PARAM_NOMEOGGETITO, 0, (new IDVariant("Previsione per capitolo - Entrata per unità org.")));
      IMDB.set_Value(IMDBDef7.TBL_PARAM, IMDBDef7.FLD_PARAM_NOMEOGGESTAM, 0, (new IDVariant("Peg_Entrate_UO")));
      MainFrm.Show(MyGlb.FRM_STAPREPERCAP, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PrevPegEntrataUO", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Prev Peg Spesa
  // **********************************************************************
  public int PrevPegSpesa ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Prev Peg Spesa Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_STAPREPERCAP, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_STAPREPERCAP,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef7.TBL_PARAM, IMDBDef7.FLD_PARAM_NOMEOGGETITO, 0, (new IDVariant("Previsione per capitolo - Spesa")));
      IMDB.set_Value(IMDBDef7.TBL_PARAM, IMDBDef7.FLD_PARAM_NOMEOGGESTAM, 0, (new IDVariant("Peg_Spese")));
      MainFrm.Show(MyGlb.FRM_STAPREPERCAP, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PrevPegSpesa", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Prev Peg Spesa CC
  // **********************************************************************
  public int PrevPegSpesaCC ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Prev Peg Spesa CC Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_STAPREPERCAP, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_STAPREPERCAP,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef7.TBL_PARAM, IMDBDef7.FLD_PARAM_NOMEOGGETITO, 0, (new IDVariant("Previsione per capitolo - Spesa per centro di costo")));
      IMDB.set_Value(IMDBDef7.TBL_PARAM, IMDBDef7.FLD_PARAM_NOMEOGGESTAM, 0, (new IDVariant("Peg_Spese_CC")));
      MainFrm.Show(MyGlb.FRM_STAPREPERCAP, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PrevPegSpesaCC", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Prev Peg Spesa UO
  // **********************************************************************
  public int PrevPegSpesaUO ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Prev Peg Spesa UO Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_STAPREPERCAP, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_STAPREPERCAP,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef7.TBL_PARAM, IMDBDef7.FLD_PARAM_NOMEOGGETITO, 0, (new IDVariant("Previsione per capitolo - Spesa per unità org.")));
      IMDB.set_Value(IMDBDef7.TBL_PARAM, IMDBDef7.FLD_PARAM_NOMEOGGESTAM, 0, (new IDVariant("Peg_Spese_UO")));
      MainFrm.Show(MyGlb.FRM_STAPREPERCAP, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PrevPegSpesaUO", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Peg Agg Entrata
  // **********************************************************************
  public int PegAggEntrata ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Peg Agg Entrata Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_PEGAGGENTSPE,(new IDVariant(0)).booleanValue()); 
      IMDB.set_Value(IMDBDef3.TBL_PARAMETRI433, IMDBDef3.FLD_PARAMETRI433_PARAMPARTE, 0, (new IDVariant("E")));
      IMDB.set_Value(IMDBDef3.TBL_PARAMETRI433, IMDBDef3.FLD_PARAMETRI433_PARATIPOSTAM, 0, (new IDVariant("ES")));
      MainFrm.Show(MyGlb.FRM_PEGAGGENTSPE, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PegAggEntrata", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Peg Agg Spesa
  // **********************************************************************
  public int PegAggSpesa ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Peg Agg Spesa Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_PEGAGGENTSPE,(new IDVariant(0)).booleanValue()); 
      IMDB.set_Value(IMDBDef3.TBL_PARAMETRI433, IMDBDef3.FLD_PARAMETRI433_PARAMPARTE, 0, (new IDVariant("S")));
      IMDB.set_Value(IMDBDef3.TBL_PARAMETRI433, IMDBDef3.FLD_PARAMETRI433_PARATIPOSTAM, 0, (new IDVariant("ES")));
      MainFrm.Show(MyGlb.FRM_PEGAGGENTSPE, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PegAggSpesa", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Peg Agg Entrata CC
  // **********************************************************************
  public int PegAggEntrataCC ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Peg Agg Entrata CC Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_PEGAGGENTSPE,(new IDVariant(0)).booleanValue()); 
      IMDB.set_Value(IMDBDef3.TBL_PARAMETRI433, IMDBDef3.FLD_PARAMETRI433_PARAMPARTE, 0, (new IDVariant("E")));
      IMDB.set_Value(IMDBDef3.TBL_PARAMETRI433, IMDBDef3.FLD_PARAMETRI433_PARATIPOSTAM, 0, (new IDVariant("CC")));
      MainFrm.Show(MyGlb.FRM_PEGAGGENTSPE, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PegAggEntrataCC", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Peg Agg Spesa CC
  // **********************************************************************
  public int PegAggSpesaCC ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Peg Agg Spesa CC Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_PEGAGGENTSPE,(new IDVariant(0)).booleanValue()); 
      IMDB.set_Value(IMDBDef3.TBL_PARAMETRI433, IMDBDef3.FLD_PARAMETRI433_PARAMPARTE, 0, (new IDVariant("S")));
      IMDB.set_Value(IMDBDef3.TBL_PARAMETRI433, IMDBDef3.FLD_PARAMETRI433_PARATIPOSTAM, 0, (new IDVariant("CC")));
      MainFrm.Show(MyGlb.FRM_PEGAGGENTSPE, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PegAggSpesaCC", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Peg Agg Entrata UO
  // **********************************************************************
  public int PegAggEntrataUO ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Peg Agg Entrata UO Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_PEGAGGENTSPE,(new IDVariant(0)).booleanValue()); 
      IMDB.set_Value(IMDBDef3.TBL_PARAMETRI433, IMDBDef3.FLD_PARAMETRI433_PARAMPARTE, 0, (new IDVariant("E")));
      IMDB.set_Value(IMDBDef3.TBL_PARAMETRI433, IMDBDef3.FLD_PARAMETRI433_PARATIPOSTAM, 0, (new IDVariant("UO")));
      MainFrm.Show(MyGlb.FRM_PEGAGGENTSPE, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PegAggEntrataUO", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Peg Agg Spesa UO
  // **********************************************************************
  public int PegAggSpesaUO ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Peg Agg Spesa UO Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_PEGAGGENTSPE,(new IDVariant(0)).booleanValue()); 
      IMDB.set_Value(IMDBDef3.TBL_PARAMETRI433, IMDBDef3.FLD_PARAMETRI433_PARAMPARTE, 0, (new IDVariant("S")));
      IMDB.set_Value(IMDBDef3.TBL_PARAMETRI433, IMDBDef3.FLD_PARAMETRI433_PARATIPOSTAM, 0, (new IDVariant("UO")));
      MainFrm.Show(MyGlb.FRM_PEGAGGENTSPE, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PegAggSpesaUO", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Genera Dati Certificato Preventivo
  // **********************************************************************
  public int GeneraDatiCertificatoPreventivo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Genera Dati Certificato Preventivo Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_DATICERTIFIC,(new IDVariant(0)).booleanValue()); 
      IMDB.set_Value(IMDBDef4.TBL_PARAM129, IMDBDef4.FLD_PARAM129_PARATIPOCERT, 0, (new IDVariant("PREV")));
      MainFrm.Show(MyGlb.FRM_DATICERTIFIC, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GeneraDatiCertificatoPreventivo", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Genera Dati Certificato Consuntivo
  // **********************************************************************
  public int GeneraDatiCertificatoConsuntivo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Genera Dati Certificato Consuntivo Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_DATICERTIFIC,(new IDVariant(0)).booleanValue()); 
      IMDB.set_Value(IMDBDef4.TBL_PARAM129, IMDBDef4.FLD_PARAM129_PARATIPOCERT, 0, (new IDVariant("CONS")));
      MainFrm.Show(MyGlb.FRM_DATICERTIFIC, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GeneraDatiCertificatoConsuntivo", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Passaggio su Bilancio Effettivo
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int PassaggiosuBilancioEffettivo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Passaggio su Bilancio Effettivo Body
      // Corpo Procedura
      // 
      if (FASEBILANCIO.compareTo((new IDVariant(7)), true)>=0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Funzione non ammessa per la fase di bilancio dell'esercizio"));
        MainFrm.set_AlertMessage(v_AVVISO); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_PASSSUBILEFF, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "PassaggiosuBilancioEffettivo", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apertura Nuovo Bilancio
  // **********************************************************************
  public int AperturaNuovoBilancio ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_COUNT1 = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_COUNT2 = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Apertura Nuovo Bilancio Body
      // Procedure Body
      // 
      v_COUNT1 = (new IDVariant(0));
      v_COUNT2 = (new IDVariant(0));
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  ESEIMP A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_IMP < " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_COUNT1 = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  ESEACC A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      SQL.append("and   (A.ANNO_ACC < " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_COUNT2 = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_COUNT1.compareTo((new IDVariant(0)), true)>0 || v_COUNT2.compareTo((new IDVariant(0)), true)>0)
      {
        IDVariant v_MESSERR = new IDVariant(0,IDVariant.STRING);
        v_MESSERR = (new IDVariant(",sono presenti Impegni/Accertamenti. Apertura Nuovo Bilancio non ammessa.", IDVariant.STRING));
        MainFrm.set_AlertMessage(IDL.Add(IDL.Add(IDL.Add((new IDVariant("Esercizio")), (new IDVariant(" "))), IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0))), v_MESSERR)); 
      }
      else
      {
        IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
        v_MESSAGGIO = IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add((new IDVariant("Apertura Bilancio")), (new IDVariant(" "))), IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0))), (new IDVariant("."))), (new IDVariant(" "))), (new IDVariant("Continuare?")));
        if (!(MainFrm.MessageConfirm(v_MESSAGGIO)))
        {
          return 0;
        }
        else
        {
          MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
          MainFrm.Cf4armDBObject.BILAPERTURA(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0));
          if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
          {
            MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
          }
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "AperturaNuovoBilancio", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Elimina Bilancio Simulato
  // **********************************************************************
  public int EliminaBilancioSimulato ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Elimina Bilancio Simulato Body
      // Procedure Body
      // 
      IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
      IDVariant v_MESS2 = new IDVariant(0,IDVariant.STRING);
      v_MESS2 = (new IDVariant("Si vuole eliminare il Bilancio Simulato per l'Esercizio Finanziario"));
      v_MESSAGGIO = IDL.Add(IDL.Add(IDL.Add(v_MESS2, (new IDVariant(" "))), IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0))), (new IDVariant("?")));
      if (!(MainFrm.MessageConfirm(v_MESSAGGIO)))
      {
        return 0;
      }
      else
      {
        MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
        MainFrm.Cf4armDBObject.BPRELIMINA(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), FASEBILANCIO);
        if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
        {
          MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
        }
        else
        {
          IDVariant v_MESSFINALE = new IDVariant(0,IDVariant.STRING);
          v_MESSFINALE = (new IDVariant("Elaborazione Terminata", IDVariant.STRING));
          MainFrm.set_AlertMessage(v_MESSFINALE); 
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "EliminaBilancioSimulato", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Menu Calcoli Bilancio Simulato
  // **********************************************************************
  public int MenuCalcoliBilancioSimulato ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Menu Calcoli Bilancio Simulato Body
      // Corpo Procedura
      // 
      if (FASEBILANCIO.compareTo((new IDVariant(2)), true)>0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Funzione non ammessa per la fase di bilancio dell'esercizio"));
        MainFrm.set_AlertMessage(v_AVVISO); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_CALIMPBILSIM, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "MenuCalcoliBilancioSimulato", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Menu Calcoli Bilancio Effettivo
  // **********************************************************************
  public int MenuCalcoliBilancioEffettivo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Menu Calcoli Bilancio Effettivo Body
      // Corpo Procedura
      // 
      if (FASEBILANCIO.compareTo((new IDVariant(2)), true)>0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Funzione non ammessa per la fase di bilancio dell'esercizio"));
        MainFrm.set_AlertMessage(v_AVVISO); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_CALIMPBILEFF, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "MenuCalcoliBilancioEffettivo", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Nuovo Impegno
  // **********************************************************************
  public int ApriNuovoImpegno ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Nuovo Impegno Body
      // Procedure Body
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Movimenti non ammessa per l'esercizio ", IDVariant.STRING));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI20, IMDBDef4.FLD_PARAMETRI20_ROWNAMIMPRES, 0, (new IDVariant("I")));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI20, IMDBDef4.FLD_PARAMETRI20_ROWNAMANNIMP, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI20, IMDBDef4.FLD_PARAMETRI20_ROWNAMNUMIMP, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI20, IMDBDef4.FLD_PARAMETRI20_RONANUIMDAES, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI20, IMDBDef4.FLD_PARAMETRI20_ROWNAMECAPIT, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI20, IMDBDef4.FLD_PARAMETRI20_ROWNAMEARTIC, 0, (new IDVariant()));
        MainFrm.Show(MyGlb.FRM_IMPEGNO, (new IDVariant(0)).intValue(), this); 
        ((Impegno)MainFrm.GetForm(MyGlb.FRM_IMPEGNO,0)).PAN_IMPEGNO.PanelCommand(Glb.PCM_INSERT);
        ((Impegno)MainFrm.GetForm(MyGlb.FRM_IMPEGNO,0)).ProponiNuovaRigaImpegno();
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriNuovoImpegno", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Nuova Reiscrizione Impegno
  // **********************************************************************
  public int ApriNuovaReiscrizioneImpegno ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Nuova Reiscrizione Impegno Body
      // Procedure Body
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Movimenti non ammessa per l'esercizio ", IDVariant.STRING));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI20, IMDBDef4.FLD_PARAMETRI20_ROWNAMIMPRES, 0, (new IDVariant("I")));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI20, IMDBDef4.FLD_PARAMETRI20_ROWNAMANNIMP, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI20, IMDBDef4.FLD_PARAMETRI20_ROWNAMNUMIMP, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI20, IMDBDef4.FLD_PARAMETRI20_RONANUIMDAES, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI20, IMDBDef4.FLD_PARAMETRI20_ROWNAMECAPIT, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI20, IMDBDef4.FLD_PARAMETRI20_ROWNAMEARTIC, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI20, IMDBDef4.FLD_PARAMETRI20_ROWNAMEREISC, 0, (new IDVariant("SI")));
        MainFrm.Show(MyGlb.FRM_IMPEGNO, (new IDVariant(0)).intValue(), this); 
        ((Impegno)MainFrm.GetForm(MyGlb.FRM_IMPEGNO,0)).PAN_IMPEGNO.PanelCommand(Glb.PCM_INSERT);
        ((Impegno)MainFrm.GetForm(MyGlb.FRM_IMPEGNO,0)).ProponiNuovaRigaImpegno();
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriNuovaReiscrizioneImpegno", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Incarichi
  // **********************************************************************
  public int ApriIncarichi ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Incarichi Body
      // Procedure Body
      // 
      if (G_I.equals((new IDVariant("SI")), true))
      {
        MainFrm.Show(MyGlb.FRM_INCARIIMPEGN, (new IDVariant(0)).intValue(), this); 
      }
      else
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Incarichi non presente", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriIncarichi", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Nuovo Subimpegno
  // **********************************************************************
  public int ApriNuovoSubimpegno ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Nuovo Subimpegno Body
      // Procedure Body
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Movimenti non ammessa per l'esercizio ", IDVariant.STRING));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI340, IMDBDef4.FLD_PARAMETRI340_ROWNAMIMPRES, 0, (new IDVariant("I")));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI340, IMDBDef4.FLD_PARAMETRI340_ROWNAMANSUIM, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI340, IMDBDef4.FLD_PARAMETRI340_ROWNAMNUSUIM, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI340, IMDBDef4.FLD_PARAMETRI340_RONANUSUDAES, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI340, IMDBDef4.FLD_PARAMETRI340_ROWNAMANNIMP, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI340, IMDBDef4.FLD_PARAMETRI340_ROWNAMNUMIMP, 0, (new IDVariant()));
        MainFrm.Show(MyGlb.FRM_SUBIMPEGNO, (new IDVariant(0)).intValue(), this); 
        ((SubImpegno)MainFrm.GetForm(MyGlb.FRM_SUBIMPEGNO,0)).ProponiNuovaRigaSubimpegno();
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriNuovoSubimpegno", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Nuova Reiscrizione Subimpegno
  // **********************************************************************
  public int ApriNuovaReiscrizioneSubimpegno ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Nuova Reiscrizione Subimpegno Body
      // Procedure Body
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Movimenti non ammessa per l'esercizio ", IDVariant.STRING));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI340, IMDBDef4.FLD_PARAMETRI340_ROWNAMIMPRES, 0, (new IDVariant("I")));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI340, IMDBDef4.FLD_PARAMETRI340_ROWNAMANSUIM, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI340, IMDBDef4.FLD_PARAMETRI340_ROWNAMNUSUIM, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI340, IMDBDef4.FLD_PARAMETRI340_RONANUSUDAES, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI340, IMDBDef4.FLD_PARAMETRI340_ROWNAMANNIMP, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI340, IMDBDef4.FLD_PARAMETRI340_ROWNAMNUMIMP, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI340, IMDBDef4.FLD_PARAMETRI340_ROWNAMEREISC, 0, (new IDVariant("SI")));
        MainFrm.Show(MyGlb.FRM_SUBIMPEGNO, (new IDVariant(0)).intValue(), this); 
        ((SubImpegno)MainFrm.GetForm(MyGlb.FRM_SUBIMPEGNO,0)).ProponiNuovaRigaSubimpegno();
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriNuovaReiscrizioneSubimpegno", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Nuovo Accertamento
  // **********************************************************************
  public int ApriNuovoAccertamento ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Nuovo Accertamento Body
      // Procedure Body
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Movimenti non ammessa per l'esercizio ", IDVariant.STRING));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI337, IMDBDef4.FLD_PARAMETRI337_PARAMCAPITOL, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI337, IMDBDef4.FLD_PARAMETRI337_PARAMARTICOL, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI337, IMDBDef4.FLD_PARAMETRI337_PARATIPOFORM, 0, (new IDVariant("Accertamento")));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI337, IMDBDef4.FLD_PARAMETRI337_PARANUODAESP, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI337, IMDBDef4.FLD_PARAMETRI337_PARAUNITORGA, 0, (new IDVariant()));
        MainFrm.Show(MyGlb.FRM_ACCERTAMENTI, (new IDVariant(0)).intValue(), this); 
        ((Accertamenti)MainFrm.GetForm(MyGlb.FRM_ACCERTAMENTI,0)).NUOVARIGA();
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriNuovoAccertamento", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Nuova Reiscrizione Accertamento
  // **********************************************************************
  public int ApriNuovaReiscrizioneAccertamento ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Nuova Reiscrizione Accertamento Body
      // Procedure Body
      // 
      if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Movimenti non ammessa per l'esercizio ", IDVariant.STRING));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI337, IMDBDef4.FLD_PARAMETRI337_PARAMCAPITOL, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI337, IMDBDef4.FLD_PARAMETRI337_PARAMARTICOL, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI337, IMDBDef4.FLD_PARAMETRI337_PARATIPOFORM, 0, (new IDVariant("Accertamento")));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI337, IMDBDef4.FLD_PARAMETRI337_PARANUODAESP, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI337, IMDBDef4.FLD_PARAMETRI337_PARAUNITORGA, 0, (new IDVariant()));
        IMDB.set_Value(IMDBDef4.TBL_PARAMETRI337, IMDBDef4.FLD_PARAMETRI337_PARAMREISCRI, 0, (new IDVariant("SI")));
        MainFrm.Show(MyGlb.FRM_ACCERTAMENTI, (new IDVariant(0)).intValue(), this); 
        ((Accertamenti)MainFrm.GetForm(MyGlb.FRM_ACCERTAMENTI,0)).NUOVARIGA();
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriNuovaReiscrizioneAccertamento", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Accertamenti A Gruppi
  // **********************************************************************
  public int ApriAccertamentiAGruppi ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Accertamenti A Gruppi Body
      // Corpo Procedura
      // 
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI644, IMDBDef5.FLD_PARAMETRI644_PARATIPOMOVI, 0, (new IDVariant("ACC")));
      MainFrm.Show(MyGlb.FRM_MOVIMEAGRUPP, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriAccertamentiAGruppi", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Liquidazioni A Gruppi
  // **********************************************************************
  public int ApriLiquidazioniAGruppi ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Liquidazioni A Gruppi Body
      // Procedure Body
      // 
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI266, IMDBDef5.FLD_PARAMETRI266_PARAMLIQORD, 0, (new IDVariant("LIQ")));
      MainFrm.UnloadForm(MyGlb.FRM_LIQUORDIAGRU,(new IDVariant(0)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_LIQUORDIAGRU, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriLiquidazioniAGruppi", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Caricamento Imputazioni Spesa
  // **********************************************************************
  public int ApriCaricamentoImputazioniSpesa ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_FASE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Apri Caricamento Imputazioni Spesa Body
      // Procedure Body
      // 
      if (PROCEDPERSON.compareTo((new IDVariant(1)), true)!=0)
      {
        IDVariant v_ERR = new IDVariant(0,IDVariant.STRING);
        v_ERR = (new IDVariant("Caricamento Imputazioni ammesso per Personale collegato a procedura esterna", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_ERR); 
      }
      else
      {
        v_FASE = ControllaEsefin(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0));
        if (v_FASE.equals((new IDVariant(0)), true) || v_FASE.compareTo((new IDVariant(7)), true)>0)
        {
          IDVariant v_ERR = new IDVariant(0,IDVariant.STRING);
          v_ERR = (new IDVariant("Gestione Movimenti non ammessi", IDVariant.STRING));
          MainFrm.set_AlertMessage(v_ERR); 
        }
        else
        {
          MainFrm.UnloadForm(MyGlb.FRM_CARICAIMPUTA,(new IDVariant(0)).booleanValue()); 
          IMDB.set_Value(IMDBDef6.TBL_PAR75, IMDBDef6.FLD_PAR75_ROWNAMENTSPE, 0, (new IDVariant("S")));
          MainFrm.Show(MyGlb.FRM_CARICAIMPUTA, (new IDVariant(0)).intValue(), this); 
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriCaricamentoImputazioniSpesa", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Controllo Imputazioni Liquidazioni
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int ApriControlloImputazioniLiquidazioni ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Controllo Imputazioni Liquidazioni Body
      // Corpo Procedura
      // 
      ApriControlloImputazioniSpesa((new IDVariant()));
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriControlloImputazioniLiquidazioni", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Liquidazioni Da Distinta Economato
  // **********************************************************************
  public int ApriLiquidazioniDaDistintaEconomato ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_FASE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Apri Liquidazioni Da Distinta Economato Body
      // Procedure Body
      // 
      if (TIPOORDINATI.compareTo((new IDVariant(3)), true)!=0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Funzionalità non ammessa. Manca integrazione con Economato.", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
        return 0;
      }
      v_FASE = ControllaEsefin(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0));
      if (v_FASE.equals((new IDVariant(0)), true) || v_FASE.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Movimenti non Ammessa!", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
        return 0;
      }
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI299, IMDBDef5.FLD_PARAMETRI299_PARAANNODIST, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI299, IMDBDef5.FLD_PARAMETRI299_PARANUMEDIST, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI299, IMDBDef5.FLD_PARAMETRI299_PARSOLIMDALI, 0, (new IDVariant("SI")));
      MainFrm.Show(MyGlb.FRM_LIQUDADISECO, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriLiquidazioniDaDistintaEconomato", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Liquidazioni Distinta Cassa Economale
  // **********************************************************************
  public int ApriLiquidazioniDistintaCassaEconomale ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_FASE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Apri Liquidazioni Distinta Cassa Economale Body
      // Procedure Body
      // 
      if (INTEGRAZIGC4.equals((new IDVariant(0)), true))
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Funzionalità non ammessa. Manca integrazione con Cassa Economale.", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
        return 0;
      }
      v_FASE = ControllaEsefin(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0));
      if (v_FASE.equals((new IDVariant(0)), true) || v_FASE.compareTo((new IDVariant(7)), true)>0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Movimenti non Ammessa!", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
        return 0;
      }
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI295, IMDBDef5.FLD_PARAMETRI295_PARAANNODIST, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI295, IMDBDef5.FLD_PARAMETRI295_PARANUMEDIST, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI295, IMDBDef5.FLD_PARAMETRI295_PARSOLMODALI, 0, (new IDVariant("SI")));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI295, IMDBDef5.FLD_PARAMETRI295_PARAMPERIDAL, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI295, IMDBDef5.FLD_PARAMETRI295_PARAMAL, 0, (new IDVariant()));
      MainFrm.Show(MyGlb.FRM_LIQDISCASECO, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriLiquidazioniDistintaCassaEconomale", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Liquidazione Multipla
  // **********************************************************************
  public int ApriLiquidazioneMultipla ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_DESCRIZIONEP = new IDVariant(0,IDVariant.STRING);
    IDVariant v_BOLLO = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      v_DESCRIZIONEP = (new IDVariant("Saldo Fattura", IDVariant.STRING));
      // 
      // Apri Liquidazione Multipla Body
      // Procedure Body
      // 
      if (FASEBILANCIO.compareTo((new IDVariant(0)), true)>0 && FASEBILANCIO.compareTo((new IDVariant(7)), true)<=0)
      {
        APRILIQUMULT_PARLIQMULDEL();
        APRILIQUMULT_PARFAS2DELRO();
        // 
        // apro e richuiudo per evitare che la prima volta non setti i parametri impostati
        // 
        {
          MainFrm.Show(MyGlb.FRM_FASE1ESTRLIQ, (new IDVariant(0)).intValue(), this); 
          MainFrm.UnloadForm(MyGlb.FRM_FASE1ESTRLIQ,(new IDVariant(0)).booleanValue()); 
        }
        IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_DESCRIZIONE, 0, new IDVariant(v_DESCRIZIONEP));
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  MIN(A.CODICE) as MINT60CODICE ");
        SQL.append("from ");
        SQL.append("  T60 A ");
        SQL.append("where (A.TIPO = 'F') ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_BOLLO = QV.Get("MINT60CODICE", IDVariant.INTEGER) ;
        }
        QV.Close();
        IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_BOLLO, 0, new IDVariant(v_BOLLO));
        IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_D_DATA_REG, 0, IDL.Today());
        MainFrm.Show(MyGlb.FRM_FASE1ESTRLIQ, (new IDVariant(0)).intValue(), this); 
      }
      else
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Movimenti non Ammessa per l'Esercizio ", IDVariant.STRING));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriLiquidazioneMultipla", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Parametri Liquidazione Multipla: Delete
  // Why are you deleting these data?
  // **********************************************************************
  private void APRILIQUMULT_PARLIQMULDEL() throws SQLException
  {
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_CAPITOLO, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_ARTICOLO, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_PARAMTITOLO, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_PARAMCATEGOR, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_PARAMCODINTE, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_PARAMCODTERZ, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_ANNO_IMP, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_NUMERO_IMP, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_ANNO_SUBIMP, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_NUMERO_SUBIMP, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_ANNO_DEL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_NUMERO_DEL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_SEDE_DEL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_DESCRIZIONE, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_BOLLO, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_ANNO_PROPOSTA, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_UNITA_PROPONENTE, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_NUMERO_PROPOSTA, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_VOCE_ECON, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_D_DATA_REG, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_CODICE_GESTIONALE, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_PARAMINEMISS, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_PARATIPOVINC, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_PARAMRILECO, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_PARAMFATTORE, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_PARAMCENTRO, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_PARAMCOMPDAL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_PARAMCOMPAL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_PARAMFINANZI, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_UFFICIO, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_CAUSALE, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_DIVERSO_BEN, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_NUM_QUIETANZA_DIV_BEN, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_NUMERO_CONTABILE, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_DATA_CONTABILE, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_SPESE, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_SCADENZA, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_ALLEGATI, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_COMMISSIONI, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_INFO_TESORIERE, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_PARAPRODAESP, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_CIG, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_MOTIVO_ESCLUSIONE_CIG, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_CUP, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_CODICE_COFOG, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_CODICE_EUROPEO, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARALIQUMULT, IMDBDef5.FLD_PARALIQUMULT_COD_LIVELLO_5, 0, new IDVariant());
  }

  // **********************************************************************
  // Parametri Fase 2: Delete rows
  // Why are you deleting these data?
  // **********************************************************************
  private void APRILIQUMULT_PARFAS2DELRO() throws SQLException
  {
    IMDB.set_Value(IMDBDef5.TBL_PARAMETFASE2, IMDBDef5.FLD_PARAMETFASE2_PARDATPRODAL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARAMETFASE2, IMDBDef5.FLD_PARAMETFASE2_PARADATPROAL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARAMETFASE2, IMDBDef5.FLD_PARAMETFASE2_PARAMSCADDAL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARAMETFASE2, IMDBDef5.FLD_PARAMETFASE2_PARAMSCADEAL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARAMETFASE2, IMDBDef5.FLD_PARAMETFASE2_PARAMORDINAM, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARAMETFASE2, IMDBDef5.FLD_PARAMETFASE2_PARATOTAPARZ, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARAMETFASE2, IMDBDef5.FLD_PARAMETFASE2_PARACODIBENE, 0, new IDVariant());
  }

  // **********************************************************************
  // Apri Liquidazione SP
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public int ApriLiquidazioneSP ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Liquidazione SP Body
      // Procedure Body
      // 
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI266, IMDBDef5.FLD_PARAMETRI266_PARAMLIQORD, 0, (new IDVariant("SP")));
      MainFrm.Show(MyGlb.FRM_LIQUORDIAGRU, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriLiquidazioneSP", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Pagamento Completo
  // **********************************************************************
  public int ApriPagamentoCompleto ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Pagamento Completo Body
      // Procedure Body
      // 
      if (ControlloFaseEsefin(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)).equals((new IDVariant(-1)), true))
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Movimenti non ammessa per l'esercizio ", IDVariant.STRING));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_PAGAMECOMPLE, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriPagamentoCompleto", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Emissione Mandati Da Provvisori
  // **********************************************************************
  public int ApriEmissioneMandatiDaProvvisori ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTROLLO = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_MSG = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      v_MSG = (new IDVariant("Sui mandandati provvisori sono presenti Impegni di esercizi successivi: non è possibile emettere Liquidazioni ", IDVariant.STRING));
      // 
      // Apri Emissione Mandati Da Provvisori Body
      // Procedure Body
      // 
      // 
      // controllo
      // 
      {
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  MAN_PROV_DETTAGLI A ");
        SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.ANNO_IMP > " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_CONTROLLO = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
        if (v_CONTROLLO.compareTo((new IDVariant(0)), true)!=0)
        {
          MainFrm.set_AlertMessage(v_MSG); 
          return 0;
        }
        else
        {
          MainFrm.Show(MyGlb.FRM_EMISMANDAPRO, (new IDVariant(0)).intValue(), this); 
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEmissioneMandatiDaProvvisori", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Emissione Automatica Mandati
  // **********************************************************************
  public int ApriEmissioneAutomaticaMandati ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Emissione Automatica Mandati Body
      // Procedure Body
      // 
      if (ControlloFaseEsefin(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)).equals((new IDVariant(-1)), true))
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Gestione Movimenti non ammessa per l'esercizio ", IDVariant.STRING));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_EMISAUTOMAND, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEmissioneAutomaticaMandati", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Ricezione Pagamenti Da Tesoreria
  // **********************************************************************
  public int ApriRicezionePagamentiDaTesoreria ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Ricezione Pagamenti Da Tesoreria Body
      // Procedure Body
      // 
      MainFrm.UnloadForm(MyGlb.FRM_RICPAGINDATE,(new IDVariant(0)).booleanValue()); 
      IMDB.set_Value(IMDBDef6.TBL_PARAMETRI66, IMDBDef6.FLD_PARAMETRI66_ROWNAMETIPO, 0, (new IDVariant(1)));
      IMDB.set_Value(IMDBDef6.TBL_PARAMETRI66, IMDBDef6.FLD_PARAMETRI66_ROWNAMEFASE, 0, (new IDVariant("PAGAM")));
      MainFrm.Show(MyGlb.FRM_RICPAGINDATE, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriRicezionePagamentiDaTesoreria", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Trasmissione Mandati A Tesoreria
  // **********************************************************************
  public int ApriTrasmissioneMandatiATesoreria ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Trasmissione Mandati A Tesoreria Body
      // Procedure Body
      // 
      // 
      // controllo sulla fase
      // 
      {
        if (FASEBILANCIO.equals((new IDVariant(0)), true) || FASEBILANCIO.compareTo((new IDVariant(7)), true)>0)
        {
          IDVariant v_MSG = new IDVariant(0,IDVariant.STRING);
          v_MSG = (new IDVariant("Gestione movimenti non Ammessa", IDVariant.STRING));
          MainFrm.set_AlertMessage(v_MSG); 
          return 0;
        }
      }
      // 
      // controllo sulla licenza
      // 
      {
        IDVariant v_MSG = new IDVariant(0,IDVariant.STRING);
        v_MSG = (new IDVariant("Utilizzare la fase di invio del Mandato Informatico", IDVariant.STRING));
        if (Licenza(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOISTANZ, 0), IDL.Upper((new IDVariant("MIF")))))
        {
          if (!(IDL.IsNull(DATA_INIZIO_MAND_INF)))
          {
            if (DATA_INIZIO_MAND_INF.compareTo(IDL.Today(), true)<0)
            {
              MainFrm.set_AlertMessage(v_MSG); 
              return 0;
            }
          }
        }
      }
      APRTRAMANATE_PARTRMAATEDE();
      MainFrm.UnloadForm(MyGlb.FRM_TRASMANDATES,(new IDVariant(0)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_TRASMANDATES, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriTrasmissioneMandatiATesoreria", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Parametri Trasmissione Mandati A Tesoreria: Delete
  // Why are you deleting these data?
  // **********************************************************************
  private void APRTRAMANATE_PARTRMAATEDE() throws SQLException
  {
    IMDB.set_Value(IMDBDef5.TBL_PARTRAMANATE, IMDBDef5.FLD_PARTRAMANATE_ROWNAMEDAL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARTRAMANATE, IMDBDef5.FLD_PARTRAMANATE_ROWNAMEAL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARTRAMANATE, IMDBDef5.FLD_PARTRAMANATE_ROWNAMEMANDA, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARTRAMANATE, IMDBDef5.FLD_PARTRAMANATE_ROWNAMOLDTIP, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARTRAMANATE, IMDBDef5.FLD_PARTRAMANATE_ROWNAMDISNUM, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARTRAMANATE, IMDBDef5.FLD_PARTRAMANATE_ROWNAMDATRIS, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARTRAMANATE, IMDBDef5.FLD_PARTRAMANATE_ROWNAMEDALD, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARTRAMANATE, IMDBDef5.FLD_PARTRAMANATE_ROWNAMEALD, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARTRAMANATE, IMDBDef5.FLD_PARTRAMANATE_ROWNAMETIPO, 0, new IDVariant());
    IMDB.set_Value(IMDBDef5.TBL_PARTRAMANATE, IMDBDef5.FLD_PARTRAMANATE_ROWNAMEUFFIC, 0, new IDVariant());
  }

  // **********************************************************************
  // Apri Elenco Anomali File Auto Man
  // **********************************************************************
  public int ApriElencoAnomaliFileAutoMan ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Elenco Anomali File Auto Man Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_ELENERROAUTO, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_ELENERROAUTO,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef6.TBL_NEWTABLE, IMDBDef6.FLD_NEWTABLE_ROWNAMEFASE, 0, (new IDVariant("PAGAM")));
      MainFrm.Show(MyGlb.FRM_ELENERROAUTO, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriElencoAnomaliFileAutoMan", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Annulli Mandato
  // **********************************************************************
  public int ApriAnnulliMandato ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Annulli Mandato Body
      // Procedure Body
      // 
      // 
      // controllo se esiste la licenza MIF
      // 
      {
        if (ControlloAmmissibilitàManOrdInf(DATA_INIZIO_MAND_INF))
        {
          if (GESTIONE_ANNULLI.equals((new IDVariant("SI")), true))
          {
            MainFrm.Show(MyGlb.FRM_ANNULLMANDAT, (new IDVariant(0)).intValue(), this); 
          }
          else
          {
            IDVariant v_MSG1 = new IDVariant(0,IDVariant.STRING);
            v_MSG1 = (new IDVariant("Gestione Annulli non ammessa", IDVariant.STRING));
            MainFrm.set_AlertMessage(v_MSG1); 
          }
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriAnnulliMandato", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Variazioni Mandato
  // **********************************************************************
  public int ApriVariazioniMandato ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Variazioni Mandato Body
      // Procedure Body
      // 
      // 
      // controllo se esiste la licenza MIF
      // 
      {
        if (ControlloAmmissibilitàManOrdInf(DATA_INIZIO_MAND_INF))
        {
          if (GESTIONE_VARIAZIONI.equals((new IDVariant("SI")), true))
          {
            MainFrm.Show(MyGlb.FRM_VARIAZMANDAT, (new IDVariant(0)).intValue(), this); 
          }
          else
          {
            IDVariant v_MSG1 = new IDVariant(0,IDVariant.STRING);
            v_MSG1 = (new IDVariant("Gestione Variazioni non ammessa", IDVariant.STRING));
            MainFrm.set_AlertMessage(v_MSG1); 
          }
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriVariazioniMandato", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Sostituzioni Mandato
  // **********************************************************************
  public int ApriSostituzioniMandato ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Sostituzioni Mandato Body
      // Procedure Body
      // 
      // 
      // controllo se esiste la licenza MIF
      // 
      {
        if (ControlloAmmissibilitàManOrdInf(DATA_INIZIO_MAND_INF))
        {
          if (GESTIONE_SOSTITUZIONI.equals((new IDVariant("SI")), true))
          {
            MainFrm.Show(MyGlb.FRM_SOSTITMANDAT, (new IDVariant(0)).intValue(), this); 
          }
          else
          {
            IDVariant v_MSG1 = new IDVariant(0,IDVariant.STRING);
            v_MSG1 = (new IDVariant("Gestione Sostituzioni non ammessa", IDVariant.STRING));
            MainFrm.set_AlertMessage(v_MSG1); 
          }
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriSostituzioniMandato", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Cambio Di Stato Non Inviati Mandati
  // **********************************************************************
  public int ApriCambioDiStatoNonInviatiMandati ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Cambio Di Stato Non Inviati Mandati Body
      // Procedure Body
      // 
      if (ControlloAmmissibilitàManOrdInf(DATA_INIZIO_MAND_INF))
      {
        MainFrm.UnloadForm(MyGlb.FRM_TRASMANDATES,(new IDVariant(0)).booleanValue()); 
        IMDB.set_Value(IMDBDef5.TBL_PARTRAMANATE, IMDBDef5.FLD_PARTRAMANATE_ROWNAMEMANDA, 0, (new IDVariant(1)));
        MainFrm.Show(MyGlb.FRM_TRASMANDATES, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriCambioDiStatoNonInviatiMandati", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Eliminazione Invii Mandati
  // **********************************************************************
  public int ApriEliminazioneInviiMandati ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Eliminazione Invii Mandati Body
      // Procedure Body
      // 
      if (ControlloAmmissibilitàManOrdInf(DATA_INIZIO_MAND_INF))
      {
        MainFrm.UnloadForm(MyGlb.FRM_ELIMINAZIONE,(new IDVariant(0)).booleanValue()); 
        MainFrm.UnloadForm(MyGlb.FRM_SCELTIPOELIM,(new IDVariant(0)).booleanValue()); 
        // 
        // indico che tratto mandati
        // 
        {
          IMDB.set_Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEMANDA, 0, (new IDVariant(1)));
        }
        // 
        // setto valore di default, considerando che sto trattando i mandati
        // 
        {
          IMDB.set_Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0, (new IDVariant(1)));
        }
        MainFrm.Show(MyGlb.FRM_SCELTIPOELIM, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEliminazioneInviiMandati", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Invio Mandati
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public int ApriInvioMandati ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Invio Mandati Body
      // Procedure Body
      // 
      if (ControlloAmmissibilitàManOrdInf(DATA_INIZIO_MAND_INF))
      {
        MainFrm.UnloadForm(MyGlb.FRM_INVMANEORDIN,(new IDVariant(0)).booleanValue()); 
        APRIINVIMAND_PARAINVIDELE();
        IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMETIPO, 0, (new IDVariant(1)));
        IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMEMANDA, 0, (new IDVariant(1)));
        MainFrm.Show(MyGlb.FRM_INVMANEORDIN, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriInvioMandati", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Parametri Invio: Delete
  // Why are you deleting these data?
  // **********************************************************************
  private void APRIINVIMAND_PARAINVIDELE() throws SQLException
  {
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMEDAL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMEAL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMDISNUM, 0, new IDVariant());
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMETIPO, 0, new IDVariant());
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMDATRIS, 0, new IDVariant());
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMEDALD, 0, new IDVariant());
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMEALD, 0, new IDVariant());
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMEMANDA, 0, new IDVariant());
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMOLDTIP, 0, new IDVariant());
  }

  // **********************************************************************
  // Apri Ricezione Pagamenti
  // **********************************************************************
  public int ApriRicezionePagamenti ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Ricezione Pagamenti Body
      // Procedure Body
      // 
      if (ControlloAmmissibilitàManOrdInf(DATA_INIZIO_MAND_INF))
      {
        MainFrm.UnloadForm(MyGlb.FRM_RICPAGINDATE,(new IDVariant(0)).booleanValue()); 
        IMDB.set_Value(IMDBDef6.TBL_PARAMETRI66, IMDBDef6.FLD_PARAMETRI66_ROWNAMETIPO, 0, (new IDVariant(1)));
        IMDB.set_Value(IMDBDef6.TBL_PARAMETRI66, IMDBDef6.FLD_PARAMETRI66_ROWNAMEFASE, 0, (new IDVariant("MINF")));
        MainFrm.Show(MyGlb.FRM_RICPAGINDATE, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriRicezionePagamenti", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Ordinativi A Gruppi
  // **********************************************************************
  public int ApriOrdinativiAGruppi ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Ordinativi A Gruppi Body
      // Procedure Body
      // 
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI266, IMDBDef5.FLD_PARAMETRI266_PARAMLIQORD, 0, (new IDVariant("ORD")));
      MainFrm.UnloadForm(MyGlb.FRM_LIQUORDIAGRU,(new IDVariant(0)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_LIQUORDIAGRU, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriOrdinativiAGruppi", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Caricamento Imputazioni Entrata
  // **********************************************************************
  public int ApriCaricamentoImputazioniEntrata ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_FASE = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Apri Caricamento Imputazioni Entrata Body
      // Procedure Body
      // 
      if (PROCEDPERSON.compareTo((new IDVariant(1)), true)!=0)
      {
        IDVariant v_ERR = new IDVariant(0,IDVariant.STRING);
        v_ERR = (new IDVariant("Caricamento Imputazioni ammesso per Personale collegato a procedura esterna", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_ERR); 
      }
      else
      {
        v_FASE = ControllaEsefin(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0));
        if (v_FASE.equals((new IDVariant(0)), true) || v_FASE.compareTo((new IDVariant(7)), true)>0)
        {
          IDVariant v_ERR = new IDVariant(0,IDVariant.STRING);
          v_ERR = (new IDVariant("Gestione Movimenti non ammessi", IDVariant.STRING));
          MainFrm.set_AlertMessage(v_ERR); 
        }
        else
        {
          MainFrm.UnloadForm(MyGlb.FRM_CARICAIMPUTA,(new IDVariant(0)).booleanValue()); 
          IMDB.set_Value(IMDBDef6.TBL_PAR75, IMDBDef6.FLD_PAR75_ROWNAMENTSPE, 0, (new IDVariant("E")));
          MainFrm.Show(MyGlb.FRM_CARICAIMPUTA, (new IDVariant(0)).intValue(), this); 
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriCaricamentoImputazioniEntrata", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Controllo Imputazioni Ordinativi
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int ApriControlloImputazioniOrdinativi ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Controllo Imputazioni Ordinativi Body
      // Corpo Procedura
      // 
      ApriControlloImputazioniEntrata((new IDVariant()));
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriControlloImputazioniOrdinativi", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Ordinativi EP
  // **********************************************************************
  public int ApriOrdinativiEP ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Ordinativi EP Body
      // Procedure Body
      // 
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI266, IMDBDef5.FLD_PARAMETRI266_PARAMLIQORD, 0, (new IDVariant("EP")));
      MainFrm.Show(MyGlb.FRM_LIQUORDIAGRU, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriOrdinativiEP", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Annulli Ordinativi
  // **********************************************************************
  public int ApriAnnulliOrdinativi ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Annulli Ordinativi Body
      // Procedure Body
      // 
      // 
      // controllo se esiste la licenza MIF
      // 
      {
        if (ControlloAmmissibilitàManOrdInf(DATA_INIZIO_ORD_INF))
        {
          if (GESTIONE_ANNULLI.equals((new IDVariant("SI")), true))
          {
            MainFrm.Show(MyGlb.FRM_ANNULLIORD, (new IDVariant(0)).intValue(), this); 
          }
          else
          {
            IDVariant v_MSG1 = new IDVariant(0,IDVariant.STRING);
            v_MSG1 = (new IDVariant("Gestione Annulli non ammessa", IDVariant.STRING));
            MainFrm.set_AlertMessage(v_MSG1); 
          }
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriAnnulliOrdinativi", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Variazioni Ordinativi
  // **********************************************************************
  public int ApriVariazioniOrdinativi ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Variazioni Ordinativi Body
      // Procedure Body
      // 
      // 
      // controllo se esiste la licenza MIF
      // 
      {
        if (ControlloAmmissibilitàManOrdInf(DATA_INIZIO_ORD_INF))
        {
          if (GESTIONE_VARIAZIONI.equals((new IDVariant("SI")), true))
          {
            MainFrm.Show(MyGlb.FRM_VARIAZIONORD, (new IDVariant(0)).intValue(), this); 
          }
          else
          {
            IDVariant v_MSG1 = new IDVariant(0,IDVariant.STRING);
            v_MSG1 = (new IDVariant("Gestione Variazioni non ammessa", IDVariant.STRING));
            MainFrm.set_AlertMessage(v_MSG1); 
          }
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriVariazioniOrdinativi", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Sostituzioni Ordinativi
  // **********************************************************************
  public int ApriSostituzioniOrdinativi ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Sostituzioni Ordinativi Body
      // Procedure Body
      // 
      // 
      // controllo se esiste la licenza MIF
      // 
      {
        if (ControlloAmmissibilitàManOrdInf(DATA_INIZIO_ORD_INF))
        {
          if (GESTIONE_SOSTITUZIONI.equals((new IDVariant("SI")), true))
          {
            MainFrm.Show(MyGlb.FRM_SOSTITUZIORD, (new IDVariant(0)).intValue(), this); 
          }
          else
          {
            IDVariant v_MSG1 = new IDVariant(0,IDVariant.STRING);
            v_MSG1 = (new IDVariant("Gestione Sostituzioni non ammessa", IDVariant.STRING));
            MainFrm.set_AlertMessage(v_MSG1); 
          }
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriSostituzioniOrdinativi", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Cambio Di Stato Non Inviati Ordinativi
  // **********************************************************************
  public int ApriCambioDiStatoNonInviatiOrdinativi ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Cambio Di Stato Non Inviati Ordinativi Body
      // Procedure Body
      // 
      if (ControlloAmmissibilitàManOrdInf(DATA_INIZIO_ORD_INF))
      {
        MainFrm.UnloadForm(MyGlb.FRM_CERCA1,(new IDVariant(0)).booleanValue()); 
        MainFrm.Show(MyGlb.FRM_CERCA1, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriCambioDiStatoNonInviatiOrdinativi", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Eliminazione Invii Ordinativi
  // **********************************************************************
  public int ApriEliminazioneInviiOrdinativi ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Eliminazione Invii Ordinativi Body
      // Procedure Body
      // 
      if (ControlloAmmissibilitàManOrdInf(DATA_INIZIO_ORD_INF))
      {
        MainFrm.UnloadForm(MyGlb.FRM_ELIMINAZIONE,(new IDVariant(0)).booleanValue()); 
        // 
        // indico che tratto mandati
        // 
        {
          IMDB.set_Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMEMANDA, 0, (new IDVariant(2)));
        }
        // 
        // setto valore di default, considerando che sto trattando i mandati
        // 
        {
          IMDB.set_Value(IMDBDef6.TBL_PARATIPOELI1, IMDBDef6.FLD_PARATIPOELI1_ROWNAMETIPO, 0, (new IDVariant(2)));
        }
        MainFrm.Show(MyGlb.FRM_SCELTIPOELIM, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEliminazioneInviiOrdinativi", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Invio Ordinativi
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public int ApriInvioOrdinativi ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Invio Ordinativi Body
      // Procedure Body
      // 
      if (ControlloAmmissibilitàManOrdInf(DATA_INIZIO_ORD_INF))
      {
        MainFrm.UnloadForm(MyGlb.FRM_INVMANEORDIN,(new IDVariant(0)).booleanValue()); 
        APRIINVIORDI_PARAINVIDELE();
        IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMETIPO, 0, (new IDVariant(5)));
        IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMEMANDA, 0, (new IDVariant(2)));
        MainFrm.Show(MyGlb.FRM_INVMANEORDIN, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriInvioOrdinativi", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Parametri Invio: Delete
  // Why are you deleting these data?
  // **********************************************************************
  private void APRIINVIORDI_PARAINVIDELE() throws SQLException
  {
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMEDAL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMEAL, 0, new IDVariant());
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMDISNUM, 0, new IDVariant());
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMETIPO, 0, new IDVariant());
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMDATRIS, 0, new IDVariant());
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMEDALD, 0, new IDVariant());
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMEALD, 0, new IDVariant());
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMEMANDA, 0, new IDVariant());
    IMDB.set_Value(IMDBDef6.TBL_PARAMETINVIO, IMDBDef6.FLD_PARAMETINVIO_ROWNAMOLDTIP, 0, new IDVariant());
  }

  // **********************************************************************
  // Apri Ricezione Incassi
  // **********************************************************************
  public int ApriRicezioneIncassi ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Ricezione Incassi Body
      // Procedure Body
      // 
      if (ControlloAmmissibilitàManOrdInf(DATA_INIZIO_ORD_INF))
      {
        MainFrm.UnloadForm(MyGlb.FRM_RICPAGINDATE,(new IDVariant(0)).booleanValue()); 
        IMDB.set_Value(IMDBDef6.TBL_PARAMETRI66, IMDBDef6.FLD_PARAMETRI66_ROWNAMETIPO, 0, (new IDVariant(2)));
        IMDB.set_Value(IMDBDef6.TBL_PARAMETRI66, IMDBDef6.FLD_PARAMETRI66_ROWNAMEFASE, 0, (new IDVariant("MINF")));
        MainFrm.Show(MyGlb.FRM_RICPAGINDATE, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriRicezioneIncassi", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Elenco Anomali File Auto Inc
  // **********************************************************************
  public int ApriElencoAnomaliFileAutoInc ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Elenco Anomali File Auto Inc Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_ELENERROAUTO, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_ELENERROAUTO,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef6.TBL_NEWTABLE, IMDBDef6.FLD_NEWTABLE_ROWNAMEFASE, 0, (new IDVariant("INCASSI")));
      MainFrm.Show(MyGlb.FRM_ELENERROAUTO, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriElencoAnomaliFileAutoInc", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Caricamento Provvisori Mandati
  // **********************************************************************
  public int ApriCaricamentoProvvisoriMandati ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Caricamento Provvisori Mandati Body
      // Procedure Body
      // 
      IMDB.set_Value(IMDBDef6.TBL_PARAMETRI84, IMDBDef6.FLD_PARAMETRI84_PARAMFASE, 0, (new IDVariant("Mandati")));
      IMDB.set_Value(IMDBDef6.TBL_PARAMETRI84, IMDBDef6.FLD_PARAMETRI84_PARAMTIPO, 0, (new IDVariant("Mandati")));
      MainFrm.Show(MyGlb.FRM_CARICAPROVVI, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriCaricamentoProvvisoriMandati", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Gestione Provvisori Mandati
  // **********************************************************************
  public int ApriGestioneProvvisoriMandati ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Gestione Provvisori Mandati Body
      // Procedure Body
      // 
      MainFrm.UnloadForm(MyGlb.FRM_AGGIPROVMAND,(new IDVariant(0)).booleanValue()); 
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI318, IMDBDef5.FLD_PARAMETRI318_PARAENTRSPES, 0, (new IDVariant("S")));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI318, IMDBDef5.FLD_PARAMETRI318_PARANCPROREG, 0, (new IDVariant()));
      MainFrm.Show(MyGlb.FRM_AGGIPROVMAND, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriGestioneProvvisoriMandati", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Caricamento Provvisori Ordinativi
  // **********************************************************************
  public int ApriCaricamentoProvvisoriOrdinativi ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Caricamento Provvisori Ordinativi Body
      // Procedure Body
      // 
      IMDB.set_Value(IMDBDef6.TBL_PARAMETRI84, IMDBDef6.FLD_PARAMETRI84_PARAMFASE, 0, (new IDVariant("Ordinativi")));
      IMDB.set_Value(IMDBDef6.TBL_PARAMETRI84, IMDBDef6.FLD_PARAMETRI84_PARAMTIPO, 0, (new IDVariant("Ordinativi")));
      MainFrm.Show(MyGlb.FRM_CARICAPROVVI, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriCaricamentoProvvisoriOrdinativi", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Gestione Provvisori Ordinativi
  // **********************************************************************
  public int ApriGestioneProvvisoriOrdinativi ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Gestione Provvisori Ordinativi Body
      // Procedure Body
      // 
      MainFrm.UnloadForm(MyGlb.FRM_AGGIPROVORDI,(new IDVariant(0)).booleanValue()); 
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI393, IMDBDef5.FLD_PARAMETRI393_PARAENTRSPES, 0, (new IDVariant("E")));
      IMDB.set_Value(IMDBDef5.TBL_PARAMETRI393, IMDBDef5.FLD_PARAMETRI393_PARANCPROREG, 0, (new IDVariant()));
      MainFrm.Show(MyGlb.FRM_AGGIPROVORDI, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriGestioneProvvisoriOrdinativi", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Elenco Anomali File Auto Provv Man
  // **********************************************************************
  public int ApriElencoAnomaliFileAutoProvvMan ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Elenco Anomali File Auto Provv Man Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_ELENERROAUTO, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_ELENERROAUTO,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef6.TBL_NEWTABLE, IMDBDef6.FLD_NEWTABLE_ROWNAMEFASE, 0, (new IDVariant("MANPROV")));
      MainFrm.Show(MyGlb.FRM_ELENERROAUTO, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriElencoAnomaliFileAutoProvvMan", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Elenco Anomali File Auto Provv Ord
  // **********************************************************************
  public int ApriElencoAnomaliFileAutoProvvOrd ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Elenco Anomali File Auto Provv Ord Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_ELENERROAUTO, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_ELENERROAUTO,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef6.TBL_NEWTABLE, IMDBDef6.FLD_NEWTABLE_ROWNAMEFASE, 0, (new IDVariant("ORDPROV")));
      MainFrm.Show(MyGlb.FRM_ELENERROAUTO, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriElencoAnomaliFileAutoProvvOrd", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Progetti Di Entrata
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public int ApriProgettiDiEntrata ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Progetti Di Entrata Body
      // Procedure Body
      // 
      if (FunctionRppAttiva().compareTo((new IDVariant(1)), true)!=0)
      {
        IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
        v_MESSAGGIO = (new IDVariant("Funzionalità non ammessa. Rpp non Gestita", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_MESSAGGIO); 
        return 0;
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_PROGETENTRAT, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriProgettiDiEntrata", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Progetti Di Spesa
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public int ApriProgettiDiSpesa ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Progetti Di Spesa Body
      // Procedure Body
      // 
      if (FunctionRppAttiva().compareTo((new IDVariant(1)), true)!=0)
      {
        IDVariant v_MESSAGGIO = new IDVariant(0,IDVariant.STRING);
        v_MESSAGGIO = (new IDVariant("Funzionalità non ammessa. Rpp non Gestita", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_MESSAGGIO); 
        return 0;
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_PROGETTSPESA, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriProgettiDiSpesa", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Comunicazioni Stanz Ese GP
  //  
  // **********************************************************************
  public int ApriComunicazioniStanzEseGP ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Comunicazioni Stanz Ese GP Body
      // Corpo Procedura
      // 
      if (FASEBILANCIO.compareTo((new IDVariant(1)), true)!=0 && FASEBILANCIO.compareTo((new IDVariant(2)), true)!=0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Attenzione: la stampa deve essere elaborata in esercizio provvisorio o gestione provvisoria"));
        MainFrm.set_AlertMessage(v_AVVISO); 
      }
      MainFrm.Show(MyGlb.FRM_COMESEOGESPR, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriComunicazioniStanzEseGP", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Stanziamenti Con Residuo
  //  
  // **********************************************************************
  public int ApriStanziamentiConResiduo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Stanziamenti Con Residuo Body
      // Corpo Procedura
      // 
      if (FASEBILANCIO.compareTo((new IDVariant(1)), true)!=0 && FASEBILANCIO.compareTo((new IDVariant(2)), true)!=0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Attenzione: la stampa deve essere elaborata in esercizio provvisorio o gestione provvisoria"));
        MainFrm.set_AlertMessage(v_AVVISO); 
      }
      MainFrm.Show(MyGlb.FRM_STANZCONRESI, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriStanziamentiConResiduo", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Prospetto Liquidita
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int ApriProspettoLiquidita ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Prospetto Liquidita Body
      // Corpo Procedura
      // 
      IDVariant S = new IDVariant(0,IDVariant.STRING);
      S = (new IDVariant("PRLIQ"));
      MainFrm.UnloadForm(MyGlb.FRM_STAMPCONPARA,(new IDVariant(0)).booleanValue()); 
      IMDB.set_Value(IMDBDef7.TBL_PARAMETRI689, IMDBDef7.FLD_PARAMETRI689_NOMOGGFORCAP, 0, (new IDVariant(MainFrm.CmdObj.CmdCaption(MyGlb.CMD_PROSPELIQUID+BaseCmdLinIdx))));
      IMDB.set_Value(IMDBDef7.TBL_PARAMETRI689, IMDBDef7.FLD_PARAMETRI689_COD_STAMPA, 0, new IDVariant(S));
      MainFrm.Show(MyGlb.FRM_STAMPCONPARA, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriProspettoLiquidita", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per Capitolo
  // **********************************************************************
  public int ApriEsploratorePerCapitolo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per Capitolo Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_ESPLORCAPITO, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerCapitolo", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per Bilancio
  // **********************************************************************
  public int ApriEsploratorePerBilancio ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per Bilancio Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_ESPLOPERBILA, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerBilancio", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per Piano Conti
  // **********************************************************************
  public int ApriEsploratorePerPianoConti ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per Piano Conti Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_ESPEPIDECOIN, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerPianoConti", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per V Livello
  // **********************************************************************
  public int ApriEsploratorePerVLivello ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per V Livello Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_ESPLPERVLIVE, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerVLivello", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per Responsabile
  // **********************************************************************
  public int ApriEsploratorePerResponsabile ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per Responsabile Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_ESPLOPERRESP, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerResponsabile", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per Responsabile Data
  // **********************************************************************
  public int ApriEsploratorePerResponsabileData ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per Responsabile Data Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_ESPEREADUNDA, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerResponsabileData", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per Centro Di Costo
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int ApriEsploratorePerCentroDiCosto ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per Centro Di Costo Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_ESPPERCEDICO, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerCentroDiCosto", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per Ben Deb
  // **********************************************************************
  public int ApriEsploratorePerBenDeb ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per Ben Deb Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_ESPPERBENDEB, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerBenDeb", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per Delibera
  // **********************************************************************
  public int ApriEsploratorePerDelibera ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per Delibera Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_ESPLOPERDELI, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerDelibera", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per Macroaggregati
  // **********************************************************************
  public int ApriEsploratorePerMacroaggregati ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per Macroaggregati Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_ESPLOPERMACR, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerMacroaggregati", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per UO Gestione
  // **********************************************************************
  public int ApriEsploratorePerUOGestione ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per UO Gestione Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_ESPPERUNGECA, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerUOGestione", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per Finanziamento
  // **********************************************************************
  public int ApriEsploratorePerFinanziamento ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per Finanziamento Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      IMDB.set_Value(IMDBDef6.TBL_PARAMEESPL12, IMDBDef6.FLD_PARAMEESPL12_PARATIPOESPL, 0, (new IDVariant("F")));
      MainFrm.Show(MyGlb.FRM_ESPPERFINOP1, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerFinanziamento", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per Opera
  // **********************************************************************
  public int ApriEsploratorePerOpera ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per Opera Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      IMDB.set_Value(IMDBDef6.TBL_PARAMEESPL12, IMDBDef6.FLD_PARAMEESPL12_PARATIPOESPL, 0, (new IDVariant("O")));
      MainFrm.Show(MyGlb.FRM_ESPPERFINOP1, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerOpera", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per Capitolo Fin Ope
  // **********************************************************************
  public int ApriEsploratorePerCapitoloFinOpe ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per Capitolo Fin Ope Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_ESPPERCAFIOP, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerCapitoloFinOpe", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per Fin Ope
  // **********************************************************************
  public int ApriEsploratorePerFinOpe ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per Fin Ope Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      IMDB.set_Value(IMDBDef6.TBL_PARAMEESPL15, IMDBDef6.FLD_PARAMEESPL15_PARATIPOESPL, 0, (new IDVariant("F")));
      MainFrm.Show(MyGlb.FRM_ESPPERFINOPE, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerFinOpe", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per Ope Fin
  // **********************************************************************
  public int ApriEsploratorePerOpeFin ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per Ope Fin Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      IMDB.set_Value(IMDBDef6.TBL_PARAMEESPL15, IMDBDef6.FLD_PARAMEESPL15_PARATIPOESPL, 0, (new IDVariant("O")));
      MainFrm.Show(MyGlb.FRM_ESPPERFINOPE, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerOpeFin", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per UO Gestione Macroaggregati
  // **********************************************************************
  public int ApriEsploratorePerUOGestioneMacroaggregati ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per UO Gestione Macroaggregati Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERRESMAC,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_ESPPERUNGEMA, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerUOGestioneMacroaggregati", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Esploratore Per Responsabile Macroaggregati
  // **********************************************************************
  public int ApriEsploratorePerResponsabileMacroaggregati ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Esploratore Per Responsabile Macroaggregati Body
      // Corpo Procedura
      // 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLORCAPITO,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERBILA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEPIDECOIN,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERRESP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPEREADUNDA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCEDICO,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERBENDEB,(new IDVariant(0)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERDELI,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLOPERMACR,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGECA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERUNGEMA,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOP1,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERCAFIOP,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPPERFINOPE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.UnloadForm(MyGlb.FRM_ESPLPERVLIVE,(new IDVariant(-1)).booleanValue()); 
      MainFrm.Show(MyGlb.FRM_ESPPERRESMAC, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriEsploratorePerResponsabileMacroaggregati", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Corrispondenze
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int Corrispondenze ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Corrispondenze Body
      // Corpo Procedura
      // 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Corrispondenze", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Riclassificazione Capitoli
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int RiclassificazioneCapitoli ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Riclassificazione Capitoli Body
      // Corpo Procedura
      // 
      if (IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)).compareTo(ESEPIACONMOD, true)!=0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Aggiornamento Riclassificazioni non previsto per l'esercizio "));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_RICLASCAPITO, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "RiclassificazioneCapitoli", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Movimentazione
  // **********************************************************************
  public int Movimentazione ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Movimentazione Body
      // Corpo Procedura
      // 
      if (IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)).compareTo(ESEPIACONMOD, true)!=0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Aggiornamento Riclassificazioni non previsto per l'esercizio "));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_MOVIMENTAZIO, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "Movimentazione", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Controllo Anomalie
  // **********************************************************************
  public int ControlloAnomalie ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Controllo Anomalie Body
      // Corpo Procedura
      // 
      MainFrm.Show(MyGlb.FRM_BONLIV5CODEU, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ControlloAnomalie", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Capitoli Con Clasif Diverse
  // **********************************************************************
  public int CapitoliConClasifDiverse ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Capitoli Con Clasif Diverse Body
      // Corpo Procedura
      // 
      if (IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)).compareTo(ESEPIACONMOD, true)!=0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Aggiornamento Riclassificazioni non previsto per l'esercizio "));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_CAPCONCLADIV, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CapitoliConClasifDiverse", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Capitoli Con Anomalie
  // **********************************************************************
  public int CapitoliConAnomalie ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Capitoli Con Anomalie Body
      // Corpo Procedura
      // 
      if (IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)).compareTo(ESEPIACONMOD, true)!=0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Aggiornamento Riclassificazioni non previsto per l'esercizio "));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        MainFrm.Show(MyGlb.FRM_CAPITCONANOM, (new IDVariant(0)).intValue(), this); 
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CapitoliConAnomalie", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Cod Liv 5 Gruppi Liq
  // **********************************************************************
  public int CodLiv5GruppiLiq ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Cod Liv 5 Gruppi Liq Body
      // Corpo Procedura
      // 
      if (IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)).compareTo(ESEPIACONMOD, true)!=0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Aggiornamento Riclassificazioni non previsto per l'esercizio "));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        IDVariant v_NOMESTAMPA = new IDVariant(0,IDVariant.STRING);
        v_NOMESTAMPA = (new IDVariant("Gruppi_Liq_Cod_5"));
        SetParametroStampaJasper((new IDVariant("ESERCIZIO")), IDL.ToString(ESEPIACONMOD));
        LanciaStampaJasper(v_NOMESTAMPA, (new IDVariant("")), (new IDVariant("")), (new IDVariant("")));
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CodLiv5GruppiLiq", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Cod Liv 5 Gruppi Ord
  // **********************************************************************
  public int CodLiv5GruppiOrd ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Cod Liv 5 Gruppi Ord Body
      // Corpo Procedura
      // 
      if (IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)).compareTo(ESEPIACONMOD, true)!=0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Aggiornamento Riclassificazioni non previsto per l'esercizio "));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        IDVariant v_NOMESTAMPA = new IDVariant(0,IDVariant.STRING);
        v_NOMESTAMPA = (new IDVariant("Gruppi_Ord_Cod_5"));
        SetParametroStampaJasper((new IDVariant("ESERCIZIO")), IDL.ToString(ESEPIACONMOD));
        LanciaStampaJasper(v_NOMESTAMPA, (new IDVariant("")), (new IDVariant("")), (new IDVariant("")));
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CodLiv5GruppiOrd", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Cod Liv 5 Imp Mutui
  // **********************************************************************
  public int CodLiv5ImpMutui ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Cod Liv 5 Imp Mutui Body
      // Corpo Procedura
      // 
      if (IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)).compareTo(ESEPIACONMOD, true)!=0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Aggiornamento Riclassificazioni non previsto per l'esercizio "));
        MainFrm.set_AlertMessage(IDL.Add(v_AVVISO, IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)))); 
      }
      else
      {
        IDVariant v_NOMESTAMPA = new IDVariant(0,IDVariant.STRING);
        v_NOMESTAMPA = (new IDVariant("Imp_Mutui_Cod_5"));
        SetParametroStampaJasper((new IDVariant("ESERCIZIO")), IDL.ToString(ESEPIACONMOD));
        LanciaStampaJasper(v_NOMESTAMPA, (new IDVariant("")), (new IDVariant("")), (new IDVariant("")));
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CodLiv5ImpMutui", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Stampa Ricl Macroaggregati
  // **********************************************************************
  public int ApriStampaRiclMacroaggregati ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Stampa Ricl Macroaggregati Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_SITPERCLAMAC, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_SITPERCLAMAC,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef4.TBL_PERSIT7, IMDBDef4.FLD_PERSIT7_NOMOGGTIPMAC, 0, (new IDVariant("Macroaggregato")));
      MainFrm.Show(MyGlb.FRM_SITPERCLAMAC, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriStampaRiclMacroaggregati", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Stampa Codice IV Liv
  // **********************************************************************
  public int ApriStampaCodiceIVLiv ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Stampa Codice IV Liv Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_SITPERCLAMAC, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_SITPERCLAMAC,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef4.TBL_PERSIT7, IMDBDef4.FLD_PERSIT7_NOMOGGTIPMAC, 0, (new IDVariant("Codice IV Livello")));
      MainFrm.Show(MyGlb.FRM_SITPERCLAMAC, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriStampaCodiceIVLiv", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Stampa Codice V Liv
  // **********************************************************************
  public int ApriStampaCodiceVLiv ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Stampa Codice V Liv Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_SITPERCLAMAC, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_SITPERCLAMAC,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef4.TBL_PERSIT7, IMDBDef4.FLD_PERSIT7_NOMOGGTIPMAC, 0, (new IDVariant("Codice V Livello")));
      MainFrm.Show(MyGlb.FRM_SITPERCLAMAC, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriStampaCodiceVLiv", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Stampa Codice Cofog
  // **********************************************************************
  public int ApriStampaCodiceCofog ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Stampa Codice Cofog Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_SITPERCLAMAC, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_SITPERCLAMAC,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef4.TBL_PERSIT7, IMDBDef4.FLD_PERSIT7_NOMOGGTIPMAC, 0, (new IDVariant("Cofog")));
      MainFrm.Show(MyGlb.FRM_SITPERCLAMAC, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriStampaCodiceCofog", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Stampa Sit Per Flessibilità
  // **********************************************************************
  public int ApriStampaSitPerFlessibilità ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Stampa Sit Per Flessibilità Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_SITPERALTCLA, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_SITPERALTCLA,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef4.TBL_PERSIT, IMDBDef4.FLD_PERSIT_NOMOGGTIPCLA, 0, (new IDVariant("Flessibilità")));
      MainFrm.Show(MyGlb.FRM_SITPERALTCLA, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriStampaSitPerFlessibilità", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Stampa Sit Per Vincolo
  // **********************************************************************
  public int ApriStampaSitPerVincolo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Stampa Sit Per Vincolo Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_SITPERALTCLA, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_SITPERALTCLA,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef4.TBL_PERSIT, IMDBDef4.FLD_PERSIT_NOMOGGTIPCLA, 0, (new IDVariant("Tipo Vincolo")));
      MainFrm.Show(MyGlb.FRM_SITPERALTCLA, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriStampaSitPerVincolo", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Stampa Sit Per Dirgen
  // **********************************************************************
  public int ApriStampaSitPerDirgen ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Stampa Sit Per Dirgen Body
      // Corpo Procedura
      // 
      // if (IDL.IsNull(SUDDIVISIONE_UNITA_SUP))
      // {
        // IDVariant S = new IDVariant(0,IDVariant.STRING);
        // S = (new IDVariant("Suddivisione Unità Organizzativa superiore non indicata nei Parametri WEB"));
        // MainFrm.set_AlertMessage(S); 
      // }
      if ((MainFrm.GetForm(MyGlb.FRM_SITPERALTCLA, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_SITPERALTCLA,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef4.TBL_PERSIT, IMDBDef4.FLD_PERSIT_NOMOGGTIPCLA, 0, (new IDVariant("Unità Organizzativa")));
      MainFrm.Show(MyGlb.FRM_SITPERALTCLA, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriStampaSitPerDirgen", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Elenco Capitoli Non Presenti In DL77
  // **********************************************************************
  public int ElencoCapitoliNonPresentiInDL77 ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Elenco Capitoli Non Presenti In DL77 Body
      // Corpo Procedura
      // 
      // SetParametroStampaJasper((new IDVariant("ES")), (new IDVariant("E")));
      SetParametroStampaJasper((new IDVariant("ESERCIZIO")), IDL.ToString(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0)));
      LanciaStampaJasper((new IDVariant("Elenco_Capitoli")), (new IDVariant("")), (new IDVariant("")), (new IDVariant("")));
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ElencoCapitoliNonPresentiInDL77", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Carica Menu Ricorsivo
  // **********************************************************************
  public int CaricaMenuRicorsivo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Carica Menu Ricorsivo Body
      // Corpo Procedura
      // 
      if (TEST.compareTo((new IDVariant("SI")), true)!=0)
      {
        IDVariant v_NUMEVOCIABIL = new IDVariant(0,IDVariant.INTEGER);
        IDArray v_COMMANDSET = null;
        v_COMMANDSET = MainFrm.CmdObj.GetCommandSets(0);
        ACommand v_IDCOMMAND = null;
        v_NUMEVOCIABIL = AFC.TotaleNumeroVociAbilitatePerProgetto();
        CARIMENURICO_MENUDELETE();
        AFC.CaricaVociAbilitate();
        IDVariant I = new IDVariant(0,IDVariant.INTEGER);
        for (I = (new IDVariant(0)); I.compareTo(new IDVariant(v_COMMANDSET.Size()), true)<0; I = IDL.Add(I, (new IDVariant(1))))
        {
          v_IDCOMMAND = (ACommand)v_COMMANDSET.get_Object(I);
          AbilitaComando(v_IDCOMMAND);
        }
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CaricaMenuRicorsivo", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Menu: Delete
  // Perchè stai eliminando questi dati?
  // **********************************************************************
  private void CARIMENURICO_MENUDELETE() throws SQLException
  {
    IMDB.TblTruncate(IMDBDef7.TBL_MENU);
  }

  // **********************************************************************
  // Abilita Comando
  // Id Comando:  - Input
  // **********************************************************************
  public int AbilitaComando (ACommand IdComando)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_VOCEABILITAT = new IDVariant(0,IDVariant.INTEGER);
    IDVariant v_CAPTION = new IDVariant(0,IDVariant.STRING);
    IDVariant v_COMMANDCODE = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      v_VOCEABILITAT = (new IDVariant(0, IDVariant.INTEGER));
      // 
      // Abilita Comando Body
      // Corpo Procedura
      // 
      v_COMMANDCODE = IDL.NullValue(new IDVariant(IdComando.CmdCode),(new IDVariant(IdComando.Code)));
      ABILITCOMAND_CFASELINTV65(v_COMMANDCODE);
      if (!IMDB.Eof(IMDBDef17.QRY_CFASELINTV65, 0))
      {
        v_VOCEABILITAT = IMDB.Value(IMDBDef17.QRY_CFASELINTV65, IMDBDef17.QSL_CFASELINTV65_COUNT, 0, IDVariant.INTEGER) ;
        v_CAPTION = IMDB.Value(IMDBDef17.QRY_CFASELINTV65, IMDBDef17.QSL_CFASELINTV65_MAXCOMANCAPT, 0, IDVariant.STRING) ;
      }
      if (v_VOCEABILITAT.compareTo((new IDVariant(0)), true)>0)
      {
        IdComando.set_bVisible(MainFrm.ActiveFormIdx(), (new IDVariant(-1)).booleanValue());
        IdComando.set_bCaption(new IDVariant(v_CAPTION).stringValue());
        if ((new IDVariant(IdComando.uCommands())).compareTo((new IDVariant(0)), true)>0)
        {
          IDVariant J = new IDVariant(0,IDVariant.INTEGER);
          for (; J.compareTo((new IDVariant(IdComando.uCommands())), true)<0; J = IDL.Add(J, (new IDVariant(1))))
          {
            AbilitaComando(IdComando.bCommands(J.intValue()));
          }
        }
        else
        {
          return 0;
        }
      }
      else
      {
        IdComando.set_bVisible(MainFrm.ActiveFormIdx(), (new IDVariant(0)).booleanValue());
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "AbilitaComando", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Cfaid: Select into variables
  // Which data are you selecting?
  // **********************************************************************
  private void ABILITCOMAND_CFASELINTV65(IDVariant v_COMMANDCODE) throws SQLException
  {
    IDVariant[] AggrBuff;
    int[] AggrRowCount;
    int AggrCount=0;
    boolean AggrNewGroup = false;

    IMDB.TblTruncate(IMDBDef17.QRY_CFASELINTV65);
    IMDB.TblTruncate(IMDBDef1.TMP_RECORDSET);
    IMDB.TblMoveFirst(IMDBDef7.TBL_MENU, 0);
    Loop1: while (!IMDB.Eof(IMDBDef7.TBL_MENU, 0))
    {
      if (IMDB.Value(IMDBDef7.TBL_MENU, IMDBDef7.FLD_MENU_COMACOMMCODE, 0).equals(v_COMMANDCODE, true))
      {
        IMDB.TblAddNew(IMDBDef1.TMP_RECORDSET, 0);
        IMDB.set_Value(IMDBDef1.TMP_RECORDSET, 0, 0, new IDVariant(1));
        IMDB.set_Value(IMDBDef1.TMP_RECORDSET, 1, 0, IMDB.Value(IMDBDef7.TBL_MENU, IMDBDef7.FLD_MENU_COMANDCAPTIO, 0));
      }
      IMDB.TblMoveNext(IMDBDef7.TBL_MENU, 0);
      if (IMDB.Eof(IMDBDef7.TBL_MENU, 0))
      {
        IMDB.TblMoveFirst(IMDBDef7.TBL_MENU, 0);
      }
      else
      {
        continue Loop1;
      }
      break;
    }
    IMDB.TblMoveFirst(IMDBDef1.TMP_RECORDSET, 0);
    AggrBuff = new IDVariant[2];
    for (int i=0; i<AggrBuff.length; i++) AggrBuff[i] = new IDVariant();
    AggrRowCount = new int[2];
    AggrCount = 0;
    IMDB.TblMoveFirst(IMDBDef1.TMP_RECORDSET, 0);
    if (IMDB.TblNumRows(IMDBDef1.TMP_RECORDSET) > 0)
    {
      while (true)
      {
        if (AggrCount == 0 && !IMDB.Eof(IMDBDef1.TMP_RECORDSET, 0))
        {
          AggrBuff[0] = new IDVariant(1);
          if (!IDL.IsNull(IMDB.Value(IMDBDef1.TMP_RECORDSET, 0, 0))) AggrRowCount[0] = 1; else AggrRowCount[0] = 0;
          AggrBuff[1] = IMDB.Value(IMDBDef1.TMP_RECORDSET, 1, 0);
          if (!IDL.IsNull(IMDB.Value(IMDBDef1.TMP_RECORDSET, 1, 0))) AggrRowCount[1] = 1; else AggrRowCount[1] = 0;
          AggrCount = 1;
          IMDB.TblMoveNext(IMDBDef1.TMP_RECORDSET, 0);
        }
        else
        {
          AggrNewGroup = IMDB.Eof(IMDBDef1.TMP_RECORDSET, 0);
          if (AggrNewGroup)
          {
            if (AggrCount > 0)
            {
              IMDB.TblAddNew(IMDBDef17.QRY_CFASELINTV65, 0);
              IMDB.set_Value(IMDBDef17.QRY_CFASELINTV65, 0, 0, new IDVariant(AggrBuff[0]));
              IMDB.set_Value(IMDBDef17.QRY_CFASELINTV65, 1, 0, AggrBuff[1]);
            }
            AggrCount = 0;
            if (IMDB.Eof(IMDBDef1.TMP_RECORDSET, 0)) break;
          }
          else
          {
            if (!IMDB.Eof(IMDBDef1.TMP_RECORDSET, 0))
            {
              if (!IDL.IsNull(IMDB.Value(IMDBDef1.TMP_RECORDSET, 0, 0)))
              {
                AggrBuff[0] = IDL.Add(AggrBuff[0], new IDVariant(1));
                AggrRowCount[0]++;
              }
              if (!IDL.IsNull(IMDB.Value(IMDBDef1.TMP_RECORDSET, 1, 0)))
              {
                if (IDL.IsNull(AggrBuff[1]) || AggrBuff[1].compareTo(IMDB.Value(IMDBDef1.TMP_RECORDSET, 1, 0)) < 0) AggrBuff[1] = IMDB.Value(IMDBDef1.TMP_RECORDSET, 1, 0);
                AggrRowCount[1]++;
              }
              AggrCount++;
              IMDB.TblMoveNext(IMDBDef1.TMP_RECORDSET, 0);
            }
          }
        }
      }
    }
    IMDB.TblMoveFirst(IMDBDef17.QRY_CFASELINTV65, 0);
  }

  // **********************************************************************
  // Disabilita Tutti I Comandi
  // **********************************************************************
  public int DisabilitaTuttiIComandi ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Disabilita Tutti I Comandi Body
      // Corpo Procedura
      // 
      IDArray v_COMMANDSET = null;
      v_COMMANDSET = MainFrm.CmdObj.GetCommandSets(0);
      ACommand v_IDCOMMAND = null;
      IDVariant I = new IDVariant(0,IDVariant.INTEGER);
      for (I = (new IDVariant(0)); I.compareTo(new IDVariant(v_COMMANDSET.Size()), true)<0; I = IDL.Add(I, (new IDVariant(1))))
      {
        v_IDCOMMAND = (ACommand)v_COMMANDSET.get_Object(I);
        v_IDCOMMAND.set_bVisible(MainFrm.ActiveFormIdx(), (new IDVariant(0)).booleanValue());
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "DisabilitaTuttiIComandi", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Disabilita Voci Menu Customizzate
  // **********************************************************************
  public int DisabilitaVociMenuCustomizzate ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Disabilita Voci Menu Customizzate Body
      // Corpo Procedura
      // 
      IDVariant v_SSERVIZDIRET = new IDVariant(0,IDVariant.STRING);
      v_SSERVIZDIRET = (new IDVariant("SERVIZI DIRETTI"));
      IDVariant v_SRIACC = new IDVariant(0,IDVariant.STRING);
      v_SRIACC = (new IDVariant("RIACCERTAMENTI"));
      // 
      // "caricamento file auto
      // 
      {
        IDVariant v_VCOUNT = new IDVariant(0,IDVariant.INTEGER);
        IDVariant S = new IDVariant(0,IDVariant.STRING);
        S = (new IDVariant("File import file auto"));
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = 'PRODUCTS/' || " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        SQL.append("and   (A.STRINGA = " + IDL.CSql(S, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
        if (v_VCOUNT.equals((new IDVariant(0)), true))
        {
          MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_ELEANOCAFIT1+BaseCmdLinIdx, (new IDVariant(0)).booleanValue());
          MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_ELEANOCAFITE+BaseCmdLinIdx, (new IDVariant(0)).booleanValue());
          MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_ELEANOCAFIT2+BaseCmdLinIdx, (new IDVariant(0)).booleanValue());
          MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_ELEANOCAFIT3+BaseCmdLinIdx, (new IDVariant(0)).booleanValue());
        }
      }
      // 
      // Sit fonti finanziamento - Treviso
      // 
      {
        IDVariant S = new IDVariant(0,IDVariant.STRING);
        S = (new IDVariant("PRODUCTS/CFA/FONTI FINANZIAMENTO"));
        IDVariant v_VCOUNT = new IDVariant(0,IDVariant.INTEGER);
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  REGISTRO A ");
        SQL.append("where (A.CHIAVE = " + IDL.CSql(S, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
        if (v_VCOUNT.equals((new IDVariant(0)), true))
        {
          MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_SITCAPPECAFI+BaseCmdLinIdx, (new IDVariant(0)).booleanValue());
          MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_SICAPEFOFIUO+BaseCmdLinIdx, (new IDVariant(0)).booleanValue());
        }
      }
      IDVariant v_ESTRAZSOR1 = new IDVariant(0,IDVariant.STRING);
      v_ESTRAZSOR1 = (new IDVariant("estraz_unione_sorbolo"));
      IDVariant v_ESTRAZSORBOL = new IDVariant(0,IDVariant.STRING);
      v_ESTRAZSORBOL = (new IDVariant("estraz_unione_sorbolo_attiva"));
      if (IDL.NullValue(AFC.GetComando(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), v_ESTRAZSOR1),(new IDVariant("X"))).compareTo(v_ESTRAZSORBOL, true)!=0)
      {
        MainFrm.CmdObj.set_CmdVisible(MyGlb.CMD_BILSORMEZUNI+BaseCmdLinIdx, (new IDVariant(0)).booleanValue());
      }
      IDVariant v_SERVDIRETTI = new IDVariant(0,IDVariant.STRING);
      v_SERVDIRETTI = (new IDVariant("NO"));
      v_SERVDIRETTI = AFC.GetRegistro(v_SSERVIZDIRET, IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0));
      if (IDL.NullValue(v_SERVDIRETTI,(new IDVariant("NO"))).compareTo((new IDVariant("SI")), true)!=0)
      {
        MainFrm.CmdObj.set_CmdSetVisible(MyGlb.CMDS_CASERDIR+BaseCmdSetIdx, (new IDVariant(0)).booleanValue());
      }
      if (IDL.NullValue(SIOPELINK,(new IDVariant("NO"))).compareTo((new IDVariant("SI")), true)!=0)
      {
        MainFrm.CmdObj.set_CmdSetVisible(MyGlb.CMDS_CASIOPEL+BaseCmdSetIdx, (new IDVariant(0)).booleanValue());
      }
      if (IDL.NullValue(INTEGRAZIPCC,(new IDVariant("NO"))).compareTo((new IDVariant("SI")), true)!=0)
      {
        MainFrm.CmdObj.set_CmdSetVisible(MyGlb.CMDS_CAINTPCC+BaseCmdSetIdx, (new IDVariant(0)).booleanValue());
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "DisabilitaVociMenuCustomizzate", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Controllo Fatture
  // **********************************************************************
  public int ApriControlloFatture ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Controllo Fatture Body
      // Procedure Body
      // 
      IMDB.set_Value(IMDBDef2.TBL_FILTRO3, IMDBDef2.FLD_FILTRO3_ROWNAMERICER, 0, (new IDVariant("SI")));
      IMDB.set_Value(IMDBDef2.TBL_FILTRO3, IMDBDef2.FLD_FILTRO3_ROWNAMFIUNOR, 0, (new IDVariant("NO")));
      MainFrm.Show(MyGlb.FRM_CONTROFATTUR, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriControlloFatture", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Elenco Accertamenti Reiscritti
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int ApriElencoAccertamentiReiscritti ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Elenco Accertamenti Reiscritti Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_ELENIMPEREIS, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_ELENIMPEREIS,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef4.TBL_PARS38, IMDBDef4.FLD_PARS38_NOOGIMOSUOAC, 0, (new IDVariant("A")));
      MainFrm.Show(MyGlb.FRM_ELENIMPEREIS, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriElencoAccertamentiReiscritti", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Elenco Impegni Reiscritti
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int ApriElencoImpegniReiscritti ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Elenco Impegni Reiscritti Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_ELENIMPEREIS, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_ELENIMPEREIS,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef4.TBL_PARS38, IMDBDef4.FLD_PARS38_NOOGIMOSUOAC, 0, (new IDVariant("I")));
      MainFrm.Show(MyGlb.FRM_ELENIMPEREIS, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriElencoImpegniReiscritti", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Aprio Elenco Subimpegni Reiscritti
  // **********************************************************************
  public int AprioElencoSubimpegniReiscritti ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Aprio Elenco Subimpegni Reiscritti Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_ELENIMPEREIS, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_ELENIMPEREIS,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef4.TBL_PARS38, IMDBDef4.FLD_PARS38_NOOGIMOSUOAC, 0, (new IDVariant("S")));
      MainFrm.Show(MyGlb.FRM_ELENIMPEREIS, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "AprioElencoSubimpegniReiscritti", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Parametri FSC
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int ApriParametriFSC ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Parametri FSC Body
      // Corpo Procedura
      // 
      IDVariant v_VCOUNT = new IDVariant(0,IDVariant.INTEGER);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  FSC_PARAMETRI A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_VCOUNT.equals((new IDVariant(0)), true))
      {
        IDVariant v_VCOUNTTOT = new IDVariant(0,IDVariant.INTEGER);
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  FSC_PARAMETRI A ");
        SQL.append("where (A.ESERCIZIO < " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VCOUNTTOT = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
        if (v_VCOUNTTOT.equals((new IDVariant(0)), true))
        {
          SQL = new StringBuffer();
          SQL.append("insert into FSC_PARAMETRI ");
          SQL.append("( ");
          SQL.append("  ESERCIZIO, ");
          SQL.append("  TIPO_CLASSIF, ");
          SQL.append("  PRIMO_ESERCIZIO_ARM, ");
          SQL.append("  PERC_1, ");
          SQL.append("  PERC_2, ");
          SQL.append("  TIPO_CALCOLO_NUOVO_ORD, ");
          SQL.append("  PERIODO_RIFERIMENTO, ");
          SQL.append("  PERIODO_RIFERIMENTO_REND, ");
          SQL.append("  STPRE_COLONNA_A, ");
          SQL.append("  RESATT_COLONNA_AB_REND, ");
          SQL.append("  TIPODIV_ZERO, ");
          SQL.append("  STREND_COLONNA_A_B ");
          SQL.append(") ");
          SQL.append("values ");
          SQL.append("( ");
          SQL.append("  " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", ");
          SQL.append("  'TIP', ");
          SQL.append("  2015, ");
          SQL.append("  0, ");
          SQL.append("  0, ");
          SQL.append("  'IC-AC', ");
          SQL.append("  'QN-2', ");
          SQL.append("  'QN-1', ");
          SQL.append("  'TUTTI', ");
          SQL.append("  'FCDDE', ");
          SQL.append("  '0', ");
          SQL.append("  'TUTTI' ");
          SQL.append(") ");
          MainFrm.Cf4armDBObject.DBO().Execute(SQL);
        }
        else
        {
          SQL = new StringBuffer();
          SQL.append("insert into FSC_PARAMETRI ");
          SQL.append("( ");
          SQL.append("  ESERCIZIO, ");
          SQL.append("  TIPO_CLASSIF, ");
          SQL.append("  PRIMO_ESERCIZIO_ARM, ");
          SQL.append("  PERC_1, ");
          SQL.append("  PERC_2, ");
          SQL.append("  TIPO_CALCOLO_NUOVO_ORD, ");
          SQL.append("  PERIODO_RIFERIMENTO, ");
          SQL.append("  STPRE_COLONNA_A, ");
          SQL.append("  GEST_VARIAZIONI_PRO, ");
          SQL.append("  PERIODO_RIFERIMENTO_REND, ");
          SQL.append("  RESATT_COLONNA_AB_REND, ");
          SQL.append("  TIPODIV_ZERO, ");
          SQL.append("  STREND_COLONNA_A_B, ");
          SQL.append("  STREND_COLONNA_A_B_RES_EFF ");
          SQL.append(") ");
          SQL.append("select ");
          SQL.append("  " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", ");
          SQL.append("  A.TIPO_CLASSIF, ");
          SQL.append("  A.PRIMO_ESERCIZIO_ARM, ");
          SQL.append("  A.PERC_1, ");
          SQL.append("  A.PERC_2, ");
          SQL.append("  A.TIPO_CALCOLO_NUOVO_ORD, ");
          SQL.append("  A.PERIODO_RIFERIMENTO, ");
          SQL.append("  A.STPRE_COLONNA_A, ");
          SQL.append("  A.GEST_VARIAZIONI_PRO, ");
          SQL.append("  A.PERIODO_RIFERIMENTO_REND, ");
          SQL.append("  A.RESATT_COLONNA_AB_REND, ");
          SQL.append("  A.TIPODIV_ZERO, ");
          SQL.append("  A.STREND_COLONNA_A_B, ");
          SQL.append("  A.STREND_COLONNA_A_B_RES_EFF ");
          SQL.append("from ");
          SQL.append("  FSC_PARAMETRI A ");
          SQL.append("where (A.ESERCIZIO = ");
          SQL.append("( ");
          SQL.append("select ");
          SQL.append("  MAX(B.ESERCIZIO) ");
          SQL.append("from ");
          SQL.append("  FSC_PARAMETRI B ");
          SQL.append("where (B.ESERCIZIO < " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append(")) ");
          MainFrm.Cf4armDBObject.DBO().Execute(SQL);
        }
      }
      MainFrm.Show(MyGlb.FRM_PARAMETRIFSC, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriParametriFSC", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Definizione Tipo Calcolo
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int DefinizioneTipoCalcolo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDCachedRowSet C6;
    IDCachedRowSet C12;

    try
    {
      TransCount = 0;
      // 
      // Definizione Tipo Calcolo Body
      // Corpo Procedura
      // 
      IDVariant v_VFSCPARTIPCL = new IDVariant(0,IDVariant.STRING);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  A.TIPO_CLASSIF as FSCPARTIPCLA ");
      SQL.append("from ");
      SQL.append("  FSC_PARAMETRI A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VFSCPARTIPCL = QV.Get("FSCPARTIPCLA", IDVariant.STRING) ;
      }
      QV.Close();
      if (IDL.IsNull(v_VFSCPARTIPCL))
      {
        IDVariant S = null;
        S = (new IDVariant("Tipo Classificazione non definito nei Parametri FCDDE"));
        MainFrm.set_AlertMessage(S); 
        return 0;
      }
      if (v_VFSCPARTIPCL.equals((new IDVariant("TIP")), true) || v_VFSCPARTIPCL.equals((new IDVariant("CAT")), true))
      {
        IDVariant v_VCOUNT = new IDVariant(0,IDVariant.INTEGER);
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  FSC_TIPI_CALC_CLASSIF A ");
        SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
        if (v_VCOUNT.equals((new IDVariant(0)), true))
        {
          MainFrm.Cf4armDBObject.BeginTrans();
          SQL = new StringBuffer();
          SQL.append("select ");
          SQL.append("  A.CODICE as CODICE, ");
          SQL.append("  A.DESCRIZIONE as DESCRIZIONE ");
          SQL.append("from ");
          SQL.append("  BIL_STRUTTURA A ");
          SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append("and   (A.E_S = 'E') ");
          SQL.append("and   (A.LIVELLO = 2) ");
          SQL.append("and   (A.CODICE_PADRE_GERARCHIA IN ('1', '2', '3', '4', '5')) ");
          SQL.append("and   (" + IDL.CSql(v_VFSCPARTIPCL, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " = 'TIP') ");
          SQL.append("UNION ");
          SQL.append("select ");
          SQL.append("  B.COD_CATEGORIA_ST, ");
          SQL.append("  B.DES_CATEGORIA ");
          SQL.append("from ");
          SQL.append("  VISTA_CATEGORIE_E_ARM B ");
          SQL.append("where ((" + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + " BETWEEN B.ESERCIZIO_INIZIO AND B.ESERCIZIO_SCADENZA)) ");
          SQL.append("and   (" + IDL.CSql(v_VFSCPARTIPCL, IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + " = 'CAT') ");
          SQL.append("order by 1, 2 ");
          C6 = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
          if (!C6.EOF()) C6.MoveNext();
          while (!C6.EOF())
          {
            try
            {
              SQL = new StringBuffer();
              SQL.append("insert into FSC_TIPI_CALC_CLASSIF ");
              SQL.append("( ");
              SQL.append("  ESERCIZIO, ");
              SQL.append("  TIPOLOGIA_CATEGORIA, ");
              SQL.append("  DESCRIZIONE, ");
              SQL.append("  TIPO_CALCOLO, ");
              SQL.append("  UTENTE_INSERIMENTO, ");
              SQL.append("  DATA_INSERIMENTO ");
              SQL.append(") ");
              SQL.append("values ");
              SQL.append("( ");
              SQL.append("  " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", ");
              SQL.append("  " + IDL.CSql(C6.Get("CODICE"), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", ");
              SQL.append("  " + IDL.CSql(C6.Get("DESCRIZIONE"), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
              SQL.append("  NULL, ");
              SQL.append("  " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
              SQL.append("  TRUNC( SYSDATE ) ");
              SQL.append(") ");
              MainFrm.Cf4armDBObject.DBO().Execute(SQL);
            }
            catch (Exception e8)
            {
              MainFrm.set_AlertMessage(new IDVariant(e8.getMessage())); 
              MainFrm.Cf4armDBObject.RollbackTrans();
              return 0;
            }
            C6.MoveNext();
          }
          C6.Close();
          MainFrm.Cf4armDBObject.CommitTrans();
        }
      }
      else
      {
        IDVariant v_VCOUNT1 = new IDVariant(0,IDVariant.INTEGER);
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  FSC_TIPI_CALC_CAP A ");
        SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VCOUNT1 = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
        MainFrm.Cf4armDBObject.BeginTrans();
        if (v_VCOUNT1.equals((new IDVariant(0)), true))
        {
          SQL = new StringBuffer();
          SQL.append("select ");
          SQL.append("  A.CAPITOLO as CAPCAPITOLO, ");
          SQL.append("  A.ARTICOLO as CAPARTICOLO, ");
          SQL.append("  A.DESCRIZIONE as CAPDESCRIZIO ");
          SQL.append("from ");
          SQL.append("  CAP A ");
          SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
          SQL.append("and   (A.E_S = 'E') ");
          SQL.append("and   (SUBSTR(A.CODICE_STRUTTURA, 1, 1) IN ('1', '2', '3', '4', '5')) ");
          SQL.append("order by ");
          SQL.append("  A.CAPITOLO, ");
          SQL.append("  A.ARTICOLO ");
          C12 = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
          if (!C12.EOF()) C12.MoveNext();
          while (!C12.EOF())
          {
            try
            {
              SQL = new StringBuffer();
              SQL.append("insert into FSC_TIPI_CALC_CAP ");
              SQL.append("( ");
              SQL.append("  ESERCIZIO, ");
              SQL.append("  CAPITOLO, ");
              SQL.append("  ARTICOLO, ");
              SQL.append("  DESCRIZIONE, ");
              SQL.append("  TIPO_CALCOLO, ");
              SQL.append("  UTENTE_INSERIMENTO, ");
              SQL.append("  DATA_INSERIMENTO ");
              SQL.append(") ");
              SQL.append("values ");
              SQL.append("( ");
              SQL.append("  " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", ");
              SQL.append("  " + IDL.CSql(C12.Get("CAPCAPITOLO"), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", ");
              SQL.append("  " + IDL.CSql(C12.Get("CAPARTICOLO"), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ", ");
              SQL.append("  " + IDL.CSql(C12.Get("CAPDESCRIZIO"), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
              SQL.append("  NULL, ");
              SQL.append("  " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0), IDL.FMT_CHAR, MainFrm.Cf4armDBObject.DBO()) + ", ");
              SQL.append("  TRUNC( SYSDATE ) ");
              SQL.append(") ");
              MainFrm.Cf4armDBObject.DBO().Execute(SQL);
            }
            catch (Exception e14)
            {
              MainFrm.set_AlertMessage(new IDVariant(e14.getMessage())); 
              MainFrm.Cf4armDBObject.RollbackTrans();
              return 0;
            }
            C12.MoveNext();
          }
          C12.Close();
        }
        MainFrm.Cf4armDBObject.CommitTrans();
      }
      if ((MainFrm.GetForm(MyGlb.FRM_DEFITIPOCALC, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_DEFITIPOCALC,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef3.TBL_PARS45, IMDBDef3.FLD_PARS45_NOMOGGTIPCLA, 0, new IDVariant(v_VFSCPARTIPCL));
      MainFrm.Show(MyGlb.FRM_DEFITIPOCALC, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "DefinizioneTipoCalcolo", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Calcolo Generale Fondo
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int CalcoloGeneraleFondo ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Calcolo Generale Fondo Body
      // Corpo Procedura
      // 
      IDVariant v_VTIPOCLASSIF = null;
      v_VTIPOCLASSIF = (new IDVariant());
      IDVariant v_VPRIMESERARM = null;
      v_VPRIMESERARM = (new IDVariant());
      IDVariant v_VCOUNT = new IDVariant(0,IDVariant.INTEGER);
      SQL = new StringBuffer();
      SQL.append("select ");
      SQL.append("  MAX(A.TIPO_CLASSIF) as MAXFSCPATICL, ");
      SQL.append("  MAX(A.PRIMO_ESERCIZIO_ARM) as MAFSPAPRESAR, ");
      SQL.append("  COUNT(*) as COUNT1 ");
      SQL.append("from ");
      SQL.append("  FSC_PARAMETRI A ");
      SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
      QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!QV.EOF()) QV.MoveNext();
      if (!QV.EOF())
      {
        v_VTIPOCLASSIF = QV.Get("MAXFSCPATICL", IDVariant.STRING) ;
        v_VPRIMESERARM = QV.Get("MAFSPAPRESAR", IDVariant.INTEGER) ;
        v_VCOUNT = QV.Get("COUNT1", IDVariant.INTEGER) ;
      }
      QV.Close();
      if (v_VCOUNT.equals((new IDVariant(0)), true))
      {
        IDVariant S = null;
        S = (new IDVariant("Parametri FCDDE non valorizzati"));
        MainFrm.set_AlertMessage(S); 
        return 0;
      }
      if (IDL.IsNull(v_VPRIMESERARM))
      {
        IDVariant S = new IDVariant(0,IDVariant.STRING);
        S = (new IDVariant("Primo Esercizio Armonizzazione non indicato nei parametri Fondo Svalutazione Crediti"));
        MainFrm.set_AlertMessage(S); 
        return 0;
      }
      if (IDL.IsNull(v_VTIPOCLASSIF))
      {
        IDVariant S = new IDVariant(0,IDVariant.STRING);
        S = (new IDVariant("Tipo classificazione non indicata nei parametri Fondo Svalutazione Crediti"));
        MainFrm.set_AlertMessage(S); 
        return 0;
      }
      IDVariant v_S2 = new IDVariant(0,IDVariant.STRING);
      v_S2 = (new IDVariant("Tipi calcolo non definiti"));
      IDVariant v_S1 = new IDVariant(0,IDVariant.STRING);
      v_S1 = (new IDVariant("Sono presenti classificazioni non escluse dal calcolo e senza indicazione del tipo di calcolo"));
      if (v_VTIPOCLASSIF.equals((new IDVariant("TIP")), true) || v_VTIPOCLASSIF.equals((new IDVariant("CAT")), true))
      {
        IDVariant v_VTOTO = new IDVariant(0,IDVariant.INTEGER);
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  FSC_TIPI_CALC_CLASSIF A ");
        SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VTOTO = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
        if (v_VTOTO.equals((new IDVariant(0)), true))
        {
          MainFrm.set_AlertMessage(v_S2); 
          return 0;
        }
        IDVariant v_VESCLUSI = new IDVariant(0,IDVariant.INTEGER);
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  FSC_TIPI_CALC_CLASSIF A ");
        SQL.append("where ((A.ESCLUSO IS NULL)) ");
        SQL.append("and   ((A.TIPO_CALCOLO IS NULL)) ");
        SQL.append("and   (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VESCLUSI = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
        if (v_VESCLUSI.compareTo((new IDVariant(0)), true)>0)
        {
          MainFrm.set_AlertMessage(v_S1); 
          return 0;
        }
      }
      else
      {
        IDVariant v_VTOTO1 = new IDVariant(0,IDVariant.INTEGER);
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  FSC_TIPI_CALC_CAP A ");
        SQL.append("where (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VTOTO1 = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
        if (v_VTOTO1.equals((new IDVariant(0)), true))
        {
          MainFrm.set_AlertMessage(v_S2); 
          return 0;
        }
        IDVariant v_VESCLUSI1 = new IDVariant(0,IDVariant.INTEGER);
        SQL = new StringBuffer();
        SQL.append("select ");
        SQL.append("  COUNT(*) as COUNT1 ");
        SQL.append("from ");
        SQL.append("  FSC_TIPI_CALC_CAP A ");
        SQL.append("where ((A.ESCLUSO IS NULL)) ");
        SQL.append("and   ((A.TIPO_CALCOLO IS NULL)) ");
        SQL.append("and   (A.ESERCIZIO = " + IDL.CSql(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), IDL.FMT_NUM, MainFrm.Cf4armDBObject.DBO()) + ") ");
        QV = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
        if (!QV.EOF()) QV.MoveNext();
        if (!QV.EOF())
        {
          v_VESCLUSI1 = QV.Get("COUNT1", IDVariant.INTEGER) ;
        }
        QV.Close();
        if (v_VESCLUSI1.compareTo((new IDVariant(0)), true)>0)
        {
          MainFrm.set_AlertMessage(v_S1); 
          return 0;
        }
      }
      // MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
      // 
      // Lancio della Procedure
      // 
      // MainFrm.Cf4armDBObject.FSCCALCOLOGEN(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), v_VPRIMESERARM);
      // if (IDL.NullValue((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())),(new IDVariant(""))).compareTo((new IDVariant("")), true)!=0)
      // {
        // MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
      // }
      // else
      // {
      // }
      // 
      // Apertura Form
      // 
      IMDB.set_Value(IMDBDef3.TBL_FSCPARAMETRI, IMDBDef3.FLD_FSCPARAMETRI_NOMOGGTIPCLA, 0, new IDVariant(v_VTIPOCLASSIF));
      IMDB.set_Value(IMDBDef3.TBL_FSCPARAMETRI, IMDBDef3.FLD_FSCPARAMETRI_NOMOGGPRESAR, 0, new IDVariant(v_VPRIMESERARM));
      MainFrm.Show(MyGlb.FRM_FCDDEBILPREV, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CalcoloGeneraleFondo", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Finanziamento
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int ApriFinanziamento ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Finanziamento Body
      // Corpo Procedura
      // 
      IMDB.set_Value(IMDBDef1.TBL_PARAM144, IMDBDef1.FLD_PARAM144_NOMEOGGETTIU, 0, (new IDVariant("U")));
      MainFrm.Show(MyGlb.FRM_FINANZIAMENT, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriFinanziamento", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Apri Opera
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int ApriOpera ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Apri Opera Body
      // Corpo Procedura
      // 
      IMDB.set_Value(IMDBDef1.TBL_PARAM146, IMDBDef1.FLD_PARAM146_NOMEOGGETTIU, 0, (new IDVariant("U")));
      MainFrm.Show(MyGlb.FRM_OPERE, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ApriOpera", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Stampa Cronoprogramma
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int StampaCronoprogramma ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDCachedRowSet C3;

    try
    {
      TransCount = 0;
      // 
      // Stampa Cronoprogramma Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_STAMPACRONOP, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_STAMPACRONOP,(new IDVariant(0)).booleanValue()); 
      }
      SQL = new StringBuffer();
      SQL.append("select distinct ");
      SQL.append("  A.CRONOPROGRAMMA_ID as CRONOPROGRID, ");
      SQL.append("  A.PROGRESSIVO_IMPUTAZIONE as PROGREIMPUTA ");
      SQL.append("from ");
      SQL.append("  IMPUTAZIONI_CRONOPROGRAMMI A ");
      C3 = MainFrm.Cf4armDBObject.DBO().OpenRS(SQL);
      if (!C3.EOF()) C3.MoveNext();
      while (!C3.EOF())
      {
        MainFrm.Cf4armDBObject.set_ErrorMessage((new IDVariant("")).stringValue());
        MainFrm.Cf4armDBObject.GENERACRONOPIANOCOMPTMP(IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOESERCI, 0), C3.Get("CRONOPROGRID"), C3.Get("PROGREIMPUTA"), PROGRESESSIO, IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0));
        if ((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage())).compareTo((new IDVariant("")), true)!=0)
        {
          MainFrm.set_AlertMessage((new IDVariant(MainFrm.Cf4armDBObject.ErrorMessage()))); 
          return 0;
        }
        C3.MoveNext();
      }
      C3.Close();
      IMDB.set_Value(IMDBDef3.TBL_PARS58, IMDBDef3.FLD_PARS58_NOOGSTELOELV, 0, (new IDVariant(1)));
      MainFrm.Show(MyGlb.FRM_STAMPACRONOP, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "StampaCronoprogramma", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Stampa Elenco Variazioni
  // **********************************************************************
  public int StampaElencoVariazioni ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Stampa Elenco Variazioni Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_STAMPACRONOP, 0, false)!=null))
      {
        MainFrm.UnloadForm(MyGlb.FRM_STAMPACRONOP,(new IDVariant(0)).booleanValue()); 
      }
      IMDB.set_Value(IMDBDef3.TBL_PARS58, IMDBDef3.FLD_PARS58_NOOGSTELOELV, 0, (new IDVariant(2)));
      MainFrm.Show(MyGlb.FRM_STAMPACRONOP, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "StampaElencoVariazioni", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Emiss Mandati Cassa Economale
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int EmissMandatiCassaEconomale ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Emiss Mandati Cassa Economale Body
      // Corpo Procedura
      // 
      if (INTEGRAZIGC4.equals((new IDVariant(0)), true))
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Funzionalità non ammessa. Manca integrazione con Cassa Economale.", IDVariant.STRING));
        MainFrm.set_AlertMessage(v_AVVISO); 
        return 0;
      }
      MainFrm.Show(MyGlb.FRM_ELEEMIMACAEC, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "EmissMandatiCassaEconomale", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Proposte Variazioni Impegni Subimpegni
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int ProposteVariazioniImpegniSubimpegni ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Proposte Variazioni Impegni Subimpegni Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_PROVARIMPSUB, 0, false)!=null))
      {
        if (new IDVariant(((ProposteVariazioniImpegniSubimpegni)MainFrm.GetForm(MyGlb.FRM_PROVARIMPSUB,0)).PAN_PROPOSVARIAZ.Status()).equals((new IDVariant(3)), true))
        {
          IDVariant S = new IDVariant(0,IDVariant.STRING);
          S = (new IDVariant("Confermare prima le modifiche"));
          MainFrm.set_AlertMessage(S); 
          return 0;
        }
      }
      IMDB.set_Value(IMDBDef5.TBL_PARS85, IMDBDef5.FLD_PARS85_NOMEOGGETTES, 0, (new IDVariant("S")));
      IMDB.set_Value(IMDBDef5.TBL_PARS85, IMDBDef5.FLD_PARS85_NOMEOGGEMISS, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARS85, IMDBDef5.FLD_PARS85_NOMEOGGEPROG, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARS85, IMDBDef5.FLD_PARS85_NOMEOGGETITO, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARS85, IMDBDef5.FLD_PARS85_NOMEOGGETTUO, 0, (new IDVariant()));
      MainFrm.Show(MyGlb.FRM_PROVARIMPSUB, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ProposteVariazioniImpegniSubimpegni", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Generazione Variazioni
  // Spiega quale elaborazione viene eseguita da questa
  // procedura
  // **********************************************************************
  public int GenerazioneVariazioni ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Generazione Variazioni Body
      // Corpo Procedura
      // 
      MainFrm.Show(MyGlb.FRM_GENVARPROVAR, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "GenerazioneVariazioni", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Proposte Variazioni Acc
  // **********************************************************************
  public int ProposteVariazioniAcc ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Proposte Variazioni Acc Body
      // Corpo Procedura
      // 
      if ((MainFrm.GetForm(MyGlb.FRM_PROVARIMPSUB, 0, false)!=null))
      {
        if (new IDVariant(((ProposteVariazioniImpegniSubimpegni)MainFrm.GetForm(MyGlb.FRM_PROVARIMPSUB,0)).PAN_PROPOSVARIAZ.Status()).equals((new IDVariant(3)), true))
        {
          IDVariant S = new IDVariant(0,IDVariant.STRING);
          S = (new IDVariant("Confermare prima le modifiche"));
          MainFrm.set_AlertMessage(S); 
          return 0;
        }
      }
      IMDB.set_Value(IMDBDef5.TBL_PARS85, IMDBDef5.FLD_PARS85_NOMEOGGETTES, 0, (new IDVariant("E")));
      IMDB.set_Value(IMDBDef5.TBL_PARS85, IMDBDef5.FLD_PARS85_NOMEOGGEMISS, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARS85, IMDBDef5.FLD_PARS85_NOMEOGGEPROG, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARS85, IMDBDef5.FLD_PARS85_NOMEOGGETITO, 0, (new IDVariant()));
      IMDB.set_Value(IMDBDef5.TBL_PARS85, IMDBDef5.FLD_PARS85_NOMEOGGETTUO, 0, (new IDVariant()));
      MainFrm.Show(MyGlb.FRM_PROVARIMPSUB, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ProposteVariazioniAcc", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Eliminazione Variazioni
  // **********************************************************************
  public int EliminazioneVariazioni ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Eliminazione Variazioni Body
      // Corpo Procedura
      // 
      MainFrm.Show(MyGlb.FRM_ELIMINVARIAZ, (new IDVariant(0)).intValue(), this); 
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "EliminazioneVariazioni", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Elaborazioni On Change Expand
  // Evento notificato dal CommandSet quando viene espanso
  // o collassato
  // Expanded: E' un valore booleano che indice se il CommandSet è stato aperto (True) o chiuso (False). - Input
  // Cancel: E' un parametro di uscita booleano. Se viene impostato a True l'operazione di apertura/chiusura viene annullata. - Input/Output
  // **********************************************************************
  private void CMDS_CAELABOR_OnCmdSetChangeExpand(IDVariant Expanded, IDVariant Cancel)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Elaborazioni On Change Expand Body
      // Corpo Procedura
      // 
      if (ESEPIACONMOD.compareTo(IDL.ToString((new IDVariant(2014))), true)!=0)
      {
        IDVariant v_AVVISO = new IDVariant(0,IDVariant.STRING);
        v_AVVISO = (new IDVariant("Menu non abilitato"));
        MainFrm.set_AlertMessage(v_AVVISO); 
        Cancel.set((new IDVariant(-1)));
      }
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "ElaborazioniOnChangeExpand", _e);
    }
  }

  // **********************************************************************
  // Stringa Connessione Stampa
  // Explain which processing is carried out by this procedure
  // Percorso Libreria PB - Input
  // Data Windowconparametri - Input
  // **********************************************************************
  public IDVariant StringaConnessioneStampa (IDVariant PercorsoLibreriaPB, IDVariant DataWindowconparametri)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_OUTPUT = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Stringa Connessione Stampa Body
      // Procedure Body
      // 
      v_OUTPUT = IDL.Add(IDL.Add(IMDB.Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PARPERDELSER, 0), (new IDVariant("?"))), IDL.Add((new IDVariant("exefile=")), IDL.Add(IDL.Add(IMDB.Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PARANOMEESEG, 0), (new IDVariant("&"))), IDL.Add((new IDVariant("s=")), IDL.Add(IMDB.Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PARASERVNAME, 0), IDL.Add((new IDVariant("&")), IDL.Add((new IDVariant("i=")), IDL.Add(IMDB.Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PARCODISTAD4, 0), IDL.Add((new IDVariant("&")), IDL.Add((new IDVariant("l=")), IDL.Add(PercorsoLibreriaPB, IDL.Add((new IDVariant("&")), IDL.Add((new IDVariant("dw=")), DataWindowconparametri)))))))))))));
      return v_OUTPUT;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "StringaConnessioneStampa", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Costruisci Parametri
  // Explain which processing is carried out by this procedure
  // Libreria Da Aprire - Input
  // **********************************************************************
  public IDVariant CostruisciParametri (IDVariant LibreriaDaAprire)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_DARESTITUIRE = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Costruisci Parametri Body
      // Procedure Body
      // 
      v_DARESTITUIRE = new IDVariant(LibreriaDaAprire);
      COSTRUPARAME_PARASTAMSI41();
      while (!IMDB.Eof(IMDBDef17.QRY_PARASTAMSI41, 0))
      {
        v_DARESTITUIRE = IDL.Add(v_DARESTITUIRE, IDL.Add((new IDVariant(" ")), IDL.Add((new IDVariant("-a")), IDL.Add(IDL.ToString(IMDB.Value(IMDBDef17.QRY_PARASTAMSI41, IMDBDef17.QSL_PARASTAMSI41_PARAMEPROGRE, 0)), IDL.Add((new IDVariant(" ")), IMDB.Value(IMDBDef17.QRY_PARASTAMSI41, IMDBDef17.QSL_PARASTAMSI41_PARAMETRO, 0))))));
        IMDB.TblMoveNext(IMDBDef17.QRY_PARASTAMSI41, 0);
      }
      return v_DARESTITUIRE;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CostruisciParametri", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Parametri Stampa Si4print
  // Which data are you selecting?
  // **********************************************************************
  private void COSTRUPARAME_PARASTAMSI41() throws SQLException
  {
    IDVariant[] AggrBuff;
    int[] AggrRowCount;
    int AggrCount=0;
    boolean AggrNewGroup = false;

    IMDB.TblTruncate(IMDBDef17.QRY_PARASTAMSI41);
    IMDB.TblMoveFirst(IMDBDef7.TBL_PARASTAMSI4P, 0);
    Loop1: while (!IMDB.Eof(IMDBDef7.TBL_PARASTAMSI4P, 0))
    {
      IMDB.TblAddNew(IMDBDef17.QRY_PARASTAMSI41, 0);
      IMDB.TblLinkRow(IMDBDef17.QRY_PARASTAMSI41, 0, IMDBDef7.TBL_PARASTAMSI4P, 0);
      IMDB.TblLinkField(IMDBDef17.QRY_PARASTAMSI41, 0, 0, IMDBDef7.TBL_PARASTAMSI4P, IMDBDef7.FLD_PARASTAMSI4P_PARAMEPROGRE, 0);
      IMDB.TblLinkField(IMDBDef17.QRY_PARASTAMSI41, 1, 0, IMDBDef7.TBL_PARASTAMSI4P, IMDBDef7.FLD_PARASTAMSI4P_PARAMETRO, 0);
      IMDB.TblMoveNext(IMDBDef7.TBL_PARASTAMSI4P, 0);
      if (IMDB.Eof(IMDBDef7.TBL_PARASTAMSI4P, 0))
      {
        IMDB.TblMoveFirst(IMDBDef7.TBL_PARASTAMSI4P, 0);
      }
      else
      {
        continue Loop1;
      }
      break;
    }
    IMDB.TblInitSort(IMDBDef17.QRY_PARASTAMSI41);
    IMDB.TblSortBy(IMDBDef17.QRY_PARASTAMSI41,0,true);
    IMDB.TblStartSort(IMDBDef17.QRY_PARASTAMSI41);
    IMDB.TblMoveFirst(IMDBDef17.QRY_PARASTAMSI41, 0);
  }

  // **********************************************************************
  // Lancia Stampa
  // Explain which processing is carried out by this procedure
  // Percorsolibreria: What data are you passing to the procedure? - Input
  // Datawindow: What data are you passing to the procedure? - Input
  // **********************************************************************
  public int LanciaStampa (IDVariant Percorsolibreria, IDVariant Datawindow)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Lancia Stampa Body
      // Procedure Body
      // 
      MainFrm.set_RedirectTo(StringaConnessioneStampa(Percorsolibreria, IDL.Add(CostruisciParametri(Datawindow), ((IDL.NullValue(IMDB.Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PASTDAEORAFP, 0),(new IDVariant("NO"))).equals((new IDVariant("NO"))))?(new IDVariant("&f=NO")):(new IDVariant(""))))));
      MainFrm.set_RedirectNewWindow((new IDVariant(-1)).booleanValue());
      MainFrm.set_RedirectFeatures((new IDVariant(""))); 
      LANCIASTAMPA_PARSTASI4DEL();
      IMDB.set_Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PASTDAEORAFP, 0, (new IDVariant()));
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "LanciaStampa", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Parametri Stampa Si4print: Delete
  // Why are you deleting these data?
  // **********************************************************************
  private void LANCIASTAMPA_PARSTASI4DEL() throws SQLException
  {
    IMDB.TblTruncate(IMDBDef7.TBL_PARASTAMSI4P);
  }

  // **********************************************************************
  // Set Parametro Stampa
  // Explain which processing is carried out by this procedure
  // Parametro: What data are you passing to the procedure? - Input
  // **********************************************************************
  public int SetParametroStampa (IDVariant Parametro)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTA = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Set Parametro Stampa Body
      // Procedure Body
      // 
      SETPARAMSTAM_CFDBCFDBSE11();
      if (!IMDB.Eof(IMDBDef17.QRY_CFDBCFDBSE11, 0))
      {
        v_CONTA = IMDB.Value(IMDBDef17.QRY_CFDBCFDBSE11, IMDBDef17.QSL_CFDBCFDBSE11_MAXNUVAPAPR0, 0, IDVariant.INTEGER) ;
      }
      SETPARAMSTAM_PARSTASIININ(v_CONTA, Parametro);
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SetParametroStampa", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Cf4arm DB (Cf4arm DB): Select into variables
  // Which data are you selecting?
  // **********************************************************************
  private void SETPARAMSTAM_CFDBCFDBSE11() throws SQLException
  {
    IDVariant[] AggrBuff;
    int[] AggrRowCount;
    int AggrCount=0;
    boolean AggrNewGroup = false;

    IMDB.TblTruncate(IMDBDef17.QRY_CFDBCFDBSE11);
    IMDB.TblTruncate(IMDBDef1.TMP_RECORDSET);
    IMDB.TblMoveFirst(IMDBDef7.TBL_PARASTAMSI4P, 0);
    Loop1: while (!IMDB.Eof(IMDBDef7.TBL_PARASTAMSI4P, 0))
    {
      IMDB.TblAddNew(IMDBDef1.TMP_RECORDSET, 0);
      IMDB.set_Value(IMDBDef1.TMP_RECORDSET, 0, 0, IDL.NullValue(IMDB.Value(IMDBDef7.TBL_PARASTAMSI4P, IMDBDef7.FLD_PARASTAMSI4P_PARAMEPROGRE, 0),(new IDVariant(0))));
      IMDB.TblMoveNext(IMDBDef7.TBL_PARASTAMSI4P, 0);
      if (IMDB.Eof(IMDBDef7.TBL_PARASTAMSI4P, 0))
      {
        IMDB.TblMoveFirst(IMDBDef7.TBL_PARASTAMSI4P, 0);
      }
      else
      {
        continue Loop1;
      }
      break;
    }
    IMDB.TblMoveFirst(IMDBDef1.TMP_RECORDSET, 0);
    AggrBuff = new IDVariant[1];
    for (int i=0; i<AggrBuff.length; i++) AggrBuff[i] = new IDVariant();
    AggrRowCount = new int[1];
    AggrCount = 0;
    IMDB.TblMoveFirst(IMDBDef1.TMP_RECORDSET, 0);
    if (IMDB.TblNumRows(IMDBDef1.TMP_RECORDSET) > 0)
    {
      while (true)
      {
        if (AggrCount == 0 && !IMDB.Eof(IMDBDef1.TMP_RECORDSET, 0))
        {
          AggrBuff[0] = IMDB.Value(IMDBDef1.TMP_RECORDSET, 0, 0);
          if (!IDL.IsNull(IMDB.Value(IMDBDef1.TMP_RECORDSET, 0, 0))) AggrRowCount[0] = 1; else AggrRowCount[0] = 0;
          AggrCount = 1;
          IMDB.TblMoveNext(IMDBDef1.TMP_RECORDSET, 0);
        }
        else
        {
          AggrNewGroup = IMDB.Eof(IMDBDef1.TMP_RECORDSET, 0);
          if (AggrNewGroup)
          {
            if (AggrCount > 0)
            {
              IMDB.TblAddNew(IMDBDef17.QRY_CFDBCFDBSE11, 0);
              IMDB.set_Value(IMDBDef17.QRY_CFDBCFDBSE11, 0, 0, AggrBuff[0]);
            }
            AggrCount = 0;
            if (IMDB.Eof(IMDBDef1.TMP_RECORDSET, 0)) break;
          }
          else
          {
            if (!IMDB.Eof(IMDBDef1.TMP_RECORDSET, 0))
            {
              if (!IDL.IsNull(IMDB.Value(IMDBDef1.TMP_RECORDSET, 0, 0)))
              {
                if (IDL.IsNull(AggrBuff[0]) || AggrBuff[0].compareTo(IMDB.Value(IMDBDef1.TMP_RECORDSET, 0, 0)) < 0) AggrBuff[0] = IMDB.Value(IMDBDef1.TMP_RECORDSET, 0, 0);
                AggrRowCount[0]++;
              }
              AggrCount++;
              IMDB.TblMoveNext(IMDBDef1.TMP_RECORDSET, 0);
            }
          }
        }
      }
    }
    IMDB.TblMoveFirst(IMDBDef17.QRY_CFDBCFDBSE11, 0);
  }

  // **********************************************************************
  // Parametri Stampa Si4print: Insert into
  // Why are you inserting this record?
  // **********************************************************************
  private void SETPARAMSTAM_PARSTASIININ(IDVariant v_CONTA, IDVariant Parametro) throws SQLException
  {
    IMDB.TblAddNew(IMDBDef7.TBL_PARASTAMSI4P, 0);
    IMDB.set_Value(IMDBDef7.TBL_PARASTAMSI4P, IMDBDef7.FLD_PARASTAMSI4P_PARAMEPROGRE, 0, IDL.Add(v_CONTA, (new IDVariant(1))));
    IMDB.set_Value(IMDBDef7.TBL_PARASTAMSI4P, IMDBDef7.FLD_PARASTAMSI4P_PARAMETRO, 0, Parametro);
  }

  // **********************************************************************
  // Stampa Data E Ora
  // Explain which processing is carried out by this procedure
  // **********************************************************************
  public int StampaDataEOra ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Stampa Data E Ora Body
      // Procedure Body
      // 
      IMDB.set_Value(IMDBDef7.TBL_DATISTAMSI4P, IMDBDef7.FLD_DATISTAMSI4P_PASTDAEORAFP, 0, (new IDVariant("SI")));
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "StampaDataEOra", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Stringa Connessione Jasper
  // Nome Stampa:  - Input
  // Parametri: Elenco parametri da passare alla stampa(nome=valore) - Input
  // Tipo: Opzionale può essere rtf -- passare in minuscolo - Optional - Input
  // **********************************************************************
  public IDVariant StringaConnessioneJasper (IDVariant NomeStampa, IDVariant Parametri, IDVariant Tipo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_OUTPUT = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Stringa Connessione Jasper Body
      // Procedure Body
      // 
      v_OUTPUT = IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(IDL.Add(((IDL.NullValue(Tipo,(new IDVariant(""))).equals((new IDVariant("")), true) || Tipo.equals((new IDVariant("pdf")), true))?IMDB.Value(IMDBDef7.TBL_DATISTAMJASP, IMDBDef7.FLD_DATISTAMJASP_PARAMETROURL, 0):IMDB.Value(IMDBDef7.TBL_DATISTAMJASP, IMDBDef7.FLD_DATISTAMJASP_PARAMURLEXPO, 0)), (new IDVariant("?"))), ((IDL.NullValue(Tipo,(new IDVariant("pdf"))).compareTo((new IDVariant("pdf")), true)!=0 && IDL.NullValue(Tipo,(new IDVariant(""))).compareTo((new IDVariant("")), true)!=0)?IDL.Add(IDL.Add((new IDVariant("type=")), Tipo), (new IDVariant("&"))):(new IDVariant("")))), (new IDVariant("project="))), IMDB.Value(IMDBDef7.TBL_DATISTAMJASP, IMDBDef7.FLD_DATISTAMJASP_PARAMEPROJEC, 0)), (new IDVariant("&"))), (new IDVariant("report="))), NomeStampa), (new IDVariant("&"))), (new IDVariant("conn="))), IMDB.Value(IMDBDef7.TBL_DATISTAMJASP, IMDBDef7.FLD_DATISTAMJASP_PARAMETRCONN, 0)), Parametri);
      return v_OUTPUT;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "StringaConnessioneJasper", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Costruisci Parametri Jasper
  // **********************************************************************
  public IDVariant CostruisciParametriJasper ()
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_DARESTITUIRE = new IDVariant(0,IDVariant.STRING);

    try
    {
      TransCount = 0;
      // 
      // Costruisci Parametri Jasper Body
      // Procedure Body
      // 
      COSTPARAJASP_PARASTAMJAS1();
      while (!IMDB.Eof(IMDBDef17.QRY_PARASTAMJAS1, 0))
      {
        v_DARESTITUIRE = IDL.Add(IDL.Add(IDL.Add(IDL.Add(v_DARESTITUIRE, (new IDVariant("&"))), IDL.ToString(IMDB.Value(IMDBDef17.QRY_PARASTAMJAS1, IMDBDef17.QSL_PARASTAMJAS1_NOMEPARAMETR, 0))), (new IDVariant("="))), IMDB.Value(IMDBDef17.QRY_PARASTAMJAS1, IMDBDef17.QSL_PARASTAMJAS1_VALOREPARAME, 0));
        IMDB.TblMoveNext(IMDBDef17.QRY_PARASTAMJAS1, 0);
      }
      return v_DARESTITUIRE;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "CostruisciParametriJasper", _e);
      return new IDVariant();
    }
  }

  // **********************************************************************
  // Parametri Stampa Jasper
  // Which data are you selecting?
  // **********************************************************************
  private void COSTPARAJASP_PARASTAMJAS1() throws SQLException
  {
    IDVariant[] AggrBuff;
    int[] AggrRowCount;
    int AggrCount=0;
    boolean AggrNewGroup = false;

    IMDB.TblTruncate(IMDBDef17.QRY_PARASTAMJAS1);
    IMDB.TblMoveFirst(IMDBDef7.TBL_PARASTAMJASP, 0);
    Loop1: while (!IMDB.Eof(IMDBDef7.TBL_PARASTAMJASP, 0))
    {
      IMDB.TblAddNew(IMDBDef17.QRY_PARASTAMJAS1, 0);
      IMDB.TblLinkRow(IMDBDef17.QRY_PARASTAMJAS1, 0, IMDBDef7.TBL_PARASTAMJASP, 0);
      IMDB.TblLinkField(IMDBDef17.QRY_PARASTAMJAS1, 0, 0, IMDBDef7.TBL_PARASTAMJASP, IMDBDef7.FLD_PARASTAMJASP_PARAMEPROGRE, 0);
      IMDB.TblLinkField(IMDBDef17.QRY_PARASTAMJAS1, 1, 0, IMDBDef7.TBL_PARASTAMJASP, IMDBDef7.FLD_PARASTAMJASP_NOMEPARAMETR, 0);
      IMDB.TblLinkField(IMDBDef17.QRY_PARASTAMJAS1, 2, 0, IMDBDef7.TBL_PARASTAMJASP, IMDBDef7.FLD_PARASTAMJASP_VALOREPARAME, 0);
      IMDB.TblMoveNext(IMDBDef7.TBL_PARASTAMJASP, 0);
      if (IMDB.Eof(IMDBDef7.TBL_PARASTAMJASP, 0))
      {
        IMDB.TblMoveFirst(IMDBDef7.TBL_PARASTAMJASP, 0);
      }
      else
      {
        continue Loop1;
      }
      break;
    }
    IMDB.TblInitSort(IMDBDef17.QRY_PARASTAMJAS1);
    IMDB.TblSortBy(IMDBDef17.QRY_PARASTAMJAS1,0,true);
    IMDB.TblStartSort(IMDBDef17.QRY_PARASTAMJAS1);
    IMDB.TblMoveFirst(IMDBDef17.QRY_PARASTAMJAS1, 0);
  }

  // **********************************************************************
  // Lancia Stampa Jasper
  // Nome Stampa:  - Input
  // Salva:  - Optional - Input
  // Percorso File:  - Optional - Input
  // Tipo: Default pdf . Può essere nullo (default) o rtf ad esempio - Optional - Input
  // **********************************************************************
  public int LanciaStampaJasper (IDVariant NomeStampa, IDVariant Salva, IDVariant PercorsoFile, IDVariant Tipo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Lancia Stampa Jasper Body
      // Procedure Body
      // 
      IDVariant v_SAVE1 = new IDVariant(0,IDVariant.STRING);
      v_SAVE1 = (new IDVariant("&save=yes&filename="));
      IDVariant v_OPZIONALE = null;
      v_OPZIONALE = (new IDVariant());
      if (Salva.equals((new IDVariant("SI")), true))
      {
        v_OPZIONALE = IDL.Add(v_SAVE1, PercorsoFile);
      }
      MainFrm.set_RedirectTo(IDL.Add(StringaConnessioneJasper(NomeStampa, CostruisciParametriJasper(), IDL.Lower(Tipo)), v_OPZIONALE));
      MainFrm.set_RedirectNewWindow((new IDVariant(-1)).booleanValue());
      MainFrm.set_RedirectFeatures((new IDVariant(""))); 
      LANCSTAMJASP_PARSTAJASDEL();
      if (ATTIVASTATIS.equals((new IDVariant("SI")), true))
      {
        MainFrm.Cf4armDBObject.STATISTICHEUTILIZZOUPDCONTATOREFORM(NomeStampa, IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIOMODULO, 0), (new IDVariant("STAMPA")), IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSIONRUOLO, 0), IMDB.Value(IMDBDef7.TBL_DATISESSIONE, IMDBDef7.FLD_DATISESSIONE_SESSUSERNAME, 0));
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "LanciaStampaJasper", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Parametri Stampa Jasper: Delete
  // Why are you deleting these data?
  // **********************************************************************
  private void LANCSTAMJASP_PARSTAJASDEL() throws SQLException
  {
    IMDB.TblTruncate(IMDBDef7.TBL_PARASTAMJASP);
  }

  // **********************************************************************
  // Set Parametro Stampa Jasper
  // Nome Parametro:  - Input
  // Valore Parametro: What data are you passing to the procedure? - Input
  // **********************************************************************
  public int SetParametroStampaJasper (IDVariant NomeParametro, IDVariant ValoreParametro)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;
    IDVariant v_CONTA = new IDVariant(0,IDVariant.INTEGER);

    try
    {
      TransCount = 0;
      // 
      // Set Parametro Stampa Jasper Body
      // Procedure Body
      // 
      SETPARSTAJAS_CFDBCFDBSEIV();
      if (!IMDB.Eof(IMDBDef17.QRY_CFDBCFDBSEIV, 0))
      {
        v_CONTA = IMDB.Value(IMDBDef17.QRY_CFDBCFDBSEIV, IMDBDef17.QSL_CFDBCFDBSEIV_MAXNUVAPAPR0, 0, IDVariant.INTEGER) ;
      }
      SETPARSTAJAS_PARSTAJAININ(v_CONTA, NomeParametro, ValoreParametro);
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SetParametroStampaJasper", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Cf4arm DB (Cf4arm DB): Select into variables
  // Which data are you selecting?
  // **********************************************************************
  private void SETPARSTAJAS_CFDBCFDBSEIV() throws SQLException
  {
    IDVariant[] AggrBuff;
    int[] AggrRowCount;
    int AggrCount=0;
    boolean AggrNewGroup = false;

    IMDB.TblTruncate(IMDBDef17.QRY_CFDBCFDBSEIV);
    IMDB.TblTruncate(IMDBDef1.TMP_RECORDSET);
    IMDB.TblMoveFirst(IMDBDef7.TBL_PARASTAMJASP, 0);
    Loop1: while (!IMDB.Eof(IMDBDef7.TBL_PARASTAMJASP, 0))
    {
      IMDB.TblAddNew(IMDBDef1.TMP_RECORDSET, 0);
      IMDB.set_Value(IMDBDef1.TMP_RECORDSET, 0, 0, IDL.NullValue(IMDB.Value(IMDBDef7.TBL_PARASTAMJASP, IMDBDef7.FLD_PARASTAMJASP_PARAMEPROGRE, 0),(new IDVariant(0))));
      IMDB.TblMoveNext(IMDBDef7.TBL_PARASTAMJASP, 0);
      if (IMDB.Eof(IMDBDef7.TBL_PARASTAMJASP, 0))
      {
        IMDB.TblMoveFirst(IMDBDef7.TBL_PARASTAMJASP, 0);
      }
      else
      {
        continue Loop1;
      }
      break;
    }
    IMDB.TblMoveFirst(IMDBDef1.TMP_RECORDSET, 0);
    AggrBuff = new IDVariant[1];
    for (int i=0; i<AggrBuff.length; i++) AggrBuff[i] = new IDVariant();
    AggrRowCount = new int[1];
    AggrCount = 0;
    IMDB.TblMoveFirst(IMDBDef1.TMP_RECORDSET, 0);
    if (IMDB.TblNumRows(IMDBDef1.TMP_RECORDSET) > 0)
    {
      while (true)
      {
        if (AggrCount == 0 && !IMDB.Eof(IMDBDef1.TMP_RECORDSET, 0))
        {
          AggrBuff[0] = IMDB.Value(IMDBDef1.TMP_RECORDSET, 0, 0);
          if (!IDL.IsNull(IMDB.Value(IMDBDef1.TMP_RECORDSET, 0, 0))) AggrRowCount[0] = 1; else AggrRowCount[0] = 0;
          AggrCount = 1;
          IMDB.TblMoveNext(IMDBDef1.TMP_RECORDSET, 0);
        }
        else
        {
          AggrNewGroup = IMDB.Eof(IMDBDef1.TMP_RECORDSET, 0);
          if (AggrNewGroup)
          {
            if (AggrCount > 0)
            {
              IMDB.TblAddNew(IMDBDef17.QRY_CFDBCFDBSEIV, 0);
              IMDB.set_Value(IMDBDef17.QRY_CFDBCFDBSEIV, 0, 0, AggrBuff[0]);
            }
            AggrCount = 0;
            if (IMDB.Eof(IMDBDef1.TMP_RECORDSET, 0)) break;
          }
          else
          {
            if (!IMDB.Eof(IMDBDef1.TMP_RECORDSET, 0))
            {
              if (!IDL.IsNull(IMDB.Value(IMDBDef1.TMP_RECORDSET, 0, 0)))
              {
                if (IDL.IsNull(AggrBuff[0]) || AggrBuff[0].compareTo(IMDB.Value(IMDBDef1.TMP_RECORDSET, 0, 0)) < 0) AggrBuff[0] = IMDB.Value(IMDBDef1.TMP_RECORDSET, 0, 0);
                AggrRowCount[0]++;
              }
              AggrCount++;
              IMDB.TblMoveNext(IMDBDef1.TMP_RECORDSET, 0);
            }
          }
        }
      }
    }
    IMDB.TblMoveFirst(IMDBDef17.QRY_CFDBCFDBSEIV, 0);
  }

  // **********************************************************************
  // Parametri Stampa Jasper: Insert into
  // Why are you inserting this record?
  // **********************************************************************
  private void SETPARSTAJAS_PARSTAJAININ(IDVariant v_CONTA, IDVariant NomeParametro, IDVariant ValoreParametro) throws SQLException
  {
    IMDB.TblAddNew(IMDBDef7.TBL_PARASTAMJASP, 0);
    IMDB.set_Value(IMDBDef7.TBL_PARASTAMJASP, IMDBDef7.FLD_PARASTAMJASP_PARAMEPROGRE, 0, IDL.Add(v_CONTA, (new IDVariant(1))));
    IMDB.set_Value(IMDBDef7.TBL_PARASTAMJASP, IMDBDef7.FLD_PARASTAMJASP_NOMEPARAMETR, 0, NomeParametro);
    IMDB.set_Value(IMDBDef7.TBL_PARASTAMJASP, IMDBDef7.FLD_PARASTAMJASP_VALOREPARAME, 0, ValoreParametro);
  }

  // **********************************************************************
  // Salva Stampa Jasper
  // Nome Stampa:  - Input
  // Percorso File:  - Optional - Input
  // Tipo: Default pdf . Può essere nullo (default) o rtf ad esempio - Optional - Input
  // **********************************************************************
  public int SalvaStampaJasper (IDVariant NomeStampa, IDVariant PercorsoFile, IDVariant Tipo)
  {
    StringBuffer SQL = new StringBuffer();
    int TransCount   = 0;
    int ReturnStatus = 0;
    IDCachedRowSet QV;

    try
    {
      TransCount = 0;
      // 
      // Salva Stampa Jasper Body
      // Procedure Body
      // 
      IDVariant v_SAVE = new IDVariant(0,IDVariant.STRING);
      v_SAVE = (new IDVariant("&save=yes&filename="));
      IDL.HttpRequest(MainFrm, IDL.Replace(IDL.Add(IDL.Add(StringaConnessioneJasper(NomeStampa, CostruisciParametriJasper(), IDL.Lower(Tipo)), v_SAVE), PercorsoFile), (new IDVariant(" ")), (new IDVariant("%20")))); 
      if (VBFiles.FileLen(PercorsoFile).compareTo((new IDVariant(0)), true)>0)
      {
        MainFrm.AddTempFile(PercorsoFile.stringValue()); 
        SALVSTAMJASP_PARSTAJASDEL();
      }
      return 0;
    }
    catch (Exception _e)
    {
      MainFrm.ErrObj.ProcError ("Cfaid", "SalvaStampaJasper", _e);
      return -1;
    }
  }

  // **********************************************************************
  // Parametri Stampa Jasper: Delete
  // Why are you deleting these data?
  // **********************************************************************
  private void SALVSTAMJASP_PARSTAJASDEL() throws SQLException
  {
    IMDB.TblTruncate(IMDBDef7.TBL_PARASTAMJASP);
  }

  
  
  // **********************************************
  // Event Stubs
  // **********************************************
  // **********************************************************************
  // Terminate
  // Evento notificato dall'applicazione subito prima della
  // chiusura della sessione utente
  // **********************************************************************
  public void TerminateApp ()
  {
    DispatchToComp("TerminateApp", new Object[] {});
    //
    // Stub
  }

  // **********************************************************************
  // On Logoff
  // Evento notificato dall'applicazione quando l'utente
  // clicca sul pulsante di logoff dell'applicazione
  // **********************************************************************
  public void OnLogoff(IDVariant Skip, IDVariant Cancel)
  {
    DispatchToComp("OnLogoff", new Object[] {Skip, Cancel});
    //
    // Stub
  }

  // **********************************************************************
  // On Resize
  // Evento notificato dall'applicazione quando cambiano
  // le dimensioni del browser
  // **********************************************************************
  public void OnWepResize()
  {
    DispatchToComp("OnWepResize", new Object[] {});
    //
    // Stub
  }

  // **********************************************************************
  // On Table Substitution
  // Evento notificato dall'applicazione quando viene eseguita
  // una query e nella from list di questa è contenuta una
  // tabella su cui è stato attivato il flag "Sostituzione
  // tabella"
  // **********************************************************************
  public void OnTableSubstitution(IDVariant PreviousTableCode, IDVariant Join, IDVariant TableCode, IDVariant Reason, IDVariant QueryType)
  {
    DispatchToComp("OnTableSubstitution", new Object[] {PreviousTableCode, Join, TableCode, Reason, QueryType});
    //
    // Stub
  }

  
  
  // **********************************************
  // Show Desktop page
  // **********************************************
  public void ShowDesktop()
  {
    if (RD3CompressFiles)
    {
      RenderAllImages(true);
    }
    else
    {
      // No compressione. Invio il file Desktop.htm
      StreamFile(RealPath + "/Desktop.htm");
    }
  }
  
  // **************************************************************
  // Gestisco l'arrivo di un comando RD3 interno all'XML
  // **************************************************************
  public boolean HandleCommand(XMLNode node)
  {
    // Leggo il nome del comando 
    String cmdvalue = node.GetAttribute("obn");
    // 
    // Inserisco il comando, e tutti gli eventuali attributi presenti, nella mappa dei parametri
    ExtractUrlParams2("CMD=" + cmdvalue);
    cmdvalue = GetUrlParam().stringValue();
    //
    // Replico la gestione del comando della MyWebEntryPoint (riga 327)
    DTTObj.SetRequestName("Command " + cmdvalue, "Query String Command Detected", DTTRequest.PRI_DATA);
    //
    boolean ro = RolObj.CheckRole();
    boolean cr = false;
    if (ro)
      cr = CmdObj.ExecCmdCode(cmdvalue); // Solo se utente già loggato!
    if (!ro || !cr)
    {
      // Lancio evento, non era gestita da un comando
      DTTObj.AddMsg(DTTEngine.DTTMSG_INFO, "", 152, "MainFrm.BeginRequest", "Fire OnCommand(" + cmdvalue + ") event");
      OnCommand(new IDVariant(cmdvalue));      
    }
    //
    if (cmdvalue.equals("?IDVER"))
      DumpVersions(true);
    if (cmdvalue.equals("?DEBUG"))
      OpenDebugWindow();
    if (cmdvalue.equals("?DTTOK"))
    {
      DTTObj.DTTStarted = true;
      set_AlertMessage(new IDVariant("DTT Started"));
    }
    if (cmdvalue.equals("?DTTKO"))
    {
      DTTObj.DTTStarted = false;
      set_AlertMessage(new IDVariant("DTT Stopped"));
    }
    //
    return true;
  }

  // **********************************************
  // Determina la lingua usata dall'applicazione
  // **********************************************
  public String GetAppLanguage()
  {
    if (RTCObj.Enabled && RolObj.glbLanguage != ".")
      return RolObj.glbLanguage;
    else
      return MyParamsObj().LANGUAGE;
  }

  // **********************************************
  // Determina l'url dell'applicazione
  // **********************************************
  public String GetAppUrl(boolean defDoc, boolean defPort)
  {
    // Solo l'applicazione sa rispondere correttamente
    if (CompOwner != null)
      return CompOwner.GetAppUrl(defDoc);
    //
    if (Request == null)
      return "";
    //
    String url = Request.getScheme() + "://";
    url += Request.getServerName();
    if (Request.getServerPort() > 0)
    {
      if (defPort && ((Request.getScheme().equals("http") && Request.getServerPort() != 80) || (Request.getScheme().equals("https") && Request.getServerPort() != 443)))
        url += ":" + Request.getServerPort();
    }
    url += Request.getContextPath();
    if (!url.endsWith("/"))
      url += "/";
    //
    // Se si vuole il documento lo aggiungo
    if (defDoc)
      url += RD3EntryPoint;
    //
    return url;
  }

  // ************************************************************
  // Creo il file di manifest
  // ************************************************************
  public void AddCustomToManifest(ArrayList CachedFiles) 
  {
    super.AddCustomToManifest(CachedFiles);
    //
    AddCaseInsensitive(CachedFiles, "bootstrap/bootstrap.min.337.css");
    AddCaseInsensitive(CachedFiles, "bootstrap/bootstrap-theme.min.337.css");
    AddCaseInsensitive(CachedFiles, "bootstrap/bootstrap.min.337.js");
    AddCaseInsensitive(CachedFiles, "bootstrap/jquery.min.1124.js");
    AddCaseInsensitive(CachedFiles, "firefox.css");
    AddCaseInsensitive(CachedFiles, "logout.htm");
    AddCaseInsensitive(CachedFiles, "error.htm");
    AddCaseInsensitive(CachedFiles, "images/logo.bmp");
    AddCaseInsensitive(CachedFiles, "images/list.gif");
    AddCaseInsensitive(CachedFiles, "images/inde.gif");
    AddCaseInsensitive(CachedFiles, "FIELDS_TO_BE_FIXED.xml");
    AddCaseInsensitive(CachedFiles, "CHARS_TO_BE_FIXED.xml");
    AddCaseInsensitive(CachedFiles, "qHelpCfaid.htm");
    AddCaseInsensitive(CachedFiles, "qHelpCfaceid.htm");
    AddCaseInsensitive(CachedFiles, "qHelpCfaesid.htm");
    AddCaseInsensitive(CachedFiles, "qHelpCfafinid.htm");
    AddCaseInsensitive(CachedFiles, "qHelpCfamuid.htm");
    AddCaseInsensitive(CachedFiles, "qHelpCfaodid.htm");
    AddCaseInsensitive(CachedFiles, "images/Icon.ico");
    AddCaseInsensitive(CachedFiles, "images/splash2.jpg");
    AddCaseInsensitive(CachedFiles, "images/wsearch.gif");
    AddCaseInsensitive(CachedFiles, "images/wsearch1.gif");
    AddCaseInsensitive(CachedFiles, "images/wlookup.gif");
    AddCaseInsensitive(CachedFiles, "images/wfind.gif");
    AddCaseInsensitive(CachedFiles, "images/wlist.gif");
    AddCaseInsensitive(CachedFiles, "images/wcancel.gif");
    AddCaseInsensitive(CachedFiles, "images/wrefresh.gif");
    AddCaseInsensitive(CachedFiles, "images/wnew.gif");
    AddCaseInsensitive(CachedFiles, "images/wdupl.gif");
    AddCaseInsensitive(CachedFiles, "images/wdelete.gif");
    AddCaseInsensitive(CachedFiles, "images/wupdate.gif");
    AddCaseInsensitive(CachedFiles, "images/print.gif");
    AddCaseInsensitive(CachedFiles, "images/open.gif");
    AddCaseInsensitive(CachedFiles, "images/button1.gif");
    AddCaseInsensitive(CachedFiles, "images/print1.gif");
    AddCaseInsensitive(CachedFiles, "images/CheckSel.JPG");
    AddCaseInsensitive(CachedFiles, "images/CheckNotSel.JPG");
    AddCaseInsensitive(CachedFiles, "images/Testo.bmp");
    AddCaseInsensitive(CachedFiles, "images/update.gif");
    AddCaseInsensitive(CachedFiles, "images/delete.gif");
    AddCaseInsensitive(CachedFiles, "images/nota scritta.gif");
    AddCaseInsensitive(CachedFiles, "images/nota bianca.gif");
    AddCaseInsensitive(CachedFiles, "images/info.gif");
    AddCaseInsensitive(CachedFiles, "images/Paste.gif");
    AddCaseInsensitive(CachedFiles, "images/Paste2.GIF");
    AddCaseInsensitive(CachedFiles, "images/tp1.gif");
    AddCaseInsensitive(CachedFiles, "images/list.gif");
    AddCaseInsensitive(CachedFiles, "images/testo.gif");
    AddCaseInsensitive(CachedFiles, "images/testo1.gif");
    AddCaseInsensitive(CachedFiles, "images/new.gif");
    AddCaseInsensitive(CachedFiles, "images/button_large.GIF");
    AddCaseInsensitive(CachedFiles, "images/search.gif");
    AddCaseInsensitive(CachedFiles, "images/next.gif");
    AddCaseInsensitive(CachedFiles, "images/pallinoRosso.gif");
    AddCaseInsensitive(CachedFiles, "images/Tras.gif");
    AddCaseInsensitive(CachedFiles, "images/vnera.gif");
    AddCaseInsensitive(CachedFiles, "images/vverde.gif");
    AddCaseInsensitive(CachedFiles, "images/dettaglio.gif");
    AddCaseInsensitive(CachedFiles, "images/smile_question.gif");
    AddCaseInsensitive(CachedFiles, "images/smileverde.gif");
    AddCaseInsensitive(CachedFiles, "images/smilerosso.gif");
    AddCaseInsensitive(CachedFiles, "images/button_very_large.GIF");
    AddCaseInsensitive(CachedFiles, "images/csv.gif");
    AddCaseInsensitive(CachedFiles, "images/cancel.gif");
    AddCaseInsensitive(CachedFiles, "images/open1.gif");
    AddCaseInsensitive(CachedFiles, "images/dupl.gif");
    AddCaseInsensitive(CachedFiles, "images/Paste3.GIF");
    AddCaseInsensitive(CachedFiles, "images/refresh.gif");
    AddCaseInsensitive(CachedFiles, "images/cancel1.gif");
    AddCaseInsensitive(CachedFiles, "images/at_grey.png");
    AddCaseInsensitive(CachedFiles, "images/at_grey_alert.png");
    AddCaseInsensitive(CachedFiles, "images/collapse.gif");
    AddCaseInsensitive(CachedFiles, "images/expand.gif");
    AddCaseInsensitive(CachedFiles, "images/clip_sm.gif");
    AddCaseInsensitive(CachedFiles, "images/collapse_red.gif");
    AddCaseInsensitive(CachedFiles, "images/expand_red.gif");
    AddCaseInsensitive(CachedFiles, "images/at_grey1.png");
    AddCaseInsensitive(CachedFiles, "images/at_grey_alert1.png");
    AddCaseInsensitive(CachedFiles, "images/arrow_down.png");
    AddCaseInsensitive(CachedFiles, "images/right.png");
    AddCaseInsensitive(CachedFiles, "images/right_plus.png");
    AddCaseInsensitive(CachedFiles, "images/wrong.png");
    AddCaseInsensitive(CachedFiles, "images/desk.png");
    AddCaseInsensitive(CachedFiles, "images/consult.png");
    AddCaseInsensitive(CachedFiles, "images/info_g.gif");
    AddCaseInsensitive(CachedFiles, "images/unlock.png");
    AddCaseInsensitive(CachedFiles, "images/multi_plus.png");
    AddCaseInsensitive(CachedFiles, "images/multi_minus.png");
    AddCaseInsensitive(CachedFiles, "images/warning.png");
    AddCaseInsensitive(CachedFiles, "images/doc_cancel.png");
    AddCaseInsensitive(CachedFiles, "images/check.png");
    AddCaseInsensitive(CachedFiles, "images/vgialla.gif");
    AddCaseInsensitive(CachedFiles, "images/list-20_icon.png");
    AddCaseInsensitive(CachedFiles, "images/list-20_y_icon.png");
    AddCaseInsensitive(CachedFiles, "images/import_export_xml_icon.jpg");
    AddCaseInsensitive(CachedFiles, "images/at_red.png");
    AddCaseInsensitive(CachedFiles, "images/at_green.png");
    AddCaseInsensitive(CachedFiles, "images/at_grey2.png");
    AddCaseInsensitive(CachedFiles, "images/at.png");
    AddCaseInsensitive(CachedFiles, "images/Manda.gif");
    AddCaseInsensitive(CachedFiles, "images/Ordina.gif");
    AddCaseInsensitive(CachedFiles, "images/zip_file.png");
    AddCaseInsensitive(CachedFiles, "images/xml_icon.png");
    AddCaseInsensitive(CachedFiles, "images/zip_file_ico_small.PNG");
    AddCaseInsensitive(CachedFiles, "images/xml.png");
    AddCaseInsensitive(CachedFiles, "images/OrdSoldi.gif");
    AddCaseInsensitive(CachedFiles, "images/ManSoldi.gif");
    AddCaseInsensitive(CachedFiles, "images/vrossa.gif");
    AddCaseInsensitive(CachedFiles, "images/at_yellow.png");
    AddCaseInsensitive(CachedFiles, "images/pagopa.png");
    AddCaseInsensitive(CachedFiles, "images/varimp.gif");
    AddCaseInsensitive(CachedFiles, "images/varacc.gif");
    AddCaseInsensitive(CachedFiles, "images/pdf.png");
    AddCaseInsensitive(CachedFiles, "images/check1.png");
    AddCaseInsensitive(CachedFiles, "images/signed.png");
    AddCaseInsensitive(CachedFiles, "images/search_db.png");
    AddCaseInsensitive(CachedFiles, "images/search_sm.gif");
    AddCaseInsensitive(CachedFiles, "images/search_db_16.png");
  }

  // ************************************************************
  // Elenca i file utilizzati dall'applicazione offline
  // ************************************************************
  public void GetFontsList(ArrayList Fonts)
  {
    super.GetFontsList(Fonts);
    //
  }

  // **************************************
  // Caricamento sessione da file (Serializable)
  // **************************************
  private void readObject(ObjectInputStream in) throws Exception
  {
    // Chiamo il serializzatore di "default"
    in.defaultReadObject();
    //
    // Serializzo classi a cui non penserebbe nessuno dato che contengono solo static stuff
    MyGlb.readObject(this, in);
    MyCmdHandler.readObject(this, in);
    MyTimerHandler.readObject(this, in);
    MyIndHandler.readObject(this, in);
  }
  private void writeObject(ObjectOutputStream out) throws Exception
  {
    // Chiamo il serializzatore di "default"
    out.defaultWriteObject();
    //
    // Serializzo classi a cui non penserebbe nessuno dato che contengono solo static stuff
    MyGlb.writeObject(this, out);
    MyCmdHandler.writeObject(this, out);
    MyTimerHandler.writeObject(this, out);
    MyIndHandler.writeObject(this, out);
  }

  class _DontSerialize extends Object {}   // Classe dummy che "spegne" la serializzazione delle sessioni
  private _DontSerialize ds = new _DontSerialize();
}
